{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "HistoryItemPrefab",
    "default",
    "type",
    "Prefab",
    "_history",
    "_viewlist",
    "_content",
    "_viewitemTemp",
    "_historyData",
    "_curRoomInfo",
    "_emptyTip",
    "onLoad",
    "node",
    "getChildByName",
    "active",
    "find",
    "children",
    "removeChild",
    "node_wh",
    "searchURL",
    "window",
    "location",
    "search",
    "indexOf",
    "substring",
    "length",
    "targetAccount",
    "split",
    "addClickEvent",
    "target",
    "component",
    "handler",
    "eventHandler",
    "EventHandler",
    "clickEvents",
    "getComponent",
    "Button",
    "push",
    "onBtnBackClicked",
    "initRoomHistoryList",
    "onBtnHistoryClicked",
    "console",
    "log",
    "self",
    "vv",
    "userMgr",
    "getHistoryList",
    "data",
    "sort",
    "a",
    "b",
    "time",
    "i",
    "j",
    "s",
    "seats",
    "name",
    "Buffer",
    "toString",
    "dateFormat",
    "date",
    "Date",
    "datetime",
    "year",
    "getFullYear",
    "month",
    "getMonth",
    "day",
    "getDate",
    "h",
    "getHours",
    "m",
    "getMinutes",
    "getSeconds",
    "format",
    "getViewItem",
    "idx",
    "titleId",
    "Label",
    "string",
    "id",
    "btnOp",
    "info",
    "score",
    "shrinkContent",
    "initGameHistoryList",
    "roomInfo",
    "create_time",
    "result",
    "JSON",
    "parse",
    "index",
    "content",
    "childrenCount",
    "instantiate",
    "addChild",
    "num",
    "lastOne",
    "getGameListOfRoom",
    "getGamesOfRoom",
    "uuid",
    "getDetailOfGame",
    "roomUUID",
    "base_info",
    "action_records",
    "gameNetMgr",
    "prepareReplay",
    "replayMgr",
    "init",
    "director",
    "loadScene",
    "onViewItemClicked",
    "event",
    "onBtnOpClicked",
    "parent"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        HistoryItemPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _history: null,\r\n        _viewlist: null,\r\n        _content: null,\r\n        _viewitemTemp: null,\r\n        _historyData: null,\r\n        _curRoomInfo: null,\r\n        _emptyTip: null,\r\n    },\r\n    // use this for initialization\r\n    onLoad: function() {\r\n        this._history = this.node.getChildByName(\"history\");\r\n        this._history.active = false;\r\n        this._emptyTip = this._history.getChildByName(\"emptyTip\");\r\n        this._emptyTip.active = true;\r\n        this._viewlist = this._history.getChildByName(\"viewlist\");\r\n        this._content = cc.find(\"view/content\", this._viewlist);\r\n        this._viewitemTemp = this._content.children[0];\r\n        this._content.removeChild(this._viewitemTemp);\r\n        var node = cc.find(\"Canvas/selectMJ/btn_zhanji\");\r\n        var node_wh = cc.find(\"Canvas/selectWH/btn_zhanji\");\r\n        node.active = false;\r\n        node_wh.active = false;\r\n        var searchURL = window.location.search;\r\n        if (searchURL && searchURL.indexOf(\"account\") != -1) {\r\n            searchURL = searchURL.substring(1, searchURL.length);\r\n            var targetAccount = searchURL.split(\"&\")[0].split(\"=\")[1];\r\n            if (targetAccount.indexOf(\"qiao\") > -1) {\r\n                node.active = true;\r\n                node_wh.active = true;\r\n            }\r\n        }\r\n        this.addClickEvent(node, this.node, \"History\", \"onBtnHistoryClicked\");\r\n        var node = cc.find(\"Canvas/history/btn_back\");\r\n        this.addClickEvent(node, this.node, \"History\", \"onBtnBackClicked\");\r\n    },\r\n    addClickEvent: function(node, target, component, handler) {\r\n        var eventHandler = new cc.Component.EventHandler();\r\n        eventHandler.target = target;\r\n        eventHandler.component = component;\r\n        eventHandler.handler = handler;\r\n        var clickEvents = node.getComponent(cc.Button).clickEvents;\r\n        clickEvents.push(eventHandler);\r\n    },\r\n    onBtnBackClicked: function() {\r\n        if (this._curRoomInfo == null) {\r\n            this._historyData = null;\r\n            this._history.active = false;\r\n        } else {\r\n            this.initRoomHistoryList(this._historyData);\r\n        }\r\n    },\r\n    onBtnHistoryClicked: function() {\r\n        console.log('点击战绩按钮');\r\n        this._history.active = true;\r\n        var self = this;\r\n        cc.vv.userMgr.getHistoryList(function(data) {\r\n            data.sort(function(a, b) {\r\n                return a.time < b.time;\r\n            });\r\n            self._historyData = data;\r\n            for (var i = 0; i < data.length; ++i) {\r\n                for (var j = 0; j < 4; ++j) {\r\n                    var s = data[i].seats[j];\r\n                    s.name = new Buffer(s.name, 'base64').toString();\r\n                }\r\n            }\r\n            self.initRoomHistoryList(data);\r\n        });\r\n    },\r\n    dateFormat: function(time) {\r\n        var date = new Date(time);\r\n        var datetime = \"{0}-{1}-{2} {3}:{4}:{5}\";\r\n        var year = date.getFullYear();\r\n        var month = date.getMonth() + 1;\r\n        month = month >= 10 ? month : (\"0\" + month);\r\n        var day = date.getDate();\r\n        day = day >= 10 ? day : (\"0\" + day);\r\n        var h = date.getHours();\r\n        h = h >= 10 ? h : (\"0\" + h);\r\n        var m = date.getMinutes();\r\n        m = m >= 10 ? m : (\"0\" + m);\r\n        var s = date.getSeconds();\r\n        s = s >= 10 ? s : (\"0\" + s);\r\n        datetime = datetime.format(year, month, day, h, m, s);\r\n        return datetime;\r\n    },\r\n    initRoomHistoryList: function(data) {\r\n        for (var i = 0; i < data.length; ++i) {\r\n            var node = this.getViewItem(i);\r\n            node.idx = i;\r\n            var titleId = \"\" + (i + 1);\r\n            node.getChildByName(\"title\").getComponent(cc.Label).string = titleId;\r\n            node.getChildByName(\"roomNo\").getComponent(cc.Label).string = \"房间ID:\" + data[i].id;\r\n            var datetime = this.dateFormat(data[i].time * 1000);\r\n            node.getChildByName(\"time\").getComponent(cc.Label).string = datetime;\r\n            var btnOp = node.getChildByName(\"btnOp\");\r\n            btnOp.idx = i;\r\n            btnOp.getChildByName(\"Label\").getComponent(cc.Label).string = \"详情\";\r\n            for (var j = 0; j < 4; ++j) {\r\n                var s = data[i].seats[j];\r\n                var info = s.name + \":\" + s.score;\r\n                //console.log(info);\r\n                node.getChildByName(\"info\" + j).getComponent(cc.Label).string = info;\r\n            }\r\n        }\r\n        this._emptyTip.active = data.length == 0;\r\n        this.shrinkContent(data.length);\r\n        this._curRoomInfo = null;\r\n    },\r\n    initGameHistoryList: function(roomInfo, data) {\r\n        data.sort(function(a, b) {\r\n            return a.create_time < b.create_time;\r\n        });\r\n        for (var i = 0; i < data.length; ++i) {\r\n            var node = this.getViewItem(i);\r\n            var idx = data.length - i - 1;\r\n            node.idx = idx;\r\n            var titleId = \"\" + (idx + 1);\r\n            node.getChildByName(\"title\").getComponent(cc.Label).string = titleId;\r\n            node.getChildByName(\"roomNo\").getComponent(cc.Label).string = \"房间ID:\" + roomInfo.id;\r\n            var datetime = this.dateFormat(data[i].create_time * 1000);\r\n            node.getChildByName(\"time\").getComponent(cc.Label).string = datetime;\r\n            var btnOp = node.getChildByName(\"btnOp\");\r\n            btnOp.idx = idx;\r\n            btnOp.getChildByName(\"Label\").getComponent(cc.Label).string = \"回放\";\r\n            var result = JSON.parse(data[i].result);\r\n            for (var j = 0; j < 4; ++j) {\r\n                var s = roomInfo.seats[j];\r\n                var info = s.name + \":\" + result[j];\r\n                //console.log(info);\r\n                node.getChildByName(\"info\" + j).getComponent(cc.Label).string = info;\r\n            }\r\n        }\r\n        this.shrinkContent(data.length);\r\n        this._curRoomInfo = roomInfo;\r\n    },\r\n    getViewItem: function(index) {\r\n        var content = this._content;\r\n        if (content.childrenCount > index) {\r\n            return content.children[index];\r\n        }\r\n        var node = cc.instantiate(this._viewitemTemp);\r\n        content.addChild(node);\r\n        return node;\r\n    },\r\n    shrinkContent: function(num) {\r\n        while (this._content.childrenCount > num) {\r\n            var lastOne = this._content.children[this._content.childrenCount - 1];\r\n            this._content.removeChild(lastOne, true);\r\n        }\r\n    },\r\n    getGameListOfRoom: function(idx) {\r\n        var self = this;\r\n        var roomInfo = this._historyData[idx];\r\n        cc.vv.userMgr.getGamesOfRoom(roomInfo.uuid, function(data) {\r\n            if (data != null && data.length > 0) {\r\n                self.initGameHistoryList(roomInfo, data);\r\n            }\r\n        });\r\n    },\r\n    getDetailOfGame: function(idx) {\r\n        var self = this;\r\n        var roomUUID = this._curRoomInfo.uuid;\r\n        cc.vv.userMgr.getDetailOfGame(roomUUID, idx, function(data) {\r\n            data.base_info = JSON.parse(data.base_info);\r\n            data.action_records = JSON.parse(data.action_records);\r\n            cc.vv.gameNetMgr.prepareReplay(self._curRoomInfo, data);\r\n            cc.vv.replayMgr.init(data);\r\n            cc.director.loadScene(\"mjgame\");\r\n        });\r\n    },\r\n    onViewItemClicked: function(event) {\r\n        var idx = event.target.idx;\r\n        console.log(idx);\r\n        if (this._curRoomInfo == null) {\r\n            this.getGameListOfRoom(idx);\r\n        } else {\r\n            this.getDetailOfGame(idx);\r\n        }\r\n    },\r\n    onBtnOpClicked: function(event) {\r\n        var idx = event.target.parent.idx;\r\n        console.log(idx);\r\n        if (this._curRoomInfo == null) {\r\n            this.getGameListOfRoom(idx);\r\n        } else {\r\n            this.getDetailOfGame(idx);\r\n        }\r\n    },\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n    // },\r\n});"
  ]
}