require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":4,"isarray":3}],3:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],4:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],"Alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c12553sxCxG/on0Bz7rkX0f', 'Alert');
// scripts/components/Alert.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _alert: null,
        _btnOK: null,
        _btnCancel: null,
        _title: null,
        _content: null,
        _onok: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._alert = cc.find("Canvas/alert");
        this._title = cc.find("Canvas/alert/title").getComponent(cc.Label);
        this._content = cc.find("Canvas/alert/content").getComponent(cc.Label);
        this._btnOK = cc.find("Canvas/alert/btn_ok");
        this._btnCancel = cc.find("Canvas/alert/btn_cancel");
        cc.vv.utils.addClickEvent(this._btnOK, this.node, "Alert", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._btnCancel, this.node, "Alert", "onBtnClicked");
        this._alert.active = false;
        cc.vv.alert = this;
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_ok") {
            if (this._onok) {
                this._onok();
            }
        }
        this._alert.active = false;
        this._onok = null;
    },
    show: function show(title, content, onok, needcancel) {
        this._alert.active = true;
        this._onok = onok;
        this._title.string = title;
        this._content.string = content;
        if (needcancel) {
            this._btnCancel.active = true;
            this._btnOK.x = -150;
            this._btnCancel.x = 150;
        } else {
            this._btnCancel.active = false;
            this._btnOK.x = 0;
        }
    },
    onDestory: function onDestory() {
        if (cc.vv) {
            cc.vv.alert = null;
        }
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"Announcement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09575MN/CxH97HxpSlbuo85', 'Announcement');
// scripts/components/Announcement.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        ima1: {
            type: cc.SpriteFrame,
            default: null
        },
        ima2: {
            type: cc.SpriteFrame,
            default: null
        },
        lContent: cc.Node,
        rContent: cc.Node
    },
    onLoad: function onLoad() {},
    onBtnSwitch: function onBtnSwitch(event) {
        for (var i = 0; i < this.lContent.children.length; i++) {
            if (i == event.target.getSiblingIndex()) {
                this.lContent.children[i].getComponent("cc.Sprite").spriteFrame = this.ima1;
                this.rContent.children[i].active = true;
            } else {
                this.lContent.children[i].getComponent("cc.Sprite").spriteFrame = this.ima2;
                this.rContent.children[i].active = false;
            }
        }
    },
    refreshAnnouncement: function refreshAnnouncement() {
        for (var i = 0; i < this.lContent.children.length; i++) {
            cc.vv.utils.addClickEvent(this.lContent.children[i], this.node, "Announcement", "onBtnSwitch");
        };
    },
    getAnnouncement: function getAnnouncement() {
        var self = this;
        var fn = function fn(ret) {
            if (ret.errcode) {
                console.log("没有公告");
            } else {
                var i = 0;
                var y = self.lContent.children[0].y;
                var h = self.lContent.children[0].height;
                var node1 = self.lContent.children[0];
                var node2 = self.rContent.children[0];
                self.lContent.removeAllChildren();
                self.rContent.removeAllChildren();
                for (var key in ret) {
                    var n1 = cc.instantiate(node1);
                    var n2 = cc.instantiate(node2);
                    n1.getChildByName('label').getComponent(cc.Label).string = ret[key].title;
                    n2.getChildByName('notice_title2').getChildByName('label').getComponent(cc.Label).string = ret[key].title;
                    n2.getChildByName('richtext').getComponent(cc.RichText).string = ret[key].content;
                    n1.y = y - i * (20 + h);
                    if (i != 0) {
                        n2.active = false;
                        n1.getComponent("cc.Sprite").spriteFrame = self.ima2;
                    } else {
                        n2.active = true;
                        n1.getComponent("cc.Sprite").spriteFrame = self.ima1;
                    }
                    self.lContent.addChild(n1);
                    self.rContent.addChild(n2);
                    i++;
                }
                self.refreshAnnouncement();
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_announcement", data, fn);
    },
    onBtnClose: function onBtnClose() {
        this.node.active = false;
    },
    update: function update(dt) {}
});

cc._RFpop();
},{}],"AnysdkMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f58cea6lrpDZJSNs2BGBqxN', 'AnysdkMgr');
// scripts/AnysdkMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _isCapturing: false
    },
    // use this for initialization
    onLoad: function onLoad() {},
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
    init: function init() {
        this.ANDROID_API = "com/vivigames/scmj/WXAPI";
        this.IOS_API = "AppController";
    },
    login: function login() {
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod(this.ANDROID_API, "Login", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod(this.IOS_API, "login");
        } else {
            console.log("platform:" + cc.sys.os + " dosn't implement share.");
        }
    },
    share: function share(title, desc) {
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod(this.ANDROID_API, "Share", "(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V", cc.vv.SI.appweb, title, desc);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod(this.IOS_API, "share:shareTitle:shareDesc:", cc.vv.SI.appweb, title, desc);
        } else {
            console.log("platform:" + cc.sys.os + " dosn't implement share.");
        }
    },
    shareResult: function shareResult() {
        if (this._isCapturing) {
            return;
        }
        this._isCapturing = true;
        var size = cc.director.getWinSize();
        var currentDate = new Date();
        var fileName = "result_share.jpg";
        var fullPath = jsb.fileUtils.getWritablePath() + fileName;
        if (jsb.fileUtils.isFileExist(fullPath)) {
            jsb.fileUtils.removeFile(fullPath);
        }
        var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height));
        texture.setPosition(cc.p(size.width / 2, size.height / 2));
        texture.begin();
        cc.director.getRunningScene().visit();
        texture.end();
        texture.saveToFile(fileName, cc.IMAGE_FORMAT_JPG);
        var self = this;
        var tryTimes = 0;
        var fn = function fn() {
            if (jsb.fileUtils.isFileExist(fullPath)) {
                var height = 100;
                var scale = height / size.height;
                var width = Math.floor(size.width * scale);
                if (cc.sys.os == cc.sys.OS_ANDROID) {
                    jsb.reflection.callStaticMethod(self.ANDROID_API, "ShareIMG", "(Ljava/lang/String;II)V", fullPath, width, height);
                } else if (cc.sys.os == cc.sys.OS_IOS) {
                    jsb.reflection.callStaticMethod(self.IOS_API, "shareIMG:width:height:", fullPath, width, height);
                } else {
                    console.log("platform:" + cc.sys.os + " dosn't implement share.");
                }
                self._isCapturing = false;
            } else {
                tryTimes++;
                if (tryTimes > 10) {
                    console.log("time out...");
                    return;
                }
                setTimeout(fn, 50);
            }
        };
        setTimeout(fn, 50);
    },
    onLoginResp: function onLoginResp(code, uid, roomid) {
        var fn = function fn(ret) {
            if (ret.errcode == 0) {
                console.log("返回的微信账号信息是:" + ret.account, ret.sign, ret.shareRoomId);
                cc.sys.localStorage.setItem("wx_account", ret.account);
                cc.sys.localStorage.setItem("wx_sign", ret.sign);
            }
            cc.vv.userMgr.onAuth(ret);
        };
        console.log("向微信发送验证请求");
        cc.vv.http.sendRequest("/wechat_auth", {
            code: code,
            uid: uid,
            os: cc.sys.os,
            roomid: roomid
        }, fn);
    }
});

cc._RFpop();
},{}],"AudioMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '55caepcpvFK5r0Ax5f8jss4', 'AudioMgr');
// scripts/AudioMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        bgmVolume: 1.0,
        sfxVolume: 1.0,
        bgmAudioID: -1
    },
    // use this for initialization
    init: function init() {
        var t = cc.sys.localStorage.getItem("bgmVolume");
        if (t != null && t > 0) {
            this.bgmVolume = parseFloat(t);
        } else {
            cc.sys.localStorage.setItem("bgmVolume", 1.0);
        };
        var t = cc.sys.localStorage.getItem("sfxVolume");
        if (t != null && t > 0) {
            this.sfxVolume = parseFloat(t);
        } else {
            cc.sys.localStorage.setItem("sfxVolume", 1.0);
        };
        cc.game.on(cc.game.EVENT_HIDE, function () {
            console.log("cc.audioEngine.pauseAll");
            cc.audioEngine.pauseAll();
        });
        cc.game.on(cc.game.EVENT_SHOW, function () {
            console.log("cc.audioEngine.resumeAll");
            cc.audioEngine.resumeAll();
        });
    },
    getUrl: function getUrl(url) {
        return cc.url.raw("resources/sounds/" + url);
    },
    playBGM: function playBGM(url) {
        var audioUrl = this.getUrl(url);
        console.log(audioUrl);
        if (this.bgmAudioID >= 0) {
            cc.audioEngine.stop(this.bgmAudioID);
        }
        this.bgmAudioID = cc.audioEngine.play(audioUrl, true, this.bgmVolume);
        var t = cc.sys.localStorage.getItem("bgmVolume");
        if (t == null) {
            t = 0;
        }
        console.log('当前音量是多少' + t);
        this.setBGMVolume(t);
        // alert("当前的id是--"+this.bgmAudioID);
    },
    playSFX: function playSFX(url) {
        var audioUrl = this.getUrl(url);
        if (this.sfxVolume > 0) {
            var audioId = cc.audioEngine.play(audioUrl, false, this.sfxVolume);
        }
    },

    setSFXVolume: function setSFXVolume(v) {
        if (this.sfxVolume != v) {
            cc.sys.localStorage.setItem("sfxVolume", v);
            this.sfxVolume = v;
        }
    },
    setBGMVolume: function setBGMVolume(v, force) {
        if (this.bgmAudioID >= 0) {
            if (v > 0) {
                cc.audioEngine.resume(this.bgmAudioID);
            } else {
                cc.audioEngine.pause(this.bgmAudioID);
            }
            //cc.audioEngine.setVolume(this.bgmAudioID,this.bgmVolume);
        }
        if (this.bgmVolume != v || force) {
            cc.sys.localStorage.setItem("bgmVolume", v);
            this.bgmVolume = v;
            cc.audioEngine.setVolume(this.bgmAudioID, v);
        }
    },
    pauseAll: function pauseAll() {
        cc.audioEngine.pauseAll();
    },
    resumeAll: function resumeAll() {
        cc.audioEngine.resumeAll();
    }
});

cc._RFpop();
},{}],"ChargeType":[function(require,module,exports){
"use strict";
cc._RFpush(module, '13f26e/5eVFWbY53112nuHF', 'ChargeType');
// scripts/components/ChargeType.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _charge: null,
        // 标题
        _title: null,
        // 确认按钮
        _btnOK: null,
        // 取消按钮
        _btnCancel: null,
        // 输入框
        _editbox: null,
        // 显示输入的金币数量
        _content: null,
        // 显示兑换率
        _rateTxt: null,
        _chargeCnt: null,
        _rate: 1,
        _costRMB: 0,
        // 最少充值数量
        _MINCOST: 1,
        _MAXCOSTRMB: 99999,
        _payParam: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.initUI();
        //FIXME:  当前的兑换率是
        this.refreshInfo();
        cc.vv.chargeType = this;
    },
    initUI: function initUI() {
        this._charge = cc.find("Canvas/zuanshiChange");
        this._btnOK = cc.find("Canvas/zuanshiChange/yes").getComponent(cc.Button);
        this._btnCancel = cc.find("Canvas/zuanshiChange/no").getComponent(cc.Button);
        this._editbox = cc.find("Canvas/zuanshiChange/editbox").getComponent(cc.EditBox);
    },
    onCloseBtnClicked: function onCloseBtnClicked() {
        console.log("关闭界面");
        this._editbox.string = "";
        this._charge.active = false;
        cc.vv.wc.hide();
    },
    onConfirmBtnClicked: function onConfirmBtnClicked() {
        this.refreshInfo();
        // 验证是不是整数，不是整数要求重新输入
        console.log("金额是", this._costRMB);
        var flag = this.validateIntNum(this._costRMB);
        if (!flag) {
            var str = "请输入整数金额,且最小充值金额" + this._MINCOST + "元";
            cc.vv.alert.show("注意", str);
        } else {
            var fn = function fn(ret) {
                cc.vv.wc.hide();
                if (ret == null) {
                    cc.vv.alert.show("注意", "充值失败请稍后重试");
                    return;
                }
                this.sendChargeRequest(ret);
                cc.vv.wc.show("正在充值，请稍后");
                cc.vv.userMgr.refreshTime = 2000;
            };
            var data = {
                account: cc.vv.userMgr.account,
                sign: cc.vv.userMgr.sign,
                userid: cc.vv.userMgr.userId,
                costRMB: this._costRMB,
                ship_type: 1
            };
            cc.vv.wc.show("正在充值，请稍后");
            cc.vv.http.sendRequest("/go_to_charge", data, fn.bind(this));
        }
    },
    show: function show() {
        this._charge.active = true;
    },
    refreshInfo: function refreshInfo() {
        this._rate = 1 || cc.vv.userMgr.chargerate;
        this._costRMB = Number(this._editbox.string);
        console.log('this.cost', this._costRMB);
        // this._chargeCnt = (this._chargeCnt * this._rate).toFixed(0);
        // if (!this._costRMB) {
        //     this._content.string = "您当前未输入充值金额";
        // } else {
        //     this._content.string = "您输入的金额是:" + this._costRMB;
        // }
    },
    // 判断是不是输入的正确的金额
    validateIntNum: function validateIntNum(val) {
        var patten = /^[1-9]\d*$/;
        var flag = patten.test(val);
        if (!flag) {
            return false;
        } else {
            console.log("当前输入的数字是正整数", val, this._MINCOST);
            return val >= this._MINCOST;
        }
    },
    // 发送申请充值请求
    sendChargeRequest: function sendChargeRequest(data) {
        if (data == null) {
            cc.vv.alert.show("注意", "充值失败请稍后重试");
            return;
        }
        console.log("发送 充值请求");
        var url = data.url;
        var xhr = cc.loader.getXMLHttpRequest();
        xhr.open("POST", url, true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status >= 200 && xhr.status <= 207) {
                var httpStatus = xhr.statusText;
                var response = JSON.parse(xhr.responseText);
                console.log("返回！！！！！" + response.errmsg + "response.errcode:" + response.errcode);
                if (response.errcode == 0) {
                    var ret = response.errmsg;
                    console.log("返回的结果是!!!!!!" + ret);
                    this._payParam = ret;
                    if (!cc.sys.isNative) {
                        console.log("是H5游戏");
                        window.pay(this._payParam);
                    }
                    // 接收完后，隐藏充值窗口
                    this.onCloseBtnClicked();
                } else {
                    cc.vv.alert.show("注意", "充值失败请稍后重试");
                    cc.vv.wc.hide();
                    console.log("返回的结果出错");
                }
            } else {
                console.log("无结果返回");
            }
        }.bind(this);
        xhr.timeout = 5000; // 5 seconds for timeout
        var req = JSON.stringify(data);
        xhr.send(req);
    }
});

cc._RFpop();
},{}],"Charge":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5102696ophLmZJO8XdAVsYZ', 'Charge');
// scripts/components/Charge.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _charge: null,
        // 标题
        _title: null,
        // 确认按钮
        _btnOK: null,
        // 取消按钮
        _btnCancel: null,
        // 输入框
        _editbox: null,
        // 显示输入的金币数量
        _content: null,
        // 显示兑换率
        _rateTxt: null,
        _chargeCnt: null,
        _rate: 1,
        _costRMB: 0,
        // 最少充值数量
        _MINCOST: 1,
        _MAXCOSTRMB: 99999,
        _payParam: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.initUI();
        //FIXME:  当前的兑换率是
        this.refreshInfo();
        cc.vv.charge = this;
    },
    initUI: function initUI() {
        this._charge = cc.find("Canvas/charge");
        this._title = cc.find("Canvas/charge/title").getComponent(cc.Label);
        this._btnOK = cc.find("Canvas/charge/btn_ok").getComponent(cc.Button);
        this._btnCancel = cc.find("Canvas/charge/btn_cancel").getComponent(cc.Button);
        this._editbox = cc.find("Canvas/charge/editbox").getComponent(cc.EditBox);
        this._content = cc.find("Canvas/charge/content").getComponent(cc.Label);
        this._rateTxt = cc.find("Canvas/charge/rate").getComponent(cc.Label);
    },
    onCloseBtnClicked: function onCloseBtnClicked() {
        console.log("关闭界面");
        this._editbox.string = "";
        this._charge.active = false;
        cc.vv.wc.hide();
    },
    onConfirmBtnClicked: function onConfirmBtnClicked() {
        this.refreshInfo();
        // 验证是不是整数，不是整数要求重新输入
        console.log("金额是", this._costRMB);
        var flag = this.validateIntNum(this._costRMB);
        if (!flag) {
            var str = "请输入整数金额,且最小充值金额" + this._MINCOST + "元";
            cc.vv.alert.show("注意", str);
        } else {
            var fn = function fn(ret) {
                cc.vv.wc.hide();
                if (ret == null) {
                    cc.vv.alert.show("注意", "充值失败请稍后重试");
                    return;
                }
                this.sendChargeRequest(ret);
                cc.vv.wc.show("正在充值，请稍后");
                cc.vv.userMgr.refreshTime = 2000;
            };
            var data = {
                account: cc.vv.userMgr.account,
                sign: cc.vv.userMgr.sign,
                userid: cc.vv.userMgr.userId,
                costRMB: this._costRMB,
                ship_type: 0
            };
            cc.vv.wc.show("正在充值，请稍后");
            cc.vv.http.sendRequest("/go_to_charge", data, fn.bind(this));
        }
    },
    show: function show() {
        this._charge.active = true;
    },
    refreshInfo: function refreshInfo() {
        this._rate = 1 || cc.vv.userMgr.chargerate;
        this._costRMB = Number(this._editbox.string);
        console.log('this.cost', this._costRMB);
        // this._chargeCnt = (this._chargeCnt * this._rate).toFixed(0);
        if (!this._costRMB) {
            this._content.string = "您当前未输入充值金额";
        } else {
            this._content.string = "您输入的金额是:" + this._costRMB;
        }
    },
    // 判断是不是输入的正确的金额
    validateIntNum: function validateIntNum(val) {
        var patten = /^[1-9]\d*$/;
        var flag = patten.test(val);
        if (!flag) {
            return false;
        } else {
            console.log("当前输入的数字是正整数", val, this._MINCOST);
            return val >= this._MINCOST;
        }
    },
    // 发送申请充值请求
    sendChargeRequest: function sendChargeRequest(data) {
        if (data == null) {
            cc.vv.alert.show("注意", "充值失败请稍后重试");
            return;
        }
        console.log("发送 充值请求");
        var url = "http://mj.yajugame.com/manage1/?/go/index/payDo/";
        var xhr = cc.loader.getXMLHttpRequest();
        xhr.open("POST", url, true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status >= 200 && xhr.status <= 207) {
                var httpStatus = xhr.statusText;
                var response = JSON.parse(xhr.responseText);
                console.log("返回！！！！！" + response.errmsg + "response.errcode:" + response.errcode);
                if (response.errcode == 0) {
                    var ret = response.errmsg;
                    console.log("返回的结果是!!!!!!" + ret);
                    this._payParam = ret;
                    if (!cc.sys.isNative) {
                        console.log("是H5游戏");
                        window.pay(this._payParam);
                    }
                    // 接收完后，隐藏充值窗口
                    this.onCloseBtnClicked();
                } else {
                    cc.vv.alert.show("注意", "充值失败请稍后重试");
                    cc.vv.wc.hide();
                    console.log("返回的结果出错");
                }
            } else {
                console.log("无结果返回");
            }
        }.bind(this);
        xhr.timeout = 5000; // 5 seconds for timeout
        var req = JSON.stringify(data);
        xhr.send(req);
    }
});

cc._RFpop();
},{}],"Chat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '58f27rxustNsYlRX3fryN8X', 'Chat');
// scripts/components/Chat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _chatRoot: null,
        _tabQuick: null,
        _tabEmoji: null,
        _iptChat: null,
        _quickChatInfo: null,
        _btnChat: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        cc.vv.chat = this;
        this._btnChat = this.node.getChildByName("btn_chat");
        this._btnChat.active = cc.vv.replayMgr.isReplay() == false;
        this._chatRoot = this.node.getChildByName("chat");
        this._chatRoot.active = false;
        this._tabQuick = this._chatRoot.getChildByName("quickchatlist");
        this._tabEmoji = this._chatRoot.getChildByName("emojis");
        this._iptChat = this._chatRoot.getChildByName("iptChat").getComponent(cc.EditBox);
        this._quickChatInfo = {};
        this._quickChatInfo["item0"] = {
            index: 0,
            content: "快点啊，都等到我花儿都谢谢了！",
            sound: "fix_msg_1.mp3"
        };
        this._quickChatInfo["item1"] = {
            index: 1,
            content: "怎么又断线了，网络怎么这么差啊！",
            sound: "fix_msg_2.mp3"
        };
        this._quickChatInfo["item2"] = {
            index: 2,
            content: "不要走，决战到天亮！",
            sound: "fix_msg_3.mp3"
        };
        this._quickChatInfo["item3"] = {
            index: 3,
            content: "你的牌打得也太好了！",
            sound: "fix_msg_4.mp3"
        };
        this._quickChatInfo["item4"] = {
            index: 4,
            content: "你是妹妹还是哥哥啊？",
            sound: "fix_msg_5.mp3"
        };
        this._quickChatInfo["item5"] = {
            index: 5,
            content: "和你合作真是太愉快了！",
            sound: "fix_msg_6.mp3"
        };
        this._quickChatInfo["item6"] = {
            index: 6,
            content: "大家好，很高兴见到各位！",
            sound: "fix_msg_7.mp3"
        };
        this._quickChatInfo["item7"] = {
            index: 7,
            content: "各位，真是不好意思，我得离开一会儿。",
            sound: "fix_msg_8.mp3"
        };
        this._quickChatInfo["item8"] = {
            index: 8,
            content: "不要吵了，专心玩游戏吧！",
            sound: "fix_msg_9.mp3"
        };
    },
    getQuickChatInfo: function getQuickChatInfo(index) {
        var key = "item" + index;
        return this._quickChatInfo[key];
    },

    onBtnChatClicked: function onBtnChatClicked() {
        this._chatRoot.active = true;
    },
    onBgClicked: function onBgClicked() {
        this._chatRoot.active = false;
    },
    onTabClicked: function onTabClicked(event) {
        if (event.target.name == "tabQuick") {
            this._tabQuick.active = true;
            this._tabEmoji.active = false;
        } else if (event.target.name == "tabEmoji") {
            this._tabQuick.active = false;
            this._tabEmoji.active = true;
        }
    },
    onQuickChatItemClicked: function onQuickChatItemClicked(event) {
        this._chatRoot.active = false;
        var info = this._quickChatInfo[event.target.name];
        cc.vv.net.send("quick_chat", info.index);
    },
    onEmojiItemClicked: function onEmojiItemClicked(event) {
        console.log(event.target.name);
        this._chatRoot.active = false;
        cc.vv.net.send("emoji", event.target.name);
    },
    onBtnSendChatClicked: function onBtnSendChatClicked() {
        this._chatRoot.active = false;
        if (this._iptChat.string == "") {
            return;
        }
        cc.vv.net.send("chat", this._iptChat.string);
        this._iptChat.string = "";
    }
});

cc._RFpop();
},{}],"CheckBox":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc9e5hcegFBFpbh0CwUFw8V', 'CheckBox');
// scripts/components/CheckBox.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        target: cc.Node,
        sprite: cc.SpriteFrame,
        checkedSprite: cc.SpriteFrame,
        checked: false
    },
    // use this for initialization
    onLoad: function onLoad() {
        this.refresh();
    },
    onClicked: function onClicked() {
        this.checked = !this.checked;
        this.refresh();
    },
    refresh: function refresh() {
        var targetSprite = this.target.getComponent(cc.Sprite);
        if (this.checked) {
            targetSprite.spriteFrame = this.checkedSprite;
        } else {
            targetSprite.spriteFrame = this.sprite;
        }
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"Collapse":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a0204tG1oNHzbCpkxGvdJW8', 'Collapse');
// scripts/Collapse.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        bthLQ1: cc.Node,
        bthLQ2: cc.Node,
        bthLQ3: cc.Node,
        bthLQ4: cc.Node,
        bthSC1: cc.Node,
        bthSC2: cc.Node,
        left_content: cc.Node,
        right_content: cc.Node,
        ima1: {
            type: cc.SpriteFrame,
            default: null
        },
        ima2: {
            type: cc.SpriteFrame,
            default: null
        }
    },
    // use this for initialization
    onLoad: function onLoad() {
        cc.vv.utils.addClickEvent(this.bthLQ1, this.node, "Collapse", "onBtnLq");
        cc.vv.utils.addClickEvent(this.bthLQ3, this.node, "Collapse", "onBtnLq");
        for (var i = 0; i < this.left_content.children.length; i++) {
            cc.vv.utils.addClickEvent(this.left_content.children[i], this.node, "Collapse", "onBtnSwitch");
        };
    },
    onBtnSwitch: function onBtnSwitch(event) {
        for (var i = 0; i < this.left_content.children.length; i++) {
            if (i == event.target.getSiblingIndex()) {
                this.left_content.children[i].getComponent("cc.Sprite").spriteFrame = this.ima1;
                this.right_content.children[i].active = true;
            } else {
                this.left_content.children[i].getComponent("cc.Sprite").spriteFrame = this.ima2;
                this.right_content.children[i].active = false;
            }
        }
    },
    refreshBtns: function refreshBtns() {
        if (cc.vv.userMgr.collapse_prise >= 2) {
            this.bthLQ1.active = false;
            this.bthLQ2.active = true;
            this.bthLQ3.active = false;
            this.bthLQ4.active = true;
        } else {
            if (cc.vv.userMgr.collapse_prise == 1) {
                if (parseInt(cc.vv.userMgr.gems) < 10000) {
                    this.bthLQ1.active = false;
                    this.bthLQ2.active = true;
                    this.bthLQ3.active = true;
                    this.bthLQ4.active = false;
                } else {
                    this.bthLQ1.active = false;
                    this.bthLQ2.active = true;
                    this.bthLQ3.active = false;
                    this.bthLQ4.active = true;
                }
            }
            if (cc.vv.userMgr.collapse_prise <= 0) {
                if (parseInt(cc.vv.userMgr.gems) < 10000) {
                    this.bthLQ1.active = true;
                    this.bthLQ2.active = false;
                    this.bthLQ3.active = false;
                    this.bthLQ4.active = true;
                } else {
                    this.bthLQ1.active = false;
                    this.bthLQ2.active = true;
                    this.bthLQ3.active = false;
                    this.bthLQ4.active = true;
                }
            }
        }
        if (cc.vv.userMgr.is_first_charge == 1) {
            this.bthSC1.active = true;
            this.bthSC2.active = false;
        } else {
            this.bthSC1.active = false;
            this.bthSC2.active = true;
        }
    },
    onBtnLq: function onBtnLq() {
        var self = this;
        var fn = function fn(ret) {
            if (ret.errcode == 0) {
                cc.vv.userMgr.gems = ret.gems;
                cc.vv.userMgr.coins = ret.coins;
                cc.vv.userMgr.collapse_prise = ret.collapse_prise;
            }
            self.refreshBtns();
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_user_collapse", data, fn);
    },
    onBtnSC: function onBtnSC() {
        var self = this;
        var fn = function fn(ret) {
            if (ret.errcode == 0) {
                cc.vv.userMgr.gems = ret.gems;
                cc.vv.userMgr.coins = ret.coins;
                cc.vv.userMgr.is_first_charge = ret.is_first_charge;
            }
            self.refreshBtns();
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_user_first_charge", data, fn);
    },
    update: function update(dt) {}
});

cc._RFpop();
},{}],"CqNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '86cf71G/4VA35+lnYHmSM6a', 'CqNetMgr');
// scripts/CqNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    initHandlers: function initHandlers(GameNet) {
        var self = GameNet;
        cc.vv.net.addHandler("login_result", function (data) {
            console.log("login_result===>", data);
            if (data.errcode === 0) {
                var data = data.data;
                self.roomId = data.roomid;
                self.room_type = data.conf.room_type;
                self.conf = data.conf;
                self.maxNumOfGames = data.conf.maxGames;
                self.numOfGames = data.numofgames;
                self.seats = data.seats;
                self.seatIndex = self.getSeatIndexByID(cc.vv.userMgr.userId);
                self.isOver = false;
                self.cq_data = data.data;
            } else {
                console.log(data.errmsg);
            }
        });
        cc.vv.net.addHandler("login_finished", function (data) {
            console.log("login_finished");
            cc.director.loadScene("caiquan");
        });
        cc.vv.net.addHandler("exit_result", function (data) {
            self.roomId = null;
            self.room_type = -1;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("dispress_push", function (data) {
            self.roomId = null;
            self.room_type = -1;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("disconnect", function (data) {
            self.roomId = null;
            self.room_type = -1;
            self.cqDispatchEvent("disconnect");
        });
        cc.vv.net.addHandler("cq_begin_push", function (data) {
            console.log("cq_begin_push");
            self.cqDispatchEvent("cq_begin", data);
        });
        cc.vv.net.addHandler("cq_new_user_comes_push", function (data) {
            console.log("cq_new_user_comes_push", data);
            self.cq_data = data.data;
            self.cqDispatchEvent("cq_new_user", data);
        });
        cc.vv.net.addHandler("cq_game_over_push", function (data) {
            console.log("cq_game_over_push", data);
            self.cqDispatchEvent("cq_game_over", data);
        });
        cc.vv.net.addHandler("cq_game_time_push", function (data) {
            // console.log("cq_game_time_push", data);
            self.cqDispatchEvent("cq_game_time", data);
        });
        cc.vv.net.addHandler("cq_exit_notify_push", function (data) {
            var userId = data;
            self.cqDispatchEvent("cq_exit_notify", userId);
        });
        cc.vv.net.addHandler("cq_dispress_push", function (data) {
            var userId = data;
            self.roomId = null;
            self.room_type = -1;
            self.turn = -1;
            self.seats = null;
            self.cq_data = null;
            self.cqDispatchEvent("cq_dispress", userId);
        });
        cc.vv.net.addHandler("cq_loser_notify_push", function (data) {
            var userId = data;
            if (cc.vv.userMgr.userId == userId) {
                self.roomId = null;
                self.room_type = -1;
                self.turn = -1;
                self.seats = null;
                self.cq_data = null;
            }
            self.cqDispatchEvent("cq_loser_notify", userId);
        });
        cc.vv.net.addHandler("cq_winner_notify_push", function (data) {
            var userId = data;
            self.roomId = null;
            self.room_type = -1;
            self.turn = -1;
            self.seats = null;
            self.cq_data = null;
            self.cqDispatchEvent("cq_winner_notify", userId);
        });
        cc.vv.net.addHandler("cq_chuquan_notify_push", function (data) {
            self.cqDispatchEvent("cq_chuquan_notify", data);
        });
    }
});

cc._RFpop();
},{}],"CreateRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'eec07HsL4pBn5/PiT3SYBew', 'CreateRoom');
// scripts/components/CreateRoom.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _difenxuanze: null,
        _zimo: null,
        _wanfaxuanze: null,
        _jushuxuanze: null,
        _dianganghua: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        this._difenxuanze = [];
        var t = this.node.getChildByName("difenxuanze");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._difenxuanze.push(n);
            }
        }
        console.log(this._difenxuanze);
        this._wanfaxuanze = [];
        var t = this.node.getChildByName("wanfaxuanze");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("CheckBox");
            if (n != null) {
                this._wanfaxuanze.push(n);
            }
        }
        console.log(this._wanfaxuanze);
        this._jushuxuanze = [];
        var t = this.node.getChildByName("xuanzejushu");
        for (var i = 0; i < t.childrenCount; ++i) {
            var n = t.children[i].getComponent("RadioButton");
            if (n != null) {
                this._jushuxuanze.push(n);
            }
        }
    },
    onBtnBack: function onBtnBack() {
        this.node.active = false;
    },
    onBtnOK: function onBtnOK() {
        this.node.active = false;
        this.createRoom();
    },
    createRoom: function createRoom() {
        var self = this;
        var onCreate = function onCreate(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                //console.log(ret.errmsg);
                if (ret.errcode == 2222) {
                    cc.vv.alert.show("提示", "金币不足，创建房间失败!");
                } else {
                    cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                }
            } else {
                cc.vv.userMgr.room_type = 0;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        var difen = 0;
        for (var i = 0; i < self._difenxuanze.length; ++i) {
            if (self._difenxuanze[i].checked) {
                difen = i;
                break;
            }
        }
        var yikouxiang = self._wanfaxuanze[0].checked;
        var yipaoduoxiang = self._wanfaxuanze[1].checked;
        // 类型选择一口香，默认设置不可修改
        var type = "ykx";
        var jushuxuanze = 0;
        for (var i = 0; i < self._jushuxuanze.length; ++i) {
            if (self._jushuxuanze[i].checked) {
                jushuxuanze = i;
                break;
            }
        }
        var conf = {
            room_type: 0, //0代表麻将房间
            type: type,
            difen: difen,
            jushuxuanze: jushuxuanze,
            yipaoduoxiang: yipaoduoxiang
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        console.log(data);
        cc.vv.wc.show("正在创建房间");
        cc.vv.http.sendRequest("/create_private_room", data, onCreate);
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"DnChat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4f140eGiLhFPKjLpkkOkFGo', 'DnChat');
// scripts/components/DnChat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _chatRoot: null,
        _tabQuick: null,
        _tabEmoji: null,
        _iptChat: null,
        _quickChatInfo: null,
        _btnChat: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        cc.vv.zjhchat = this;
        // this._btnChat = this.node.getChildByName("xinxi");
        // this._btnChat.active = cc.vv.replayMgr.isReplay() == false;
        this._chatRoot = this.node.getChildByName("chat");
        this._chatRoot.active = false;
        this._tabQuick = this._chatRoot.getChildByName("quickchatlist");
        this._tabEmoji = this._chatRoot.getChildByName("emojis");
        this._iptChat = this._chatRoot.getChildByName("iptChat").getComponent(cc.EditBox);
        this._quickChatInfo = {};
        this._quickChatInfo["item0"] = {
            index: 0,
            content: "快点啊，都等到我花儿都谢谢了！",
            sound: "fix_msg_1.mp3"
        };
        this._quickChatInfo["item1"] = {
            index: 1,
            content: "怎么又断线了，网络怎么这么差啊！",
            sound: "fix_msg_2.mp3"
        };
        this._quickChatInfo["item2"] = {
            index: 2,
            content: "不要走，决战到天亮！",
            sound: "fix_msg_3.mp3"
        };
        this._quickChatInfo["item3"] = {
            index: 3,
            content: "你的牌打得也太好了！",
            sound: "fix_msg_4.mp3"
        };
        this._quickChatInfo["item4"] = {
            index: 4,
            content: "你是妹妹还是哥哥啊？",
            sound: "fix_msg_5.mp3"
        };
        this._quickChatInfo["item5"] = {
            index: 5,
            content: "和你合作真是太愉快了！",
            sound: "fix_msg_6.mp3"
        };
        this._quickChatInfo["item6"] = {
            index: 6,
            content: "大家好，很高兴见到各位！",
            sound: "fix_msg_7.mp3"
        };
        this._quickChatInfo["item7"] = {
            index: 7,
            content: "各位，真是不好意思，我得离开一会儿。",
            sound: "fix_msg_8.mp3"
        };
        this._quickChatInfo["item8"] = {
            index: 8,
            content: "不要吵了，专心玩游戏吧！",
            sound: "fix_msg_9.mp3"
        };
    },
    getQuickChatInfo: function getQuickChatInfo(index) {
        var key = "item" + index;
        return this._quickChatInfo[key];
    },

    onBtnChatClicked: function onBtnChatClicked() {
        this._chatRoot.active = true;
    },
    onBgClicked: function onBgClicked() {
        this._chatRoot.active = false;
    },
    onTabClicked: function onTabClicked(event) {
        if (event.target.name == "tabQuick") {
            this._tabQuick.active = true;
            this._tabEmoji.active = false;
        } else if (event.target.name == "tabEmoji") {
            this._tabQuick.active = false;
            this._tabEmoji.active = true;
        }
    },
    onQuickChatItemClicked: function onQuickChatItemClicked(event) {
        this._chatRoot.active = false;
        var info = this._quickChatInfo[event.target.name];
        cc.vv.net.send("quick_chat", info.index);
    },
    onEmojiItemClicked: function onEmojiItemClicked(event) {
        console.log(event.target.name);
        this._chatRoot.active = false;
        cc.vv.net.send("emoji", event.target.name);
    },
    onBtnSendChatClicked: function onBtnSendChatClicked() {
        this._chatRoot.active = false;
        if (this._iptChat.string == "") {
            return;
        }
        cc.vv.net.send("chat", this._iptChat.string);
        this._iptChat.string = "";
    }
});

cc._RFpop();
},{}],"DnNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b88c0v9pnZPgKkHlfIEBTYl', 'DnNetMgr');
// scripts/DnNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    initHandlers: function initHandlers(GameNet) {
        var self = GameNet;
        cc.vv.net.addHandler("login_result", function (data) {
            console.log("login_result===>", data);
            if (data.errcode === 0) {
                var data = data.data;
                self.roomId = data.roomid;
                self.room_type = data.conf.room_type;
                self.conf = data.conf;
                self.maxNumOfGames = data.conf.maxGames;
                self.numOfGames = data.numofgames;
                self.seats = data.seats;
                self.seatIndex = self.getSeatIndexByID(cc.vv.userMgr.userId);
                self.isOver = false;
                self.cq_data = data.data;
            } else {
                console.log(data.errmsg);
            }
        });
        cc.vv.net.addHandler("login_finished", function (data) {
            console.log("login_finished");
            cc.director.loadScene("dngame");
        });
        cc.vv.net.addHandler("exit_result", function (data) {
            self.roomId = null;
            self.room_type = -1;
            self.turn = -1;
            // self.seats = null;
            if (data) {
                //特殊情况下（锦标赛等）可以设置这里的data，在退出的时候进行操作
                self.actionData = data;
            }
        });
        cc.vv.net.addHandler("exit_notify_push", function (data) {
            var userId = data;
            var s = self.getSeatByID(userId);
            if (s != null) {
                s.userid = 0;
                s.name = "";
                self.dispatchEvent("user_state_changed", s);
            }
        });
        cc.vv.net.addHandler("chat_push", function (data) {
            self.dispatchEvent("chat_push", data);
        });
        cc.vv.net.addHandler("quick_chat_push", function (data) {
            self.dispatchEvent("quick_chat_push", data);
        });
        cc.vv.net.addHandler("emoji_push", function (data) {
            self.dispatchEvent("emoji_push", data);
        });
        cc.vv.net.addHandler("not_exit_push", function (data) {
            self.dispatchEvent("not_exit", data);
        });
        cc.vv.net.addHandler("count_down_push", function (data) {
            self.dispatchEvent("count_down", data);
        });
        cc.vv.net.addHandler("match_exit_error", function (data) {
            self.dispatchEvent('match_exit_error');
        });
        cc.vv.net.addHandler("dispress_push", function (data) {
            self.roomId = null;
            self.room_type = -1;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("disconnect", function (data) {
            var actionData = self.actionData;
            self.dispatchEvent("exit_room");
            if (self.roomId == null) {
                if (actionData) {
                    if (actionData.msg) {
                        cc.vv.alert.show("提示", actionData.msg);
                    }
                    setTimeout(function () {
                        self.actionData = null;
                        cc.director.loadScene("newhall");
                    }, actionData.delay * 1000);
                } else {
                    cc.director.loadScene("newhall");
                }
                self.room_type = -1;
            } else {
                if (self.isOver == false) {
                    cc.vv.userMgr.oldRoomId = self.roomId;
                    self.dispatchEvent("disconnect");
                } else {
                    self.roomId = null;
                    self.room_type = -1;
                }
            }
        });
        // 新人加入房间
        cc.vv.net.addHandler("new_user_comes_push", function (data) {
            var seatIndex = data.seatindex;
            if (self.seats[seatIndex].userid > 0) {
                self.seats[seatIndex].online = true;
            } else {
                data.online = true;
                self.seats[seatIndex] = data;
            }
            self.dispatchEvent('new_user', self.seats[seatIndex]);
        });
        //游戏初始化 
        cc.vv.net.addHandler("game_initInfo_push", function (data) {
            var gameInfo = data.gameInfo;
            self.dispatchEvent('game_init', gameInfo);
        });
        cc.vv.net.addHandler("game_begin_push", function (data) {
            var data = data;
            self.dispatchEvent('game_begin', data);
        });
        cc.vv.net.addHandler("game_b_OneQzEnd", function (data) {
            var data = data;
            self.dispatchEvent('show_qiang', data);
        });
        cc.vv.net.addHandler("game_zhuangSelected_push", function (data) {
            var data = data;
            self.dispatchEvent('game_zhuangSelected', data);
        });
        cc.vv.net.addHandler("game_myXzBegin_push", function (data) {
            var data = data;
            self.dispatchEvent('game_myXzBegin', data);
        });
        cc.vv.net.addHandler("game_myHoldsUpdate_push", function (data) {
            var data = data;
            self.dispatchEvent('game_myHoldsUpdate', data);
        });
        cc.vv.net.addHandler("game_myXzEnd_push", function (data) {
            var data = data;
            self.dispatchEvent('game_myXzEnd', data);
        });
        cc.vv.net.addHandler("game_b_OneXzEnd", function (data) {
            var data = data;
            self.dispatchEvent('show_beiShuText', data);
        });
        cc.vv.net.addHandler("game_b_OneSnEnd", function (data) {
            var data = data;
            self.dispatchEvent('game_b_OneSnEnd', data);
        });
        cc.vv.net.addHandler("game_showAllUser_push", function (data) {
            var data = data;
            self.dispatchEvent('game_showAllUser', data);
        });
    }
});

cc._RFpop();
},{}],"DzpkChat":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e962ci+LvxH+IxIaKKQZ1Ly', 'DzpkChat');
// scripts/components/DzpkChat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _chatRoot: null,
        _tabQuick: null,
        _tabEmoji: null,
        _iptChat: null,
        _quickChatInfo: null,
        _btnChat: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        cc.vv.zjhchat = this;
        // this._btnChat = this.node.getChildByName("xinxi");
        // this._btnChat.active = cc.vv.replayMgr.isReplay() == false;
        this._chatRoot = this.node.getChildByName("chat");
        this._chatRoot.active = false;
        this._tabQuick = this._chatRoot.getChildByName("quickchatlist");
        this._tabEmoji = this._chatRoot.getChildByName("emojis");
        this._iptChat = this._chatRoot.getChildByName("iptChat").getComponent(cc.EditBox);
        this._quickChatInfo = {};
        this._quickChatInfo["item0"] = {
            index: 0,
            content: "快点啊，都等到我花儿都谢谢了！",
            sound: "fix_msg_1.mp3"
        };
        this._quickChatInfo["item1"] = {
            index: 1,
            content: "怎么又断线了，网络怎么这么差啊！",
            sound: "fix_msg_2.mp3"
        };
        this._quickChatInfo["item2"] = {
            index: 2,
            content: "不要走，决战到天亮！",
            sound: "fix_msg_3.mp3"
        };
        this._quickChatInfo["item3"] = {
            index: 3,
            content: "你的牌打得也太好了！",
            sound: "fix_msg_4.mp3"
        };
        this._quickChatInfo["item4"] = {
            index: 4,
            content: "你是妹妹还是哥哥啊？",
            sound: "fix_msg_5.mp3"
        };
        this._quickChatInfo["item5"] = {
            index: 5,
            content: "和你合作真是太愉快了！",
            sound: "fix_msg_6.mp3"
        };
        this._quickChatInfo["item6"] = {
            index: 6,
            content: "大家好，很高兴见到各位！",
            sound: "fix_msg_7.mp3"
        };
        this._quickChatInfo["item7"] = {
            index: 7,
            content: "各位，真是不好意思，我得离开一会儿。",
            sound: "fix_msg_8.mp3"
        };
        this._quickChatInfo["item8"] = {
            index: 8,
            content: "不要吵了，专心玩游戏吧！",
            sound: "fix_msg_9.mp3"
        };
    },
    getQuickChatInfo: function getQuickChatInfo(index) {
        var key = "item" + index;
        return this._quickChatInfo[key];
    },

    onBtnChatClicked: function onBtnChatClicked() {
        this._chatRoot.active = true;
    },
    onBgClicked: function onBgClicked() {
        this._chatRoot.active = false;
    },
    onTabClicked: function onTabClicked(event) {
        if (event.target.name == "tabQuick") {
            this._tabQuick.active = true;
            this._tabEmoji.active = false;
        } else if (event.target.name == "tabEmoji") {
            this._tabQuick.active = false;
            this._tabEmoji.active = true;
        }
    },
    onQuickChatItemClicked: function onQuickChatItemClicked(event) {
        this._chatRoot.active = false;
        var info = this._quickChatInfo[event.target.name];
        cc.vv.net.send("quick_chat", info.index);
    },
    onEmojiItemClicked: function onEmojiItemClicked(event) {
        console.log(event.target.name);
        this._chatRoot.active = false;
        cc.vv.net.send("emoji", event.target.name);
    },
    onBtnSendChatClicked: function onBtnSendChatClicked() {
        this._chatRoot.active = false;
        if (this._iptChat.string == "") {
            return;
        }
        cc.vv.net.send("chat", this._iptChat.string);
        this._iptChat.string = "";
    }
});

cc._RFpop();
},{}],"DzpkNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'bf725IY7KRKX7l9fK/74VIp', 'DzpkNetMgr');
// scripts/DzpkNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        seatIndex: -1,
        seats: null,
        turn: -1,
        button: -1,
        chu: -1,
        maxNumOfGames: 0,
        numOfGames: 0,
        isOver: false,
        consume_num: 0
    },
    reset: function reset() {
        this.turn = -1;
        this.chu = -1;
        this.button = -1;
        this.curaction = null;
        for (var i = 0; i < this.seats.length; ++i) {
            this.seats[i].op = null;
            this.seats[i].ready = false;
        }
    },
    clear: function clear() {},
    getSeatIndexByID: function getSeatIndexByID(userId) {
        for (var i = 0; i < this.seats.length; ++i) {
            var s = this.seats[i];
            if (s.userid == userId) {
                return i;
            }
        }
        return -1;
    },
    isOwner: function isOwner() {
        return this.seatIndex == 0;
    },
    getSeatByID: function getSeatByID(userId) {
        var seatIndex = this.getSeatIndexByID(userId);
        var seat = this.seats[seatIndex];
        return seat;
    },
    getSelfData: function getSelfData() {
        return this.seats[this.seatIndex];
    },
    getLocalIndex: function getLocalIndex(index) {
        var ret = (index - this.seatIndex + 5) % 5;
        return ret;
    },
    getLocalIndexByUserId: function getLocalIndexByUserId(userId) {
        var seatIndex = this.getSeatIndexByID(userId);
        var ret = this.getLocalIndex(seatIndex);
        return ret;
    },
    dispatchEvent: function dispatchEvent(event, data) {
        if (this.dataEventHandler) {
            this.dataEventHandler.emit(event, data);
        }
    },
    initHandlers: function initHandlers(GameNet) {
        var self = this;
        cc.vv.net.addHandler("login_result", function (data) {
            if (data.errcode === 0) {
                var data = data.data;
                cc.vv.gameNetMgr.roomId = data.roomid;
                cc.vv.gameNetMgr.room_type = data.conf.room_type;
                self.maxNumOfGames = data.conf.maxGames;
                self.numOfGames = data.numofgames;
                self.seats = data.seats;
                self.seatIndex = self.getSeatIndexByID(cc.vv.userMgr.userId);
                self.isOver = false;
                self.consume_num = data.scene.consume_num ? data.scene.consume_num : 50;
            } else {
                console.log(data.errmsg);
            }
        });
        cc.vv.net.addHandler("login_finished", function (data) {
            cc.director.loadScene("dzpkgame");
        });
        cc.vv.net.addHandler("socket_MyHolds", function (data) {
            if (data && data.length > 0) {
                self.dispatchEvent("socket_MyHolds", data);
            }
        });
        cc.vv.net.addHandler("count_down_push", function (data) {
            self.dispatchEvent("count_down", data);
        });
        cc.vv.net.addHandler("game_begin_push", function (data) {
            self.dispatchEvent("game_begin", data);
        });
        cc.vv.net.addHandler("game_diChiUpdate_push", function (data) {
            self.dispatchEvent("game_diChiUpdate", data);
        });
        cc.vv.net.addHandler("game_myInfo_push", function (data) {
            var seat = self.getSeatByID(data.userid);
            seat.score = data.money;
            self.dispatchEvent("game_myInfo", data);
        });
        cc.vv.net.addHandler("game_myTurn_push", function (data) {
            self.dispatchEvent("game_myTurn", data);
        });
        cc.vv.net.addHandler("game_oneClickGuo_push", function (data) {
            self.dispatchEvent("game_oneGuo", data);
        });
        cc.vv.net.addHandler("game_oneGen_push", function (data) {
            var seat = self.getSeatByID(data.userid);
            seat.score = data.money;
            self.dispatchEvent("game_oneGen", data);
        });
        cc.vv.net.addHandler("game_oneAllIn_push", function (data) {
            var seat = self.getSeatByID(data.userid);
            seat.score = data.money;
            self.dispatchEvent("game_oneAllIn", data);
        });
        cc.vv.net.addHandler("game_oneQuit_push", function (data) {
            self.dispatchEvent("game_oneQuit", data);
        });
        cc.vv.net.addHandler("game_playersInNewCircle_push", function (data) {
            self.dispatchEvent("game_playersInNewCircle", data);
        });
        cc.vv.net.addHandler("game_newCircle_push", function (data) {
            self.dispatchEvent("game_newCircle", data);
        });
        cc.vv.net.addHandler("game_turnChanged_push", function (data) {
            if (cc.vv.userMgr.userId != data) {
                self.dispatchEvent("game_turnChanged", data);
            }
        });
        cc.vv.net.addHandler("game_caculateResult_push", function (data) {
            for (var i = 0; i < data.length; i++) {
                if (cc.vv.userMgr.userId == data[i].userid && data[i].isWinner) {
                    self.dispatchEvent("game_winner", data);
                } else if (cc.vv.userMgr.userId == data[i].userid && !data[i].isWinner) {
                    self.dispatchEvent("game_loser", data);
                }
            };
            self.dispatchEvent("game_caculateResult", data);
        });
        cc.vv.net.addHandler("game_myARGStatusChanged_push", function (data) {
            self.dispatchEvent("game_myARGStatusChanged", data);
        });
        cc.vv.net.addHandler("game_over", function (data) {
            self.dispatchEvent("game_over", data);
        });
        cc.vv.net.addHandler("game_gameInfoById_push", function (data) {
            if (data) self.dispatchEvent("game_gameInfoById", data);
        });
        cc.vv.net.addHandler("game_userInfoById_push", function (data) {
            self.dispatchEvent("game_userInfoById", data);
        });
        cc.vv.net.addHandler("game_allGuo_push", function (data) {
            self.dispatchEvent("game_allGuo", data);
        });
        cc.vv.net.addHandler("exit_result", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.seats = null;
            self.dispatchEvent("exit_result", data);
        });
        cc.vv.net.addHandler("exit_notify_push", function (data) {
            var userId = data;
            var s = self.getSeatByID(userId);
            if (s != null) {
                s.userid = 0;
                s.name = "";
                self.dispatchEvent("user_state_changed", s);
            }
        });
        cc.vv.net.addHandler("dispress_push", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("disconnect", function (data) {
            self.dispatchEvent("exit_room");
            if (self.roomId == null) {
                cc.director.loadScene("newhall");
                self.room_type = -1;
            } else {
                if (self.isOver == false) {
                    cc.vv.userMgr.oldRoomId = self.roomId;
                    self.dispatchEvent("disconnect");
                } else {
                    self.roomId = null;
                    self.room_type = -1;
                }
            }
        });
        cc.vv.net.addHandler("chat_push", function (data) {
            self.dispatchEvent("chat_push", data);
        });
        cc.vv.net.addHandler("quick_chat_push", function (data) {
            self.dispatchEvent("quick_chat_push", data);
        });
        cc.vv.net.addHandler("emoji_push", function (data) {
            self.dispatchEvent("emoji_push", data);
        });
        // 新人加入房间
        cc.vv.net.addHandler("new_user_comes_push", function (data) {
            var seatIndex = data.seatindex;
            if (self.seats[seatIndex].userid > 0) {
                self.seats[seatIndex].online = true;
                self.seats[seatIndex].ready = data.ready;
                self.seats[seatIndex].score = data.score;
                self.seats[seatIndex].status = data.status;
            } else {
                data.online = true;
                self.seats[seatIndex] = data;
            }
            self.dispatchEvent('new_user', self.seats[seatIndex]);
        });
    }
});

cc._RFpop();
},{}],"Folds":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0bf63eiZEFMWbW03o8heqa5', 'Folds');
// scripts/components/Folds.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _folds: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.initView();
        this.initEventHandler();
        this.initAllFolds();
    },
    initView: function initView() {
        this._folds = {};
        var game = this.node.getChildByName("game");
        var sides = ["myself", "right", "up", "left"];
        for (var i = 0; i < sides.length; ++i) {
            var sideName = sides[i];
            var sideRoot = game.getChildByName(sideName);
            var folds = [];
            var foldRoot = sideRoot.getChildByName("folds");
            for (var j = 0; j < foldRoot.children.length; ++j) {
                var n = foldRoot.children[j];
                n.active = false;
                var sprite = n.getComponent(cc.Sprite);
                sprite.spriteFrame = null;
                folds.push(sprite);
            }
            this._folds[sideName] = folds;
        }
        this.hideAllFolds();
    },
    hideAllFolds: function hideAllFolds() {
        for (var k in this._folds) {
            var f = this._folds[i];
            for (var i in f) {
                f[i].node.active = false;
            }
        }
    },
    initEventHandler: function initEventHandler() {
        var self = this;
        this.node.on('game_begin', function (data) {
            self.initAllFolds();
        });
        this.node.on('game_sync', function (data) {
            self.initAllFolds();
        });
        this.node.on('game_chupai_notify', function (data) {
            self.initFolds(data.detail);
        });
        this.node.on('guo_notify', function (data) {
            self.initFolds(data.detail);
        });
    },
    initAllFolds: function initAllFolds() {
        var seats = cc.vv.gameNetMgr.seats;
        for (var i in seats) {
            this.initFolds(seats[i]);
        }
    },
    initFolds: function initFolds(seatData) {
        var folds = seatData.folds;
        if (folds == null) {
            return;
        }
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatData.seatindex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var foldsSprites = this._folds[side];
        for (var i = 0; i < folds.length; ++i) {
            var index = i;
            if (side == "right" || side == "up") {
                index = foldsSprites.length - i - 1;
            }
            var sprite = foldsSprites[index];
            this.setSpriteFrameByMJID(pre, sprite, folds[i]);
            if (side == "myself" && i == folds.length - 1) {
                //如果是最后一个
                var target_node = sprite.node;
                var old_x = target_node.x;
                var old_y = target_node.y;
                var pos = {
                    x: 0,
                    y: 0
                };
                var folds_diff_x = cc.find("Canvas/game/myself/folds").x;
                if (pos) {
                    target_node.x = pos.x / 0.8 - folds_diff_x / 0.8; //移到出牌位置
                    target_node.y = 70;
                    var action = cc.moveTo(0.2, cc.p(old_x, old_y));
                    target_node.runAction(action);
                }
            } else {
                sprite.node.active = true;
            }
        }
        for (var i = folds.length; i < foldsSprites.length; ++i) {
            var index = i;
            if (side == "right" || side == "up") {
                index = foldsSprites.length - i - 1;
            }
            var sprite = foldsSprites[index];
            sprite.spriteFrame = null;
            sprite.node.active = false;
        }
    },
    setSpriteFrameByMJID: function setSpriteFrameByMJID(pre, sprite, mjid) {
        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
        sprite.node.active = true;
    }
});

cc._RFpop();
},{}],"GameNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9545659TARKZLMoHGqXoY2N', 'GameNetMgr');
// scripts/GameNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        dataEventHandler: null,
        cqEventHandler: null,
        roomId: null,
        maxNumOfGames: 0,
        numOfGames: 0,
        numOfMJ: 0,
        seatIndex: -1,
        seats: null,
        turn: -1,
        button: -1,
        chupai: -1,
        gamestate: "",
        isOver: false,
        dissoveData: null,
        room_type: -1,
        cq_data: null
    },
    reset: function reset() {
        this.turn = -1;
        this.chupai = -1;
        this.button = -1;
        this.gamestate = "";
        this.curaction = null;
        for (var i = 0; i < this.seats.length; ++i) {
            this.seats[i].holds = [];
            this.seats[i].folds = [];
            this.seats[i].pengs = [];
            this.seats[i].caiShen = [];
            this.seats[i].chis = [];
            this.seats[i].angangs = [];
            this.seats[i].diangangs = [];
            this.seats[i].wangangs = [];
            this.seats[i].ready = false;
            this.seats[i].hued = false;
            this.seats[i].tinged = false;
        }
    },
    clear: function clear() {
        this.dataEventHandler = null;
        this.cqEventHandler = null;
        if (this.isOver == null) {
            this.seats = null;
            this.roomId = null;
            this.room_type = -1;
            this.maxNumOfGames = 0;
            this.numOfGames = 0;
        }
    },
    dispatchEvent: function dispatchEvent(event, data) {
        if (event == 'test') console.log(this.dataEventHandler);
        if (this.dataEventHandler) {
            this.dataEventHandler.emit(event, data);
        }
    },
    cqDispatchEvent: function cqDispatchEvent(event, data) {
        if (this.cqEventHandler) {
            // console.log('cqDispatchEvent',data);
            this.cqEventHandler.emit(event, data);
        }
    },

    getSeatIndexByID: function getSeatIndexByID(userId) {
        if (this.seats) {
            for (var i = 0; i < this.seats.length; ++i) {
                var s = this.seats[i];
                if (s.userid == userId) {
                    return i;
                }
            }
        }

        return -1;
    },
    isOwner: function isOwner() {
        return this.seatIndex == 0;
    },
    getSeatByID: function getSeatByID(userId) {
        var seatIndex = this.getSeatIndexByID(userId);
        var seat = this.seats[seatIndex];
        return seat;
    },
    getSelfData: function getSelfData() {
        return this.seats[this.seatIndex];
    },
    getLocalIndex: function getLocalIndex(index) {
        var ret = (index - this.seatIndex + 4) % 4;
        return ret;
    },
    getLocalIndexZJH: function getLocalIndexZJH(index) {
        var ret = (index - this.seatIndex + 5) % 5;
        return ret;
    },
    getLocalIndexByUserIdZJH: function getLocalIndexByUserIdZJH(userId) {
        var seatIndex = this.getSeatIndexByID(userId);
        var ret = this.getLocalIndexZJH(seatIndex);
        return ret;
    },
    prepareReplay: function prepareReplay(roomInfo, detailOfGame) {
        this.roomId = roomInfo.id;
        this.seats = roomInfo.seats;
        this.turn = detailOfGame.base_info.button;
        this.room_type = 0;
        var baseInfo = detailOfGame.base_info;
        for (var i = 0; i < this.seats.length; ++i) {
            var s = this.seats[i];
            s.seatindex = i;
            s.score = null;
            s.holds = baseInfo.game_seats[i];
            s.pengs = [];
            s.caiShen = [];
            s.chis = [];
            s.extraPais = [];
            s.angangs = [];
            s.diangangs = [];
            s.wangangs = [];
            s.folds = [];
            console.log(s);
            if (cc.vv.userMgr.userId == s.userid) {
                this.seatIndex = i;
            }
        }
        this.conf = {
            type: baseInfo.type
        };
        if (this.conf.type == null) {
            this.conf.type == "ykx";
        }
    },
    getWanfa: function getWanfa() {
        var conf = this.conf;
        if (conf) {
            var strArr = [];
            if (conf.maxGames) {
                strArr.push(conf.maxGames + "局");
            }
            if (conf.baseScore) {
                strArr.push(" 底分:" + conf.baseScore);
            }
            if (conf.yipaoduoxiang == true) {
                strArr.push(" 一炮多响");
            }
            return strArr.join(" ");
        }
        return "";
    },
    requireByGame: function requireByGame() {
        // var gameHandler = require('');
        // gameHandler.initEvents();
    },
    initHandlers: function initHandlers(type) {
        cc.vv.net.handlers = {};
        var self = this;
        var t;
        if (type == 2) {
            t = require('ZjhNetMgr');
        } else if (type == 1) {
            t = require('CqNetMgr');
        } else if (type == 0) {
            t = require('MjNetMgr');
        } else if (type == 3) {
            t = require('DnNetMgr');
        } else if (type == 4) {
            t = require('DzpkNetMgr');
        } else if (type == 100) {
            t = require('JbsNetMgr');
        }
        cc.vv.NetMgr = new t();
        cc.vv.NetMgr.initHandlers(self);
    },
    doGuo: function doGuo(seatIndex, pai) {
        var seatData = this.seats[seatIndex];
        var folds = seatData.folds;
        if (folds) {
            folds.push(pai);
        }
        this.dispatchEvent('guo_notify', seatData);
    },
    doMopai: function doMopai(seatIndex, pai) {
        var seatData = this.seats[seatIndex];
        if (seatData.holds) {
            seatData.holds.push(pai);
            this.dispatchEvent('game_mopai', {
                seatIndex: seatIndex,
                pai: pai
            });
        }
    },
    doChupai: function doChupai(seatIndex, pai) {
        this.chupai = pai;
        var seatData = this.seats[seatIndex];
        if (seatData.holds) {
            var idx = seatData.holds.indexOf(pai);
            seatData.holds.splice(idx, 1);
        }
        this.dispatchEvent('game_chupai_notify', {
            seatData: seatData,
            pai: pai
        });
    },
    doPeng: function doPeng(seatIndex, pai, extraPengPai) {
        console.log("doPeng", extraPengPai);
        var seatData = this.seats[seatIndex];
        //移除手牌
        if (seatData.holds) {
            for (var i = 0; i < 2; ++i) {
                var idx = seatData.holds.indexOf(pai);
                seatData.holds.splice(idx, 1);
            }
        }
        //更新碰牌数据
        var pengs = seatData.pengs;
        pengs.push(pai);
        if (extraPengPai != null && extraPengPai.length > 0) {
            seatData.extraPais = extraPengPai;
        }
        // console.log('------------------------------------');
        // console.log("玩家的手中多余的牌是", seatData.extraPais);
        // console.log('------------------------------------');
        this.dispatchEvent('peng_notify', seatData);
    },
    doChi: function doChi(seatIndex, pai, chiArray, extraPai) {
        var seatData = this.seats[seatIndex];
        //移除手牌
        // console.log("吃牌回掉函数");
        if (seatData.holds) {
            for (var i = 0; i < 2; ++i) {
                var idx = seatData.holds.indexOf(chiArray[i]);
                if (idx != -1) {
                    seatData.holds.splice(idx, 1);
                }
            }
            var chis = seatData.chis;
            chiArray.push(pai);
            chiArray.sort(function (a, b) {
                return a - b;
            });
            chis.push(chiArray);
        }
        if (extraPai != null && extraPai.length > 0) {
            seatData.extraPais = extraPai;
        }
        this.dispatchEvent('chi_notify', seatData);
    },
    getGangType: function getGangType(seatData, pai) {
        if (seatData.pengs.indexOf(pai) != -1) {
            return "wangang";
        } else {
            var cnt = 0;
            for (var i = 0; i < seatData.holds.length; ++i) {
                if (seatData.holds[i] == pai) {
                    cnt++;
                }
            }
            if (cnt == 3) {
                return "diangang";
            } else {
                return "angang";
            }
        }
    },
    doGang: function doGang(seatIndex, pai, gangtype) {
        var seatData = this.seats[seatIndex];
        if (!gangtype) {
            gangtype = this.getGangType(seatData, pai);
        }
        if (gangtype == "wangang") {
            if (seatData.pengs.indexOf(pai) != -1) {
                var idx = seatData.pengs.indexOf(pai);
                if (idx != -1) {
                    seatData.pengs.splice(idx, 1);
                }
            }
            seatData.wangangs.push(pai);
        }
        if (seatData.holds) {
            for (var i = 0; i <= 4; ++i) {
                var idx = seatData.holds.indexOf(pai);
                if (idx == -1) {
                    //如果没有找到，表示移完了，直接跳出循环
                    break;
                }
                seatData.holds.splice(idx, 1);
            }
        }
        if (gangtype == "angang") {
            if (!seatData.angangs) {
                seatData.angangs = [];
            }
            seatData.angangs.push(pai);
        } else if (gangtype == "diangang") {
            if (!seatData.diangangs) {
                seatData.diangangs = [];
            }
            seatData.diangangs.push(pai);
        }
        this.dispatchEvent('gang_notify', {
            seatData: seatData,
            gangtype: gangtype
        });
    },
    // 财神
    doCaiShen: function doCaiShen(seatIndex, pai) {
        console.log("财神!docaishen", seatIndex, pai);
        var seatData = this.seats[seatIndex];
        // 移除手牌
        if (seatData.holds) {
            var idx = seatData.holds.indexOf(pai);
            seatData.holds.splice(idx, 1);
        }
        var caiShen = seatData.caiShen;
        caiShen.push(pai);
        this.dispatchEvent('game_caishen_notify', seatData);
    },
    doHu: function doHu(data) {
        this.dispatchEvent('hupai', data);
    },
    doTurnChange: function doTurnChange(si) {
        var data = {
            last: this.turn,
            turn: si
        };
        this.turn = si;
        this.dispatchEvent('game_chupai', data);
    },
    connectGameServer: function connectGameServer(data) {
        this.initHandlers(cc.vv.userMgr.room_type);
        this.dissoveData = null;
        cc.vv.net.ip = data.ip + ":" + data.port;
        console.log(cc.vv.net.ip);
        var self = this;
        var onConnectOK = function onConnectOK() {
            console.log("onConnectOK");
            var sd = {
                token: data.token,
                roomid: data.roomid,
                time: data.time,
                sign: data.sign
            };
            console.log("login============");
            cc.vv.net.send("login", sd);
        };
        var onConnectFailed = function onConnectFailed() {
            console.log("failed.");
            cc.vv.wc.hide();
        };
        cc.vv.wc.show("正在进入房间");
        cc.vv.net.connect(onConnectOK, onConnectFailed);
    },
    connectMatchServer: function connectMatchServer(connect_data, match_data) {
        this.initHandlers(100); //锦标赛的type设为100
        cc.vv.match_net.ip = connect_data.ip + ":" + connect_data.port;
        var self = this;
        var onConnectOK = function onConnectOK() {
            if (match_data) {
                match_data.userid = cc.vv.userMgr.userId;
            }
            cc.vv.match_net.send("login", match_data);
            cc.vv.wc.hide();
        };
        var onConnectFailed = function onConnectFailed() {
            cc.vv.wc.hide();
            cc.vv.alert.show("注意", "进入比赛队列失败！");
        };

        cc.vv.wc.show("正在进入比赛队列");
        cc.vv.match_net.connect(onConnectOK, onConnectFailed);
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{"CqNetMgr":"CqNetMgr","DnNetMgr":"DnNetMgr","DzpkNetMgr":"DzpkNetMgr","JbsNetMgr":"JbsNetMgr","MjNetMgr":"MjNetMgr","ZjhNetMgr":"ZjhNetMgr"}],"GameOver":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'facfdljnx5F+rFDAq5Qbmqa', 'GameOver');
// scripts/components/GameOver.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _gameover: null,
        _gameresult: null,
        _seats: [],
        _isGameEnd: false,
        _pingju: null,
        _win: null,
        _lose: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        if (cc.vv.gameNetMgr.conf == null) {
            return;
        }
        this._gameover = this.node.getChildByName("game_over");
        this._gameover.active = false;
        this._pingju = this._gameover.getChildByName("pingju");
        this._win = this._gameover.getChildByName("win");
        this._lose = this._gameover.getChildByName("lose");
        this._liuju = this._gameover.getChildByName("huangzhuang");
        this._gameresult = this.node.getChildByName("game_result");
        var wanfa = this._gameover.getChildByName("wanfa").getComponent(cc.Label);
        wanfa.string = cc.vv.gameNetMgr.getWanfa();
        var listRoot = this._gameover.getChildByName("result_list");
        for (var i = 1; i <= 4; ++i) {
            var s = "s" + i;
            var sn = listRoot.getChildByName(s);
            var viewdata = {};
            viewdata.username = sn.getChildByName('username').getComponent(cc.Label);
            viewdata.reason = sn.getChildByName('reason').getComponent(cc.Label);
            var f = sn.getChildByName('fan');
            if (f != null) {
                viewdata.fan = f.getComponent(cc.Label);
            }
            viewdata.score = sn.getChildByName('score').getComponent(cc.Label);
            viewdata.hu = sn.getChildByName('hu');
            viewdata.mahjongs = sn.getChildByName('pai');
            viewdata.zhuang = sn.getChildByName('zhuang');
            viewdata.hupai = sn.getChildByName('hupai');
            viewdata.hua = sn.getChildByName('hua');
            viewdata._pengandgang = [];
            this._seats.push(viewdata);
        }
        //初始化网络事件监听器
        var self = this;
        this.node.on('game_over', function (data) {
            self.onGameOver(data.detail);
        });
        this.node.on('game_end', function (data) {
            self._isGameEnd = true;
        });
    },
    onGameOver: function onGameOver(data) {
        console.log(data);
        if (data.length == 0) {
            this._gameresult.active = true;
            return;
        }
        this._gameover.active = true;
        this._pingju.active = false;
        this._win.active = false;
        this._lose.active = false;
        this._liuju.active = false;
        var myscore = data[cc.vv.gameNetMgr.seatIndex].score;
        var isLiuJu = data[cc.vv.gameNetMgr.seatIndex].isLiuJu;
        if (isLiuJu) {
            this._liuju.active = true;
        } else {
            if (myscore > 0) {
                this._win.active = true;
            } else if (myscore < 0) {
                this._lose.active = true;
            } else {
                this._pingju.active = true;
            }
        }
        //显示玩家信息
        for (var i = 0; i < 4; ++i) {
            var seatView = this._seats[i];
            var userData = data[i];
            var hued = false;
            //胡牌的玩家才显示 是否清一色 根xn的字样
            var numOfGangs = userData.angangs.length + userData.wangangs.length + userData.diangangs.length;
            var numOfGen = userData.numofgen;
            var actionArr = [];
            var is7pairs = false;
            var ischadajiao = false;
            for (var j = 0; j < userData.actions.length; ++j) {
                var ac = userData.actions[j];
                if (ac.type == "zimo" || ac.type == "ganghua" || ac.type == "dianganghua" || ac.type == "hu" || ac.type == "gangpaohu" || ac.type == "qiangganghu" || ac.type == "chadajiao") {
                    if (ac.type == "zimo") {
                        actionArr.push("自摸");
                    } else if (ac.type == "ganghua") {
                        actionArr.push("杠上花");
                    }
                    hued = true;
                } else if (ac.type == "fangpao") {
                    actionArr.push("放炮");
                } else if (ac.type == "angang") {
                    actionArr.push("暗杠");
                } else if (ac.type == "diangang") {
                    actionArr.push("明杠");
                }
            }
            if (hued) {
                if (userData.isHaoQiDui) {
                    actionArr.push("豪七对");
                } else if (userData.pattern == "therity") {
                    actionArr.push("十三幺");
                } else {
                    if (userData.pattern == "7pairs") {
                        actionArr.push("七对");
                    }
                    if (userData.qingyise) {
                        actionArr.push("清一色");
                    }
                    if (userData.menqing) {
                        actionArr.push("门清");
                    }
                    if (userData.haidihu) {
                        actionArr.push("海底捞月");
                    }
                    if (userData.isFourOne) {
                        actionArr.push("四归一");
                    }
                    if (userData.zhuoWuKui) {
                        actionArr.push("捉五魁");
                    }
                    if (userData.hunyise) {
                        actionArr.push("混一色");
                    }
                    if (userData.baZhang) {
                        actionArr.push("八张");
                    }
                    if (userData.laoShao) {
                        actionArr.push("老少");
                    }
                    if (userData.yiTiaoLong) {
                        actionArr.push("一条龙");
                    }
                    if (userData.xiaoLian) {
                        actionArr.push("小连");
                    }
                    if (userData.daLian) {
                        actionArr.push("大连");
                    }
                    if (userData.huCnt == 1) {
                        actionArr.push("单吊");
                    }
                    if (userData.xiaoGao) {
                        actionArr.push("小高");
                    }
                    if (userData.daGao) {
                        actionArr.push("大高");
                    }
                    if (userData.queMen) {
                        actionArr.push("缺门");
                    }
                    if (userData.kezi) {
                        actionArr.push("刻");
                    }
                    if (userData.pengpenghu) {
                        actionArr.push("碰碰胡");
                    }
                    var lianZhuangNum = parseInt(userData.lianZhuangNum) - 1;
                    if (lianZhuangNum > 0) {
                        actionArr.push("连庄" + lianZhuangNum + "次");
                    }
                }
            }
            for (var o = 0; o < 3; ++o) {
                seatView.hu.children[o].active = false;
            }
            //FIXME 隐藏第几个胡牌的
            if (userData.huorder >= 0) {
                seatView.hu.children[userData.huorder].active = true;
            }
            seatView.username.string = cc.vv.gameNetMgr.seats[i].name;
            seatView.zhuang.active = cc.vv.gameNetMgr.button == i;
            seatView.reason.string = actionArr.join("、");
            //胡牌的玩家才有番
            var fan = 0;
            if (hued) {
                fan = userData.fan;
            }
            seatView.fan.string = fan + "番";
            //
            if (userData.score > 0) {
                seatView.score.string = "+" + userData.score;
            } else {
                seatView.score.string = userData.score;
            }
            var hupai = -1;
            if (hued) {
                hupai = userData.hupai;
                //从手牌中剔除胡的那张牌 
                var hu_index = userData.holds.indexOf(hupai);
                userData.holds.splice(hu_index, 1);
            }
            cc.vv.mahjongmgr.sortMJ(userData.holds);
            //胡牌不参与排序
            if (hued) {
                userData.holds.push(hupai);
            }
            //隐藏所有牌
            for (var k = 0; k < seatView.mahjongs.childrenCount; ++k) {
                var n = seatView.mahjongs.children[k];
                n.active = false;
            }
            var lackingNum = (userData.pengs.length + numOfGangs + userData.chis.length) * 3;
            //显示相关的牌
            for (var k = 0; k < userData.holds.length; ++k) {
                var pai = userData.holds[k];
                var n = seatView.mahjongs.children[k + lackingNum];
                n.active = true;
                var sprite = n.getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            }
            for (var k = 0; k < seatView._pengandgang.length; ++k) {
                seatView._pengandgang[k].active = false;
            }
            //初始化杠牌
            var index = 0;
            var gangs = userData.angangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "angang");
                index++;
            }
            var gangs = userData.diangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "diangang");
                index++;
            }
            var gangs = userData.wangangs;
            for (var k = 0; k < gangs.length; ++k) {
                var mjid = gangs[k];
                this.initPengAndGangs(seatView, index, mjid, "wangang");
                index++;
            }
            //初始化碰牌
            var pengs = userData.pengs;
            if (pengs) {
                for (var k = 0; k < pengs.length; ++k) {
                    var mjid = pengs[k];
                    this.initPengAndGangs(seatView, index, mjid, "peng");
                    index++;
                }
            }
            //初始化吃牌
            var chis = userData.chis;
            if (chis) {
                for (var k = 0; k < chis.length; ++k) {
                    var mjids = chis[k];
                    if (mjids) {
                        this.initPengAndGangs(seatView, index, mjids, "chi");
                        index++;
                    }
                }
            }
            //初始化花牌
            var hua = userData.caiShen;
            this.initHua(seatView, hua);
        }
    },

    initHua: function initHua(seatView, mjids) {
        for (var i = 0; i < seatView.hua.children.length; i++) {
            seatView.hua.children[i].active = false;
        }
        if (mjids) {
            for (var i = 0; i < mjids.length; i++) {
                seatView.hua.children[i].active = true;
                seatView.hua.children[i].getComponent(cc.Sprite).spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjids[i]);
            }
        }
    },
    initPengAndGangs: function initPengAndGangs(seatView, index, mjid, flag) {
        var pgroot = null;
        if (seatView._pengandgang.length <= index) {
            pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabSelf);
            seatView._pengandgang.push(pgroot);
            seatView.mahjongs.addChild(pgroot);
        } else {
            pgroot = seatView._pengandgang[index];
            pgroot.active = true;
        }
        var sprites = pgroot.getComponentsInChildren(cc.Sprite);
        for (var s = 0; s < sprites.length; ++s) {
            var sprite = sprites[s];
            if (sprite.node.name == "gang") {
                var isGang = flag != "peng" && flag != "chi";
                sprite.node.active = isGang;
                sprite.node.scaleX = 1.0;
                sprite.node.scaleY = 1.0;
                if (flag == "angang") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame("myself");
                    sprite.node.scaleX = 1.4;
                    sprite.node.scaleY = 1.4;
                } else {
                    if (flag == "chi") {
                        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid[s]);
                    } else {
                        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid);
                    }
                }
            } else {
                if (flag == "chi") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid[s]);
                } else {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("B_", mjid);
                }
            }
        }
        pgroot.x = index * 55 * 3 + index * 10;
    },
    onBtnReadyClicked: function onBtnReadyClicked() {
        console.log("onBtnReadyClicked");
        if (this._isGameEnd) {
            this._gameresult.active = true;
        } else {
            cc.vv.net.send('ready');
        }
        this._gameover.active = false;
    },
    onBtnShareClicked: function onBtnShareClicked() {
        console.log("onBtnShareClicked");
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '2b08d8pm0VBDLYlZIdfLuPS', 'GameResult');
// scripts/components/GameResult.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _gameresult: null,
        _seats: []
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._gameresult = this.node.getChildByName("game_result");
        //this._gameresult.active = false;
        var seats = this._gameresult.getChildByName("seats");
        for (var i = 0; i < seats.children.length; ++i) {
            this._seats.push(seats.children[i].getComponent("Seat"));
        }
        var btnClose = cc.find("Canvas/game_result/btnClose");
        if (btnClose) {
            cc.vv.utils.addClickEvent(btnClose, this.node, "GameResult", "onBtnCloseClicked");
        }
        var btnShare = cc.find("Canvas/game_result/btnShare");
        if (btnShare) {
            cc.vv.utils.addClickEvent(btnShare, this.node, "GameResult", "onBtnShareClicked");
        }
        //初始化网络事件监听器
        var self = this;
        this.node.on('game_end', function (data) {
            self.onGameEnd(data.detail);
        });
    },
    showResult: function showResult(seat, info, isZuiJiaPaoShou) {
        seat.node.getChildByName("zuijiapaoshou").active = isZuiJiaPaoShou;
        seat.node.getChildByName("zimocishu").getComponent(cc.Label).string = info.numzimo;
        seat.node.getChildByName("jiepaocishu").getComponent(cc.Label).string = info.numjiepao;
        seat.node.getChildByName("dianpaocishu").getComponent(cc.Label).string = info.numdianpao;
        seat.node.getChildByName("angangcishu").getComponent(cc.Label).string = info.numangang;
        seat.node.getChildByName("minggangcishu").getComponent(cc.Label).string = info.numminggang;
        // seat.node.getChildByName("chajiaocishu").getComponent(cc.Label).string = info.numchadajiao;
    },
    onGameEnd: function onGameEnd(endinfo) {
        var seats = cc.vv.gameNetMgr.seats;
        var maxscore = -1;
        var maxdianpao = 0;
        var dianpaogaoshou = -1;
        for (var i = 0; i < seats.length; ++i) {
            var seat = seats[i];
            if (seat.score > maxscore) {
                maxscore = seat.score;
            }
            if (endinfo[i].numdianpao > maxdianpao) {
                maxdianpao = endinfo[i].numdianpao;
                dianpaogaoshou = i;
            }
        }
        for (var i = 0; i < seats.length; ++i) {
            var seat = seats[i];
            var isBigwin = false;
            if (seat.score > 0) {
                isBigwin = seat.score == maxscore;
            }
            this._seats[i].setInfo(seat.name, seat.score, isBigwin);
            this._seats[i].setID(seat.userid);
            var isZuiJiaPaoShou = dianpaogaoshou == i;
            this.showResult(this._seats[i], endinfo[i], isZuiJiaPaoShou);
        }
    },
    onBtnCloseClicked: function onBtnCloseClicked() {
        //刷新客户端金币和钻石
        cc.vv.userMgr.getGemsAndCoins(function (data) {
            cc.vv.userMgr.gems = data.gems;
            cc.vv.userMgr.coins = data.coins;
        });
        cc.director.loadScene("newhall");
    },
    onBtnShareClicked: function onBtnShareClicked() {
        cc.vv.share.show();
        // cc.vv.anysdkMgr.shareResult();
    }
});

cc._RFpop();
},{}],"Global":[function(require,module,exports){
"use strict";
cc._RFpush(module, '24e30ZJLgdH3rs1R1CvqN8U', 'Global');
// scripts/Global.js

"use strict";

var Global = cc.Class({
    extends: cc.Component,
    statics: {
        isstarted: false,
        netinited: false,
        userguid: 0,
        nickname: "",
        money: 0,
        lv: 0,
        roomId: 0
    }
});

cc._RFpop();
},{}],"HTTP":[function(require,module,exports){
"use strict";
cc._RFpush(module, '90ae61J525JQIt5taF3Nce2', 'HTTP');
// scripts/HTTP.js

"use strict";

// 包头麻将调试地址
// var URL = "http://116.62.193.47:8009";
// var URL = "http://116.62.193.47:9009";
// var URL = "http://121.196.213.165:9009";
var URL = "http://127.0.0.1:9009";
cc.game.config['noCache'] = true;
cc.game.config.myversion = 201708042;
var HTTP = cc.Class({
    extends: cc.Component,
    statics: {
        sessionId: 0,
        userId: 0,
        master_url: URL,
        url: URL,
        sendRequest: function sendRequest(path, data, handler, extraUrl) {
            var xhr = cc.loader.getXMLHttpRequest();
            xhr.timeout = 5000;
            var str = "?";
            for (var k in data) {
                if (str != "?") {
                    str += "&";
                }
                str += k + "=" + data[k];
            }
            if (extraUrl == null) {
                extraUrl = HTTP.url;
            }
            var requestURL = extraUrl + path + encodeURI(str);
            // console.log("RequestURL:" + requestURL);
            xhr.open("GET", requestURL, true);
            if (cc.sys.isNative) {
                xhr.setRequestHeader("Accept-Encoding", "gzip,deflate", "text/html;charset=UTF-8");
            }
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status >= 200 && xhr.status < 300) {
                    // console.log("http res("+ xhr.responseText.length + "):" + xhr.responseText);
                    try {
                        var ret = JSON.parse(xhr.responseText);
                        if (handler !== null) {
                            handler(ret);
                        } /* code */
                    } catch (e) {
                        console.log("err:" + e);
                        //handler(null);
                    } finally {
                        if (cc.vv && cc.vv.wc) {
                            //       cc.vv.wc.hide();
                        }
                    }
                }
            };
            if (cc.vv && cc.vv.wc) {
                //cc.vv.wc.show();
            }
            xhr.send();
            return xhr;
        }
    }
});

cc._RFpop();
},{}],"Hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6edb3jjx+FBepS1mk1xKDF2', 'Hall');
// scripts/components/Hall.js

"use strict";

var Net = require("Net");
var Global = require("Global");
cc.Class({
    extends: cc.Component,
    properties: {
        lblName: cc.Label,
        lblGems: cc.Label,
        lblID: cc.Label,
        lblNotice: cc.Label,
        joinGameWin: cc.Node,
        applyAgentWin: cc.Node,
        createRoomWin: cc.Node,
        settingsWin: cc.Node,
        helpWin: cc.Node,
        shareWin: cc.Node,
        btnJoinGame: cc.Node,
        btnReturnGame: cc.Node,
        sprHeadImg: cc.Sprite,
        effAnimation: cc.Node,
        _lastCheckTime: 0
    },
    initNetHandlers: function initNetHandlers() {
        var self = this;
    },
    onShare: function onShare() {
        cc.vv.anysdkMgr.share("亚巨包头麻将", "亚巨包头麻将");
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        if (!cc.vv) {
            cc.director.loadScene("login");
            return;
        }
        this.preLoad();
        this.initLabels();
        this.effNode = cc.find("Canvas/eff");
        // 如果未创建房间，创建按钮显示特效
        // 如果存在房间，返回房间显示特效            
        var pos = cc.v2(310, 53);
        this.playBtnEff(true, pos);
        if (cc.vv.gameNetMgr.roomId) {
            this.btnJoinGame.active = false;
            this.btnReturnGame.active = true;
            pos = cc.v2(310, 53);
        } else {
            this.btnJoinGame.active = true;
            this.btnReturnGame.active = false;
            pos = cc.v2(86, -108);
        }
        // 播放按钮特效
        this.playBtnEff(true, pos);
        var roomId = cc.vv.userMgr.oldRoomId;
        if (roomId != null) {
            cc.vv.userMgr.oldRoomId = null;
            cc.vv.userMgr.enterRoom(roomId);
        }
        var imgLoader = this.sprHeadImg.node.getComponent("ImageLoader");
        imgLoader.setUserID(cc.vv.userMgr.userId);
        cc.vv.utils.addClickEvent(this.sprHeadImg.node, this.node, "Hall", "onBtnClicked");
        this.initButtonHandler("Canvas/right_bottom/btn_shezhi");
        this.initButtonHandler("Canvas/right_bottom/btn_help");
        this.initButtonHandler("Canvas/right_bottom/btn_share_wx");
        this.helpWin.addComponent("OnBack");
        if (!cc.vv.userMgr.notice) {
            cc.vv.userMgr.notice = {
                version: null,
                msg: "数据请求中..."
            };
        }
        if (!cc.vv.userMgr.gemstip) {
            cc.vv.userMgr.gemstip = {
                version: null,
                msg: "数据请求中..."
            };
        }
        this.lblNotice.string = cc.vv.userMgr.notice.msg;
        this.refreshInfo();
        this.refreshNotice();
        this.refreshGemsTip();
        // cc.vv.audioMgr.playBGM("bgMain.mp3");
        cc.vv.audioMgr.playBGM("bgFight.mp3");
        this.initEventHandlers();
    },
    refreshInfo: function refreshInfo() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                if (ret.gems != null) {
                    this.lblGems.string = cc.vv.utils.showJinbi(ret.gems);
                }
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_user_status", data, onGet.bind(this));
    },
    refreshGemsTip: function refreshGemsTip() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                cc.vv.userMgr.gemstip.version = ret.version;
                cc.vv.userMgr.gemstip.msg = ret.msg.replace("<newline>", "\n");
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            type: "fkgm",
            version: cc.vv.userMgr.gemstip.version
        };
        cc.vv.http.sendRequest("/get_message", data, onGet.bind(this));
    },
    refreshNotice: function refreshNotice() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                cc.vv.userMgr.notice.version = ret.version;
                cc.vv.userMgr.notice.msg = ret.msg;
                this.lblNotice.string = ret.msg;
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            type: "notice",
            version: cc.vv.userMgr.notice.version
        };
        cc.vv.http.sendRequest("/get_message", data, onGet.bind(this));
    },
    initButtonHandler: function initButtonHandler(btnPath) {
        var btn = cc.find(btnPath);
        cc.vv.utils.addClickEvent(btn, this.node, "Hall", "onBtnClicked");
    },
    preLoad: function preLoad() {
        cc.loader.loadResDir("textures/images", function (err, assets) {
            cc.loader.loadResDir("textures/MJRoom", function (err, assets) {
                cc.loader.loadResDir("textures/MJ", function (err, assets) {});
            });
        });
    },
    initLabels: function initLabels() {
        this.lblName.string = cc.vv.userMgr.userName;
        this.lblGems.string = cc.vv.utils.showJinbi(cc.vv.userMgr.gems);
        this.lblID.string = "ID:" + cc.vv.userMgr.userId;
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_shezhi") {
            this.settingsWin.active = true;
        } else if (event.target.name == "btn_help") {
            this.helpWin.active = true;
        } else if (event.target.name == "btn_share_wx") {
            cc.vv.share.show();
        }
    },
    onApplyAgentClicked: function onApplyAgentClicked() {
        this.applyAgentWin.active = true;
    },
    onApplyAgentBtnBack: function onApplyAgentBtnBack() {
        this.applyAgentWin.active = false;
    },
    onJoinGameClicked: function onJoinGameClicked() {
        this.joinGameWin.active = true;
    },
    onReturnGameClicked: function onReturnGameClicked() {
        cc.director.loadScene("mjgame");
    },
    onBtnAddGemsClicked: function onBtnAddGemsClicked() {
        console.log("点击充值按钮");
        cc.vv.charge.show();
    },
    onCreateRoomClicked: function onCreateRoomClicked() {
        if (cc.vv.gameNetMgr.roomId != null) {
            cc.vv.alert.show("提示", "房间已经创建!\n必须解散当前房间才能创建新的房间");
            return;
        }
        console.log("onCreateRoomClicked");
        this.createRoomWin.active = true;
    },
    initEventHandlers: function initEventHandlers() {
        this.node.on('update_gems', function (event) {
            if (event.detail.gems != null) {
                var str = event.detail.gems;
                this.lblGems.string = cc.vv.utils.showJinbi(str);
            }
        }.bind(this));
    },
    // 获得更新消息
    getRefreshInfo: function getRefreshInfo() {
        var fn = function fn(ret) {
            if (ret == null) {
                console.log('消息是空的');
                return;
            }
            if (ret.userid == cc.vv.userMgr.userId) {
                if (ret.gems != null) {
                    this.lblGems.string = cc.vv.utils.showJinbi(ret.gems);
                }
            }
        };
        this._lastCheckTime = Date.now();
        cc.vv.http.sendRequest("/need_refresh", {
            userid: cc.vv.userMgr.userId
        }, fn.bind(this));
    },
    // 播放按钮特效
    playBtnEff: function playBtnEff(flag, pos) {
        if (flag) {
            this.btnEff = this.effAnimation.getComponent(cc.Animation);
            // this.effAnimation.getComponent(cc.Node).getPosition();
            this.effNode.setPosition(pos);
            var animState = this.btnEff.play('anniu');
            animState.speed = 0.3;
            animState.wrapMode = cc.WrapMode.Loop;
            animState.repeatCount = Infinity;
        }
    },
    gotoNewHall: function gotoNewHall() {
        cc.director.loadScene("newhall");
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (Date.now() - this._lastCheckTime > 30000) {
            this.getRefreshInfo();
        };
        var x = this.lblNotice.node.x;
        x -= dt * 100;
        if (x + this.lblNotice.node.width < -1000) {
            x = 500;
        }
        this.lblNotice.node.x = x;
        // 如果当前自己有房间，不能直接进入分享过来的房间
        if (cc.vv && cc.vv.userMgr.roomData != null) {
            cc.vv.userMgr.enterRoom(cc.vv.userMgr.roomData);
            cc.vv.userMgr.roomData = null;
        } else {
            // 如果当前没有房间，且分享过来的房间号不是空的话，可以进入房间
            if (cc.vv && cc.vv.userMgr.shareRoomId != null) {
                cc.vv.userMgr.roomData = null;
                var roomid = cc.vv.userMgr.shareRoomId;
                cc.vv.userMgr.shareRoomId = null;
                cc.vv.userMgr.enterRoom(roomid, function (ret) {
                    if (ret.errcode != 0) {
                        var content = "房间[" + roomid + "]不存在，请重新输入!";
                        if (ret.errcode == 4) {
                            content = "房间[" + roomid + "]已满!";
                        }
                        cc.vv.alert.show("提示", content);
                    }
                }.bind(this));
            }
        }
    }
});

cc._RFpop();
},{"Global":"Global","Net":"Net"}],"History":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '4d7bci0LUxMT6MJKXJDj89w', 'History');
// scripts/components/History.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        HistoryItemPrefab: {
            default: null,
            type: cc.Prefab
        },
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _history: null,
        _viewlist: null,
        _content: null,
        _viewitemTemp: null,
        _historyData: null,
        _curRoomInfo: null,
        _emptyTip: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        this._history = this.node.getChildByName("history");
        this._history.active = false;
        this._emptyTip = this._history.getChildByName("emptyTip");
        this._emptyTip.active = true;
        this._viewlist = this._history.getChildByName("viewlist");
        this._content = cc.find("view/content", this._viewlist);
        this._viewitemTemp = this._content.children[0];
        this._content.removeChild(this._viewitemTemp);
        var node = cc.find("Canvas/selectMJ/btn_zhanji");
        node.active = false;
        var searchURL = window.location.search;
        if (searchURL && searchURL.indexOf("account") != -1) {
            searchURL = searchURL.substring(1, searchURL.length);
            var targetAccount = searchURL.split("&")[0].split("=")[1];
            if (targetAccount.indexOf("qiao") > -1) {
                node.active = true;
            }
        }
        this.addClickEvent(node, this.node, "History", "onBtnHistoryClicked");
        var node = cc.find("Canvas/history/btn_back");
        this.addClickEvent(node, this.node, "History", "onBtnBackClicked");
    },
    addClickEvent: function addClickEvent(node, target, component, handler) {
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;
        var clickEvents = node.getComponent(cc.Button).clickEvents;
        clickEvents.push(eventHandler);
    },
    onBtnBackClicked: function onBtnBackClicked() {
        if (this._curRoomInfo == null) {
            this._historyData = null;
            this._history.active = false;
        } else {
            this.initRoomHistoryList(this._historyData);
        }
    },
    onBtnHistoryClicked: function onBtnHistoryClicked() {
        console.log('点击战绩按钮');
        this._history.active = true;
        var self = this;
        cc.vv.userMgr.getHistoryList(function (data) {
            data.sort(function (a, b) {
                return a.time < b.time;
            });
            self._historyData = data;
            for (var i = 0; i < data.length; ++i) {
                for (var j = 0; j < 4; ++j) {
                    var s = data[i].seats[j];
                    s.name = new Buffer(s.name, 'base64').toString();
                }
            }
            self.initRoomHistoryList(data);
        });
    },
    dateFormat: function dateFormat(time) {
        var date = new Date(time);
        var datetime = "{0}-{1}-{2} {3}:{4}:{5}";
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        month = month >= 10 ? month : "0" + month;
        var day = date.getDate();
        day = day >= 10 ? day : "0" + day;
        var h = date.getHours();
        h = h >= 10 ? h : "0" + h;
        var m = date.getMinutes();
        m = m >= 10 ? m : "0" + m;
        var s = date.getSeconds();
        s = s >= 10 ? s : "0" + s;
        datetime = datetime.format(year, month, day, h, m, s);
        return datetime;
    },
    initRoomHistoryList: function initRoomHistoryList(data) {
        for (var i = 0; i < data.length; ++i) {
            var node = this.getViewItem(i);
            node.idx = i;
            var titleId = "" + (i + 1);
            node.getChildByName("title").getComponent(cc.Label).string = titleId;
            node.getChildByName("roomNo").getComponent(cc.Label).string = "房间ID:" + data[i].id;
            var datetime = this.dateFormat(data[i].time * 1000);
            node.getChildByName("time").getComponent(cc.Label).string = datetime;
            var btnOp = node.getChildByName("btnOp");
            btnOp.idx = i;
            btnOp.getChildByName("Label").getComponent(cc.Label).string = "详情";
            for (var j = 0; j < 4; ++j) {
                var s = data[i].seats[j];
                var info = s.name + ":" + s.score;
                //console.log(info);
                node.getChildByName("info" + j).getComponent(cc.Label).string = info;
            }
        }
        this._emptyTip.active = data.length == 0;
        this.shrinkContent(data.length);
        this._curRoomInfo = null;
    },
    initGameHistoryList: function initGameHistoryList(roomInfo, data) {
        data.sort(function (a, b) {
            return a.create_time < b.create_time;
        });
        for (var i = 0; i < data.length; ++i) {
            var node = this.getViewItem(i);
            var idx = data.length - i - 1;
            node.idx = idx;
            var titleId = "" + (idx + 1);
            node.getChildByName("title").getComponent(cc.Label).string = titleId;
            node.getChildByName("roomNo").getComponent(cc.Label).string = "房间ID:" + roomInfo.id;
            var datetime = this.dateFormat(data[i].create_time * 1000);
            node.getChildByName("time").getComponent(cc.Label).string = datetime;
            var btnOp = node.getChildByName("btnOp");
            btnOp.idx = idx;
            btnOp.getChildByName("Label").getComponent(cc.Label).string = "回放";
            var result = JSON.parse(data[i].result);
            for (var j = 0; j < 4; ++j) {
                var s = roomInfo.seats[j];
                var info = s.name + ":" + result[j];
                //console.log(info);
                node.getChildByName("info" + j).getComponent(cc.Label).string = info;
            }
        }
        this.shrinkContent(data.length);
        this._curRoomInfo = roomInfo;
    },
    getViewItem: function getViewItem(index) {
        var content = this._content;
        if (content.childrenCount > index) {
            return content.children[index];
        }
        var node = cc.instantiate(this._viewitemTemp);
        content.addChild(node);
        return node;
    },
    shrinkContent: function shrinkContent(num) {
        while (this._content.childrenCount > num) {
            var lastOne = this._content.children[this._content.childrenCount - 1];
            this._content.removeChild(lastOne, true);
        }
    },
    getGameListOfRoom: function getGameListOfRoom(idx) {
        var self = this;
        var roomInfo = this._historyData[idx];
        cc.vv.userMgr.getGamesOfRoom(roomInfo.uuid, function (data) {
            if (data != null && data.length > 0) {
                self.initGameHistoryList(roomInfo, data);
            }
        });
    },
    getDetailOfGame: function getDetailOfGame(idx) {
        var self = this;
        var roomUUID = this._curRoomInfo.uuid;
        cc.vv.userMgr.getDetailOfGame(roomUUID, idx, function (data) {
            data.base_info = JSON.parse(data.base_info);
            data.action_records = JSON.parse(data.action_records);
            cc.vv.gameNetMgr.prepareReplay(self._curRoomInfo, data);
            cc.vv.replayMgr.init(data);
            cc.director.loadScene("mjgame");
        });
    },
    onViewItemClicked: function onViewItemClicked(event) {
        var idx = event.target.idx;
        console.log(idx);
        if (this._curRoomInfo == null) {
            this.getGameListOfRoom(idx);
        } else {
            this.getDetailOfGame(idx);
        }
    },
    onBtnOpClicked: function onBtnOpClicked(event) {
        var idx = event.target.parent.idx;
        console.log(idx);
        if (this._curRoomInfo == null) {
            this.getGameListOfRoom(idx);
        } else {
            this.getDetailOfGame(idx);
        }
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"buffer":2}],"ImageLoader":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'ed057Bgp8FHlJbGI+ljAN7d', 'ImageLoader');
// scripts/components/ImageLoader.js

'use strict';

function loadImage(url, code, callback) {
    cc.loader.load(url, function (err, tex) {
        var spriteFrame = new cc.SpriteFrame(tex, cc.Rect(0, 0, tex.width, tex.height));
        callback(code, spriteFrame);
    });
};

function getBaseInfo(userid, callback) {
    if (cc.vv.baseInfoMap == null) {
        cc.vv.baseInfoMap = {};
    }
    if (cc.vv.baseInfoMap[userid] != null) {
        callback(userid, cc.vv.baseInfoMap[userid]);
    } else {
        cc.vv.http.sendRequest('/base_info', {
            userid: userid
        }, function (ret) {
            var url = null;
            if (ret.headimgurl) {
                url = ret.headimgurl;
            }
            var info = {
                name: ret.name,
                sex: ret.sex,
                url: url
            };
            cc.vv.baseInfoMap[userid] = info;
            callback(userid, info);
        }, cc.vv.http.master_url);
    }
};
cc.Class({
    extends: cc.Component,
    properties: {},
    // use this for initialization
    onLoad: function onLoad() {
        this.setupSpriteFrame();
    },
    setUserID: function setUserID(userid, ttype) {
        if (!userid) {
            return;
        }
        if (cc.vv.images == null) {
            cc.vv.images = {};
        }
        var self = this;
        // 如果指定类型为1表示显示二维码信息
        if (ttype == 1) {
            var yaoqing = 'btmj' + cc.vv.userMgr.yaoqing_key;
            var roomid = cc.vv.userMgr.shareRoomId || cc.vv.gameNetMgr.roomId || "000000";
            var url = 'http://mj.yajugame.com/manage1/?/member/user/qrcode_app/';
            if (!yaoqing) {
                return;
            }
            url = url + yaoqing + '/' + roomid + '.png';
            loadImage(url, userid, function (err, spriteFrame) {
                self._spriteFrame = spriteFrame;
                self.setupSpriteFrame();
            });
        } else {
            getBaseInfo(userid, function (code, info) {
                if (info && info.url) {
                    loadImage(info.url, userid, function (err, spriteFrame) {
                        self._spriteFrame = spriteFrame;
                        self.setupSpriteFrame();
                    });
                }
            });
        }
    },
    setupSpriteFrame: function setupSpriteFrame() {
        if (this._spriteFrame) {
            var spr = this.getComponent(cc.Sprite);
            if (spr) {
                spr.spriteFrame = this._spriteFrame;
            }
        }
    }
});

cc._RFpop();
},{}],"JbsNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd4522T19FRDDZLEYIwuCL4T', 'JbsNetMgr');
// scripts/JbsNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    initHandlers: function initHandlers(GameNet) {
        var self = GameNet;
        cc.vv.match_net.addHandler("signup", function (data) {
            cc.vv.alert.show("提示", "进入比赛队列成功！比赛人数一满您将直接进入游戏！");
        });
        cc.vv.match_net.addHandler("signup_fail", function (data) {
            cc.vv.alert.show("提示", "进入比赛队列失败！");
        });
        cc.vv.match_net.addHandler("create_match_finish", function (data) {
            console.log("create_match_finish", data);
            //达到开始比赛条件
            cc.vv.userMgr.enterRoom(data.roomid);
        });
        cc.vv.match_net.addHandler("match_result", function (data) {
            console.log("match_result", data);
            //处理一轮比赛结果
            if (!data) {
                return;
            }
            var msg = '该轮比赛结束，';
            if (data.isWin) {
                msg += '恭喜进入下一轮！';
            } else {
                msg += '您已被淘汰！';
                cc.vv.match_net.close();
            }
            cc.vv.alert.show('提示', msg);
        });
        cc.vv.match_net.addHandler("match_over", function (data) {
            console.log("match_over", data);
            //处理整个比赛结果
            if (!data) {
                return;
            }
            var msg = '锦标赛结束，';
            var ranking = data.ranking; //排名
            if (ranking == 1) {
                msg += '恭喜获得冠军';
            } else if (ranking == 2) {
                msg += '恭喜获得第二名';
            } else if (ranking == 3) {
                msg += '恭喜获得第三名';
            }
            cc.vv.match_net.close();
            // var reward_num = data.reward_num;
            // var reward_type = data.reward_type;
            // if (reward_type == 1) {
            //     msg += reward_num + '金币！';
            // } else if (reward_type == 2) {
            //     msg += reward_num + '钻石！';
            // }
            cc.vv.alert.show('提示', msg);
        });
        cc.vv.match_net.addHandler("exit_match", function (data) {
            cc.vv.match_net.close();
        });
    }
});

cc._RFpop();
},{}],"Jbs":[function(require,module,exports){
"use strict";
cc._RFpush(module, '857c5r5HgpOQpuzO6ITUKu3', 'Jbs');
// scripts/components/Jbs.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {},
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._btnClose = this.node.getChildByName("btnClose"); //返回按钮
        this._zjhmatch = this.node.getChildByName("zjhmatch"); //扎金花界面
        this._dnmatch = this.node.getChildByName("dnmatch"); //斗牛界面
        this._mjmatch = this.node.getChildByName("mjmatch"); //麻将界面
        this._detail = this.node.getChildByName('detail'); //比赛详情界面
        this._detail_rule = this._detail.getChildByName('rule'); //规则详情
        this._detail_reward = this._detail.getChildByName('reward'); //奖励详情
        this._detail_record = this._detail.getChildByName('record'); //战绩详情
        cc.vv.utils.addClickEvent(this._btnClose, this.node, "Jbs", "onBtnClose");
        this.initEventWanfa(this._zjhmatch);
        this.initEventWanfa(this._dnmatch);
        this.initEventWanfa(this._mjmatch);
        this.initEventDetail(this._detail_rule);
        this.initEventDetail(this._detail_reward);
        this.initEventDetail(this._detail_record);
    },
    onBtnClose: function onBtnClose() {
        this.node.active = false;
    },
    onBtnWanfa: function onBtnWanfa(event) {
        var name = event.target.name;
        name = name.replace("jbs_", "");
        if (name.indexOf("_") > -1) {
            //可点击
            name = name.replace("_", "");
            switch (name) {
                case 'dou':
                    //斗牛
                    this._dnmatch.active = true;
                    break;
                case 'ma':
                    //麻将
                    this._mjmatch.active = true;
                    break;
                case 'zha':
                    //扎金花
                    this._zjhmatch.active = true;
                    break;
            }
            //隐藏当前panel
            event.target.parent.parent.active = false;
        }
    },
    onBtnDetailChange: function onBtnDetailChange(event) {
        var name = event.target.name;
        name = name.replace("_button", "");
        this._detail_rule.active = false;
        this._detail_reward.active = false;
        this._detail_record.active = false;

        switch (name) {
            case 'rule':
                //规则
                this._detail_rule.active = true;
                break;
            case 'reward':
                //奖励
                this._detail_reward.active = true;
                break;
            case 'record':
                //战绩
                this._detail_record.active = true;
                break;
        }
    },
    onBtnBaoMing: function onBtnBaoMing(event) {
        var self = this;
        var btn = event.target;
        var match_data = btn.data;
        var send_data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            userid: cc.vv.userMgr.userId,
            match_id: match_data['id']
        };
        cc.vv.http.sendRequest("/jinbiao_room", send_data, function (ret) {
            if (!ret || ret.errcode != 0) {
                if (ret.errmsg) {
                    cc.vv.alert.show('注意', ret.errmsg);
                } else {
                    cc.vv.alert.show('注意', '报名失败，不满足报名条件');
                }
                return;
            };
            //刷新客户端金币和钻石
            cc.vv.userMgr.getGemsAndCoins(function (data) {
                cc.vv.userMgr.gems = data.gems;
                cc.vv.userMgr.coins = data.coins;
            });
            var connect_data = {
                ip: ret.ip,
                port: ret.port
            };
            cc.vv.gameNetMgr.connectMatchServer(connect_data, match_data);
            self.node.active = false; //报名后，自动隐藏报名界面，用于再次打开的时候可以刷新数据
        });
    },
    //退赛按钮
    onBtnTuiSai: function onBtnTuiSai(event) {
        var self = this;
        var match_id = event.target.data['match_id'];
        var send_data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            userid: cc.vv.userMgr.userId,
            match_id: match_id
        };
        cc.vv.http.sendRequest("/tuisai", send_data, function (ret) {
            if (!ret || ret.errcode != 0) {
                if (ret.errmsg) {
                    cc.vv.alert.show('注意', ret.errmsg);
                } else {
                    cc.vv.alert.show('注意', '退赛失败');
                }
                return;
            };

            //刷新客户端金币和钻石
            cc.vv.userMgr.getGemsAndCoins(function (data) {
                cc.vv.userMgr.gems = data.gems;
                cc.vv.userMgr.coins = data.coins;
            });
            var connect_data = {
                ip: ret.ip,
                port: ret.port
            };
            self._detail.active = false;
            self.node.active = false; //报名后，自动隐藏报名界面，用于再次打开的时候可以刷新数据
            cc.vv.alert.show('提示', '退赛成功，80%报名费已返还！');
        });
    },
    //顶部按钮切换页面
    initEventWanfa: function initEventWanfa(target) {
        var children = target.getChildByName('jbs_wanfa').children;
        var hasMaJiang = true;
        if (cc.vv.userMgr.modules && cc.vv.userMgr.modules.indexOf(2) == -1) {
            //没有麻将
            hasMaJiang = false;
        }
        for (var i in children) {
            var child = children[i];
            if (!hasMaJiang && child.name.indexOf('jbs_ma') > -1) {
                //如果不包含麻将，就隐藏麻将按钮
                child.active = false;
            }
            cc.vv.utils.addClickEvent(child, this.node, "Jbs", "onBtnWanfa", true);
        }
    },
    //详情顶部按钮切换
    initEventDetail: function initEventDetail(target) {
        var rule_button = target.getChildByName('rule_button');
        var reward_button = target.getChildByName('reward_button');
        var record_button = target.getChildByName('record_button');
        cc.vv.utils.addClickEvent(rule_button, this.node, "Jbs", "onBtnDetailChange", true);
        cc.vv.utils.addClickEvent(reward_button, this.node, "Jbs", "onBtnDetailChange", true);
        cc.vv.utils.addClickEvent(record_button, this.node, "Jbs", "onBtnDetailChange", true);
    },
    //刷新报名界面数据
    freshMatch: function freshMatch(matchDatas) {
        var self = this;
        if (!matchDatas) return;
        for (var i in matchDatas) {
            var matchData = matchDatas[i];
            var target = null;
            switch (i) {
                case 'zha':
                    target = self._zjhmatch;
                    break;
                case 'dou':
                    target = self._dnmatch;
                    break;
                case 'ma':
                    target = self._mjmatch;
                    break;
            }
            var content = target.getChildByName('scrollview').getChildByName('view').getChildByName('content');
            for (var j in matchData) {
                var data = matchData[j];
                var list = content.children[j];
                var info = list.getChildByName('info');
                info.getChildByName('label').getComponent(cc.Label).string = data.name; //比赛名称

                var layout = list.getChildByName('layout');
                layout.data = data;
                cc.vv.utils.addClickEvent(layout, self.node, "Jbs", "showBaoMingDetail", true); //给报名信息添加点击事件，显示详细信息

                var num_in_match = 13;
                if (data['num_in_match'] != null && typeof data['num_in_match'] != 'undefined') {
                    num_in_match = data['num_in_match'];
                    num_in_match = parseInt(num_in_match) % parseInt(data.enterNum);
                }
                info.getChildByName('hasEnter').getChildByName('num').getComponent(cc.Label).string = num_in_match + '人'; //已经加入的人数
                info.getChildByName('enough').getComponent(cc.Label).string = '满' + data.enterNum + '人开赛';

                var baoming_btn = list.getChildByName('button'); //报名按钮
                baoming_btn.data = data;
                cc.vv.utils.addClickEvent(baoming_btn, self.node, "Jbs", "onBtnBaoMing", true); //给报名按钮添加点击事件
                baoming_btn.getChildByName('label').getComponent(cc.Label).string = data.fee; //显示报名费

                var yibaoming_btn = list.getChildByName('yibaoming'); //已报名按钮
                yibaoming_btn.getChildByName('label').getComponent(cc.Label).string = data.fee; //显示报名费

                var is_ing = num_in_match == data.enterNum;
                var jbs_ing = list.getChildByName('jbs_ing');
                var is_bao_ming = data['is_bao_ming'];
                if (is_bao_ming) {
                    baoming_btn.active = false;
                    jbs_ing.active = false;
                    yibaoming_btn.active = true;
                } else {
                    baoming_btn.active = true;
                    yibaoming_btn.active = false;
                    jbs_ing.active = false;
                }
            }
        }
    },
    showMatchList: function showMatchList(matchData) {
        this.node.active = true;
        console.log('matchData', matchData);

        this.freshMatch(matchData);
    },
    showBaoMingDetail: function showBaoMingDetail(event) {
        var data = event.target.data;
        console.log('showDetails===>', data);
        if (data) {
            this._detail.active = true;
            var view = this._detail_rule.getChildByName('scrollview').getChildByName('view');
            var rule_content = view.getChildByName('rule_content');
            var num = rule_content.getChildByName('num');
            var fee = rule_content.getChildByName('fee');
            var description = rule_content.getChildByName('description');
            num.getComponent(cc.Label).string = "开赛人数：" + data.enterNum + "人";
            var fee_type;
            if (data.feeType == 2) {
                fee_type = "钻石";
            } else {
                fee_type = "金币";
            }
            fee.getComponent(cc.Label).string = "报名费用：" + data.fee + fee_type;
            // description.getComponent(cc.Label).string = 
            var reward_view = this._detail_reward.getChildByName('scrollview').getChildByName('view');
            var info = reward_view.getChildByName('content').getChildByName('info');
            var first = info.getChildByName('first').getChildByName('reward');
            first.getComponent(cc.Label).string = data.rewardFirst + fee_type;

            var second = info.getChildByName('second');
            if (data.rewardSecond) {
                second.active = true;
                var second_reward = second.getChildByName('reward');
                second_reward.getComponent(cc.Label).string = data.rewardSecond + fee_type;
            } else {
                second.active = false;
            }

            var third = info.getChildByName('third');
            if (data.rewardThird) {
                third.active = true;
                var third_award = third.getChildByName('reward');
                third_award.getComponent(cc.Label).string = data.rewardThird + fee_type;
            } else {
                third.active = false;
            }

            var tuisai_btn = this._detail_rule.getChildByName('jbs_tuisai');
            if (data.is_bao_ming && data.num_in_match != data.enterNum) {
                cc.vv.utils.addClickEvent(tuisai_btn, this.node, "Jbs", "onBtnTuiSai", true);
                tuisai_btn.active = true;
                tuisai_btn.data = {
                    match_id: data.id
                };
            } else {
                tuisai_btn.active = false;
            }
        }
    },
    hideBaoMingDetail: function hideBaoMingDetail() {
        this._detail.active = false;
    }
});

cc._RFpop();
},{}],"JoinGameInput":[function(require,module,exports){
"use strict";
cc._RFpush(module, '10a1c8jz95Ju4NnpkOWUfin', 'JoinGameInput');
// scripts/components/JoinGameInput.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        nums: {
            default: [],
            type: [cc.Label]
        },
        _inputIndex: 0
    },
    // use this for initialization
    onLoad: function onLoad() {},
    onEnable: function onEnable() {
        this.onResetClicked();
    },
    onInputFinished: function onInputFinished(roomId) {
        cc.vv.userMgr.enterRoom(roomId, function (ret) {
            if (ret.errcode == 0) {
                this.node.active = false;
            } else {
                var content = "麻将房间[" + roomId + "]不存在，请重新输入!";
                if (ret.errcode == 4) {
                    content = "麻将房间[" + roomId + "]已满!";
                }
                cc.vv.alert.show("提示", content);
                this.onResetClicked();
            }
        }.bind(this));
    },
    onInput: function onInput(num) {
        if (this._inputIndex >= this.nums.length) {
            return;
        }
        this.nums[this._inputIndex].string = num;
        this._inputIndex += 1;
        var self = this;
        if (this._inputIndex == this.nums.length) {
            var roomId = this.parseRoomID();
            console.log("ok:" + roomId);
            var content = null;
            var data = {
                account: cc.vv.userMgr.account,
                sign: cc.vv.userMgr.sign,
                room_type: 0,
                roomId: roomId
            };
            var fn = function fn(ret) {
                if (ret.errcode == 0) {
                    self.onInputFinished(roomId);
                } else if (ret.errcode == 1) {
                    content = "麻将房间[" + roomId + "]不存在，请重新输入!";
                }
                if (content) {
                    cc.vv.alert.show("提示", content);
                    self.onResetClicked();
                }
            };
            cc.vv.http.sendRequest("/judge_room", data, fn);
        }
    },
    onN0Clicked: function onN0Clicked() {
        this.onInput(0);
    },
    onN1Clicked: function onN1Clicked() {
        this.onInput(1);
    },
    onN2Clicked: function onN2Clicked() {
        this.onInput(2);
    },
    onN3Clicked: function onN3Clicked() {
        this.onInput(3);
    },
    onN4Clicked: function onN4Clicked() {
        this.onInput(4);
    },
    onN5Clicked: function onN5Clicked() {
        this.onInput(5);
    },
    onN6Clicked: function onN6Clicked() {
        this.onInput(6);
    },
    onN7Clicked: function onN7Clicked() {
        this.onInput(7);
    },
    onN8Clicked: function onN8Clicked() {
        this.onInput(8);
    },
    onN9Clicked: function onN9Clicked() {
        this.onInput(9);
    },
    onResetClicked: function onResetClicked() {
        for (var i = 0; i < this.nums.length; ++i) {
            this.nums[i].string = "";
        }
        this._inputIndex = 0;
    },
    onDelClicked: function onDelClicked() {
        if (this._inputIndex > 0) {
            this._inputIndex -= 1;
            this.nums[this._inputIndex].string = "";
        }
    },
    onCloseClicked: function onCloseClicked() {
        this.node.active = false;
    },
    parseRoomID: function parseRoomID() {
        var str = "";
        for (var i = 0; i < this.nums.length; ++i) {
            str += this.nums[i].string;
        }
        return str;
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"Login":[function(require,module,exports){
"use strict";
cc._RFpush(module, '572a7Qfh69N9ZLXkNthANfi', 'Login');
// scripts/components/Login.js

"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

String.prototype.format = function (args) {
    if (arguments.length > 0) {
        var result = this;
        if (arguments.length == 1 && (typeof args === "undefined" ? "undefined" : _typeof(args)) == "object") {
            for (var key in args) {
                var reg = new RegExp("({" + key + "})", "g");
                result = result.replace(reg, args[key]);
            }
        } else {
            for (var i = 0; i < arguments.length; i++) {
                if (arguments[i] == undefined) {
                    return "";
                } else {
                    var reg = new RegExp("({[" + i + "]})", "g");
                    result = result.replace(reg, arguments[i]);
                }
            }
        }
        return result;
    } else {
        return this;
    }
};
cc.Class({
    extends: cc.Component,
    properties: {
        _stateStr: '',
        _progress: 0.0,
        _isLoading: true,
        btnWechatLogin: cc.Node,
        loadingbar: {
            default: null,
            type: cc.ProgressBar
        },
        _time: 0,
        i: 0
    },
    // use this for initialization
    onLoad: function onLoad() {
        this.loadingbar.progress = 0;
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        this.initMgr();
        if (!cc.vv) {
            this.initMgr();
        }
        cc.vv.http.url = cc.vv.http.master_url;
        this.btnWechatLogin.active = false;
    },
    start: function start() {
        var self = this;
        var SHOW_TIME = 3000;
        var FADE_TIME = 500;
        if (cc.sys.os != cc.sys.OS_IOS || !cc.sys.isNative) {
            var t = Date.now();
            var fn = function fn() {
                var dt = Date.now() - t;
                if (dt < SHOW_TIME) {
                    setTimeout(fn, 33);
                } else {
                    var op = (1 - (dt - SHOW_TIME) / FADE_TIME) * 255;
                    if (op < 0) {
                        self.checkVersion();
                    } else {
                        setTimeout(fn, 33);
                    }
                }
            };
            setTimeout(fn, 33);
        } else {
            this.checkVersion();
        }
    },
    initMgr: function initMgr() {
        cc.vv = {};
        var UserMgr = require("UserMgr");
        cc.vv.userMgr = new UserMgr();
        var ReplayMgr = require("ReplayMgr");
        cc.vv.replayMgr = new ReplayMgr();
        cc.vv.http = require("HTTP");
        cc.vv.global = require("Global");
        cc.vv.net = require("Net");
        cc.vv.match_net = require("MatchNet");
        var GameNetMgr = require("GameNetMgr");
        cc.vv.gameNetMgr = new GameNetMgr();
        // cc.vv.gameNetMgr.initHandlers();
        var AnysdkMgr = require("AnysdkMgr");
        cc.vv.anysdkMgr = new AnysdkMgr();
        cc.vv.anysdkMgr.init();
        var VoiceMgr = require("VoiceMgr");
        cc.vv.voiceMgr = new VoiceMgr();
        cc.vv.voiceMgr.init();
        var AudioMgr = require("AudioMgr");
        cc.vv.audioMgr = new AudioMgr();
        cc.vv.audioMgr.init();
        var Utils = require("Utils");
        cc.vv.utils = new Utils();
        cc.args = this.urlParse();
        this._isLoading = true;
    },
    urlParse: function urlParse() {
        var params = {};
        if (window.location == null) {
            return params;
        }
        var name, value;
        var str = window.location.href; //取得整个地址栏
        var num = str.indexOf("?");
        str = str.substr(num + 1); //取得所有参数   
        var arr = str.split("&"); //各个参数放到数组里
        for (var i = 0; i < arr.length; i++) {
            num = arr[i].indexOf("=");
            if (num > 0) {
                name = arr[i].substring(0, num);
                value = arr[i].substr(num + 1);
                params[name] = value;
            }
        }
        return params;
    },
    checkVersion: function checkVersion() {
        var self = this;
        var onGetVersion = function onGetVersion(ret) {
            if (ret.version == null) {
                console.log("error.");
            } else {
                console.log("返回的结果是" + JSON.stringify(ret));
                cc.vv.SI = ret;
                self.startPreloading();
            }
        };
        var xhr = null;
        var complete = false;
        var fnRequest = function fnRequest() {
            self._stateStr = "正在连接服务器";
            xhr = cc.vv.http.sendRequest("/get_serverinfo", null, function (ret) {
                xhr = null;
                complete = true;
                onGetVersion(ret);
            });
            setTimeout(fn, 5000);
        };
        var fn = function fn() {
            if (!complete) {
                if (xhr) {
                    xhr.abort();
                    self._stateStr = "连接失败，即将重试";
                    setTimeout(function () {
                        fnRequest();
                    }, 5000);
                } else {
                    fnRequest();
                }
            }
        };
        fn();
    },
    startPreloading: function startPreloading() {
        this._stateStr = "正在加载资源，请稍候";
        // this._isLoading = true;
        var self = this;
        cc.loader.onProgress = function (completedCount, totalCount, item) {
            if (self._isLoading) {
                self._progress = completedCount / totalCount;
            }
        };
        cc.loader.loadResDir("textures/images/login", function (err, assets) {
            console.log("登录资源加载完成");
            self.onLoadComplete();
        });
    },
    // 加载完成
    onLoadComplete: function onLoadComplete() {
        this._isLoading = false;
        this.loadingbar.node.active = false;
        this.btnWechatLogin.active = true;
        cc.loader.onComplete = null;
        cc.loader.loadResDir("textures/home", function (err, assets) {
            console.log("hall大厅资源加载完成");
        });
    },
    // 点击微信登录按钮
    onBtnWeichatClicked: function onBtnWeichatClicked() {
        console.log("创建一个微信登录的");
        if (cc.args["account"] == null) {
            this.sendWXLoginXHR();
        } else {
            cc.vv.wc.show("正在登录游戏,请稍后");
            cc.vv.userMgr.guestAuth();
        }
    },
    // 发送请求，获取到微信登录用的code
    sendWXLoginXHR: function sendWXLoginXHR() {
        cc.vv.wc.show("正在登录游戏,请稍后");
        var url = "http://mj.yajugame.com/sessionid.php";
        var xhr = cc.loader.getXMLHttpRequest();
        xhr.open("GET", url, true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status >= 200 && xhr.status <= 207) {
                var httpStatus = xhr.statusText;
                var response = xhr.responseText;
                var res = JSON.parse(response);
                this.session_id = res["sid"];
                if (this.session_id) {
                    console.log("the sid is " + this.session_id);
                    var fn = function fn(ret) {
                        if (ret.errcode == 0) {
                            cc.vv.anysdkMgr.onLoginResp(ret.code, ret.uid, ret.roomid);
                        } else {
                            cc.vv.wc.show("请在微信中打开该链接地址或刷新页面！");
                        }
                    };
                    cc.vv.http.sendRequest("/get_wx_code", {
                        sid: this.session_id
                    }, fn);
                }
            } else {
                console.log("无结果返回");
            }
        };
        xhr.timeout = 5000; // 5 seconds for timeout
        xhr.send();
    },
    time: function time() {
        this._time = Date.now();
    },
    update: function update(dt) {
        var progress = this.loadingbar.progress;
        if (this._isLoading) {
            if (Date.now() - this._time > 100) {
                this.time();
                progress += dt;
                if (this.i >= 3) {
                    if (progress < this._progress) {
                        progress = this._progress;
                    }
                }
                if (progress > 1) {
                    progress = 1;
                }
                this.i++;
            }
            this.loadingbar.progress = progress;
        }
    }
});

cc._RFpop();
},{"AnysdkMgr":"AnysdkMgr","AudioMgr":"AudioMgr","GameNetMgr":"GameNetMgr","Global":"Global","HTTP":"HTTP","MatchNet":"MatchNet","Net":"Net","ReplayMgr":"ReplayMgr","UserMgr":"UserMgr","Utils":"Utils","VoiceMgr":"VoiceMgr"}],"MJGame":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7fa8fcvrqFOj6lhh6xHzd3c', 'MJGame');
// scripts/components/MJGame.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        gameRoot: {
            default: null,
            type: cc.Node
        },
        prepareRoot: {
            default: null,
            type: cc.Node
        },
        _myMJArr: [],
        _options: null,
        _selectedMJ: null,
        _chupaiSprite: [],
        _mjcount: null,
        _gamecount: null,
        _hupaiTips: [],
        _hupaiLists: [],
        _playEfxs: [],
        _opts: [],
        // 用于存放服务端发过来的可以吃的组合
        _chiArrays: [],
        // 用来存放玩家选中的吃的组合
        _chiOptionArray: [],
        _chiOpts: null,
        _optionsData: null,
        _canChupai: false
    },
    onLoad: function onLoad() {
        if (!cc.sys.isNative && cc.sys.isMobile) {
            var cvs = this.node.getComponent(cc.Canvas);
            cvs.fitHeight = true;
            cvs.fitWidth = true;
        }
        if (!cc.vv) {
            cc.director.loadScene("login");
            return;
        }
        this.addComponent("NoticeTip");
        this.addComponent("GameOver");
        this.addComponent("PengGangs");
        this.addComponent("MJRoom");
        this.addComponent("TimePointer");
        this.addComponent("GameResult");
        this.addComponent("Chat");
        this.addComponent("Folds");
        this.addComponent("ReplayCtrl");
        this.addComponent("PopupMgr");
        this.addComponent("ReConnect");
        this.addComponent("Voice");
        this.initView();
        this.initEventHandlers();
        this.gameRoot.active = false;
        this.prepareRoot.active = true;
        this._chiArrays = [];
        this._chiOptionArray = [];
        this.initWanfaLabel();
        this.onGameBeign();
    },
    initView: function initView() {
        //搜索需要的子节点
        var gameChild = this.node.getChildByName("game");
        this._mjcount = gameChild.getChildByName('mjcount').getComponent(cc.Label);
        this._mjcount.string = "剩余" + cc.vv.gameNetMgr.numOfMJ + "张";
        this._gamecount = gameChild.getChildByName('gamecount').getComponent(cc.Label);
        this._gamecount.string = "" + cc.vv.gameNetMgr.numOfGames + "/" + cc.vv.gameNetMgr.maxNumOfGames + "局";
        var myselfChild = gameChild.getChildByName("myself");
        var myholds = myselfChild.getChildByName("holds");
        for (var i = 0; i < myholds.children.length; ++i) {
            var sprite = myholds.children[i].getComponent(cc.Sprite);
            this._myMJArr.push(sprite);
            this.onMjToUp(sprite.node);
            sprite.spriteFrame = null;
        }
        var realwidth = cc.director.getVisibleSize().width;
        myholds.scaleX *= realwidth / 1280;
        myholds.scaleY *= realwidth / 1280;
        var sides = ["myself", "right", "up", "left"];
        for (var i = 0; i < sides.length; ++i) {
            var side = sides[i];
            var sideChild = gameChild.getChildByName(side);
            this._hupaiTips.push(sideChild.getChildByName("HuPai"));
            this._hupaiLists.push(sideChild.getChildByName("hupailist"));
            this._playEfxs.push(sideChild.getChildByName("play_efx").getComponent(cc.Animation));
            this._chupaiSprite.push(sideChild.getChildByName("ChuPai").children[0].getComponent(cc.Sprite));
            var opt = sideChild.getChildByName("opt");
            opt.active = false;
            var sprite = opt.getChildByName("pai").getComponent(cc.Sprite);
            var data = {
                node: opt,
                sprite: sprite
            };
            this._opts.push(data);
        }
        var opts = gameChild.getChildByName("ops");
        this._options = opts;
        var chiOpts = gameChild.getChildByName("chiops");
        this._chiOpts = chiOpts;
        this.hideOptions();
        this.hideChupai();
        this.hideChiOptions();
        if (this._myMJArr.length == 14) {
            this._canChupai = true;
        }
    },
    hideChupai: function hideChupai() {
        for (var i = 0; i < this._chupaiSprite.length; ++i) {
            this._chupaiSprite[i].node.active = false;
        }
    },
    checkHasCaiShen: function checkHasCaiShen() {
        // console.log('判断是否有财神');
        var hasCaiShen = false;
        if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn) {
            for (var i = 0; i < this._myMJArr.length; ++i) {
                var sprite = this._myMJArr[i];
                if (sprite.node.mjId != null) {
                    var type = cc.vv.mahjongmgr.getMahjongType(sprite.node.mjId);
                    if (type == 4) {
                        console.log("有财神");
                        hasCaiShen = true;
                        break;
                    }
                }
            }
        }
        return hasCaiShen;
    },
    // 每摸一次牌,判断一下是否是财神
    checkCaiShen: function checkCaiShen() {
        if (this.checkHasCaiShen()) {
            var self = this;
            //自动出花牌
            var fn = function fn(node) {
                var type = cc.vv.mahjongmgr.getMahjongType(node.mjId);
                node.active = false;
                self.shootCaiShen(node.mjId);
                node.y = 0;
                self.recordShootPos(node);
            };
            var node;
            for (var i = 0; i < self._myMJArr.length; ++i) {
                var sprite = self._myMJArr[i];
                if (sprite.node.mjId != null) {
                    var type = cc.vv.mahjongmgr.getMahjongType(sprite.node.mjId);
                    if (type != 4) {
                        sprite.node.getComponent(cc.Button).interactable = false;
                    } else {
                        cc.vv.global.touch_target = sprite.node;
                        // cc.vv.gameNetMgr.turn = sprite.node;
                        node = sprite.node;
                        break;
                    }
                }
            }
            var fun = fn(node);
            setTimeout(fun, 100);
            //遍历检查看是否有未打缺的牌 如果有，则需要将不是定缺的牌设置为不可用
            // console.log("检查是否有财神");
        } else {
            // console.log("没有财神");
            if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn) {
                // console.log("没有财神:", cc.vv.gameNetMgr.seatIndex, cc.vv.gameNetMgr.turn);
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        sprite.node.getComponent(cc.Button).interactable = true;
                    }
                }
            } else {
                // 没有轮到出牌顺序,不能点击麻将
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        // 出牌默认还是可以点击的
                        sprite.node.getComponent(cc.Button).interactable = true;
                    }
                }
            }
        }
    },
    //如果玩家手上还有缺的牌没有打，则只能打缺牌
    initTingedHolds: function initTingedHolds() {
        // 如果有财神,当然不能显示听牌哎
        if (this.checkHasCaiShen()) {
            return;
        }
        if (cc.vv.gameNetMgr.conf == null || !cc.vv.gameNetMgr.getSelfData().tinged) {
            for (var i = 0; i < this._myMJArr.length; ++i) {
                var sprite = this._myMJArr[i];
                if (sprite.node.mjId != null) {
                    sprite.node.getComponent(cc.Button).interactable = true;
                }
            }
        } else {
            if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn) {
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        sprite.node.getComponent(cc.Button).interactable = i == 13;
                    }
                }
            } else {
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        sprite.node.getComponent(cc.Button).interactable = true;
                    }
                }
            }
        }
    },
    initExtraPaiHolds: function initExtraPaiHolds() {
        console.log("运行到这里哦extraPaiHolds");
        if (this.checkHasCaiShen()) {
            return;
        }
        var selfData = cc.vv.gameNetMgr.getSelfData();
        if (selfData.extraPais.length <= 0) {
            console.log("当前多余的牌不存在,不需要额外处理手牌");
            return;
        }
        if (cc.vv.gameNetMgr.conf == null || !selfData.tinged) {
            for (var i = 0; i < this._myMJArr.length; ++i) {
                var sprite = this._myMJArr[i];
                if (sprite.node.mjId != null) {
                    sprite.node.getComponent(cc.Button).interactable = true;
                }
            }
        } else {
            if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn) {
                console.log("判断是否是自己");
                for (var j = 0; j < 14; ++j) {
                    var sprite = this._myMJArr[j];
                    console.log(" 当前的麻将的id是", sprite.node.mjId);
                    if (sprite.node.active == true && sprite.node.mjId != null) {
                        if (selfData.extraPais.indexOf(sprite.node.mjId) > -1) {
                            console.log("准备选择哪些可用", sprite.node.mjId);
                            sprite.node.getComponent(cc.Button).interactable = true;
                        } else {
                            console.log("准备选择哪些可以禁用的", sprite.node.mjId);
                            sprite.node.getComponent(cc.Button).interactable = false;
                        }
                    }
                }
                //ly鉴定。这样写是错误的。因为这样始终是最后一个可操作，与需求不符
                // for (var i = 0; i < selfData.extraPais.length; i++) {
                //     console.log("当前牌是", selfData.extraPais[i]);
                //     var paiId = selfData.extraPais[i];
                //     for (var j = 0; j < 14; ++j) {
                //         var sprite = this._myMJArr[j];
                //         console.log(" 当前的麻将的id是", sprite.node.mjId);
                //         if ((sprite.node.active == true) && (sprite.node.mjId != null)) {
                //             if (sprite.node.mjId == paiId) {
                //                 console.log("准备选择哪些可用", sprite.node.mjId);
                //                 sprite.node.getComponent(cc.Button).interactable = true;
                //             } else {
                //                 console.log("准备选择哪些可以禁用的", sprite.node.mjId);
                //                 sprite.node.getComponent(cc.Button).interactable = false;
                //             }
                //         }
                //     }
                // }
            } else {
                for (var i = 0; i < 14; ++i) {
                    var sprite = this._myMJArr[i];
                    if (sprite.node.active == true) {
                        sprite.node.getComponent(cc.Button).interactable = true;
                    }
                }
            }
        }
    },
    showTingedFlag: function showTingedFlag() {
        console.log("showTingedFlag");
        for (var i = 0; i < cc.vv.gameNetMgr.seats.length; ++i) {
            var seatData = cc.vv.gameNetMgr.seats[i];
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);
            var hupai = this._hupaiTips[localIndex];
            hupai.active = seatData.tinged;
            if (seatData.tinged) {
                hupai.getChildByName("sprHu").active = !seatData.tinged;
                hupai.getChildByName("sprZimo").active = !seatData.tinged;
                hupai.getChildByName("sprTing").active = seatData.tinged;
            }
        }
    },
    resetPai: function resetPai(isShow) {
        //还原被拖动的牌的位置
        var touch_target = cc.vv.global.touch_target;
        if (touch_target) {
            touch_target.x = touch_target.old_node_x;
            touch_target.y = 0;
            if (isShow) {
                touch_target.active = true;
            }
        }
    },
    initEventHandlers: function initEventHandlers() {
        cc.vv.gameNetMgr.dataEventHandler = this.node;
        //初始化事件监听器
        var self = this;
        this.node.on('game_holds', function (data) {
            self.initMahjongs();
            self.checkCaiShen();
            var selfData = cc.vv.gameNetMgr.getSelfData();
            console.log('------------------------------------');
            console.log("selfData", selfData.extraPais);
            console.log('------------------------------------');
            if (selfData != null && selfData.extraPais != null) {
                if (selfData.extraPais.length > 0) {
                    console.log("当前多余的牌存在,则需要额外处理手牌");
                    self.initExtraPaiHolds();
                    selfData.extraPais = [];
                } else {
                    self.initTingedHolds();
                }
            }
        });
        this.node.on('game_begin', function (data) {
            self.onGameBeign();
        });
        this.node.on('game_sync', function (data) {
            self.onGameBeign();
        });
        this.node.on('game_chupai', function (data) {
            data = data.detail;
            self.hideChupai();
            self.checkCaiShen();
            var selfData = cc.vv.gameNetMgr.getSelfData();
            console.log('------------------------------------');
            console.log("selfData", selfData.extraPais);
            console.log('------------------------------------');
            if (selfData != null && selfData.extraPais != null) {
                if (selfData.extraPais.length > 0) {
                    console.log("当前多余的牌存在,则需要额外处理手牌");
                    self.initExtraPaiHolds();
                    selfData.extraPais = [];
                } else {
                    self.initTingedHolds();
                }
            }
            if (data.last != cc.vv.gameNetMgr.seatIndex) {
                self.initMopai(data.last, null);
            }
            if (!cc.vv.replayMgr.isReplay() && data.turn != cc.vv.gameNetMgr.seatIndex) {
                self.initMopai(data.turn, -1);
            }
            //默认不可以出牌
            self._canChupai = false;
            if (!self.checkHasCaiShen() && data.turn == cc.vv.gameNetMgr.seatIndex) {
                //判断是否可以出牌,只有当玩家没有财神,且持有话语权才能出牌(因为'game_chupai' 是发给所有人的)。
                self._canChupai = true;
            }
        });
        this.node.on('game_mopai', function (data) {
            self.hideChupai();
            data = data.detail;
            var pai = data.pai;
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(data.seatIndex);
            if (localIndex == 0) {
                var index = 13;
                var sprite = self._myMJArr[index];
                self.setSpriteFrameByMJID("M_", sprite, pai, index);
                sprite.node.active = true;
                sprite.node.mjId = pai;
                self._canChupai = true;
            } else if (cc.vv.replayMgr.isReplay()) {
                self.initMopai(data.seatIndex, pai);
                self._canChupai = false;
            }
            cc.vv.global.touch_target = null;
            cc.vv.global.shootPos = null;
        });
        this.node.on('game_action', function (data) {
            self._optionsData = data.detail;
            self.showAction(data.detail);
            // console.log("game_action-----是否可以吃牌", data);
            // if (data.detail && data.detail.chi) {
            //     console.log("可以吃牌");
            //     self.showChiAction(data.detail);
            // }
            // if (data.detail) {
            //     if (data.detail.peng || data.detail.gang || data.detail.hu) {
            //         console.log("碰杠胡");
            //         self.showAction(data.detail);
            //     }
            // }
        });
        this.node.on('hupai', function (data) {
            console.log("ly:有人胡牌了");
            self.hideChiOptions();
            var data = data.detail;
            //如果不是玩家自己，则将玩家的牌都放倒
            var seatIndex = data.seatindex;
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
            var hupai = self._hupaiTips[localIndex];
            hupai.active = true;
            if (localIndex == 0) {
                self.hideOptions();
            }
            var seatData = cc.vv.gameNetMgr.seats[seatIndex];
            seatData.hued = true;
            if (cc.vv.gameNetMgr.conf.type == "ykx") {
                hupai.getChildByName("sprHu").active = true;
                hupai.getChildByName("sprZimo").active = false;
                hupai.getChildByName("sprTing").active = false;
                self.initHupai(localIndex, data.hupai);
                if (data.iszimo) {
                    if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                        seatData.holds.pop();
                        self.initMahjongs();
                    } else {
                        self.initOtherMahjongs(seatData);
                    }
                }
            } else {
                hupai.getChildByName("sprHu").active = !data.iszimo;
                hupai.getChildByName("sprZimo").active = data.iszimo;
                if (!(data.iszimo && localIndex == 0)) {
                    //if(cc.vv.replayMgr.isReplay() == false && localIndex != 0){
                    //    self.initEmptySprites(seatIndex);                
                    //}
                    self.initMopai(seatIndex, data.hupai);
                }
            }
            // if (cc.vv.replayMgr.isReplay() == true && cc.vv.gameNetMgr.conf.type != "ykx") {
            //     var opt = self._opts[localIndex];
            //     opt.node.active = true;
            //     opt.sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", data.hupai);
            // }
            if (data.iszimo) {
                self.playEfx(localIndex, "play_zimo");
            } else {
                self.playEfx(localIndex, "play_hu");
            }
            cc.vv.audioMgr.playSFX("nv/hu.mp3");
        });
        this.node.on('mj_count', function (data) {
            self._mjcount.string = "剩余" + cc.vv.gameNetMgr.numOfMJ + "张";
        });
        this.node.on('game_num', function (data) {
            self._gamecount.string = "" + cc.vv.gameNetMgr.numOfGames + "/" + cc.vv.gameNetMgr.maxNumOfGames + "局";
        });
        this.node.on('game_over', function (data) {
            self.gameRoot.active = false;
            self.prepareRoot.active = true;
        });
        this.node.on('game_chupai_notify', function (data) {
            self.hideChupai();
            var seatData = data.detail.seatData;
            //如果是自己，则刷新手牌
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self._canChupai = false;
                //还原被拖动的牌的位置
                self.resetPai();
                setTimeout(function () {
                    var touch_target = cc.vv.global.touch_target;
                    if (touch_target) {
                        touch_target.active = true;
                    }
                    self.initMahjongs();
                }, 500);
            } else {
                self.initOtherMahjongs(seatData);
            }
            self.showChupai();
            // 花牌没有对应的声音
            if (data.detail.pai < 34) {
                var audioUrl = cc.vv.mahjongmgr.getAudioURLByMJID(data.detail.pai);
                // console.log("audioUrl!!!" + audioUrl);
                cc.vv.audioMgr.playSFX(audioUrl);
            }
        });
        //财神处理
        this.node.on('game_caishen_notify', function (data) {
            // console.log("财神事件监听!!!!!!!!!!!!!", data);
            var seatData = data.detail;
            // console.log('财神事件监听', seatData);
            //如果是自己，则刷新手牌
            // if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
            //     setTimeout(function() {
            //         var touch_target = cc.vv.global.touch_target;
            //         if (touch_target) {
            //             touch_target.active = true;
            //         }
            //         self.initCaiShenList();
            //         self.initMahjongs();
            //     }, 500);
            // } else {
            //      self.initOtherMahjongs(seatData);
            //     self.initOtherCaiShenList(seatData);
            // }
            // self.showChupai();
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initCaiShenList();
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
                self.initOtherCaiShenList(seatData);
            }
        });
        this.node.on('match_exit_error', function (data) {
            //锦标赛不能退出游戏
            cc.vv.alert.show("提示", "锦标赛中不能退出游戏");
        });
        this.node.on('guo_notify', function (data) {
            self.hideChupai();
            self.hideOptions();
            self.hideChiOptions();
            var seatData = data.detail;
            //如果是自己，则刷新手牌
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            }
            cc.vv.audioMgr.playSFX("give.mp3");
        });
        this.node.on('guo_result', function (data) {
            self.hideOptions();
        });
        // 游戏
        this.node.on('game_playing', function (data) {
            self.initMahjongs();
        });
        this.node.on('peng_notify', function (data) {
            self.hideChiOptions();
            self.hideChupai();
            var seatData = data.detail;
            console.log("此时玩家的seatdate", seatData);
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
            var localIndex = self.getLocalIndex(seatData.seatindex);
            self.playEfx(localIndex, "play_peng");
            cc.vv.audioMgr.playSFX("nv/peng.mp3");
            self.hideOptions();
            seatData.tinged = true;
            self.showTingedFlag();
        });
        // 吃
        this.node.on("chi_notify", function (data) {
            var seatData = data.detail;
            var localIndex = self.getLocalIndex(seatData);
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
            // TODO 吃牌特效有bug
            // self.playEfx(localIndex, "play_peng");
            cc.vv.audioMgr.playSFX("nv/chi.mp3");
            self.hideChiOptions();
            self.hideOptions();
            seatData.tinged = true;
            self.showTingedFlag();
        });
        this.node.on('gang_notify', function (data) {
            self.hideChiOptions();
            self.hideChupai();
            var data = data.detail;
            var seatData = data.seatData;
            var gangtype = data.gangtype;
            if (seatData.seatindex == cc.vv.gameNetMgr.seatIndex) {
                self.initMahjongs();
            } else {
                self.initOtherMahjongs(seatData);
            }
            var localIndex = self.getLocalIndex(seatData.seatindex);
            self.playEfx(localIndex, "play_gang");
            cc.vv.audioMgr.playSFX("nv/gang.mp3");
            console.log("---------seatData------------->>", seatData.tinged, seatData);
            if (seatData.angangs.length == 0) {
                seatData.tinged = true;
            }
            self.showTingedFlag();
        });
        this.node.on("hangang_notify", function (data) {
            var data = data.detail;
            var localIndex = self.getLocalIndex(data);
            self.playEfx(localIndex, "play_gang");
            cc.vv.audioMgr.playSFX("nv/gang.mp3");
            self.hideOptions();
        });
    },
    showChupai: function showChupai() {
        var pai = cc.vv.gameNetMgr.chupai;
        if (pai >= 0) {
            var localIndex = this.getLocalIndex(cc.vv.gameNetMgr.turn);
            var sprite = this._chupaiSprite[localIndex];
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            var target_node = sprite.node;
            var old_x = target_node.x;
            var old_y = target_node.y;
            sprite.node.active = true;
            var pos = cc.vv.global.shootPos;
            switch (localIndex) {
                case 0:
                    if (pos) {
                        target_node.x = pos.x * 1.1; //移到出牌位置
                        target_node.y = pos.y * 1.1 - 158; //移到出牌位置
                    }
                    break;
                case 1:
                    target_node.x = cc.find("Canvas/game/right").x;
                    target_node.y = -150;
                    break;
                case 2:
                    target_node.x = -50;
                    target_node.y = 276;
                    break;
                case 3:
                    target_node.x = cc.find("Canvas/game/left").x;
                    target_node.y = 150;
                    break;
            }
            var action = cc.moveTo(0.05, cc.p(old_x, old_y));
            //动画需要隐藏自己出的牌
            if (cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn && cc.vv.global.touch_target) {
                cc.vv.global.touch_target.active = false;
            }
            target_node.runAction(action);
        }
    },
    toChiActionPage: function toChiActionPage() {
        // console.log("to 吃 操作的页面");
        this.showChiAction(this._optionsData);
    },
    // 碰，杠，胡，过操作
    addOption: function addOption(btnName, pai) {
        for (var i = 0; i < this._options.childrenCount; ++i) {
            var child = this._options.children[i];
            if (child.name == "op" && child.active == false) {
                child.active = true;
                var sprite = child.getChildByName("opTarget").getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
                var btn = child.getChildByName(btnName);
                btn.active = true;
                btn.pai = pai;
                return;
            }
        }
    },
    // 吃牌操作
    addChiOption: function addChiOption(btnName, data) {
        console.log("吃牌操作addchioption", data);
        // 显示全部
        for (var i = 0; i < this._chiOpts.childrenCount; ++i) {
            var child = this._chiOpts.children[i];
            child.active = true;
            if (child.name == "btnChi") {
                if (data.pai != null) {
                    child.pai = data.pai;
                }
            }
        }
        for (var i = 0; i < this._chiOpts.childrenCount; ++i) {
            var child = this._chiOpts.children[i];
            for (var j = 0; j < 3; j++) {
                var id = "op" + j;
                if (child.name == id) {
                    child.active = false;
                }
            }
        }
        for (var i = 0; i < this._chiOpts.childrenCount; ++i) {
            var parentname = this._chiOpts.children[i];
            var info = data.chiArrayInfo;
            if (info.length <= 0) {
                return;
            }
            // 目标牌
            if (parentname.name == "opTarget") {
                if (data.pai != null) {
                    var sprite = parentname.getComponent(cc.Sprite);
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", data.pai);
                }
            }
            for (var k = 0; k < info.length; k++) {
                var name = "op" + k;
                if (parentname.name == name) {
                    parentname.active = true;
                    var childName = "pai" + k;
                    var paiInfo = info[k];
                    this._chiArrays.push(paiInfo);
                    console.log('this._chiArraysthis._chiArraysthis._chiArraysthis._chiArrays', this._chiArrays);
                    this.showChiPaiArray(parentname, paiInfo);
                }
            }
        }
    },
    // 显示吃牌的组合
    showChiPaiArray: function showChiPaiArray(parentname, data) {
        console.log("显示吃牌的组合", data, this._chiArrays);
        if (data != null && data.length > 0) {
            for (var index = 0; index < 2; index++) {
                var pai = data[index];
                var painame = "pai" + index;
                var sprite = parentname.getChildByName(painame).getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID("M_", pai);
            }
        }
    },
    // 隐藏碰杠胡牌操作
    hideOptions: function hideOptions(data) {
        this._options.active = false;
        this.hideChiOptions();
        for (var i = 0; i < this._options.childrenCount; ++i) {
            var child = this._options.children[i];
            if (child.name == "op") {
                child.active = false;
                child.getChildByName("btnPeng").active = false;
                child.getChildByName("btnGang").active = false;
                child.getChildByName("btnHu").active = false;
                child.getChildByName("btnChi").active = false;
            }
        }
    },
    // 隐藏吃牌的操作
    hideChiOptions: function hideChiOptions() {
        console.log("隐藏hideChiOptions", this._chiOpts.childrenCount);
        this._chiOpts.active = false;
        for (var i = 0; i < this._chiOpts.childrenCount; ++i) {
            var child = this._chiOpts.children[i];
            child.active = false;
        }
    },
    showAction: function showAction(data) {
        if (this._options.active) {
            this.hideOptions();
        }
        if (data && (data.hu || data.gang || data.peng || data.chi)) {
            this._options.active = true;
            if (data.hu) {
                this.addOption("btnHu", data.pai);
            }
            if (data.peng) {
                this.addOption("btnPeng", data.pai);
            }
            if (data.gang) {
                for (var i = 0; i < data.gangpai.length; ++i) {
                    var gp = data.gangpai[i];
                    this.addOption("btnGang", gp);
                }
            }
            if (data.chi) {
                this.addOption("btnChi");
            }
        } else {
            var selfData = cc.vv.gameNetMgr.getSelfData();
            if (selfData.tinged) {
                return;
                //注1):2017 07 26 ly
                //下面自动出牌不在需要，由服务器端去完成
                //原因是： 下面语句执行后会产生一种牌不显示的bug。 
                //      bug是必现。原因不明。
                // //如果已经听牌，并且没有操作，则自动打牌
                // var sprite = this._myMJArr[this._myMJArr.length - 1];
                // var node = sprite.node;
                // cc.vv.global.touch_target = node;
                // node.active = false;
                // this.shoot(node.mjId);
                // node.y = 0;
                // this.recordShootPos(node);
            }
        }
    },
    // 吃牌的操作
    showChiAction: function showChiAction(data) {
        console.log("吃牌操作", data);
        // 如果碰牌的操作界面显示了,先隐藏,正常情况下这是不可能的
        if (this._options.active) {
            this.hideOptions();
        }
        if (this._chiOpts.active) {
            this.hideChiOptions();
        }
        if (data && data.chi) {
            this._chiOpts.active = true;
            this._chiArrays = [];
            this._chiOptionArray = [];
            this.addChiOption('btnChi', data);
        }
    },
    initWanfaLabel: function initWanfaLabel() {
        var wanfa = cc.find("Canvas/infobar/wanfa").getComponent(cc.Label);
        wanfa.string = cc.vv.gameNetMgr.getWanfa();
    },
    initHupai: function initHupai(localIndex, pai) {
        if (cc.vv.gameNetMgr.conf.type == "ykx") {
            var hupailist = this._hupaiLists[localIndex];
            for (var i = 0; i < hupailist.children.length; ++i) {
                var hupainode = hupailist.children[i];
                if (hupainode.active == false) {
                    var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
                    hupainode.getComponent(cc.Sprite).spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, pai);
                    hupainode.active = true;
                    break;
                }
            }
        }
    },
    // 在胡牌堆里面处理财神显示
    initCaiShen: function initCaiShen(localIndex, pai) {
        var hupailist = this._hupaiLists[localIndex];
        for (var i = 0; i < hupailist.children.length; ++i) {
            var hupainode = hupailist.children[i];
            if (hupainode.active == false) {
                var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
                hupainode.getComponent(cc.Sprite).spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, pai);
                hupainode.active = true;
                break;
            }
        }
    },
    playEfx: function playEfx(index, name) {
        this._playEfxs[index].node.active = true;
        this._playEfxs[index].play(name);
    },
    onGameBeign: function onGameBeign() {
        for (var i = 0; i < this._playEfxs.length; ++i) {
            this._playEfxs[i].node.active = false;
        }
        for (var i = 0; i < this._hupaiLists.length; ++i) {
            for (var j = 0; j < this._hupaiLists[i].childrenCount; ++j) {
                this._hupaiLists[i].children[j].active = false;
            }
        }
        for (var i = 0; i < cc.vv.gameNetMgr.seats.length; ++i) {
            var seatData = cc.vv.gameNetMgr.seats[i];
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);
            var hupai = this._hupaiTips[localIndex];
            hupai.active = seatData.hued;
            if (seatData.hued) {
                // 如果胡牌了.肯定不显示听牌了
                hupai.getChildByName("sprHu").active = !seatData.iszimo;
                hupai.getChildByName("sprZimo").active = seatData.iszimo;
                hupai.getChildByName("sprTing").active = false;
            }
        }
        this.hideChupai();
        this.hideOptions();
        var sides = ["right", "up", "left"];
        var gameChild = this.node.getChildByName("game");
        for (var i = 0; i < sides.length; ++i) {
            var sideChild = gameChild.getChildByName(sides[i]);
            var holds = sideChild.getChildByName("holds");
            for (var j = 0; j < holds.childrenCount; ++j) {
                var nc = holds.children[j];
                nc.active = true;
                nc.scaleX = 1.0;
                nc.scaleY = 1.0;
                var sprite = nc.getComponent(cc.Sprite);
                sprite.spriteFrame = cc.vv.mahjongmgr.holdsEmpty[i + 1];
            }
        }
        if (cc.vv.gameNetMgr.gamestate == "" && cc.vv.replayMgr.isReplay() == false) {
            return;
        }
        this.gameRoot.active = true;
        this.prepareRoot.active = false;
        this.initMahjongs();
        this.initCaiShenList();
        var seats = cc.vv.gameNetMgr.seats;
        for (var i in seats) {
            var seatData = seats[i];
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);
            if (localIndex != 0) {
                this.initOtherMahjongs(seatData);
                this.initOtherCaiShenList(seatData);
                if (i == cc.vv.gameNetMgr.turn) {
                    this.initMopai(i, -1);
                } else {
                    this.initMopai(i, null);
                }
            }
        }
        this.showChupai();
        if (cc.vv.gameNetMgr.curaction != null) {
            this._optionsData = cc.vv.gameNetMgr.curaction;
            this.showAction(cc.vv.gameNetMgr.curaction);
            cc.vv.gameNetMgr.curaction = null;
        }
        this.checkCaiShen();
        var selfData = cc.vv.gameNetMgr.getSelfData();
        console.log('------------------------------------');
        console.log("selfData", selfData);
        console.log('------------------------------------');
        if (!selfData.extraPais) {
            return;
        }
        if (selfData.extraPais.length > 0) {
            console.log("当前多余的牌存在,则需要额外处理手牌");
            this.initExtraPaiHolds();
            selfData.extraPais = [];
        } else {
            this.initTingedHolds();
        }
        this.showTingedFlag();
    },
    recordShootPos: function recordShootPos(node) {
        //记录出牌位置
        if (node) {
            var pos = {
                x: node.x,
                y: node.y
            };
            cc.vv.global.shootPos = pos;
        }
    },
    onMjToUp: function onMjToUp(nc) {
        var self = this;
        nc.on(cc.Node.EventType.TOUCH_START, function (touch) {
            if (!self._canChupai) {
                return;
            }
            if (!nc.getComponent(cc.Button).interactable || cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {
                return;
            }
            this.old_node_x = nc.x;
            this.old_node_y = nc.y;
            this.old_touch_x = touch.getLocation().x;
            this.old_touch_y = touch.getLocation().y;
            cc.vv.global.touch_target = nc;
        });
        nc.on(cc.Node.EventType.TOUCH_MOVE, function (touch) {
            if (!self._canChupai) {
                return;
            }
            if (!nc.getComponent(cc.Button).interactable || cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {
                return;
            }
            var touchX_diff = touch.getLocation().x - this.old_touch_x;
            var touchY_diff = touch.getLocation().y - this.old_touch_y;
            if (touchY_diff > 0) {
                nc.x = this.old_node_x + touchX_diff;
                nc.y = this.old_node_y + touchY_diff;
            }
        });
        nc.on(cc.Node.EventType.TOUCH_END, function (touch) {
            if (!self._canChupai) {
                return;
            }
            if (!nc.getComponent(cc.Button).interactable || cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {
                return;
            }
            var touchY_diff = touch.getLocation().y - this.old_touch_y;
            if (touchY_diff > nc.height / 2) {
                self.recordShootPos(nc);
                var type = cc.vv.mahjongmgr.getMahjongType(nc.mjId);
                if (type == 4) {
                    self.shootCaiShen(nc.mjId);
                } else {
                    self.shoot(nc.mjId);
                }
                // nc.active = false;
            }
            //还原到原始位置
            nc.x = this.old_node_x;
            nc.y = this.old_node_y;
        });
        nc.on(cc.Node.EventType.TOUCH_CANCEL, function (touch) {
            if (!self._canChupai) {
                return;
            }
            if (!nc.getComponent(cc.Button).interactable || cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {
                return;
            }
            var touchCancel = touch.getLocation();
            var delta = touchCancel.y - this.old_touch_y;
            if (delta > nc.height / 2) {
                self.recordShootPos(nc);
                var type = cc.vv.mahjongmgr.getMahjongType(nc.mjId);
                if (type == 4) {
                    self.shootCaiShen(nc.mjId);
                } else {
                    self.shoot(nc.mjId);
                }
                nc.active = false;
            }
            //还原到原始位置
            nc.x = this.old_node_x;
            nc.y = this.old_node_y;
        });
    },
    onMJClicked: function onMJClicked(event) {
        var self = this;
        if (!self._canChupai) {
            return;
        }
        //如果不是自己的轮子，则忽略
        if (cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {
            console.log("not your turn." + cc.vv.gameNetMgr.turn);
            return;
        }
        var self = this;
        for (var i = 0; i < this._myMJArr.length; ++i) {
            if (event.target == this._myMJArr[i].node) {
                //如果是再次点击，则出牌
                if (event.target == this._selectedMJ) {
                    // event.target.active = false;
                    var type = cc.vv.mahjongmgr.getMahjongType(this._selectedMJ.mjId);
                    if (type == 4) {
                        this.shootCaiShen(this._selectedMJ.mjId);
                    } else {
                        this.shoot(this._selectedMJ.mjId);
                    }
                    this._selectedMJ.y = 0;
                    this._selectedMJ = null;
                    self.recordShootPos(event.target);
                    return;
                }
                if (this._selectedMJ != null) {
                    this._selectedMJ.y = 0;
                }
                event.target.y = 15;
                this._selectedMJ = event.target;
                return;
            }
        }
    },
    //出牌
    shoot: function shoot(mjId) {
        if (mjId == null) {
            return;
        }
        cc.vv.net.send('chupai', mjId);
    },
    //出牌
    shootCaiShen: function shootCaiShen(mjId) {
        console.log("财神,换牌");
        if (mjId == null) {
            return;
        }
        // 一定要是财神才能进行此操作
        cc.vv.net.send('caishen', mjId);
    },
    getMJIndex: function getMJIndex(side, index) {
        if (side == "right" || side == "up") {
            return 13 - index;
        }
        return index;
    },
    initMopai: function initMopai(seatIndex, pai) {
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        var gameChild = this.node.getChildByName("game");
        var sideChild = gameChild.getChildByName(side);
        var holds = sideChild.getChildByName("holds");
        var lastIndex = this.getMJIndex(side, 13);
        var nc = holds.children[lastIndex];
        nc.scaleX = 1.0;
        nc.scaleY = 1.0;
        if (pai == null) {
            nc.active = false;
        } else if (pai >= 0) {
            nc.active = true;
            if (side == "up") {
                nc.scaleX = 0.73;
                nc.scaleY = 0.73;
            }
            var sprite = nc.getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, pai);
        } else if (pai != null) {
            nc.active = true;
            if (side == "up") {
                nc.scaleX = 1.0;
                nc.scaleY = 1.0;
            }
            var sprite = nc.getComponent(cc.Sprite);
            sprite.spriteFrame = cc.vv.mahjongmgr.getHoldsEmptySpriteFrame(side);
        }
    },
    initEmptySprites: function initEmptySprites(seatIndex) {
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        var gameChild = this.node.getChildByName("game");
        var sideChild = gameChild.getChildByName(side);
        var holds = sideChild.getChildByName("holds");
        var spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame(side);
        for (var i = 0; i < holds.childrenCount; ++i) {
            var nc = holds.children[i];
            nc.scaleX = 1.0;
            nc.scaleY = 1.0;
            var sprite = nc.getComponent(cc.Sprite);
            sprite.spriteFrame = spriteFrame;
        }
    },
    initOtherMahjongs: function initOtherMahjongs(seatData) {
        console.log("seat:" + seatData.seatindex, seatData);
        var localIndex = this.getLocalIndex(seatData.seatindex);
        if (localIndex == 0 || seatData) {
            return;
        }
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var game = this.node.getChildByName("game");
        var sideRoot = game.getChildByName(side);
        var sideHolds = sideRoot.getChildByName("holds");
        console.log('sideholds', sideHolds);
        var num = seatData.pengs.length + seatData.angangs.length + seatData.diangangs.length + seatData.wangangs.length + seatData.chis.length;
        num *= 3;
        for (var i = 0; i < num; ++i) {
            var idx = this.getMJIndex(side, i);
            sideHolds.children[idx].active = false;
        }
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        var holds = this.sortHolds(seatData);
        if (holds != null && holds.length > 0) {
            for (var i = 0; i < holds.length; ++i) {
                var idx = this.getMJIndex(side, i + num);
                var sprite = sideHolds.children[idx].getComponent(cc.Sprite);
                if (side == "up") {
                    sprite.node.scaleX = 0.73;
                    sprite.node.scaleY = 0.73;
                }
                sprite.node.active = true;
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, holds[i]);
            }
            if (holds.length + num == 13) {
                var lasetIdx = this.getMJIndex(side, 13);
                sideHolds.children[lasetIdx].active = false;
            }
        }
    },
    sortHolds: function sortHolds(seatData) {
        var holds = seatData.holds;
        if (holds == null) {
            return null;
        }
        //如果手上的牌的数目是2,5,8,11,14，表示最后一张牌是刚摸到的牌
        var mopai = null;
        var l = holds.length;
        if (l == 2 || l == 5 || l == 8 || l == 11 || l == 14) {
            mopai = holds.pop();
        }
        cc.vv.mahjongmgr.sortMJ(holds);
        //将摸牌添加到最后
        if (mopai != null) {
            holds.push(mopai);
        }
        return holds;
    },
    initMahjongs: function initMahjongs() {
        var seats = cc.vv.gameNetMgr.seats;
        var seatData = seats[cc.vv.gameNetMgr.seatIndex];
        var holds = this.sortHolds(seatData);
        if (holds == null) {
            return;
        }
        console.log("seatData.chis.length", seatData.chis.length);
        console.log("this._myMJArrthis._myMJArrthis._myMJArrthis._myMJArr", this._myMJArr);
        //初始化手牌
        var lackingNum = (seatData.pengs.length + seatData.angangs.length + seatData.diangangs.length + seatData.wangangs.length + seatData.chis.length) * 3;
        console.log("lackingNum", lackingNum);
        for (var i = 0; i < holds.length; ++i) {
            var mjid = holds[i];
            var sprite = this._myMJArr[i + lackingNum];
            if (sprite && sprite.node) {
                sprite.node.mjId = mjid;
                sprite.node.y = 0;
                sprite.node.active = true;
                this.setSpriteFrameByMJID("M_", sprite, mjid);
            }
        }
        for (var i = 0; i < lackingNum; ++i) {
            var sprite = this._myMJArr[i];
            sprite.node.mjId = null;
            sprite.spriteFrame = null;
            sprite.node.active = false;
        }
        for (var i = lackingNum + holds.length; i < this._myMJArr.length; ++i) {
            var sprite = this._myMJArr[i];
            sprite.node.mjId = null;
            sprite.spriteFrame = null;
            sprite.node.active = false;
        }
    },
    setSpriteFrameByMJID: function setSpriteFrameByMJID(pre, sprite, mjid) {
        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
        sprite.node.active = true;
    },
    getLocalIndex: function getLocalIndex(index) {
        var ret = (index - cc.vv.gameNetMgr.seatIndex + 4) % 4;
        console.log("old:" + index + ",base:" + cc.vv.gameNetMgr.seatIndex + ",new:" + ret);
        return ret;
    },
    onOptionClicked: function onOptionClicked(event) {
        console.log("吃碰杠牌操作");
        console.log(event.target.pai);
        if (event.target.name == "btnPeng") {
            cc.vv.net.send("peng");
        } else if (event.target.name == "btnGang") {
            cc.vv.net.send("gang", event.target.pai);
        } else if (event.target.name == "btnHu") {
            cc.vv.net.send("hu");
        } else if (event.target.name == "btnGuo") {
            cc.vv.net.send("guo");
        } else if (event.target.name == "btnChi") {
            console.log("吃牌操作按钮点击");
            cc.vv.net.send("chi", event.target.pai);
            console.log("向服务器发送吃牌操作--", {
                pai: event.target.pai,
                chiArray: this._chiOptionArray
            });
        }
    },
    // 吃牌操作
    onChiOptionClicked: function onChiOptionClicked(event) {
        console.log("吃牌操作事件绑定");
        // 用来存放玩家选中的吃的组合
        console.log(event.target.pai);
        if (event.target.name == "op0") {
            if (this._chiArrays.length <= 0) {
                this._chiOptionArray = [];
            } else {
                this._chiOptionArray = this._chiArrays[0];
            }
            console.log("玩家选中了第一组组合", this._chiOptionArray);
        } else if (event.target.name == "op1") {
            if (this._chiArrays.length <= 0) {
                this._chiOptionArray = [];
            } else {
                this._chiOptionArray = this._chiArrays[1];
            }
            console.log("选择了第二组组合", this._chiOptionArray);
        } else if (event.target.name == "op2") {
            if (this._chiArrays.length <= 0) {
                this._chiOptionArray = [];
            } else {
                this._chiOptionArray = this._chiArrays[2];
            }
            console.log("选择了第三组组合", this._chiOptionArray);
        } else if (event.target.name == "btnGuo") {
            cc.vv.net.send("guo");
        } else if (event.target.name == "btnChi") {
            console.log("吃牌操作按钮点击");
            if (this._chiOptionArray.length > 0) {
                console.log("可以吃的组合选中了,发送数据到服务器", this._chiOptionArray);
                var data = {
                    pai: event.target.pai,
                    chiOptioned: this._chiOptionArray
                };
                console.log("吃牌的组合是", data);
                cc.vv.net.send("chi", data);
            } else {
                cc.vv.alert.show("注意", "请选择一组吃牌的组合");
            }
            console.log("向服务器发送吃牌操作--", event.target.pai);
        }
    },
    initCaiShenList: function initCaiShenList() {
        // console.log('开始游戏,调用财神初始化信息');
        var seats = cc.vv.gameNetMgr.seats;
        var seatData = seats[cc.vv.gameNetMgr.seatIndex];
        var caishen = seatData.caiShen;
        // console.log('caiShen initCaiShenList', caishen);
        if (caishen == null) {
            return;
        }
        var gameChild = this.node.getChildByName("game");
        var myselfChild = gameChild.getChildByName("myself");
        var caishen_list = myselfChild.getChildByName("hupailist");
        for (var i = 0; i < caishen.length; ++i) {
            var mj_caishen_id = caishen[i];
            var sprite = caishen_list.children[i].getComponent(cc.Sprite);
            sprite.node.mjId = mj_caishen_id;
            this.setSpriteFrameByMJID("M_", sprite, mj_caishen_id);
        }
    },
    initOtherCaiShenList: function initOtherCaiShenList(seatData) {
        // console.log('初始化其他人的财神');
        var caishen = seatData.caiShen;
        // console.log('caiShen initOtherCaiShenList', caishen);
        if (caishen == null) {
            return;
        }
        var localIndex = this.getLocalIndex(seatData.seatindex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var game = this.node.getChildByName("game");
        var sideRoot = game.getChildByName(side);
        var side_caishen_list = sideRoot.getChildByName("hupailist");
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        for (var i = 0; i < caishen.length; ++i) {
            var mj_caishen_id = caishen[i];
            var sprite = side_caishen_list.children[i].getComponent(cc.Sprite);
            sprite.node.mjId = mj_caishen_id;
            this.setSpriteFrameByMJID(pre, sprite, mj_caishen_id);
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {},
    onDestroy: function onDestroy() {
        console.log("onDestroy");
        if (cc.vv) {
            cc.vv.gameNetMgr.clear();
        }
    }
});

cc._RFpop();
},{}],"MJRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '921dfQJZddJ+5GFUXqxmMmT', 'MJRoom');
// scripts/components/MJRoom.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        lblRoomNo: {
            default: null,
            type: cc.Label
        },
        _seats: [],
        _seats2: [],
        _timeLabel: null,
        _voiceMsgQueue: [],
        _lastPlayingSeat: null,
        _playingSeat: null,
        _lastPlayTime: null,
        _shareContent: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.initView();
        this.initSeats();
        this.initEventHandlers();
    },
    initView: function initView() {
        var prepare = this.node.getChildByName("prepare");
        var seats = prepare.getChildByName("seats");
        for (var i = 0; i < seats.children.length; ++i) {
            this._seats.push(seats.children[i].getComponent("Seat"));
        }
        this.refreshBtns();
        this.lblRoomNo = cc.find("Canvas/infobar/Z_room_txt/New Label").getComponent(cc.Label);
        this._timeLabel = cc.find("Canvas/infobar/time").getComponent(cc.Label);
        this.lblRoomNo.string = cc.vv.gameNetMgr.roomId;
        var gameChild = this.node.getChildByName("game");
        var sides = ["myself", "right", "up", "left"];
        for (var i = 0; i < sides.length; ++i) {
            var sideNode = gameChild.getChildByName(sides[i]);
            var seat = sideNode.getChildByName("seat");
            this._seats2.push(seat.getComponent("Seat"));
        }
        var btnWechat = cc.find("Canvas/prepare/btnWeichat");
        if (btnWechat) {
            cc.vv.utils.addClickEvent(btnWechat, this.node, "MJRoom", "onBtnWeichatClicked");
        }
    },
    refreshBtns: function refreshBtns() {
        var prepare = this.node.getChildByName("prepare");
        var btnExit = prepare.getChildByName("btnExit");
        var btnDispress = prepare.getChildByName("btnDissolve");
        var btnWeichat = prepare.getChildByName("btnWeichat");
        var btnBack = prepare.getChildByName("btnBack");
        var isIdle = cc.vv.gameNetMgr.numOfGames == 0;
        btnExit.active = !cc.vv.gameNetMgr.isOwner() && isIdle;
        btnDispress.active = cc.vv.gameNetMgr.isOwner() && isIdle;
        btnWeichat.active = isIdle;
        btnBack.active = isIdle;
    },
    initEventHandlers: function initEventHandlers() {
        var self = this;
        this.node.on('new_user', function (data) {
            self.initSingleSeat(data.detail);
        });
        this.node.on('user_state_changed', function (data) {
            self.initSingleSeat(data.detail);
        });
        this.node.on('game_begin', function (data) {
            self.refreshBtns();
            self.initSeats();
        });
        this.node.on('game_num', function (data) {
            self.refreshBtns();
        });
        this.node.on('voice_msg', function (data) {
            var data = data.detail;
            self._voiceMsgQueue.push(data);
            self.playVoice();
        });
        this.node.on('chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);
            self._seats[localIdx].chat(data.content);
            self._seats2[localIdx].chat(data.content);
        });
        this.node.on('quick_chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);
            var index = data.content;
            var info = cc.vv.chat.getQuickChatInfo(index);
            self._seats[localIdx].chat(info.content);
            self._seats2[localIdx].chat(info.content);
            cc.vv.audioMgr.playSFX(info.sound);
        });
        this.node.on('emoji_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndex(idx);
            console.log(data);
            self._seats[localIdx].emoji(data.content);
            self._seats2[localIdx].emoji(data.content);
        });
    },
    initSeats: function initSeats() {
        var seats = cc.vv.gameNetMgr.seats;
        for (var i = 0; i < seats.length; ++i) {
            this.initSingleSeat(seats[i]);
        }
    },
    initSingleSeat: function initSingleSeat(seat) {
        var index = cc.vv.gameNetMgr.getLocalIndex(seat.seatindex);
        var isOffline = !seat.online;
        var isZhuang = seat.seatindex == cc.vv.gameNetMgr.button;
        console.log("isOffline:" + isOffline);
        this._seats[index].setInfo(seat.name, seat.score);
        this._seats[index].setReady(seat.ready);
        this._seats[index].setOffline(isOffline);
        this._seats[index].setID(seat.userid);
        this._seats[index].voiceMsg(false);
        this._seats2[index].setInfo(seat.name, seat.score);
        this._seats2[index].setZhuang(isZhuang);
        this._seats2[index].setOffline(isOffline);
        this._seats2[index].setID(seat.userid);
        this._seats2[index].voiceMsg(false);
    },
    onBtnSettingsClicked: function onBtnSettingsClicked() {
        cc.vv.popupMgr.showSettings();
    },
    onBtnBackClicked: function onBtnBackClicked() {
        cc.vv.alert.show("返回大厅", "返回大厅房间仍会保留，快去邀请大伙来玩吧！", function () {
            cc.director.loadScene("newhall");
        }, true);
    },
    onBtnChatClicked: function onBtnChatClicked() {},
    // 点击分享按钮，使用微信分享
    onBtnWeichatClicked: function onBtnWeichatClicked() {
        cc.vv.share.show();
    },
    onBtnDissolveClicked: function onBtnDissolveClicked() {
        cc.vv.alert.show("解散房间", "解散房间不扣金币，是否确定解散？", function () {
            cc.vv.net.send("dispress");
        }, true);
    },
    onBtnExit: function onBtnExit() {
        cc.vv.net.send("exit");
    },
    playVoice: function playVoice() {
        if (this._playingSeat == null && this._voiceMsgQueue.length) {
            console.log("playVoice");
            var data = this._voiceMsgQueue.shift();
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIndex = cc.vv.gameNetMgr.getLocalIndex(idx);
            this._playingSeat = localIndex;
            this._seats[localIndex].voiceMsg(true);
            this._seats2[localIndex].voiceMsg(true);
            var msgInfo = JSON.parse(data.content);
            var msgfile = "voicemsg.amr";
            console.log(msgInfo.msg.length);
            this._lastPlayTime = Date.now() + msgInfo.time;
            if (!cc.sys.isNative) {
                var serverid = msgInfo['msg'];
                window.downloadVoice(serverid);
                return;
            }
            cc.vv.voiceMgr.writeVoice(msgfile, msgInfo.msg);
            cc.vv.voiceMgr.play(msgfile);
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (window.voice && window.voice.localId != null) {
            var localId = window.voice.localId;
            window.voice.localId = null;
            cc.vv.audioMgr.pauseAll();
            window.playVoice(localId);
        }
        var minutes = Math.floor(Date.now() / 1000 / 60);
        if (this._lastMinute != minutes) {
            this._lastMinute = minutes;
            var date = new Date();
            var h = date.getHours();
            h = h < 10 ? "0" + h : h;
            var m = date.getMinutes();
            m = m < 10 ? "0" + m : m;
            this._timeLabel.string = "" + h + ":" + m;
        }
        if (this._lastPlayTime != null) {
            if (Date.now() > this._lastPlayTime + 200) {
                this.onPlayerOver();
                this._lastPlayTime = null;
            }
        } else {
            this.playVoice();
        }
    },
    onPlayerOver: function onPlayerOver() {
        if (!cc.sys.isNative) {
            window.stopPlayVoice();
        };
        cc.vv.audioMgr.resumeAll();
        console.log("onPlayCallback:" + this._playingSeat);
        var localIndex = this._playingSeat;
        this._playingSeat = null;
        this._seats[localIndex].voiceMsg(false);
        this._seats2[localIndex].voiceMsg(false);
    },
    onDestroy: function onDestroy() {
        cc.vv.voiceMgr.stop();
        //        cc.vv.voiceMgr.onPlayCallback = null;
    }
});

cc._RFpop();
},{}],"MahjongMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0ecea6X+IFIK5XFdJe38hXa', 'MahjongMgr');
// scripts/MahjongMgr.js

"use strict";

var mahjongSprites = [];
cc.Class({
    extends: cc.Component,
    properties: {
        leftAtlas: {
            default: null,
            type: cc.SpriteAtlas
        },
        rightAtlas: {
            default: null,
            type: cc.SpriteAtlas
        },
        bottomAtlas: {
            default: null,
            type: cc.SpriteAtlas
        },
        bottomFoldAtlas: {
            default: null,
            type: cc.SpriteAtlas
        },
        pengPrefabSelf: {
            default: null,
            type: cc.Prefab
        },
        pengPrefabLeft: {
            default: null,
            type: cc.Prefab
        },
        emptyAtlas: {
            default: null,
            type: cc.SpriteAtlas
        },
        holdsEmpty: {
            default: [],
            type: [cc.SpriteFrame]
        },
        _sides: null,
        _pres: null,
        _foldPres: null
    },
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._sides = ["myself", "right", "up", "left"];
        this._pres = ["M_", "R_", "B_", "L_"];
        this._foldPres = ["B_", "R_", "B_", "L_"];
        cc.vv.mahjongmgr = this;
        //筒
        for (var i = 1; i < 10; ++i) {
            mahjongSprites.push("dot_" + i);
        }
        //条
        for (var i = 1; i < 10; ++i) {
            mahjongSprites.push("bamboo_" + i);
        }
        //万
        for (var i = 1; i < 10; ++i) {
            mahjongSprites.push("character_" + i);
        }
        //东西南北风
        mahjongSprites.push("wind_east");
        mahjongSprites.push("wind_west");
        mahjongSprites.push("wind_south");
        mahjongSprites.push("wind_north");
        //中、发、白
        mahjongSprites.push("red");
        mahjongSprites.push("green");
        mahjongSprites.push("white");
        //春夏秋冬 
        mahjongSprites.push("spring");
        mahjongSprites.push("summer");
        mahjongSprites.push("autumn");
        mahjongSprites.push("winter");
        //兰竹菊梅
        mahjongSprites.push("orchid"); //兰
        mahjongSprites.push("bamboo"); //竹
        mahjongSprites.push("chrysanthemum"); //菊       
        mahjongSprites.push("plum"); //梅            
    },
    getMahjongSpriteByID: function getMahjongSpriteByID(id) {
        return mahjongSprites[id];
    },
    getMahjongType: function getMahjongType(id) {
        if (id >= 0 && id < 9) {
            //筒
            return 0;
        } else if (id >= 9 && id < 18) {
            //条
            return 1;
        } else if (id >= 18 && id < 27) {
            //万
            return 2;
        } else if (id >= 27 && id < 34) {
            //字一（东西南北中发白）
            return 3;
        } else if (id >= 34 && id < 42) {
            //花一（春夏秋冬兰竹菊梅）
            return 4;
        }
    },
    getSpriteFrameByMJID: function getSpriteFrameByMJID(pre, mjid) {
        var spriteFrameName = this.getMahjongSpriteByID(mjid);
        spriteFrameName = pre + spriteFrameName;
        if (pre == "M_") {
            return this.bottomAtlas.getSpriteFrame(spriteFrameName);
        } else if (pre == "B_") {
            return this.bottomFoldAtlas.getSpriteFrame(spriteFrameName);
        } else if (pre == "L_") {
            return this.leftAtlas.getSpriteFrame(spriteFrameName);
        } else if (pre == "R_") {
            return this.rightAtlas.getSpriteFrame(spriteFrameName);
        }
    },
    // 出牌声音对应id只有筒条万和东西南北中发白才有声音
    getAudioURLByMJID: function getAudioURLByMJID(id) {
        var paitype = this.getMahjongType(id);
        console.log("牌的类型是:" + paitype);
        if (paitype >= 0 && paitype < 4) {
            return "nv/" + id + ".mp3";
        } else {
            return null;
        }
    },
    getEmptySpriteFrame: function getEmptySpriteFrame(side) {
        if (side == "up") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_up");
        } else if (side == "myself") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_bottom");
        } else if (side == "left") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_left");
        } else if (side == "right") {
            return this.emptyAtlas.getSpriteFrame("e_mj_b_right");
        }
    },
    getHoldsEmptySpriteFrame: function getHoldsEmptySpriteFrame(side) {
        if (side == "up") {
            return this.emptyAtlas.getSpriteFrame("e_mj_up");
        } else if (side == "myself") {
            return null;
        } else if (side == "left") {
            return this.emptyAtlas.getSpriteFrame("e_mj_left");
        } else if (side == "right") {
            return this.emptyAtlas.getSpriteFrame("e_mj_right");
        }
    },
    sortMJ: function sortMJ(mahjongs) {
        var self = this;
        mahjongs.sort(function (a, b) {
            return a - b;
        });
    },
    getSide: function getSide(localIndex) {
        return this._sides[localIndex];
    },
    getPre: function getPre(localIndex) {
        return this._pres[localIndex];
    },
    getFoldPre: function getFoldPre(localIndex) {
        return this._foldPres[localIndex];
    }
});

cc._RFpop();
},{}],"MatchNet":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8afb3qixT1F+LOb/ajH8SVw', 'MatchNet');
// scripts/MatchNet.js

"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

if (window.io == null) {
    window.io = require("socket-io");
}
var Global = cc.Class({
    extends: cc.Component,
    statics: {
        ip: "",
        sio: null,
        isPinging: false,
        fnDisconnect: null,
        handlers: {},
        addHandler: function addHandler(event, fn) {
            if (this.handlers[event]) {
                console.log("event:" + event + "' handler has been registered.");
                return;
            }
            var handler = function handler(data) {
                //console.log(event + "(" + typeof(data) + "):" + (data? data.toString():"null"));
                if (event != "disconnect" && typeof data == "string") {
                    data = JSON.parse(data);
                }
                fn(data);
            };
            this.handlers[event] = handler;
            if (this.sio) {
                console.log("register:function " + event);
                this.sio.on(event, handler);
            }
        },
        connect: function connect(fnConnect, fnError) {
            var self = this;
            var opts = {
                'reconnection': true,
                'force new connection': true,
                'transports': ['websocket', 'polling']
            };
            this.sio = window.io.connect(this.ip, opts);
            this.sio.on('reconnect', function () {
                console.log('reconnection');
            });
            this.sio.on('connect', function (data) {
                self.sio.connected = true;
                fnConnect(data);
            });
            this.sio.on('disconnect', function (data) {
                console.log("disconnect");
                self.sio.connected = false;
                self.close();
            });
            this.sio.on('connect_failed', function () {
                console.log('connect_failed');
            });
            for (var key in this.handlers) {
                var value = this.handlers[key];
                if (typeof value == "function") {
                    if (key == 'disconnect') {
                        this.fnDisconnect = value;
                    } else {
                        console.log("register:function " + key);
                        this.sio.on(key, value);
                    }
                }
            }
            this.startHearbeat();
        },
        startHearbeat: function startHearbeat() {
            this.sio.on('game_pong', function () {
                self.lastRecieveTime = Date.now();
            });
            this.lastRecieveTime = Date.now();
            var self = this;
            if (!self.isPinging) {
                self.isPinging = true;
                setInterval(function () {
                    if (self.sio) {
                        //FIXME: 超时设为3s
                        if (Date.now() - self.lastRecieveTime > 10000) {
                            self.close();
                        } else {
                            self.ping();
                        }
                    }
                }, 5000);
            }
        },
        send: function send(event, data) {
            if (this.sio.connected) {
                if (data != null && (typeof data === "undefined" ? "undefined" : _typeof(data)) == "object") {
                    data = JSON.stringify(data);
                    //console.log(data);              
                }
                this.sio.emit(event, data);
            }
        },
        ping: function ping() {
            this.send('game_ping');
        },
        close: function close() {
            console.log('close');
            if (this.sio && this.sio.connected) {
                this.sio.connected = false;
                this.sio.disconnect();
                this.sio = null;
            }
            if (this.fnDisconnect) {
                this.fnDisconnect();
                this.fnDisconnect = null;
            }
        },
        test: function test(fnResult) {
            var xhr = null;
            var fn = function fn(ret) {
                fnResult(ret.isonline);
                xhr = null;
            };
            var arr = this.ip.split(':');
            var data = {
                account: cc.vv.userMgr.account,
                sign: cc.vv.userMgr.sign,
                ip: arr[0],
                port: arr[1]
            };
            xhr = cc.vv.http.sendRequest("/is_server_online", data, fn);
            setTimeout(function () {
                if (xhr) {
                    xhr.abort();
                    fnResult(false);
                }
            }, 1500);
        }
    }
});

cc._RFpop();
},{"socket-io":"socket-io"}],"MjNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f084a+6r9pFkpyzRb+cYNPH', 'MjNetMgr');
// scripts/MjNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    initHandlers: function initHandlers(GameNet) {
        var self = GameNet;
        cc.vv.net.addHandler("login_result", function (data) {
            console.log("login_result===>", data);
            if (data.errcode === 0) {
                var data = data.data;
                self.roomId = data.roomid;
                self.room_type = data.conf.room_type;
                self.conf = data.conf;
                self.maxNumOfGames = data.conf.maxGames;
                self.numOfGames = data.numofgames;
                self.seats = data.seats;
                self.seatIndex = self.getSeatIndexByID(cc.vv.userMgr.userId);
                self.isOver = false;
            } else {
                console.log(data.errmsg);
            }
        });
        cc.vv.net.addHandler("login_finished", function (data) {
            console.log("login_finished");
            cc.director.loadScene("mjgame");
        });
        cc.vv.net.addHandler("exit_result", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("exit_notify_push", function (data) {
            var userId = data;
            var s = self.getSeatByID(userId);
            if (s != null) {
                s.userid = 0;
                s.name = "";
                self.dispatchEvent("user_state_changed", s);
            }
        });
        cc.vv.net.addHandler("dispress_push", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("disconnect", function (data) {
            if (self.roomId == null) {
                if (self.room_type == 0) {
                    cc.director.loadScene("newhall");
                    self.room_type = -1;
                } else {
                    cc.director.loadScene("newhall");
                }
            } else {
                if (self.isOver == false) {
                    cc.vv.userMgr.oldRoomId = self.roomId;
                    self.dispatchEvent("disconnect");
                } else {
                    self.roomId = null;
                    self.room_type = -1;
                }
            }
        });
        cc.vv.net.addHandler("match_exit_error", function (data) {
            self.dispatchEvent('match_exit_error');
        });
        cc.vv.net.addHandler("new_user_comes_push", function (data) {
            //console.log(data);
            var seatIndex = data.seatindex;
            if (self.seats[seatIndex].userid > 0) {
                self.seats[seatIndex].online = true;
            } else {
                data.online = true;
                self.seats[seatIndex] = data;
            }
            self.dispatchEvent('new_user', self.seats[seatIndex]);
        });
        cc.vv.net.addHandler("user_state_push", function (data) {
            //console.log(data);
            var userId = data.userid;
            if (self.room_type == 0) {
                var seat = self.getSeatByID(userId);
                if (!seat) return;
                seat.online = data.online;
                self.dispatchEvent('user_state_changed', seat);
            }
        });
        cc.vv.net.addHandler("user_ready_push", function (data) {
            //console.log(data);
            var userId = data.userid;
            var seat = self.getSeatByID(userId);
            seat.ready = data.ready;
            self.dispatchEvent('user_state_changed', seat);
        });
        cc.vv.net.addHandler("game_holds_push", function (data) {
            var seat = self.seats[self.seatIndex];
            console.log(data);
            seat.holds = data;
            for (var i = 0; i < self.seats.length; ++i) {
                var s = self.seats[i];
                if (!s.folds) {
                    s.folds = [];
                }
                if (!s.pengs) {
                    s.pengs = [];
                }
                if (!s.extraPais) {
                    s.extraPais = [];
                }
                if (!s.caiShen) {
                    s.caiShen = [];
                }
                if (!s.chis) {
                    s.chis = [];
                }
                if (!s.angangs) {
                    s.angangs = [];
                }
                if (!s.diangangs) {
                    s.diangangs = [];
                }
                if (!s.wangangs) {
                    s.wangangs = [];
                }
                s.ready = false;
            }
            self.dispatchEvent('game_holds');
        });
        cc.vv.net.addHandler("game_begin_push", function (data) {
            console.log('game_begin_push');
            console.log(data);
            self.button = data;
            self.turn = self.button;
            self.gamestate = "begin";
            self.dispatchEvent('game_begin');
        });
        cc.vv.net.addHandler("game_playing_push", function (data) {
            console.log('game_playing_push');
            self.gamestate = "playing";
            self.dispatchEvent('game_playing');
        });
        cc.vv.net.addHandler("game_sync_push", function (data) {
            console.log("game_sync_push");
            console.log(data);
            self.numOfMJ = data.numofmj;
            self.gamestate = data.state;
            self.turn = data.turn;
            self.button = data.button;
            self.chupai = data.chuPai;
            for (var i = 0; i < 4; ++i) {
                var seat = self.seats[i];
                var sd = data.seats[i];
                seat.holds = sd.holds;
                seat.folds = sd.folds;
                seat.angangs = sd.angangs;
                seat.diangangs = sd.diangangs;
                seat.wangangs = sd.wangangs;
                seat.pengs = sd.pengs;
                seat.extraPais = sd.extraPais;
                seat.caiShen = sd.caiShen;
                seat.chis = sd.chis;
                seat.hued = sd.hued;
                seat.tinged = sd.tinged;
                seat.iszimo = sd.iszimo;
                seat.huinfo = sd.huinfo;
            }
        });
        cc.vv.net.addHandler("game_action_push", function (data) {
            self.curaction = data;
            cc.vv.gameNetMgr.curaction = data;
            console.log("game_action_push---获得所以操作的数据", data);
            self.dispatchEvent('game_action', data);
        });

        cc.vv.net.addHandler("game_timerBegin_push", function (data) {
            self.dispatchEvent('game_timerBegin', data);
        });

        cc.vv.net.addHandler("game_chupai_push", function (data) {
            console.log('game_chupai_push');
            //console.log(data);
            var turnUserID = data;
            var si = self.getSeatIndexByID(turnUserID);
            self.doTurnChange(si);
        });
        cc.vv.net.addHandler("game_num_push", function (data) {
            self.numOfGames = data;
            self.dispatchEvent('game_num', data);
        });
        cc.vv.net.addHandler("game_over_push", function (data) {
            console.log('game_over_push');
            var results = data.results;
            for (var i = 0; i < self.seats.length; ++i) {
                self.seats[i].score = results.length == 0 ? 0 : results[i].totalscore;
            }
            self.dispatchEvent('game_over', results);
            if (data.endinfo) {
                self.isOver = true;
                self.dispatchEvent('game_end', data.endinfo);
            }
            self.reset();
            for (var i = 0; i < self.seats.length; ++i) {
                self.dispatchEvent('user_state_changed', self.seats[i]);
            }
        });
        cc.vv.net.addHandler("mj_count_push", function (data) {
            console.log('mj_count_push');
            self.numOfMJ = data;
            //console.log(data);
            self.dispatchEvent('mj_count', data);
        });
        cc.vv.net.addHandler("hu_push", function (data) {
            console.log('hu_push');
            console.log(data);
            self.doHu(data);
        });
        cc.vv.net.addHandler("hangang_notify_push", function (data) {
            self.dispatchEvent('hangang_notify', data);
        });
        cc.vv.net.addHandler("game_chupai_notify_push", function (data) {
            var userId = data.userId;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doChupai(si, pai);
        });
        cc.vv.net.addHandler("game_mopai_push", function (data) {
            console.log('game_mopai_push');
            self.doMopai(self.seatIndex, data);
        });
        cc.vv.net.addHandler("guo_notify_push", function (data) {
            console.log('guo_notify_push');
            var userId = data.userId;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doGuo(si, pai);
        });
        cc.vv.net.addHandler("guo_result", function (data) {
            console.log('guo_result');
            self.dispatchEvent('guo_result');
        });
        cc.vv.net.addHandler("guohu_push", function (data) {
            console.log('guohu_push');
            self.dispatchEvent("push_notice", {
                info: "过胡",
                time: 1.5
            });
        });
        cc.vv.net.addHandler("peng_notify_push", function (data) {
            console.log('peng_notify_push-------碰牌操作', data);
            console.log(data);
            var userId = data.userid;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            var extraPengPai = data.extraPengPai;
            self.doPeng(si, data.pai, extraPengPai);
        });
        //  吃牌操作
        cc.vv.net.addHandler("chi_notify_push", function (data) {
            console.log('chi_notify_push', data);
            var userId = data.userid;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            var extraChiPai = data.extraChiPai;
            var chiArray = data.chiArray;
            self.doChi(si, data.pai, chiArray, extraChiPai);
        });
        cc.vv.net.addHandler("gang_notify_push", function (data) {
            console.log('gang_notify_push');
            console.log(data);
            var userId = data.userid;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            self.doGang(si, pai, data.gangtype);
        });
        //  财神弃牌操作
        cc.vv.net.addHandler("game_caishen_notify_push", function (data) {
            console.log("财神弃牌操作");
            var userId = data.userId;
            var pai = data.pai;
            var si = self.getSeatIndexByID(userId);
            console.log('财神弃牌操作!!!!!!!!!!', data);
            self.doCaiShen(si, pai);
        });
        cc.vv.net.addHandler("chat_push", function (data) {
            self.dispatchEvent("chat_push", data);
        });
        cc.vv.net.addHandler("quick_chat_push", function (data) {
            self.dispatchEvent("quick_chat_push", data);
        });
        cc.vv.net.addHandler("emoji_push", function (data) {
            self.dispatchEvent("emoji_push", data);
        });
        cc.vv.net.addHandler("dissolve_notice_push", function (data) {
            console.log("dissolve_notice_push");
            console.log(data);
            self.dissoveData = data;
            self.dispatchEvent("dissolve_notice", data);
        });
        cc.vv.net.addHandler("dissolve_cancel_push", function (data) {
            self.dissoveData = null;
            self.dispatchEvent("dissolve_cancel", data);
        });
        cc.vv.net.addHandler("voice_msg_push", function (data) {
            console.log("voice_msg_push");
            self.dispatchEvent("voice_msg", data);
        });
    }
});

cc._RFpop();
},{}],"MorraGame":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cce5a7TsatHIaNaoMqubLNv', 'MorraGame');
// scripts/components/MorraGame.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // _hallGemsV: null,
        // _hallCoinsV: null,
        _alertV: null, //提示框
        _alertContentV: null,
        _morraHallV: null, //大厅view
        _roomIdV: null,
        _seatsV: [], //座位view
        _caiquanV: [],
        //动画相关
        _leftAnimation: null,
        _rightAnimation: null,
        _leftOpenAnim: null,
        _rightOpenAnim: null,
        _animTime: 3000,
        _resultsV: null, //结果显示view
        _currentQuanV: null, //当前选择手势的view
        _winlabelV: null,
        _winBgV: null,
        currentQuan: -1, //当前选择的手势
        isRandom: false, //是否随机手势
        gameEndData: null, //对局结束数据
        jianzi: 0,
        shitou: 1,
        bu: 2,
        seatindex: 0, //当前位置 0左1右
        seats: null,
        canAgain: false, //能否继续游戏（当有人掉线或退出）
        guize: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        // this._hallGemsV = cc.find("Canvas/header/jinbi/gems").getComponent(cc.Label);
        // this._hallCoinsV = cc.find("Canvas/header/zuanshi/coins").getComponent(cc.Label);
        this.guize = cc.find("Canvas/guessbox/guize");
        this._alertV = cc.find("Canvas/guessboxAlert");
        this._alertContentV = this._alertV.getChildByName("content").getComponent(cc.Label);
        this._morraHallV = cc.find("Canvas/guessbox");
        this._roomIdV = this._morraHallV.getChildByName("roomId").getComponent(cc.Label);
        this.initSeatsView();
        this.showWinCount(false);
        this.initCaiquanView();
        this.initEventHandlers();
        this.setGemsAndCoins(cc.vv.userMgr.gems, cc.vv.userMgr.coins);
        if (cc.vv.gameNetMgr.cq_data) {
            console.log("------cq_data----", cc.vv.gameNetMgr.cq_data);
            this.seats = cc.vv.gameNetMgr.cq_data.seats;
            this.initSeatsData(cc.vv.gameNetMgr.cq_data);
        }
        cc.vv.net.send('ready');
    },
    initSeatsView: function initSeatsView() {
        var seat = [];
        seat[0] = this._morraHallV.getChildByName("seat").children[0].getComponent(cc.Label);
        seat[1] = this._morraHallV.getChildByName("seat").children[1].getComponent(cc.Label);
        this._seatsV.seat = seat;
        this._seatsV.difen = this._morraHallV.getChildByName("difen").getComponent(cc.Label);
        this._seatsV.gems = this._morraHallV.getChildByName("gemsBg").getChildByName("gems").getComponent(cc.Label);
        this._seatsV.coins = this._morraHallV.getChildByName("coinsBg").getChildByName("coins").getComponent(cc.Label);
        this._seatsV.wincont = this._morraHallV.getChildByName("winBg").getChildByName("wincont").getComponent(cc.Label);
        this._winlabelV = this._morraHallV.getChildByName("winlabel");
        this._winBgV = this._morraHallV.getChildByName("winBg");
        this._seatsV.lastTime = this._morraHallV.getChildByName("lastTimeBg").getChildByName("lastTime").getComponent(cc.Label);
    },
    initCaiquanView: function initCaiquanView() {
        var layout = this._morraHallV.getChildByName("content").getChildByName("layout");
        this._caiquanV.left = layout.getChildByName("left");
        this._caiquanV.left.active = false;
        this._caiquanV.right = layout.getChildByName("right");
        this._caiquanV.right.active = false;
        this._leftAnimation = layout.getChildByName("l_anim");
        this._rightAnimation = layout.getChildByName("r_anim");
        this._leftOpenAnim = this._leftAnimation.getComponent(cc.Animation);
        this._rightOpenAnim = this._rightAnimation.getComponent(cc.Animation);
        this._leftXuanding = this._caiquanV.left.getChildByName('xuanding');
        this._rightXuanding = this._caiquanV.right.getChildByName('xuanding');
        this._resultsV = new Array();
        this._resultsV.push(layout.getChildByName("result1"));
        this._resultsV.push(layout.getChildByName("result2"));
        this._resultsV.push(layout.getChildByName("result3"));
    },
    initEventHandlers: function initEventHandlers() {
        cc.vv.gameNetMgr.cqEventHandler = this.node;
        var self = this;
        //游戏开始
        this.node.on('cq_begin', function (data) {
            console.log('cq_begin====================>', data);
            self.playOpenAnim();
        });
        //新增用户
        this.node.on('cq_new_user', function (res) {
            var data = res.detail.data;
            cc.vv.gameNetMgr.cq_data = data;
            self.seats = data.seats;
            self.initSeatsData(data);
        });
        //游戏结束
        this.node.on('cq_game_over', function (res) {
            var data = res.detail.data;
            self.gameEndData = data;
            // self.playOpenAnim();
            self.gameEnd();
            var s = self;
            var again = function again() {
                if (s.seatindex == 0 && s.canAgain) {
                    //如果是房主
                    cc.vv.net.send('cq_again');
                }
                s.clearCq();
            };
            setTimeout(again, 2000);
            // var data = data.detail.data;
        });
        //攻擂退出房间
        this.node.on('cq_exit_notify', function (res) {
            var userid = res.detail;
            self.canAgain = false;
            if (userid == cc.vv.userMgr.userId) {
                self.clearCq();
                self.seats = null;
                self.seatindex = 0;
            } else {
                if (self.seats) {
                    self.seats.pop();
                    console.log("-------------self.seats--------->>", self.seats);
                    self._seatsV.seat[1].string = "";
                    self.showWinCount(false);
                }
            }
            self.getGemsAndCoins();
        });
        //房主解散房间
        this.node.on('cq_dispress', function (res) {
            var context = self;
            var userid = res.detail;
            if (userid == cc.vv.userMgr.userId) {} else {
                cc.vv.alert.show("提示", "擂主逃跑了！,并赠送了你全部奖金！", function () {
                    context.loadHomeHall();
                });
            }
            self.canAgain = false;
            self.clearCq();
            self.seats = null;
            self.seatindex = 0;
            self.getGemsAndCoins();
        });
        //倒计时
        this.node.on('cq_game_time', function (res) {
            var data = res.detail.data;
            self._seatsV.lastTime.string = data;
            if (data == 0) {
                if (self.currentQuan == -1) {
                    //倒计时结束随机选择手势
                    self.isRandom = true;
                    var num = Math.floor(Math.random() * 10) % 3;
                    if (num == 0) {
                        self.chuJianzi();
                    } else if (num == 1) {
                        self.chuShitou();
                    } else {
                        self.chuBu();
                    }
                }
            }
        });
        //攻擂失败
        this.node.on('cq_loser_notify', function (res) {
            var context = self;
            var userid = res.detail;
            self.canAgain = false;
            if (userid == cc.vv.userMgr.userId) {
                self.clearCq();
                self.seats = null;
                self.seatindex = 0;
                cc.vv.alert.show("提示", "您挑战失败！自动退出房间", function () {
                    context.loadHomeHall();
                });
            } else {
                if (self.seats) {
                    self.seats.pop();
                    console.log("-------------cq_loser_notify--------->>", self.seats);
                    self._seatsV.seat[1].string = "";
                }
                self.showWinCount(false);
            }
            self.getGemsAndCoins();
        });
        //攻擂成功
        this.node.on('cq_winner_notify', function (res) {
            var context = self;
            var userid = res.detail;
            var str = "";
            if (userid == cc.vv.userMgr.userId) {
                cc.vv.alert.show("提示", "攻擂成功！并获得了全部奖金！", function () {
                    context.loadHomeHall();
                });
            } else {
                cc.vv.alert.show("提示", "您被打败了！并将奖金赠送给了对手！", function () {
                    context.loadHomeHall();
                });
            }
            self.canAgain = false;
            self.clearCq();
            self.seats = null;
            self.seatindex = 0;
            self.getGemsAndCoins();
        });
        //出拳通知
        this.node.on('cq_chuquan_notify', function (data) {
            //停止动画，显示已出拳
            var userId = data.detail;
            if (self.seats[0].userid == userId) {
                // 擂主出拳
                self._leftOpenAnim.stop();
                self._leftAnimation.active = false;
                self._caiquanV.left.active = true;
                if (cc.vv.userMgr.userId != userId) {
                    //不是本人的时候，显示已选定
                    self._leftXuanding.active = true;
                }
            } else {
                //userid
                self._rightOpenAnim.stop();
                self._rightAnimation.active = false;
                self._caiquanV.right.active = true;
                if (cc.vv.userMgr.userId != userId) {
                    //不是本人的时候，显示已选定
                    self._rightXuanding.active = true;
                }
            }
        });
        this.node.on('disconnect', function (res) {
            var context = self;
            self.canAgain = false;
            self.seats = null;
            self.seatindex = 0;
        });
    },
    initSeatsData: function initSeatsData(data) {
        var self = this;
        var consu = data.conf.consu;
        if (consu == 0) {
            //金币
            self._seatsV.difen.string = cc.vv.utils.showJinbi(data.conf.baseScore) + "金币";
        } else {
            //钻石
            self._seatsV.difen.string = cc.vv.utils.showJinbi(data.conf.baseScore) + "钻石";
        }
        if (self.seats) {
            self._roomIdV.string = "房间号：" + cc.vv.gameNetMgr.roomId;
            for (var i = 0; i < self.seats.length; i++) {
                self._seatsV.seat[i].string = self.seats[i].name;
                if (self.seats[i].userid == cc.vv.userMgr.userId) {
                    self._seatsV.wincont.string = self.seats[i].score;
                    self.seatindex = self.seats[i].seatindex;
                    self.getGemsAndCoins();
                }
            }
            if (self.seats.length == 2 && self.seats[1].userid != 0) {
                if (self.seats[0].userid == cc.vv.userMgr.userId) {
                    //房主提示有人进入房间
                    self._alertContentV.string = self.seats[1].name + "进入了房间";
                    self._alertV.active = true;
                    var context = self;
                    setTimeout(function () {
                        context._alertV.active = false;
                    }, 3000);
                }
                this.showWinCount(true);
            } else {
                this.showWinCount(false);
            }
        }
        self.canAgain = self.seats.length == 2 && self.seats[1].userid != 0;
        self.clearCq();
    },
    gameEnd: function gameEnd() {
        if (!this.gameEndData || this.gameEndData == null) {
            return;
        }
        this._rightXuanding.active = false;
        this._leftXuanding.active = false;
        for (var i = 0; i < this.gameEndData.length; i++) {
            if (this.gameEndData[i].seatIndex == this.seatindex) {
                //如果是自己
                // this._resultsV[this.gameEndData[i].wined].active = true;
                this._resultsV[this.gameEndData[1].wined].active = true; //只显示攻擂者的输赢
            } else {
                this.gameOverShowGesture(this.gameEndData[i].chuQuan, i);
            }
            this._seatsV.wincont.string = i == 0 ? 0 : this.gameEndData[i].winCount; //显示攻擂者得分
        }
    },
    clearCq: function clearCq() {
        if (this._caiquanV) {
            var left = this._caiquanV.left.children;
            var right = this._caiquanV.right.children;
            for (var i = 0; i < left.length; i++) {
                for (var j = 0; j < left[i].children.length; j++) {
                    left[i].children[j].active = false;
                }
            }
            for (var i = 0; i < right.length; i++) {
                for (var j = 0; j < right[i].children.length; j++) {
                    right[i].children[j].active = false;
                }
            }
        }
        if (this._resultsV) {
            for (var i = 0; i < this._resultsV.length; i++) {
                this._resultsV[i].active = false;
            }
        }
        this._currentQuanV = null;
        this.currentQuan = -1;
        this.isRandom = false;
        this.gameEndData = null;
        if (this._caiquanV) {
            this._caiquanV.left.active = false;
        }
        if (this._caiquanV) {
            this._caiquanV.right.active = false;
        }
    },
    // 猜拳动画播放
    playOpenAnim: function playOpenAnim() {
        var self = this;
        this._caiquanV.left.active = false;
        this._caiquanV.right.active = false;
        var leftAnim = function leftAnim() {
            self._leftAnimation.active = true;
            var animState1 = self._leftOpenAnim.play('caiquan2');
            animState1.wrapMode = cc.WrapMode.Loop;
        };
        var rightAnim = function rightAnim() {
            self._rightAnimation.active = true;
            var animState2 = self._rightOpenAnim.play('caiquan1');
            animState2.wrapMode = cc.WrapMode.Loop;
        };
        if (self.isRandom) {
            leftAnim();
            rightAnim();
            return;
        }
        leftAnim();
        rightAnim();
    },
    showGesture: function showGesture(type) {
        //手势显示
        if (this._currentQuanV && this._currentQuanV != null) {
            this._currentQuanV.active = false;
        }
        var left = this._caiquanV.left.children;
        var right = this._caiquanV.right.children;
        for (var i in left) {
            left[i].active = false;
        }
        for (var i in right) {
            right[i].active = false;
        }
        if (this.seatindex == 0) {
            //左边
            left[0].active = true;
            this._currentQuanV = left[0].children[type];
        } else {
            right[1].active = true;
            this._currentQuanV = right[1].children[type];
        }
        this._currentQuanV.active = true;
        this.currentQuan = type;
        this._caiquanV.left.active = true;
        this._caiquanV.right.active = true;
    },
    gameOverShowGesture: function gameOverShowGesture(type, index) {
        var left = this._caiquanV.left.children;
        var right = this._caiquanV.right.children;
        if (index == 0) {
            left[0].active = true;
            left[0].children[type].active = true;
        } else {
            right[1].active = true;
            right[1].children[type].active = true;
        }
        return;
    },
    //是否显示赢句次数
    showWinCount: function showWinCount(flag) {
        this._winlabelV.active = flag;
        this._winBgV.active = flag;
    },
    //设置金币钻石数量
    getGemsAndCoins: function getGemsAndCoins() {
        var self = this;
        cc.vv.userMgr.getGemsAndCoins(function (data) {
            console.log("------getGemsAndCoins-------->", data);
            cc.vv.userMgr.gems = data.gems;
            cc.vv.userMgr.coins = data.coins;
            // self._hallGemsV.string = data.gems;
            // self._hallCoinsV.string = data.coins;
            self.setGemsAndCoins(data.gems, data.coins);
        });
    },
    setGemsAndCoins: function setGemsAndCoins(gems, coins) {
        if (this._seatsV && this._seatsV.gems && this._seatsV.coins) {
            this._seatsV.gems.string = cc.vv.utils.showJinbi(gems);
            this._seatsV.coins.string = coins;
        }
    },
    //出剪子
    chuJianzi: function chuJianzi() {
        if (this.currentQuan == -1) {
            this.showGesture(this.jianzi);
            cc.vv.net.send('cq_shot', this.jianzi);
        }
    },
    //出石头
    chuShitou: function chuShitou() {
        if (this.currentQuan == -1) {
            this.showGesture(this.shitou);
            cc.vv.net.send('cq_shot', this.shitou);
        }
    },
    //出布
    chuBu: function chuBu() {
        if (this.currentQuan == -1) {
            this.showGesture(this.bu);
            cc.vv.net.send('cq_shot', this.bu);
        }
    },
    //关闭弹框通知
    onBtnCloseAlert: function onBtnCloseAlert() {
        this._alertV.active = false;
        this.loadHomeHall();
        // this._morraHallV.active = false;
    },
    //关闭猜拳大厅
    onBtnCloseRoom: function onBtnCloseRoom() {
        var context = this;
        var str = "";
        if (this.seatindex == 0) {
            //房主
            if (this.seats.length == 2 && this.seats[1].userid != 0) {
                str = "您确定要放弃守擂！并将奖金赠送给了对手？";
            } else {
                str = "您确定要离开擂台？";
            }
            cc.vv.alert.show("提示", str, function () {
                cc.vv.net.send('cq_dispress');
                context.loadHomeHall();
            }, true);
        } else {
            str = "您手续费已扣除！您确定放弃攻擂？";
            cc.vv.alert.show("提示", str, function () {
                cc.vv.net.send('cq_exit');
                context.loadHomeHall();
            }, true);
        }
    },
    //加载首页大厅
    loadHomeHall: function loadHomeHall() {
        cc.director.loadScene("newhall");
    },
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
    //打开猜拳规则
    onOpenguize: function onOpenguize() {
        this.guize.active = true;
    },
    //打开猜拳规则
    onCloseguize: function onCloseguize() {
        this.guize.active = false;
    }
});

cc._RFpop();
},{}],"Morra":[function(require,module,exports){
"use strict";
cc._RFpush(module, '21606/vy7RDk4aiixV6lpY1', 'Morra');
// scripts/components/Morra.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _guessV: null,
        _createboxV: null,
        _create_gemsV: null,
        _create_coinsV: null,
        _create_tagV: null,
        _seekboxV: null,
        _alertV: null,
        _alertContentV: null,
        consu: 0 },
    // use this for initialization
    onLoad: function onLoad() {
        this._guessV = cc.find("Canvas/guess");
        this._createboxV = this._guessV.getChildByName("createbox");
        this._create_gemsV = this._createboxV.getChildByName("create_gems");
        this._create_coinsV = this._createboxV.getChildByName("create_coins");
        this._create_tagV = this._createboxV.getChildByName("create_tag");
        this._seekboxV = this._guessV.getChildByName("seekbox");
        this._alertV = cc.find("Canvas/guessboxAlert");
        this._alertContentV = this._alertV.getChildByName("content").getComponent(cc.Label);
    },
    //显示创建猜拳页面
    onBtnShowMorra: function onBtnShowMorra() {
        this._guessV.active = true;
    },
    //关闭猜拳页面
    onBtnCloseMorra: function onBtnCloseMorra() {
        this._guessV.active = false;
    },
    onBtnSetConsu: function onBtnSetConsu(ev, data) {
        if (data == 1) {
            this.consu = 1;
            this._create_tagV.getChildByName("gems_n").active = false;
            this._create_tagV.getChildByName("coins_n").active = true;
            this._create_gemsV.active = false;
            this._create_coinsV.active = true;
        } else {
            this.consu = 0;
            this._create_tagV.getChildByName("gems_n").active = true;
            this._create_tagV.getChildByName("coins_n").active = false;
            this._create_gemsV.active = true;
            this._create_coinsV.active = false;
        }
    },
    //显示创建房间页面
    onBtnShowCreat: function onBtnShowCreat() {
        this._createboxV.active = true;
        this._create_tagV.getChildByName("gems_n").active = true;
        this._create_tagV.getChildByName("coins_n").active = false;
        this._create_gemsV.active = true;
        this._create_coinsV.active = false;
        this.consu = 0;
    },
    //关闭创建房间页面
    onBtnCloseCreat: function onBtnCloseCreat() {
        this._createboxV.active = false;
        this._create_gemsV.active = false;
        this._create_coinsV.active = false;
        this.consu = 0;
    },
    //显示加入房间页面
    onBtnShowJoin: function onBtnShowJoin() {
        this._seekboxV.active = true;
    },
    //关闭加入房间页面
    onBtnCloseJoin: function onBtnCloseJoin() {
        this._seekboxV.active = false;
    },
    //关闭弹框通知
    onBtnCloseAlert: function onBtnCloseAlert() {
        this._alertV.active = false;
    },
    onBtnSetBonus: function onBtnSetBonus(ev, data) {
        if (this.consu == 0) {
            this._create_gemsV.getChildByName("editbox").getComponent(cc.EditBox).string = data;
        } else {
            this._create_coinsV.getChildByName("editbox").getComponent(cc.EditBox).string = data;
        }
    },
    //创建房间
    creatMorraRoom: function creatMorraRoom() {
        var self = this;
        var difen;
        if (this.consu == 0) {
            difen = self._create_gemsV.getChildByName("editbox").getComponent(cc.EditBox).string;
        } else {
            difen = self._create_coinsV.getChildByName("editbox").getComponent(cc.EditBox).string;
        }
        console.log("--------difen------->>", difen);
        if (!cc.vv.utils.checkRate(difen) || parseInt(difen) <= 0) {
            cc.vv.alert.show("提示", "请设置奖金数量！(只限整数)");
            // self._alertContentV.string = "请设置奖金数量！(只限整数)";
            // self._alertV.active = true;
            return;
        }
        var seiriNum = function seiriNum() {
            if (difen.charAt(0) == '0') {
                difen = difen.substr(1);
                seiriNum();
            }
        };
        seiriNum();
        if (this.consu == 0) {
            difen += "0000";
        }
        var onCreate = function onCreate(ret) {
            if (ret.errcode !== 0) {
                //console.log(ret.errmsg);
                cc.vv.wc.hide();
                var content = "";
                if (ret.errcode == 2222) {
                    content = "金币不足，创建房间失败!";
                    console.log("金币不足，创建房间失败!");
                    // cc.vv.alert.show("提示", "金币不足，创建房间失败!");
                } else {
                    content = "创建房间失败,错误码" + ret.errcode;
                    console.log("创建房间失败,错误码" + ret.errcode);
                    // cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                }
                cc.vv.alert.show("提示", content);
                // self._alertContentV.string = content;
                // self._alertV.active = true;
            } else {
                console.log('创建房间成功！！！！！！');
                //显示猜拳大厅
                // self._morraHallV.active = true;
                self.loadMorraHall();
                cc.vv.userMgr.room_type = 1;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        var conf = {
            room_type: 1, //1代表猜拳房间
            difen: difen,
            consu: self.consu };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        console.log(data);
        cc.vv.wc.show("正在创建房间");
        cc.vv.http.sendRequest("/create_private_room", data, onCreate);
    },
    //加入房间
    joinMorraRoom: function joinMorraRoom() {
        var self = this;
        var roomId = self._seekboxV.getChildByName("editbox").getComponent(cc.EditBox).string;
        if (!cc.vv.utils.checkRate(roomId)) {
            // self._alertContentV.string = "请输入正确的房间号";
            // self._alertV.active = true;
            cc.vv.alert.show("提示", "请输入正确的房间号");
            return;
        }
        var content = null;
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            room_type: 1,
            roomId: roomId
        };
        var fn = function fn(ret) {
            if (ret.errcode == 0) {
                self.join(roomId);
            } else if (ret.errcode == 1) {
                content = "猜拳房间[" + roomId + "]不存在，请重新输入!";
            }
            if (content) cc.vv.alert.show("提示", content);
        };
        cc.vv.http.sendRequest("/judge_room", data, fn);
    },
    join: function join(roomId) {
        var self = this;
        console.log("----roomId---->>", roomId);
        cc.vv.wc.show("正在进入房间");
        cc.vv.userMgr.enterRoom(roomId, function (ret) {
            cc.vv.wc.hide();
            console.log("----ret.errcode---->>", ret);
            if (ret.errcode == 0) {
                //显示猜拳大厅
                // self._morraHallV.active = true;
                cc.vv.gameNetMgr.initHandlers(1);
                self.loadMorraHall();
            } else {
                var content = "猜拳房间[" + roomId + "]不存在，请重新输入!";
                if (ret.errcode == 4) {
                    content = "房间[" + roomId + "]已满!";
                } else if (ret.errcode == 5) {
                    content = "钻石或金币不足！";
                }
                // self._alertContentV.string = content;
                // self._alertV.active = true;
                cc.vv.alert.show("提示", content);
            }
        });
    },
    //加载猜拳大厅
    loadMorraHall: function loadMorraHall() {
        cc.director.loadScene("caiquan");
    }
});

cc._RFpop();
},{}],"Net":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b1cc9yRd15CXqFg0vTGKZUk', 'Net');
// scripts/Net.js

"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

if (window.io == null) {
    window.io = require("socket-io");
}
var Global = cc.Class({
    extends: cc.Component,
    statics: {
        ip: "",
        sio: null,
        isPinging: false,
        fnDisconnect: null,
        handlers: {},
        addHandler: function addHandler(event, fn) {
            if (this.handlers[event]) {
                console.log("event:" + event + "' handler has been registered.");
                return;
            }
            var handler = function handler(data) {
                //console.log(event + "(" + typeof(data) + "):" + (data? data.toString():"null"));
                if (event != "disconnect" && typeof data == "string") {
                    data = JSON.parse(data);
                }
                fn(data);
            };
            this.handlers[event] = handler;
            if (this.sio) {
                console.log("register:function " + event);
                this.sio.on(event, handler);
            }
        },
        connect: function connect(fnConnect, fnError) {
            var self = this;
            var opts = {
                'reconnection': false,
                'force new connection': true,
                'transports': ['websocket', 'polling']
            };
            this.sio = window.io.connect(this.ip, opts);
            this.sio.on('reconnect', function () {
                console.log('reconnection');
            });
            this.sio.on('connect', function (data) {
                self.sio.connected = true;
                fnConnect(data);
            });
            this.sio.on('disconnect', function (data) {
                console.log("disconnect");
                self.sio.connected = false;
                self.close();
            });
            this.sio.on('connect_failed', function () {
                console.log('connect_failed');
            });
            for (var key in this.handlers) {
                var value = this.handlers[key];
                if (typeof value == "function") {
                    if (key == 'disconnect') {
                        this.fnDisconnect = value;
                    } else {
                        console.log("register:function " + key);
                        this.sio.on(key, value);
                    }
                }
            }
            this.startHearbeat();
        },
        startHearbeat: function startHearbeat() {
            this.sio.on('game_pong', function () {
                self.lastRecieveTime = Date.now();
            });
            this.lastRecieveTime = Date.now();
            var self = this;
            if (!self.isPinging) {
                self.isPinging = true;
                setInterval(function () {
                    if (self.sio) {
                        //FIXME: 超时设为3s
                        if (Date.now() - self.lastRecieveTime > 10000) {
                            self.close();
                        } else {
                            self.ping();
                        }
                    }
                }, 5000);
            }
        },
        send: function send(event, data) {
            if (this.sio.connected) {
                if (data != null && (typeof data === "undefined" ? "undefined" : _typeof(data)) == "object") {
                    data = JSON.stringify(data);
                    //console.log(data);              
                }
                this.sio.emit(event, data);
            }
        },
        ping: function ping() {
            this.send('game_ping');
        },
        close: function close() {
            console.log('close');
            if (this.sio && this.sio.connected) {
                this.sio.connected = false;
                this.sio.disconnect();
                this.sio = null;
            }
            if (this.fnDisconnect) {
                this.fnDisconnect();
                this.fnDisconnect = null;
            }
        },
        test: function test(fnResult) {
            var xhr = null;
            var fn = function fn(ret) {
                fnResult(ret.isonline);
                xhr = null;
            };
            var arr = this.ip.split(':');
            var data = {
                account: cc.vv.userMgr.account,
                sign: cc.vv.userMgr.sign,
                ip: arr[0],
                port: arr[1]
            };
            xhr = cc.vv.http.sendRequest("/is_server_online", data, fn);
            setTimeout(function () {
                if (xhr) {
                    xhr.abort();
                    fnResult(false);
                }
            }, 1500);
        }
    }
});

cc._RFpop();
},{"socket-io":"socket-io"}],"NewHall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '84dfbD7QXlAUJfOKA+Ujf4s', 'NewHall');
// scripts/components/NewHall.js

"use strict";

var Net = require("Net");
var Global = require("Global");
cc.Class({
    extends: cc.Component,
    properties: {
        selectZJH: cc.Node,
        selectMJ: cc.Node,
        selectDN: cc.Node,
        selectDZPK: cc.Node,
        nickname: cc.Label,
        userGems: cc.Label,
        userCoins: cc.Label,
        headImg: cc.Sprite,
        _lastCheckTime: 0,
        _lastRefreshTime: 0,
        mj_online: cc.Label,
        zjh_online: cc.Label,
        dn_online: cc.Label,
        dzpk_online: cc.Label,
        effAnimation: cc.Node,
        lblNotice: cc.Label,
        _activity: null,
        gonggao: cc.Node,
        statement: null,
        statementContent: cc.RichText
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.vv) {
            cc.director.loadScene("login");
            return;
        }
        this.statement = cc.find("Canvas/statement");
        this._activity = cc.find("Canvas/activity");
        this._match = cc.find("Canvas/match");
        this.jbs = this._match.getComponent("Jbs");
        var imgLoader = this.headImg.node.getComponent("ImageLoader");
        imgLoader.setUserID(cc.vv.userMgr.userId);
        this.jinbi = cc.find("Canvas/header/jinbi/gems").getComponent(cc.Label);
        this.diamond = cc.find("Canvas/header/zuanshi/coins").getComponent(cc.Label);
        this.jinbiChange = cc.find("Canvas/jinbiChange");
        this.initButtonHandler("Canvas/scrollview/view/content/zjhbtn");
        this.initButtonHandler("Canvas/scrollview/view/content/mjbtn");
        this.initButtonHandler("Canvas/scrollview/view/content/dnbtn");
        this.initButtonHandler("Canvas/scrollview/view/content/dzpkbtn");
        this.initButtonHandler("Canvas/footer/exchange");
        this.initButtonHandler("Canvas/header/jinbi/iconAdd");
        this.initJinbiChangeHandler();
        this.initLabels();
        this.getUserOnline();
        this.effNode = cc.find("Canvas/eff");
        // this.playBtnEff(true);
        if (!cc.vv.userMgr.notice) {
            cc.vv.userMgr.notice = {
                version: null,
                msg: "数据请求中..."
            };
        };
        if (!cc.vv.userMgr.gemstip) {
            cc.vv.userMgr.gemstip = {
                version: null,
                msg: "数据请求中..."
            };
        };
        var roomId = cc.vv.userMgr.oldRoomId;
        if (roomId != null) {
            cc.vv.userMgr.oldRoomId = null;
            cc.vv.userMgr.enterRoom(roomId);
        };
        this.lblNotice.string = cc.vv.userMgr.notice.msg;
        this.refreshNotice();
        cc.vv.audioMgr.playBGM("bgFight.mp3");
        //模块的动态显示
        if (cc.vv.userMgr.modules) {
            var content = cc.find("Canvas/scrollview/view/content");
            var del_arr = [];
            for (var i in content.children) {
                var child = content.children[i];
                if (cc.vv.userMgr.modules.indexOf(parseInt(i)) == -1) {
                    del_arr.push(child);
                }
            }
            for (var i in del_arr) {
                content.removeChild(del_arr[i]);
            }
            var width = content.children[0].width;
            var length = content.children.length;
            var per = (1280 - width * length) / (length + 1);
            per = per + 120;
            for (var i in content.children) {
                var child = content.children[i];
                child.x = per + i * (width / 2 + per);
            }
        };
        //锦标赛是否开放
        this.initJbs();
    },
    initJbs: function initJbs() {
        var btn = cc.find("Canvas/scrollview/view/content/jbsbtn");
        if (cc.vv.userMgr.is_open_jbs) {
            btn.getComponent(cc.Button).interactable = true;
            // btn.interactable = true;
            for (var i in btn.children) {
                btn.children[i].active = false;
            }
        }
    },
    /*// 播放按钮特效
    playBtnEff: function(flag) {
        if (flag) {
            this.btnEff = this.effAnimation.getComponent(cc.Animation);
            var animState = this.btnEff.play('anniu');
            animState.speed = 0.2;
            animState.wrapMode = cc.WrapMode.Loop;
            animState.repeatCount = Infinity;
        }
    },*/
    refreshNotice: function refreshNotice() {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                cc.vv.userMgr.notice.version = ret.version;
                cc.vv.userMgr.notice.msg = ret.msg;
                this.lblNotice.string = ret.msg;
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            type: "notice",
            version: cc.vv.userMgr.notice.version
        };
        cc.vv.http.sendRequest("/get_message", data, onGet.bind(this));
    },
    initLabels: function initLabels() {
        this.nickname.string = cc.vv.userMgr.userName;
        this.userGems.string = cc.vv.utils.showJinbi(cc.vv.userMgr.gems);
        this.userCoins.string = cc.vv.userMgr.coins;
    },
    initButtonHandler: function initButtonHandler(btnPath) {
        var btn = cc.find(btnPath);
        cc.vv.utils.addClickEvent(btn, this.node, "NewHall", "onBtnClicked");
    },
    initJinbiChangeHandler: function initJinbiChangeHandler() {
        cc.vv.utils.addClickEvent(this.jinbiChange.getChildByName('yes'), this.node, "NewHall", "onChangeJinbi");
        cc.vv.utils.addClickEvent(this.jinbiChange.getChildByName('no'), this.node, "NewHall", "onChangeJinbi");
    },
    onBtnClicked: function onBtnClicked(event) {
        switch (event.target.name) {
            case 'zjhbtn':
                this.selectZJH.active = true;
                this.selectZJH.getComponent("SelectZjh").initView();
                break;
            case 'exchange':
                this.jinbiChange.active = true;
                break;
            case 'mjbtn':
                this.selectMJ.active = true;
                break;
            case 'dnbtn':
                this.selectDN.active = true;
                this.selectDN.getComponent("SelectDn").initView();
                break;
            case 'dzpkbtn':
                this.selectDZPK.active = true;
                this.selectDZPK.getComponent("SelectDzpk").initView();
                break;
            case 'btn_setting':
                this.node.getChildByName("set").active = true;
                this.node.getChildByName("set").getComponent("Set").refreshVolume();
                break;
        }
    },
    showActivity: function showActivity() {
        this._activity.active = true;
        this._activity.getComponent("Collapse").refreshBtns();
    },
    hideActivity: function hideActivity() {
        this._activity.active = false;
    },
    //兑换金币
    onChangeJinbi: function onChangeJinbi(event) {
        switch (event.target.name) {
            case 'yes':
                var data = {
                    sign: cc.vv.userMgr.sign,
                    userid: cc.vv.userMgr.userId,
                    num_diamond: cc.find("Canvas/jinbiChange/editbox").getComponent(cc.EditBox).string
                };
                var onYes = function onYes(ret) {
                    if (ret) {
                        if (ret.userid == cc.vv.userMgr.userId) {
                            if (ret.jinbi != null) {
                                this.jinbi.string = cc.vv.utils.showJinbi(ret.jinbi); //刷新金币显示
                                this.diamond.string = ret.diamond; //刷新钻石显示
                                console.log('兑换成功！');
                            } else {
                                console.log('无金币数量返回！');
                            }
                        } else {
                            console.log('userid不匹配！');
                        }
                    } else {
                        console.log('兑换失败！');
                    }
                    this.jinbiChange.active = false;
                };
                cc.vv.http.sendRequest("/changeJinbi", data, onYes.bind(this));
                break;
            case 'no':
                this.jinbiChange.active = false;
                break;
        }
    },
    onBtnAddCoinsClicked: function onBtnAddCoinsClicked() {
        cc.vv.chargeType.show();
    },
    onBtnAddGemsClicked: function onBtnAddGemsClicked() {
        this.jinbiChange.active = true;
    },
    showAnnouncement: function showAnnouncement() {
        this.gonggao.active = true;
        this.gonggao.getComponent("Announcement").getAnnouncement();
    },
    // 获得更新消息
    getRefreshInfo: function getRefreshInfo() {
        var self = this;
        var fn = function fn(ret) {
            if (ret == null) {
                console.log('消息是空的');
                return;
            }
            if (ret.userid == cc.vv.userMgr.userId) {
                if (ret.gems != null) {
                    // self.userGems.string = cc.vv.utils.showJinbi(ret.gems);
                    cc.vv.userMgr.gems = ret.gems;
                }
                if (ret.coins != null) {
                    cc.vv.userMgr.coins = ret.coins;
                    // self.userCoins.string = ret.coins;
                }
                cc.vv.userMgr.refreshTime = 30000;
            }
        };
        this._lastRefreshTime = Date.now();
        cc.vv.http.sendRequest("/need_refresh", {
            userid: cc.vv.userMgr.userId
        }, fn);
    },
    getUserOnline: function getUserOnline() {
        var self = this;
        var fn = function fn(ret) {
            self.mj_online.string = ret['0'] + "人在线";
            self.zjh_online.string = ret['2'] + "人在线";
            self.dn_online.string = ret['3'] + "人在线";
            self.dzpk_online.string = ret['4'] + "人在线";
        };
        this._lastCheckTime = Date.now();
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_user_online", data, fn);
    },
    exchangeRoom: function exchangeRoom() {
        if (cc.vv.userMgr.room_type == 2) {
            var type = 'zjh';
        } else if (cc.vv.userMgr.room_type == 3) {
            var type = 'dn';
        } else {
            var type = 'dzpk';
        }
        var conf = {
            room_type: cc.vv.userMgr.room_type, //2代表扎金花房间
            scene: cc.vv.userMgr.scene,
            genre: 1,
            type: type
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf),
            e_roomid: cc.vv.userMgr.e_roomid
        };
        cc.vv.wc.show("寻找房间");
        var onSearch = function onSearch(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                // if (ret.errcode == 2) {
                //     if (ret.errmsg == 1) {
                //         cc.vv.alert.show("提示", "钻石不够，无法匹配");
                //     } else {
                //         cc.vv.alert.show("提示", "金币不够，无法匹配");
                //     }
                // } else {
                //     cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                // }
                console.log('错误码', ret.errcode);
                cc.vv.alert.show("提示", ret.errmsg);
            } else {
                cc.vv.userMgr.room_type = conf.room_type;
                cc.vv.userMgr.scene = conf.scene;
                cc.vv.userMgr.e_roomid = ret.roomid;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        cc.vv.http.sendRequest("/exchange_room", data, onSearch);
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (Date.now() - this._lastCheckTime > 10000) {
            this.getUserOnline();
        };
        if (Date.now() - this._lastRefreshTime > cc.vv.userMgr.refreshTime) {
            this.getRefreshInfo();
        };
        var x = this.lblNotice.node.x;
        x -= dt * 100;
        if (x + this.lblNotice.node.width < -1000) {
            x = 500;
        }
        this.lblNotice.node.x = x;
        if (cc.vv && cc.vv.userMgr.roomData != null) {
            cc.vv.userMgr.reconnection = 1;
            cc.vv.userMgr.enterRoom(cc.vv.userMgr.roomData);
            cc.vv.userMgr.roomData = null;
        } else {
            // 如果当前没有房间，且分享过来的房间号不是空的话，可以进入房间
            if (cc.vv && cc.vv.userMgr.shareRoomId != null) {
                cc.vv.userMgr.roomData = null;
                var roomid = cc.vv.userMgr.shareRoomId;
                cc.vv.userMgr.shareRoomId = null;
                cc.vv.userMgr.enterRoom(roomid, function (ret) {
                    if (ret.errcode != 0) {
                        var content = "房间[" + roomid + "]不存在，请重新输入!";
                        if (ret.errcode == 4) {
                            content = "房间[" + roomid + "]已满!";
                        }
                        cc.vv.alert.show("提示", content);
                    }
                }.bind(this));
            }
        }
        if (cc.vv && cc.vv.userMgr.exchange == 1) {
            cc.vv.userMgr.exchange = 0;
            this.exchangeRoom();
        }
        this.userGems.string = cc.vv.utils.showJinbi(cc.vv.userMgr.gems);
        this.userCoins.string = cc.vv.userMgr.coins;
    },
    onOpenstatement: function onOpenstatement() {
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                this.statement.active = true;
                this.statementContent.string = ret.msg;
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            type: "statement"
        };
        cc.vv.http.sendRequest("/get_message", data, onGet.bind(this));
    },
    onClosestatement: function onClosestatement() {
        this.statement.active = false;
    },
    // onJBSBtnClick: function() {
    //     cc.vv.gameNetMgr.connectMatchServer();
    // },
    onJBSBtnClick: function onJBSBtnClick() {
        var self = this;
        var send_data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            userid: cc.vv.userMgr.userId
        };
        cc.vv.http.sendRequest("/get_jbs_data", send_data, function (ret) {
            self.jbs.showMatchList(ret);
        });
    }
});

cc._RFpop();
},{"Global":"Global","Net":"Net"}],"NoticeTip":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'df61b4+FzFDvbpO5g8UNVIM', 'NoticeTip');
// scripts/components/NoticeTip.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _guohu: null,
        _info: null,
        _guohuTime: -1
    },
    // use this for initialization
    onLoad: function onLoad() {
        this._guohu = cc.find("Canvas/tip_notice");
        this._guohu.active = false;
        this._info = cc.find("Canvas/tip_notice/info").getComponent(cc.Label);
        var self = this;
        this.node.on('push_notice', function (data) {
            var data = data.detail;
            self._guohu.active = true;
            self._guohuTime = data.time;
            self._info.string = data.info;
        });
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._guohuTime > 0) {
            this._guohuTime -= dt;
            if (this._guohuTime < 0) {
                this._guohu.active = false;
            }
        }
    }
});

cc._RFpop();
},{}],"OnBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6fd982Tyi5NOYJWt/fGY8Lj', 'OnBack');
// scripts/components/OnBack.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },
    // use this for initialization
    onLoad: function onLoad() {
        var btn = this.node.getChildByName("btn_back");
        cc.vv.utils.addClickEvent(btn, this.node, "OnBack", "onBtnClicked");
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_back") {
            this.node.active = false;
        }
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"PengGangs":[function(require,module,exports){
"use strict";
cc._RFpush(module, '279d9pNFGRB3rD/ngr1LIXQ', 'PengGangs');
// scripts/components/PengGangs.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (!cc.vv) {
            return;
        }
        var gameChild = this.node.getChildByName("game");
        var myself = gameChild.getChildByName("myself");
        var pengangroot = myself.getChildByName("penggangs");
        var realwidth = cc.director.getVisibleSize().width;
        var scale = realwidth / 1280;
        pengangroot.scaleX *= scale;
        pengangroot.scaleY *= scale;
        var self = this;
        this.node.on('peng_notify', function (data) {
            //刷新所有的牌
            console.log("peng_notify", data.detail);
            var data = data.detail;
            self.onPengGangChanged(data);
        });
        this.node.on('chi_notify', function (data) {
            //刷新所有的牌
            console.log("chi_notify-----penggang", data.detail);
            var data = data.detail;
            self.onPengGangChanged(data);
        });
        this.node.on('gang_notify', function (data) {
            //刷新所有的牌
            //console.log(data.detail);
            var data = data.detail;
            self.onPengGangChanged(data.seatData);
        });
        this.node.on('game_begin', function (data) {
            self.onGameBein();
        });
        var seats = cc.vv.gameNetMgr.seats;
        for (var i in seats) {
            this.onPengGangChanged(seats[i]);
        }
    },
    onGameBein: function onGameBein() {
        this.hideSide("myself");
        this.hideSide("right");
        this.hideSide("up");
        this.hideSide("left");
    },
    hideSide: function hideSide(side) {
        var gameChild = this.node.getChildByName("game");
        var myself = gameChild.getChildByName(side);
        var pengangroot = myself.getChildByName("penggangs");
        if (pengangroot) {
            for (var i = 0; i < pengangroot.childrenCount; ++i) {
                pengangroot.children[i].active = false;
            }
        }
    },
    onPengGangChanged: function onPengGangChanged(seatData) {
        if (seatData.angangs == null && seatData.diangangs == null && seatData.wangangs == null && seatData.pengs == null && seatData.chis == null) {
            return;
        }
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatData.seatindex);
        var side = cc.vv.mahjongmgr.getSide(localIndex);
        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);
        console.log("onPengGangChanged" + localIndex);
        var gameChild = this.node.getChildByName("game");
        var myself = gameChild.getChildByName(side);
        var pengangroot = myself.getChildByName("penggangs");
        for (var i = 0; i < pengangroot.childrenCount; ++i) {
            pengangroot.children[i].active = false;
        }
        //初始化杠牌
        var index = 0;
        var gangs = seatData.angangs;
        if (gangs) {
            for (var i = 0; i < gangs.length; ++i) {
                var mjid = gangs[i];
                this.initPengAndGangs(pengangroot, side, pre, index, mjid, "angang");
                index++;
            }
        }
        var gangs = seatData.diangangs;
        if (gangs) {
            for (var i = 0; i < gangs.length; ++i) {
                var mjid = gangs[i];
                this.initPengAndGangs(pengangroot, side, pre, index, mjid, "diangang");
                index++;
            }
        }
        var gangs = seatData.wangangs;
        if (gangs) {
            for (var i = 0; i < gangs.length; ++i) {
                var mjid = gangs[i];
                this.initPengAndGangs(pengangroot, side, pre, index, mjid, "wangang");
                index++;
            }
        }
        //初始化碰牌
        var pengs = seatData.pengs;
        if (pengs) {
            for (var i = 0; i < pengs.length; ++i) {
                var mjid = pengs[i];
                this.initPengAndGangs(pengangroot, side, pre, index, mjid, "peng");
                index++;
            }
        }
        // 吃的牌一定要以数组的形式存放,类似[[1,2,3],[3,4,5]];
        //初始化吃牌
        var chis = seatData.chis;
        console.debug("显示吃牌操作", chis);
        if (chis) {
            console.debug("吃的", chis.length);
            for (var i = 0; i < chis.length; ++i) {
                var mjids = chis[i];
                this.initChis(pengangroot, side, pre, index, mjids);
                index++;
            }
        }
    },
    initPengAndGangs: function initPengAndGangs(pengangroot, side, pre, index, mjid, flag) {
        console.info("initPengAndGangs", pengangroot, side, pre, index, mjid, flag);
        var pgroot = null;
        if (pengangroot.childrenCount <= index) {
            if (side == "left" || side == "right") {
                pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabLeft);
            } else {
                pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabSelf);
            }
            pengangroot.addChild(pgroot);
        } else {
            pgroot = pengangroot.children[index];
            pgroot.active = true;
        }
        if (side == "left") {
            pgroot.y = -(index * 25 * 3);
        } else if (side == "right") {
            pgroot.y = index * 25 * 3;
            pgroot.setLocalZOrder(-index);
        } else if (side == "myself") {
            pgroot.x = index * 55 * 3 + index * 10;
        } else {
            pgroot.x = -(index * 55 * 3);
        }
        var sprites = pgroot.getComponentsInChildren(cc.Sprite);
        for (var s = 0; s < sprites.length; ++s) {
            var sprite = sprites[s];
            if (sprite.node.name == "gang") {
                var isGang = flag != "peng";
                sprite.node.active = isGang;
                sprite.node.scaleX = 1.0;
                sprite.node.scaleY = 1.0;
                if (flag == "angang") {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame(side);
                    if (side == "myself" || side == "up") {
                        sprite.node.scaleX = 1.4;
                        sprite.node.scaleY = 1.4;
                    }
                } else {
                    sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
                }
            } else {
                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjid);
            }
        }
    },
    // 吃牌
    initChis: function initChis(pengangroot, side, pre, index, mjids) {
        console.debug("initChis", mjids);
        var pgroot = null;
        if (pengangroot.childrenCount <= index) {
            if (side == "left" || side == "right") {
                pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabLeft);
            } else {
                pgroot = cc.instantiate(cc.vv.mahjongmgr.pengPrefabSelf);
            }
            pengangroot.addChild(pgroot);
        } else {
            pgroot = pengangroot.children[index];
            pgroot.active = true;
        }
        if (side == "left") {
            pgroot.y = -(index * 25 * 3);
        } else if (side == "right") {
            pgroot.y = index * 25 * 3;
            pgroot.setLocalZOrder(-index);
        } else if (side == "myself") {
            pgroot.x = index * 55 * 3 + index * 10;
        } else {
            pgroot.x = -(index * 55 * 3);
        }
        var sprites = pgroot.getComponentsInChildren(cc.Sprite);
        for (var s = 0; s < sprites.length; ++s) {
            var sprite = sprites[s];
            if (sprite.node.name == "gang") {
                sprite.node.active = false;
            }
            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre, mjids[s]);
        }
    }
});

cc._RFpop();
},{}],"PopupMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'bc0d2VLgL1Avo166tHLsjCJ', 'PopupMgr');
// scripts/components/PopupMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _popuproot: null,
        _settings: null,
        _dissolveNotice: null,
        _endTime: -1,
        _extraInfo: null,
        _noticeLabel: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        cc.vv.popupMgr = this;
        this._popuproot = cc.find("Canvas/popups");
        this._settings = cc.find("Canvas/popups/settings");
        this._dissolveNotice = cc.find("Canvas/popups/dissolve_notice");
        this._noticeLabel = this._dissolveNotice.getChildByName("info").getComponent(cc.Label);
        this.closeAll();
        this.addBtnHandler("settings/btn_close");
        this.addBtnHandler("settings/btn_sqjsfj");
        this.addBtnHandler("dissolve_notice/btn_agree");
        this.addBtnHandler("dissolve_notice/btn_reject");
        this.addBtnHandler("dissolve_notice/btn_ok");
        var self = this;
        this.node.on("dissolve_notice", function (event) {
            var data = event.detail;
            self.showDissolveNotice(data);
        });
        this.node.on("dissolve_cancel", function (event) {
            self.closeAll();
        });
    },
    start: function start() {
        if (cc.vv.gameNetMgr.dissoveData) {
            this.showDissolveNotice(cc.vv.gameNetMgr.dissoveData);
        }
    },
    addBtnHandler: function addBtnHandler(btnName) {
        var btn = cc.find("Canvas/popups/" + btnName);
        this.addClickEvent(btn, this.node, "PopupMgr", "onBtnClicked");
    },
    addClickEvent: function addClickEvent(node, target, component, handler) {
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;
        var clickEvents = node.getComponent(cc.Button).clickEvents;
        clickEvents.push(eventHandler);
    },
    onBtnClicked: function onBtnClicked(event) {
        this.closeAll();
        var btnName = event.target.name;
        if (btnName == "btn_agree") {
            cc.vv.net.send("dissolve_agree");
        } else if (btnName == "btn_reject") {
            cc.vv.net.send("dissolve_reject");
        } else if (btnName == "btn_sqjsfj") {
            cc.vv.net.send("dissolve_request");
        } else if (btnName == "btn_ok") {
            this.closeAll();
        }
    },
    closeAll: function closeAll() {
        this._popuproot.active = false;
        this._settings.active = false;
        this._dissolveNotice.active = false;
    },
    showSettings: function showSettings() {
        this.closeAll();
        this._popuproot.active = true;
        this._settings.active = true;
    },
    showDissolveRequest: function showDissolveRequest() {
        this.closeAll();
        this._popuproot.active = true;
    },
    showDissolveNotice: function showDissolveNotice(data) {
        this._endTime = Date.now() / 1000 + data.time;
        this._extraInfo = "";
        for (var i = 0; i < data.states.length; ++i) {
            var b = data.states[i];
            var name = cc.vv.gameNetMgr.seats[i].name;
            if (b) {
                this._extraInfo += "\n[已同意] " + name;
            } else {
                this._extraInfo += "\n[待确认] " + name;
            }
        }
        this.closeAll();
        this._popuproot.active = true;
        this._dissolveNotice.active = true;;
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._endTime > 0) {
            var lastTime = this._endTime - Date.now() / 1000;
            if (lastTime < 0) {
                this._endTime = -1;
            }
            var m = Math.floor(lastTime / 60);
            var s = Math.ceil(lastTime - m * 60);
            var str = "";
            if (m > 0) {
                str += m + "分";
            }
            this._noticeLabel.string = str + s + "秒后房间将自动解散" + this._extraInfo;
        }
    }
});

cc._RFpop();
},{}],"RadioButton":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8d571y2U+9AiKntO+TSf0Fb', 'RadioButton');
// scripts/components/RadioButton.js

"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

cc.Class({
    extends: cc.Component,
    properties: {
        target: cc.Node,
        sprite: cc.SpriteFrame,
        checkedSprite: cc.SpriteFrame,
        checked: false,
        groupId: -1
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        if (cc.vv.radiogroupmgr == null) {
            var RadioGroupMgr = require("RadioGroupMgr");
            cc.vv.radiogroupmgr = new RadioGroupMgr();
            cc.vv.radiogroupmgr.init();
        }
        console.log(_typeof(cc.vv.radiogroupmgr.add));
        cc.vv.radiogroupmgr.add(this);
        this.refresh();
    },
    refresh: function refresh() {
        var targetSprite = this.target.getComponent(cc.Sprite);
        if (this.checked) {
            targetSprite.spriteFrame = this.checkedSprite;
        } else {
            targetSprite.spriteFrame = this.sprite;
        }
    },
    check: function check(value) {
        this.checked = value;
        this.refresh();
    },
    onClicked: function onClicked() {
        cc.vv.radiogroupmgr.check(this);
    },
    onDestroy: function onDestroy() {
        if (cc.vv && cc.vv.radiogroupmgr) {
            cc.vv.radiogroupmgr.del(this);
        }
    }
});

cc._RFpop();
},{"RadioGroupMgr":"RadioGroupMgr"}],"RadioGroupMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '824eapeRYNKY4RJzg2Z4YA2', 'RadioGroupMgr');
// scripts/components/RadioGroupMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _groups: null
    },
    // use this for initialization
    init: function init() {
        this._groups = {};
    },
    add: function add(radioButton) {
        var groupId = radioButton.groupId;
        var buttons = this._groups[groupId];
        if (buttons == null) {
            buttons = [];
            this._groups[groupId] = buttons;
        }
        buttons.push(radioButton);
    },
    del: function del(radioButton) {
        var groupId = radioButton.groupId;
        var buttons = this._groups[groupId];
        if (buttons == null) {
            return;
        }
        var idx = buttons.indexOf(radioButton);
        if (idx != -1) {
            buttons.splice(idx, 1);
        }
        if (buttons.length == 0) {
            delete this._groups[groupId];
        }
    },
    check: function check(radioButton) {
        var groupId = radioButton.groupId;
        var buttons = this._groups[groupId];
        if (buttons == null) {
            return;
        }
        for (var i = 0; i < buttons.length; ++i) {
            var btn = buttons[i];
            if (btn == radioButton) {
                btn.check(true);
            } else {
                btn.check(false);
            }
        }
    }
});

cc._RFpop();
},{}],"ReConnect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7f553G0boRH6KrTE7wACaXx', 'ReConnect');
// scripts/components/ReConnect.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _reconnect: null,
        _lblTip: null,
        _lastPing: 0
    },
    // use this for initialization
    onLoad: function onLoad() {
        this._reconnect = cc.find("Canvas/reconnect");
        this._lblTip = cc.find("Canvas/reconnect/tip").getComponent(cc.Label);
        var self = this;
        var fnTestServerOn = function fnTestServerOn() {
            cc.vv.net.test(function (ret) {
                if (ret) {
                    cc.director.loadScene('newhall');
                } else {
                    setTimeout(fnTestServerOn, 3000);
                }
            });
        };
        var fn = function fn(data) {
            self.node.off('disconnect', fn);
            self._reconnect.active = true;
            fnTestServerOn();
        };
        this.node.on('disconnect', fn);
        this.node.on('loadHall', function (ret) {
            cc.director.loadScene('newhall');
        });
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._reconnect.active) {
            var t = Math.floor(Date.now() / 1000) % 4;
            this._lblTip.string = "与服务器断开连接，正在尝试重连";
            for (var i = 0; i < t; ++i) {
                this._lblTip.string += '.';
            }
        }
    }
});

cc._RFpop();
},{}],"ReplayCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '21e6a+ajGNDTJwDHbV3A72m', 'ReplayCtrl');
// scripts/components/ReplayCtrl.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _nextPlayTime: 1,
        _replay: null,
        _isPlaying: true
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._replay = cc.find("Canvas/replay");
        this._replay.active = cc.vv.replayMgr.isReplay();
    },
    onBtnPauseClicked: function onBtnPauseClicked() {
        this._isPlaying = false;
    },
    onBtnPlayClicked: function onBtnPlayClicked() {
        this._isPlaying = true;
    },
    onBtnBackClicked: function onBtnBackClicked() {
        cc.vv.replayMgr.clear();
        cc.vv.gameNetMgr.reset();
        cc.vv.gameNetMgr.roomId = null;
        cc.director.loadScene("newhall");
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (cc.vv) {
            if (this._isPlaying && cc.vv.replayMgr.isReplay() == true && this._nextPlayTime > 0) {
                this._nextPlayTime -= dt;
                if (this._nextPlayTime < 0) {
                    this._nextPlayTime = cc.vv.replayMgr.takeAction();
                }
            }
        }
    }
});

cc._RFpop();
},{}],"ReplayMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1a6a1p86NFL6KZEZCnbu7tt', 'ReplayMgr');
// scripts/ReplayMgr.js

"use strict";

var ACTION_CHUPAI = 1;
var ACTION_MOPAI = 2;
var ACTION_PENG = 3;
var ACTION_GANG = 4;
var ACTION_HU = 5;
var ACTION_CHI = 7;
var ACTION_CAISHEN = 8;
cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _lastAction: null,
        _actionRecords: null,
        _currentIndex: 0
    },
    // use this for initialization
    onLoad: function onLoad() {},
    clear: function clear() {
        this._lastAction = null;
        this._actionRecords = null;
        this._currentIndex = 0;
    },
    init: function init(data) {
        this._actionRecords = data.action_records;
        if (this._actionRecords == null) {
            this._actionRecords = {};
        }
        this._currentIndex = 0;
        this._lastAction = null;
    },
    isReplay: function isReplay() {
        return this._actionRecords != null;
    },
    getNextAction: function getNextAction() {
        if (this._currentIndex >= this._actionRecords.length) {
            return null;
        }
        var si = this._actionRecords[this._currentIndex++];
        var action = this._actionRecords[this._currentIndex++];
        var pai = this._actionRecords[this._currentIndex++];
        return {
            si: si,
            type: action,
            pai: pai
        };
    },
    takeAction: function takeAction() {
        var action = this.getNextAction();
        if (this._lastAction != null && this._lastAction.type == ACTION_CHUPAI) {
            if (action != null && action.type != ACTION_PENG && action.type != ACTION_GANG && action.type != ACTION_HU) {
                cc.vv.gameNetMgr.doGuo(this._lastAction.si, this._lastAction.pai);
            }
        }
        this._lastAction = action;
        if (action == null) {
            return -1;
        }
        var nextActionDelay = 1.0;
        if (action.type == ACTION_CHUPAI) {
            //console.log("chupai");
            cc.vv.gameNetMgr.doChupai(action.si, action.pai);
            return 1.0;
        } else if (action.type == ACTION_MOPAI) {
            //console.log("mopai");
            cc.vv.gameNetMgr.doMopai(action.si, action.pai);
            cc.vv.gameNetMgr.doTurnChange(action.si);
            return 0.5;
        } else if (action.type == ACTION_PENG) {
            //console.log("peng");
            cc.vv.gameNetMgr.doPeng(action.si, action.pai);
            cc.vv.gameNetMgr.doTurnChange(action.si);
            return 1.0;
        } else if (action.type == ACTION_GANG) {
            //console.log("gang");
            cc.vv.gameNetMgr.dispatchEvent('hangang_notify', action.si);
            cc.vv.gameNetMgr.doGang(action.si, action.pai);
            cc.vv.gameNetMgr.doTurnChange(action.si);
            return 1.0;
        } else if (action.type == ACTION_HU) {
            //console.log("hu");
            cc.vv.gameNetMgr.doHu({
                seatindex: action.si,
                hupai: action.pai,
                iszimo: false
            });
            return 1.5;
        } else if (action.type == ACTION_CHI) {
            //console.log("chi");
            // 
            // var pd = {
            //     "pai": pai,
            //     "chiArray": chiArray
            // };
            var pai = action.pai["pai"];
            var chiArr = action.pai["chiArray"];
            for (var i = 0; i < chiArr.length; i++) {
                if (chiArr[i] == pai) {
                    chiArr.splice(i, 1);
                }
            }
            cc.vv.gameNetMgr.doChi(action.si, pai, chiArr);
            return 1.5;
        } else if (action.type == ACTION_CAISHEN) {
            cc.vv.gameNetMgr.doCaiShen(action.si, action.pai);
            return 1.5;
        }
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"Seat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '820870ltMZNDYlvzr+qCDEJ', 'Seat');
// scripts/components/Seat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _sprIcon: null,
        _zhuang: null,
        _ready: null,
        _offline: null,
        _lblName: null,
        _lblScore: null,
        _scoreBg: null,
        _nddayingjia: null,
        _voicemsg: null,
        _chatBubble: null,
        _emoji: null,
        _lastChatTime: -1,
        _userName: "",
        _score: 0,
        _dayingjia: false,
        _isOffline: false,
        _isReady: false,
        _isZhuang: false,
        _userId: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._sprIcon = this.node.getChildByName("icon").getComponent("ImageLoader");
        this._lblName = this.node.getChildByName("name").getComponent(cc.Label);
        this._lblScore = this.node.getChildByName("score").getComponent(cc.Label);
        this._voicemsg = this.node.getChildByName("voicemsg");
        if (this._voicemsg) {
            this._voicemsg.active = false;
        }
        if (this._sprIcon && this._sprIcon.getComponent(cc.Button)) {
            cc.vv.utils.addClickEvent(this._sprIcon, this.node, "Seat", "onIconClicked");
        }
        this._offline = this.node.getChildByName("offline");
        this._ready = this.node.getChildByName("ready");
        this._zhuang = this.node.getChildByName("zhuang");
        this._scoreBg = this.node.getChildByName("Z_money_frame");
        this._nddayingjia = this.node.getChildByName("dayingjia");
        this._chatBubble = this.node.getChildByName("ChatBubble");
        if (this._chatBubble != null) {
            this._chatBubble.active = false;
        }
        this._emoji = this.node.getChildByName("emoji");
        if (this._emoji != null) {
            this._emoji.active = false;
        }
        this.refresh();
        if (this._sprIcon && this._userId) {
            this._sprIcon.setUserID(this._userId);
        }
    },
    onIconClicked: function onIconClicked() {
        var iconSprite = this._sprIcon.node.getComponent(cc.Sprite);
        if (this._userId != null && this._userId > 0) {
            var seat = cc.vv.gameNetMgr.getSeatByID(this._userId);
            var sex = 0;
            if (cc.vv.baseInfoMap) {
                var info = cc.vv.baseInfoMap[this._userId];
                if (info) {
                    sex = info.sex;
                }
            }
        }
    },
    refresh: function refresh() {
        if (this._lblName != null) {
            this._lblName.string = this._userName;
        }
        if (this._lblScore != null) {
            this._lblScore.string = this._score;
        }
        if (this._nddayingjia != null) {
            this._nddayingjia.active = this._dayingjia == true;
        }
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
        if (this._zhuang) {
            this._zhuang.active = this._isZhuang;
        }
        this.node.active = this._userName != null && this._userName != "";
    },
    setInfo: function setInfo(name, score, dayingjia) {
        this._userName = name;
        this._score = score;
        if (this._score == null) {
            this._score = 0;
        }
        this._dayingjia = dayingjia;
        if (this._scoreBg != null) {
            this._scoreBg.active = this._score != null;
        }
        if (this._lblScore != null) {
            this._lblScore.node.active = this._score != null;
        }
        this.refresh();
    },

    setZhuang: function setZhuang(value) {
        this._isZhuang = value;
        if (this._zhuang) {
            this._zhuang.active = value;
        } else {
            this._zhuang = this.node.getChildByName("zhuang");
            this._zhuang.active = value;
        }
    },
    setReady: function setReady(isReady) {
        this._isReady = isReady;
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
    },
    setID: function setID(id) {
        var idNode = this.node.getChildByName("id");
        if (idNode) {
            var lbl = idNode.getComponent(cc.Label);
            lbl.string = "ID:" + id;
        }
        this._userId = id;
        if (this._sprIcon) {
            this._sprIcon.setUserID(id);
        }
    },
    setOffline: function setOffline(isOffline) {
        this._isOffline = isOffline;
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
    },
    chat: function chat(content) {
        if (this._chatBubble == null || this._emoji == null) {
            return;
        }
        this._emoji.active = false;
        this._chatBubble.active = true;
        this._chatBubble.getComponent(cc.Label).string = content;
        this._chatBubble.getChildByName("New Label").getComponent(cc.Label).string = content;
        this._lastChatTime = 3;
    },
    emoji: function emoji(_emoji) {
        //emoji = JSON.parse(emoji);
        if (this._emoji == null || this._emoji == null) {
            return;
        }
        console.log(_emoji);
        this._chatBubble.active = false;
        this._emoji.active = true;
        this._emoji.getComponent(cc.Animation).play(_emoji);
        this._lastChatTime = 3;
    },
    voiceMsg: function voiceMsg(show) {
        if (this._voicemsg) {
            this._voicemsg.active = show;
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._lastChatTime > 0) {
            this._lastChatTime -= dt;
            if (this._lastChatTime < 0) {
                this._chatBubble.active = false;
                this._emoji.active = false;
                this._emoji.getComponent(cc.Animation).stop();
            }
        }
    }
});

cc._RFpop();
},{}],"SelectDn":[function(require,module,exports){
"use strict";
cc._RFpush(module, '06939hb4odIYavgJf6dOkV9', 'SelectDn');
// scripts/components/SelectDn.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        pm: cc.Node,
        xz: cc.Node,
        lb: cc.Node,
        th: cc.Node,
        gz: cc.Node,
        hj: cc.Node,
        // pmlable1: cc.Label,
        // pmlable2: cc.Label,
        pmlable3: cc.Label,
        pmlable4: cc.Label,
        // xzlable1: cc.Label,
        // xzlable2: cc.Label,
        xzlable3: cc.Label,
        xzlable4: cc.Label,
        // lblable1: cc.Label,
        // lblable2: cc.Label,
        lblable3: cc.Label,
        lblable4: cc.Label,
        // thlable1: cc.Label,
        // thlable2: cc.Label,
        thlable3: cc.Label,
        thlable4: cc.Label,
        // gzlable1: cc.Label,
        // gzlable2: cc.Label,
        gzlable3: cc.Label,
        gzlable4: cc.Label,
        // hjlable1: cc.Label,
        // hjlable2: cc.Label,
        hjlable3: cc.Label,
        hjlable4: cc.Label
    },
    // use this for initialization
    onLoad: function onLoad() {
        this.initButtonHandler(this.pm);
        this.initButtonHandler(this.xz);
        this.initButtonHandler(this.lb);
        this.initButtonHandler(this.th);
        this.initButtonHandler(this.gz);
        this.initButtonHandler(this.hj);
    },
    initView: function initView() {
        var self = this;
        var fn = function fn(ret) {
            if (ret) {
                for (var i = 0; i < ret.length; i++) {
                    if (i == 0) {
                        self.pm.scene = ret[i].id;
                        // self.pmlable1.string = ret[i].name;
                        // self.pmlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.pmlable3.string = ret[i].online;
                        self.pmlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 1) {
                        self.xz.scene = ret[i].id;
                        // self.xzlable1.string = ret[i].name;
                        // self.xzlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.xzlable3.string = ret[i].online;
                        self.xzlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 2) {
                        self.lb.scene = ret[i].id;
                        // self.lblable1.string = ret[i].name;
                        // self.lblable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.lblable3.string = ret[i].online;
                        self.lblable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 3) {
                        self.th.scene = ret[i].id;
                        // self.thlable1.string = ret[i].name;
                        // self.thlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.thlable3.string = ret[i].online;
                        self.thlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 4) {
                        self.gz.scene = ret[i].id;
                        // self.gzlable1.string = ret[i].name;
                        // self.gzlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.gzlable3.string = ret[i].online;
                        self.gzlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 5) {
                        self.hj.scene = ret[i].id;
                        // self.hjlable1.string = ret[i].name;
                        // self.hjlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.hjlable3.string = ret[i].online;
                        self.hjlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    }
                };
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            room_type: 3
        };
        cc.vv.http.sendRequest("/get_scene", data, fn);
    },
    onBtnBack: function onBtnBack() {
        this.node.active = false;
    },
    initButtonHandler: function initButtonHandler(btn) {
        cc.vv.utils.addClickEvent(btn, this.node, "SelectDn", "matchRoom");
    },
    matchRoom: function matchRoom(event) {
        var conf = {
            room_type: 3, //3代表斗牛房间
            scene: event.target.scene,
            genre: 1,
            type: 'dn'
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        cc.vv.wc.show("寻找房间");
        var onSearch = function onSearch(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                //console.log(ret.errmsg);
                // if (ret.errcode == 2) {
                //     cc.vv.alert.show("提示", ret.errmsg);
                // } else {
                //     if (ret.errcode == -3) {
                //         cc.vv.alert.show("提示", "您已加入房间，无法匹配");
                //     } else {
                //         cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                //     }
                // }
                console.log('错误码', ret.errcode);
                cc.vv.alert.show("提示", ret.errmsg);
            } else {
                cc.vv.userMgr.room_type = conf.room_type;
                cc.vv.userMgr.scene = conf.scene;
                cc.vv.userMgr.e_roomid = ret.roomid;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        cc.vv.http.sendRequest("/match_room", data, onSearch);
    }
});

cc._RFpop();
},{}],"SelectDzpk":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0ca87mvrqZMsqO7PN38htpU', 'SelectDzpk');
// scripts/components/SelectDzpk.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        pm: cc.Node,
        xz: cc.Node,
        lb: cc.Node,
        th: cc.Node,
        gz: cc.Node,
        hj: cc.Node,
        // pmlable1: cc.Label,
        // pmlable2: cc.Label,
        pmlable3: cc.Label,
        pmlable4: cc.Label,
        // xzlable1: cc.Label,
        // xzlable2: cc.Label,
        xzlable3: cc.Label,
        xzlable4: cc.Label,
        // lblable1: cc.Label,
        // lblable2: cc.Label,
        lblable3: cc.Label,
        lblable4: cc.Label,
        // thlable1: cc.Label,
        // thlable2: cc.Label,
        thlable3: cc.Label,
        thlable4: cc.Label,
        // gzlable1: cc.Label,
        // gzlable2: cc.Label,
        gzlable3: cc.Label,
        gzlable4: cc.Label,
        // hjlable1: cc.Label,
        // hjlable2: cc.Label,
        hjlable3: cc.Label,
        hjlable4: cc.Label
    },
    // use this for initialization
    onLoad: function onLoad() {
        this.initButtonHandler(this.pm);
        this.initButtonHandler(this.xz);
        this.initButtonHandler(this.lb);
        this.initButtonHandler(this.th);
        this.initButtonHandler(this.gz);
        this.initButtonHandler(this.hj);
    },
    initView: function initView() {
        var self = this;
        var fn = function fn(ret) {
            if (ret) {
                for (var i = 0; i < ret.length; i++) {
                    if (i == 0) {
                        self.pm.scene = ret[i].id;
                        // self.pmlable1.string = ret[i].name;
                        // self.pmlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.pmlable3.string = ret[i].online;
                        self.pmlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 1) {
                        self.xz.scene = ret[i].id;
                        // self.xzlable1.string = ret[i].name;
                        // self.xzlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.xzlable3.string = ret[i].online;
                        self.xzlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 2) {
                        self.lb.scene = ret[i].id;
                        // self.lblable1.string = ret[i].name;
                        // self.lblable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.lblable3.string = ret[i].online;
                        self.lblable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 3) {
                        self.th.scene = ret[i].id;
                        // self.thlable1.string = ret[i].name;
                        // self.thlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.thlable3.string = ret[i].online;
                        self.thlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 4) {
                        self.gz.scene = ret[i].id;
                        // self.gzlable1.string = ret[i].name;
                        // self.gzlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.gzlable3.string = ret[i].online;
                        self.gzlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 5) {
                        self.hj.scene = ret[i].id;
                        // self.hjlable1.string = ret[i].name;
                        // self.hjlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.hjlable3.string = ret[i].online;
                        self.hjlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    }
                };
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            room_type: 4
        };
        cc.vv.http.sendRequest("/get_scene", data, fn);
    },
    onBtnBack: function onBtnBack() {
        this.node.active = false;
    },
    initButtonHandler: function initButtonHandler(btn) {
        cc.vv.utils.addClickEvent(btn, this.node, "SelectDzpk", "matchRoom");
    },
    matchRoom: function matchRoom(event) {
        var conf = {
            room_type: 4, //4代表德州扑克房间
            scene: event.target.scene,
            genre: 1,
            type: 'dzpk'
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        cc.vv.wc.show("寻找房间");
        var onSearch = function onSearch(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                //console.log(ret.errmsg);
                // if (ret.errcode == 2) {
                //     if (ret.errmsg == -1) {
                //         cc.vv.alert.show("提示", "钻石不够，无法匹配");
                //     } else {
                //         cc.vv.alert.show("提示", "金币不够，无法匹配");
                //     }
                // } else {
                //     if (ret.errcode == -3) {
                //         cc.vv.alert.show("提示", "您已加入房间，无法匹配");
                //     } else {
                //         cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                //     }
                // }
                console.log('错误码', ret.errcode);
                cc.vv.alert.show("提示", ret.errmsg);
            } else {
                cc.vv.userMgr.room_type = conf.room_type;
                cc.vv.userMgr.scene = conf.scene;
                cc.vv.userMgr.e_roomid = ret.roomid;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        cc.vv.http.sendRequest("/match_room", data, onSearch);
    }
});

cc._RFpop();
},{}],"SelectMj":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'bd8f2TzJQdH+LM4cYQAzPC3', 'SelectMj');
// scripts/components/SelectMj.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        btmj: cc.Node,
        whmj: cc.Node,
        jrfj: cc.Node,
        fhfj: cc.Node
    },
    // use this for initialization
    onLoad: function onLoad() {
        this.initButtonHandler(this.btmj);
        this.initButtonHandler(this.whmj);
        this.initButtonHandler(this.jrfj);
        this.initButtonHandler(this.fhfj);
        if (cc.vv.gameNetMgr.roomId) {
            this.jrfj.active = false;
            this.fhfj.active = true;
        } else {
            this.jrfj.active = true;
            this.fhfj.active = false;
        }
    },
    initView: function initView() {},
    onBtnBack: function onBtnBack() {
        this.node.active = false;
    },
    initButtonHandler: function initButtonHandler(btn) {
        cc.vv.utils.addClickEvent(btn, this.node, "SelectMj", "onClickBtn");
    },
    onClickBtn: function onClickBtn(event) {
        switch (event.target.name) {
            case 'mj_join':
                cc.find("Canvas/JoinGame").active = true;
                break;
            case 'mj_back':
                this.onReturnGameClicked();
                break;
            case 'baotou':
                if (cc.vv.gameNetMgr.roomId) {
                    this.onReturnGameClicked();
                } else {
                    cc.find("Canvas/CreateRoom").active = true;
                }
                break;
            case 'wuhan':
                // cc.find("Canvas/JoinGame").active = true;
                break;
        }
    },
    onReturnGameClicked: function onReturnGameClicked() {
        cc.director.loadScene("mjgame");
    }
});

cc._RFpop();
},{}],"SelectZjh":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0ceec5rmkVNwbKYiMDf8JpW', 'SelectZjh');
// scripts/components/SelectZjh.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        pm: cc.Node,
        xz: cc.Node,
        lb: cc.Node,
        th: cc.Node,
        gz: cc.Node,
        hj: cc.Node,
        // pmlable1: cc.Label,
        // pmlable2: cc.Label,
        pmlable3: cc.Label,
        pmlable4: cc.Label,
        // xzlable1: cc.Label,
        // xzlable2: cc.Label,
        xzlable3: cc.Label,
        xzlable4: cc.Label,
        // lblable1: cc.Label,
        // lblable2: cc.Label,
        lblable3: cc.Label,
        lblable4: cc.Label,
        // thlable1: cc.Label,
        // thlable2: cc.Label,
        thlable3: cc.Label,
        thlable4: cc.Label,
        // gzlable1: cc.Label,
        // gzlable2: cc.Label,
        gzlable3: cc.Label,
        gzlable4: cc.Label,
        // hjlable1: cc.Label,
        // hjlable2: cc.Label,
        hjlable3: cc.Label,
        hjlable4: cc.Label
    },
    // use this for initialization
    onLoad: function onLoad() {
        this.initButtonHandler(this.pm);
        this.initButtonHandler(this.xz);
        this.initButtonHandler(this.lb);
        this.initButtonHandler(this.th);
        this.initButtonHandler(this.gz);
        this.initButtonHandler(this.hj);
    },
    initView: function initView() {
        var self = this;
        var fn = function fn(ret) {
            if (ret) {
                for (var i = 0; i < ret.length; i++) {
                    if (i == 0) {
                        self.pm.scene = ret[i].id;
                        // self.pmlable1.string = ret[i].name;
                        // self.pmlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.pmlable3.string = ret[i].online;
                        self.pmlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 1) {
                        self.xz.scene = ret[i].id;
                        // self.xzlable1.string = ret[i].name;
                        // self.xzlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.xzlable3.string = ret[i].online;
                        self.xzlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 2) {
                        self.lb.scene = ret[i].id;
                        // self.lblable1.string = ret[i].name;
                        // self.lblable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.lblable3.string = ret[i].online;
                        self.lblable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 3) {
                        self.th.scene = ret[i].id;
                        // self.thlable1.string = ret[i].name;
                        // self.thlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.thlable3.string = ret[i].online;
                        self.thlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 4) {
                        self.gz.scene = ret[i].id;
                        // self.gzlable1.string = ret[i].name;
                        // self.gzlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.gzlable3.string = ret[i].online;
                        self.gzlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    } else if (i == 5) {
                        self.hj.scene = ret[i].id;
                        // self.hjlable1.string = ret[i].name;
                        // self.hjlable2.string = ret[i].consume_type ? ("钻石" + ret[i].consume_num) : ("金币" + ret[i].consume_num);
                        self.hjlable3.string = ret[i].online;
                        self.hjlable4.string = "进房下限" + (ret[i].limit_type ? ret[i].limit_num : ret[i].limit_num);
                    }
                };
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            room_type: 2
        };
        cc.vv.http.sendRequest("/get_scene", data, fn);
    },
    onBtnBack: function onBtnBack() {
        this.node.active = false;
    },
    initButtonHandler: function initButtonHandler(btn) {
        cc.vv.utils.addClickEvent(btn, this.node, "SelectZjh", "matchRoom");
    },
    matchRoom: function matchRoom(event) {
        var conf = {
            room_type: 2, //2代表扎金花房间
            scene: event.target.scene,
            genre: 1,
            type: 'zjh'
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            conf: JSON.stringify(conf)
        };
        cc.vv.wc.show("寻找房间");
        var onSearch = function onSearch(ret) {
            if (ret.errcode !== 0) {
                cc.vv.wc.hide();
                //console.log(ret.errmsg);
                // if (ret.errcode == 2) {
                //     if (ret.errmsg == -1) {
                //         cc.vv.alert.show("提示", "钻石不够，无法匹配");
                //     } else {
                //         cc.vv.alert.show("提示", "金币不够，无法匹配");
                //     }
                // } else {
                //     if (ret.errcode == -3) {
                //         cc.vv.alert.show("提示", "您已加入房间，无法匹配");
                //     } else {
                //         cc.vv.alert.show("提示", "创建房间失败,错误码:" + ret.errcode);
                //     }
                // }
                console.log('错误码', ret.errcode);
                cc.vv.alert.show("提示", ret.errmsg);
            } else {
                cc.vv.userMgr.room_type = conf.room_type;
                cc.vv.userMgr.scene = conf.scene;
                cc.vv.userMgr.e_roomid = ret.roomid;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        cc.vv.http.sendRequest("/match_room", data, onSearch);
    }
});

cc._RFpop();
},{}],"Settings":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4c04fyd89JAZY7qGjvubi+f', 'Settings');
// scripts/components/Settings.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _btnYXOpen: null,
        _btnYXClose: null,
        _btnYYOpen: null,
        _btnYYClose: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._btnYXOpen = this.node.getChildByName("yinxiao").getChildByName("btn_yx_open");
        this._btnYXClose = this.node.getChildByName("yinxiao").getChildByName("btn_yx_close");
        this._btnYYOpen = this.node.getChildByName("yinyue").getChildByName("btn_yy_open");
        this._btnYYClose = this.node.getChildByName("yinyue").getChildByName("btn_yy_close");
        this.initButtonHandler(this.node.getChildByName("btn_close"));
        this.initButtonHandler(this.node.getChildByName("btn_exit"));
        this.initButtonHandler(this._btnYXOpen);
        this.initButtonHandler(this._btnYXClose);
        this.initButtonHandler(this._btnYYOpen);
        this.initButtonHandler(this._btnYYClose);
        var slider = this.node.getChildByName("yinxiao").getChildByName("progress");
        cc.vv.utils.addSlideEvent(slider, this.node, "Settings", "onSlided");
        var slider = this.node.getChildByName("yinyue").getChildByName("progress");
        cc.vv.utils.addSlideEvent(slider, this.node, "Settings", "onSlided");
        this.refreshVolume();
    },
    onSlided: function onSlided(slider) {
        if (slider.node.parent.name == "yinxiao") {
            cc.vv.audioMgr.setSFXVolume(slider.progress);
        } else if (slider.node.parent.name == "yinyue") {
            cc.vv.audioMgr.setBGMVolume(slider.progress);
        }
        this.refreshVolume();
    },
    initButtonHandler: function initButtonHandler(btn) {
        cc.vv.utils.addClickEvent(btn, this.node, "Settings", "onBtnClicked");
    },
    refreshVolume: function refreshVolume() {
        this._btnYXClose.active = cc.vv.audioMgr.sfxVolume > 0;
        this._btnYXOpen.active = !this._btnYXClose.active;
        var yx = this.node.getChildByName("yinxiao");
        var width = 430 * cc.vv.audioMgr.sfxVolume;
        var progress = yx.getChildByName("progress");
        progress.getComponent(cc.Slider).progress = cc.vv.audioMgr.sfxVolume;
        progress.getChildByName("progress").width = width;
        //yx.getChildByName("btn_progress").x = progress.x + width;
        this._btnYYClose.active = cc.vv.audioMgr.bgmVolume > 0;
        this._btnYYOpen.active = !this._btnYYClose.active;
        var yy = this.node.getChildByName("yinyue");
        var width = 430 * cc.vv.audioMgr.bgmVolume;
        var progress = yy.getChildByName("progress");
        progress.getComponent(cc.Slider).progress = cc.vv.audioMgr.bgmVolume;
        progress.getChildByName("progress").width = width;
        //yy.getChildByName("btn_progress").x = progress.x + width;
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "btn_close") {
            this.node.active = false;
        } else if (event.target.name == "btn_exit") {
            cc.sys.localStorage.removeItem("wx_account");
            cc.sys.localStorage.removeItem("wx_sign");
            cc.director.loadScene("login");
        } else if (event.target.name == "btn_yx_open") {
            cc.vv.audioMgr.setSFXVolume(1.0);
            this.refreshVolume();
        } else if (event.target.name == "btn_yx_close") {
            cc.vv.audioMgr.setSFXVolume(0);
            this.refreshVolume();
        } else if (event.target.name == "btn_yy_open") {
            cc.vv.audioMgr.setBGMVolume(1);
            this.refreshVolume();
        } else if (event.target.name == "btn_yy_close") {
            cc.vv.audioMgr.setBGMVolume(0);
            this.refreshVolume();
        }
    }
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
});

cc._RFpop();
},{}],"Set":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4f606opgL1N4K6AsaTgyK7s', 'Set');
// scripts/components/Set.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        voice: cc.Node,
        help: cc.Node,
        _btnYXOpen: null,
        _btnYXClose: null,
        _btnYYOpen: null,
        _btnYYClose: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._btnYXOpen = this.node.getChildByName("voice").getChildByName("jbs_details").getChildByName("sound_on");
        this._btnYXClose = this.node.getChildByName("voice").getChildByName("jbs_details").getChildByName("sound_off");
        this._btnYYOpen = this.node.getChildByName("voice").getChildByName("jbs_details").getChildByName("music_on");
        this._btnYYClose = this.node.getChildByName("voice").getChildByName("jbs_details").getChildByName("music_off");
        cc.vv.utils.addClickEvent(this._btnYXOpen, this.node, "Set", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._btnYXClose, this.node, "Set", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._btnYYOpen, this.node, "Set", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._btnYYClose, this.node, "Set", "onBtnClicked");
        this.refreshVolume();
    },
    refreshVolume: function refreshVolume() {
        this._btnYXClose.active = cc.vv.audioMgr.sfxVolume > 0;
        this._btnYXOpen.active = !this._btnYXClose.active;
        this._btnYYClose.active = cc.vv.audioMgr.bgmVolume > 0;
        this._btnYYOpen.active = !this._btnYYClose.active;
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "guanbi") {
            this.node.active = false;
        } else if (event.target.name == "sound_on") {
            cc.vv.audioMgr.setSFXVolume(1);
            this.refreshVolume();
        } else if (event.target.name == "sound_off") {
            cc.vv.audioMgr.setSFXVolume(0);
            this.refreshVolume();
        } else if (event.target.name == "music_on") {
            cc.vv.audioMgr.setBGMVolume(1);
            this.refreshVolume();
        } else if (event.target.name == "music_off") {
            cc.vv.audioMgr.setBGMVolume(0);
            this.refreshVolume();
        } else if (event.target.name == "set_music1") {
            this.voice.active = true;
            this.help.active = false;
        } else if (event.target.name == "set_faq0") {
            this.voice.active = false;
            this.help.active = true;
        }
    }
});

cc._RFpop();
},{}],"Share":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8fc5bpKUdREdI5aVkPe053K', 'Share');
// scripts/components/Share.js

"use strict";

// 微信分享相关逻辑处理
cc.Class({
    extends: cc.Component,
    properties: {
        _share: null,
        _linkPanel: cc.Node,
        _QRCodePanel: cc.Node,
        _headIcon: cc.Sprite,
        _shareInfo: cc.Label,
        _shareType: 0,
        _btnLink: {
            default: null,
            type: cc.Button
        },
        _btnQRCode: {
            default: null,
            type: cc.Button
        },
        _spriteFrame: null,
        _shareRoomId: null,
        _sprQRCode: cc.Sprite
    },
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.initUI();
        cc.vv.share = this;
    },
    initUI: function initUI() {
        this._share = cc.find("Canvas/share");
        this._linkPanel = cc.find("Canvas/share/link_panel");
        this._QRCodePanel = cc.find("Canvas/share/QR_code_panel");
        this._headIcon = this._linkPanel.getChildByName("headicon");
        this._shareInfo = this._linkPanel.getChildByName("shareinfo");
        this._btnLink = cc.find("Canvas/share/button_link").getComponent(cc.Button);
        this._btnQRCode = cc.find("Canvas/share/button_qrcode").getComponent(cc.Button);
        this._sprQRCode = cc.find("Canvas/share/QR_code_panel/QRCodeImg").getComponent(cc.Sprite);
        this._shareRoomId = cc.vv.userMgr.shareRoomId || cc.vv.gameNetMgr.roomId;
    },
    onCloseBtnClicked: function onCloseBtnClicked() {
        console.log('关闭按钮点击');
        this._share.active = false;
    },
    onLinkBtnClicked: function onLinkBtnClicked() {
        console.log('链接邀请按钮点击');
        this._shareType = 1;
        this.toggleStatue();
    },
    onQRcodeBtnClicked: function onQRcodeBtnClicked() {
        console.log('二维码分享按钮点击');
        this._shareType = 2;
        this.toggleStatue();
    },
    toggleStatue: function toggleStatue() {
        if (this._shareType == 1) {
            this._linkPanel.active = true;
            this._QRCodePanel.active = false;
            this._btnLink.interactable = false;
            this._btnQRCode.interactable = true;
            this.getShareLinkInfo();
        } else {
            this._btnLink.interactable = true;
            this._btnQRCode.interactable = false;
            this._linkPanel.active = false;
            this._QRCodePanel.active = true;
            this.getShareQRCodeInfo();
        }
    },
    show: function show() {
        this._share.active = true;
        this._shareType = 1;
        this.toggleStatue();
    },
    getShareLinkInfo: function getShareLinkInfo() {
        var shareTitle = "亚巨棋牌";
        var shareContent = "我邀请你来玩亚巨棋牌，最火热的棋牌游戏，包含各种主流及地方棋牌游戏种类，快上车吧！";
        if (cc.vv.userMgr.userName) {
            shareContent = cc.vv.userMgr.userName + "邀请你来玩亚巨棋牌，最火热的棋牌游戏，包含各种主流及地方棋牌游戏种类，快上车吧！";
        };
        if (this._shareRoomId) {
            shareContent = shareContent + "房间号是:" + this._shareRoomId;
        };
        this._shareInfo.getComponent(cc.Label).string = shareContent;
        if (!cc.sys.isNative) {
            document.title = window.wxFriend.title = shareTitle;
            window.wxFriend.desc = shareContent;
            if (cc.vv.gameNetMgr.roomId && cc.vv.gameNetMgr.roomId != null) {
                var shareUrl = cc.vv.userMgr.yaoqingUrl + cc.vv.gameNetMgr.roomId;
            } else {
                var shareUrl = cc.vv.userMgr.yaoqingUrl + "000000";
            }
            window.wxFriend.link = shareUrl;
            window.shareMessage();
        }
    },
    // 加载二维码
    getShareQRCodeInfo: function getShareQRCodeInfo() {
        var ImageLoader = this._sprQRCode.node.getComponent("ImageLoader");
        ImageLoader.setUserID(cc.vv.userMgr.userId, 1);
    },
    onDestory: function onDestory() {
        if (cc.vv) {
            cc.vv.share = null;
        }
    }
});

cc._RFpop();
},{}],"TimePointer":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5b586erPK1H5bFfrMKWs+Y6', 'TimePointer');
// scripts/components/TimePointer.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _arrow: null,
        _pointer: null,
        _timeLabel: null,
        _time: -1,
        _alertTime: -1
    },
    // use this for initialization
    onLoad: function onLoad() {
        var gameChild = this.node.getChildByName("game");
        this._arrow = gameChild.getChildByName("arrow");
        this._pointer = this._arrow.getChildByName("pointer");
        this.initPointer();
        this._timeLabel = this._arrow.getChildByName("lblTime").getComponent(cc.Label);
        this._timeLabel.string = "00";
        var self = this;
        this.node.on('game_begin', function (data) {
            self.initPointer();
        });
        this.node.on('game_chupai', function (data) {
            self.initPointer();
            self._time = 10;
            self._alertTime = 3;
        });
        this.node.on('game_timerBegin', function (data) {
            self.initPointer();
            self._time = 10;
            self._alertTime = 3;
        });
    },
    initPointer: function initPointer() {
        if (cc.vv == null) {
            return;
        }
        this._arrow.active = cc.vv.gameNetMgr.gamestate == "playing";
        if (!this._arrow.active) {
            return;
        }
        var turn = cc.vv.gameNetMgr.turn;
        var localIndex = cc.vv.gameNetMgr.getLocalIndex(turn);
        for (var i = 0; i < this._pointer.children.length; ++i) {
            this._pointer.children[i].active = i == localIndex;
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._time > 0) {
            this._time -= dt;
            if (this._alertTime > 0 && this._time < this._alertTime) {
                cc.vv.audioMgr.playSFX("timeup_alarm.mp3");
                this._alertTime = -1;
            }
            var pre = "";
            if (this._time < 0) {
                this._time = 0;
            }
            var t = Math.ceil(this._time);
            if (t < 10) {
                pre = "0";
            }
            this._timeLabel.string = pre + t;
        }
    }
});

cc._RFpop();
},{}],"UserMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '74d78JBqHdDKY6hckY2YuL+', 'UserMgr');
// scripts/UserMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        account: null,
        userId: null,
        userName: null,
        lv: 0,
        exp: 0,
        coins: 0,
        gems: 0,
        sign: 0,
        ip: "",
        sex: 0,
        roomData: null,
        oldRoomId: null,
        yaoqingUrl: null,
        headimg: null,
        shareRoomId: null,
        yaoqing_key: null,
        chargerate: null,
        is_sign: 0,
        sign_days: 0,
        room_type: -1,
        collapse_prise: 0,
        is_first_charge: 0,
        scene: -1,
        e_roomid: 0,
        exchange: 0,
        reconnection: 0,
        refreshTime: 30000
    },
    guestAuth: function guestAuth(param) {
        this.loadSceneName = param;
        var account = cc.args["account"];
        if (account == null) {
            account = cc.sys.localStorage.getItem("account");
        }
        if (account == null) {
            account = Date.now();
            cc.sys.localStorage.setItem("account", account);
        }
        cc.vv.http.sendRequest("/guest", {
            account: account
        }, this.onAuth);
    },
    onAuth: function onAuth(ret) {
        var self = cc.vv.userMgr;
        if (ret.errcode !== 0) {
            console.log(ret.errmsg);
        } else {
            self.account = ret.account;
            self.sign = ret.sign;
            self.shareRoomId = ret.shareRoomId;
            cc.vv.http.url = "http://" + cc.vv.SI.hall;
            self.login();
        }
    },
    // 登录
    login: function login() {
        var self = this;
        var onLogin = function onLogin(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                self.account = ret.account;
                self.userId = ret.userid;
                self.userName = ret.name;
                self.lv = ret.lv;
                self.exp = ret.exp;
                self.coins = ret.coins;
                self.gems = ret.gems;
                self.roomData = ret.roomid;
                self.room_type = ret.room_type;
                self.sex = ret.sex;
                self.ip = ret.ip;
                self.headimg = ret.headimg;
                self.yaoqingUrl = ret.yaoqingUrl;
                self.yaoqing_key = ret.yaoqing_key;
                self.is_sign = ret.is_sign;
                self.sign_days = ret.sign_days;
                self.collapse_prise = ret.collapse_prise;
                self.is_first_charge = ret.is_first_charge;
                self.modules = ret.modules; //显示模块
                self.is_open_jbs = ret.is_open_jbs; //是否开放锦标赛
                // TODO  充值兑换率
                // self.chargerate = ret.chargerate;
                var shareUrl = self.yaoqingUrl;
                if (!cc.sys.isNative) {
                    var roomvalid = self.shareRoomId || cc.vv.gameNetMgr.roomId || self.roomData;
                    if (roomvalid) {
                        shareUrl = shareUrl + roomvalid;
                    } else {
                        shareUrl = shareUrl + "000000";
                    }
                    if (window.wxFriend) {
                        window.wxFriend.link = shareUrl;
                        window.wxFriend.desc = self.userName + window.wxFriend.desc;
                        window.shareMessage();
                    }
                }
                if (self.loadSceneName) {
                    cc.director.loadScene(self.loadSceneName);
                } else {
                    cc.director.loadScene("newhall");
                    cc.vv.http.sendRequest("/injinbiao", {
                        userId: self.userId
                    }, function (data) {
                        if (data.ip) {
                            cc.vv.match_net.ip = data.ip + ":" + data.port;
                            console.log("?????", cc.vv.match_net.ip);
                            cc.vv.match_net.connect(function () {
                                cc.vv.gameNetMgr.initHandlers(100);
                                cc.vv.match_net.send("login", { userid: self.userId });
                            }, function () {});
                        };
                    });
                }
            }
        };
        // cc.vv.wc.show("正在登录游戏");
        cc.vv.http.sendRequest("/login", {
            account: this.account,
            sign: this.sign
        }, onLogin);
    },
    // 进入房间
    enterRoom: function enterRoom(roomId, callback) {
        var self = this;
        var onEnter = function onEnter(ret) {
            console.log('进入房间onEnter====>', ret);
            if (ret.errcode !== 0) {
                if (ret.errcode == -1) {
                    setTimeout(function () {
                        self.enterRoom(roomId, callback);
                    }, 5000);
                } else {
                    cc.vv.wc.hide();
                    if (callback != null) {
                        callback(ret);
                    }
                }
            } else {
                if (callback != null) {
                    callback(ret);
                }
                self.room_type = ret.room_type;
                self.scene = ret.scene;
                self.e_roomid = ret.roomid;
                cc.vv.gameNetMgr.connectGameServer(ret);
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            roomid: roomId
        };
        cc.vv.wc.show("正在进入房间 " + roomId);
        cc.vv.http.sendRequest("/enter_private_room", data, onEnter);
    },
    // 获取历史战斗记录
    getHistoryList: function getHistoryList(callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret.history);
                if (callback != null) {
                    callback(ret.history);
                }
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_history_list", data, onGet);
    },
    // 获取金币和钻石数量
    getGemsAndCoins: function getGemsAndCoins(callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret);
                if (callback != null) {
                    callback(ret);
                }
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_user_gems_and_coins", data, onGet);
    },
    // 用户签到
    setUserSign: function setUserSign(callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                if (callback != null) {
                    callback(ret.data);
                }
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/set_user_sign", data, onGet);
    },
    // 获取签到礼物列表
    getSignList: function getSignList(callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                if (callback != null) {
                    callback(ret.data);
                }
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign
        };
        cc.vv.http.sendRequest("/get_sign_list", data, onGet);
    },
    getGamesOfRoom: function getGamesOfRoom(uuid, callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret.data);
                callback(ret.data);
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            uuid: uuid
        };
        cc.vv.http.sendRequest("/get_games_of_room", data, onGet);
    },
    getDetailOfGame: function getDetailOfGame(uuid, index, callback) {
        var self = this;
        var onGet = function onGet(ret) {
            if (ret.errcode !== 0) {
                console.log(ret.errmsg);
            } else {
                console.log(ret.data);
                callback(ret.data);
            }
        };
        var data = {
            account: cc.vv.userMgr.account,
            sign: cc.vv.userMgr.sign,
            uuid: uuid,
            index: index
        };
        cc.vv.http.sendRequest("/get_detail_of_game", data, onGet);
    }
});

cc._RFpop();
},{}],"UserSign":[function(require,module,exports){
"use strict";
cc._RFpush(module, '03612hS7chGjpJQKni4Wrqr', 'UserSign');
// scripts/components/UserSign.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _DayListV: null,
        _sign: null,
        _btn_sign: null,
        _btn_signed: null,
        _isShowView: false,
        _time: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        this._sign = cc.find("Canvas/sign");
        this._btn_sign = this._sign.getChildByName("btn_sign");
        this._btn_signed = this._sign.getChildByName("btn_signed");
        this._time = this._sign.getChildByName("time");
        this._DayListV = new Array();
        for (var i = 0; i < 7; i++) {
            var path = "day" + (i + 1);
            this._DayListV.push(this._sign.getChildByName(path));
        }
        this._isShowView = cc.vv.userMgr.is_sign == 0;
        this.initSignData();
    },
    initSignData: function initSignData() {
        var self = this;
        if (this._isShowView) {
            //签到按钮不可点击
            this._time.getComponent(cc.Label).string = "已登录" + cc.vv.userMgr.sign_days + "天";
            this._btn_sign.active = cc.vv.userMgr.sign_days < 6 && cc.vv.userMgr.is_sign == 0;
            this._btn_signed.active = cc.vv.userMgr.sign_days < 6 && cc.vv.userMgr.is_sign == 1;
            // this._btn_sign.getComponent(cc.Button).interactable = (cc.vv.userMgr.is_sign == 0);
            cc.vv.userMgr.getSignList(function (data) {
                console.log("------initSignData------->>", data);
                if (data) {
                    for (var i = 0; i < data.length; i++) {
                        var d = data[i];
                        var view = self._DayListV[i];
                        if (view) {
                            var name = view.getChildByName("name").getComponent(cc.Label);
                            name.string = d.name + "×" + d.amount;
                            var signed = view.getChildByName("signed");
                            if (signed) {
                                if (cc.vv.userMgr.sign_days > i) {
                                    signed.active = true;
                                    if (i == data.length - 1 && cc.vv.userMgr.sign_days > 6 && cc.vv.userMgr.is_sign == 0) {
                                        signed.active = false;
                                    }
                                }
                            }
                            var btn_sign = view.getChildByName("btn_sign");
                            if (btn_sign) {
                                btn_sign.active = cc.vv.userMgr.sign_days >= 6 && cc.vv.userMgr.is_sign == 0;
                                // btn_sign.getComponent(cc.Button).interactable = (cc.vv.userMgr.is_sign == 0);
                            }
                        }
                    }
                    self._sign.active = self._isShowView;
                }
            });
        } else {
            self._sign.active = self._isShowView;
        }
    },
    //签到
    onSignBtnClicked: function onSignBtnClicked() {
        if (cc.vv.userMgr.is_sign == 0) {
            var self = this;
            cc.vv.userMgr.setUserSign(function (data) {
                if (data) {
                    cc.vv.userMgr.is_sign = 1;
                    cc.vv.userMgr.sign_days++;
                    if (data.type == 1) {
                        cc.vv.userMgr.gems += data.amount;
                    }
                    self.initSignData();
                }
            });
        } else {
            cc.vv.alert.show("提示", "今日已签到!");
        }
    },
    onCloseBtnClicked: function onCloseBtnClicked() {
        this._sign.active = false;
        this._isShowView = false;
    }
});

cc._RFpop();
},{}],"Utils":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b717fzww0hNzIqvNbb1t9wx', 'Utils');
// scripts/Utils.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },
    addClickEvent: function addClickEvent(node, target, component, handler, isReplace) {
        console.log(component + ":" + handler);
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;
        var clickEvents = node.getComponent(cc.Button).clickEvents;
        if (isReplace) {
            //是否覆盖掉之前的事件
            clickEvents[0] = eventHandler;
        } else {
            clickEvents.push(eventHandler);
        }
    },
    addSlideEvent: function addSlideEvent(node, target, component, handler) {
        var eventHandler = new cc.Component.EventHandler();
        eventHandler.target = target;
        eventHandler.component = component;
        eventHandler.handler = handler;
        var slideEvents = node.getComponent(cc.Slider).slideEvents;
        slideEvents.push(eventHandler);
    },
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
    showJinbi: function showJinbi(jinbi, suffix) {
        if (!suffix) {
            suffix = "万";
        }
        var jinbi = parseFloat(jinbi);
        if (jinbi >= 10000) {
            jinbi /= 10000;
            jinbi = jinbi + suffix;
            return jinbi;
        }
        return jinbi;
    },

    checkRate: function checkRate(nubmer) {
        //判断字符串是否为数字//
        // 　　var re = /^[0-9]+.?[0-9]*$/;  
        //判断正整数 /^[1-9]+[0-9]*]*$/ 
        var re = /^[0-9]+[0-9]*]*$/;
        if (!re.test(nubmer)) {
            return false;
        }
        return true;
    }
});

cc._RFpop();
},{}],"VoiceMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1f066RbLAxKGJZtkDFO2kq/', 'VoiceMgr');
// scripts/VoiceMgr.js

"use strict";

var radix = 12;
var base = 128 - radix;

function crypto(value) {
    value -= base;
    var h = Math.floor(value / radix) + base;
    var l = value % radix + base;
    return String.fromCharCode(h) + String.fromCharCode(l);
}
var encodermap = {};
var decodermap = {};
for (var i = 0; i < 256; ++i) {
    var code = null;
    var v = i + 1;
    if (v >= base) {
        code = crypto(v);
    } else {
        code = String.fromCharCode(v);
    }
    encodermap[i] = code;
    decodermap[code] = i;
}

function encode(data) {
    var content = "";
    var len = data.length;
    var a = len >> 24 & 0xff;
    var b = len >> 16 & 0xff;
    var c = len >> 8 & 0xff;
    var d = len & 0xff;
    content += encodermap[a];
    content += encodermap[b];
    content += encodermap[c];
    content += encodermap[d];
    for (var i = 0; i < data.length; ++i) {
        content += encodermap[data[i]];
    }
    return content;
}

function getCode(content, index) {
    var c = content.charCodeAt(index);
    if (c >= base) {
        c = content.charAt(index) + content.charAt(index + 1);
    } else {
        c = content.charAt(index);
    }
    return c;
}

function decode(content) {
    var index = 0;
    var len = 0;
    for (var i = 0; i < 4; ++i) {
        var c = getCode(content, index);
        index += c.length;
        var v = decodermap[c];
        len |= v << (3 - i) * 8;
    }
    var newData = new Uint8Array(len);
    var cnt = 0;
    while (index < content.length) {
        var c = getCode(content, index);
        index += c.length;
        newData[cnt] = decodermap[c];
        cnt++;
    }
    return newData;
}
cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        onPlayCallback: null,
        _voiceMediaPath: null
    },
    // use this for initialization
    init: function init() {
        if (cc.sys.isNative) {
            this._voiceMediaPath = jsb.fileUtils.getWritablePath() + "/voicemsgs/";
            this.setStorageDir(this._voiceMediaPath);
        }
    },
    prepare: function prepare(filename) {
        cc.vv.audioMgr.pauseAll();
        if (!cc.sys.isNative) {
            window.startRecord();
            return;
        }
        this.clearCache(filename);
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "prepare", "(Ljava/lang/String;)V", filename);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "prepareRecord:", filename);
        }
    },
    release: function release() {
        cc.vv.audioMgr.resumeAll();
        if (!cc.sys.isNative) {
            window.stopRecord();
            return;
        }
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "release", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "finishRecord");
        }
    },
    cancel: function cancel() {
        cc.vv.audioMgr.resumeAll();
        if (!cc.sys.isNative) {
            window.cancelRecord();
            window.voice.localId = null;
            return;
        }
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "cancel", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "cancelRecord");
        }
    },
    writeVoice: function writeVoice(filename, voiceData) {
        if (!cc.sys.isNative) {
            return;
        }
        if (voiceData && voiceData.length > 0) {
            var fileData = decode(voiceData);
            var url = this._voiceMediaPath + filename;
            this.clearCache(filename);
            jsb.fileUtils.writeDataToFile(fileData, url);
        }
    },
    clearCache: function clearCache(filename) {
        if (cc.sys.isNative) {
            var url = this._voiceMediaPath + filename;
            //console.log("check file:" + url);
            if (jsb.fileUtils.isFileExist(url)) {
                //console.log("remove:" + url);
                jsb.fileUtils.removeFile(url);
            }
            if (jsb.fileUtils.isFileExist(url + ".wav")) {
                //console.log("remove:" + url + ".wav");
                jsb.fileUtils.removeFile(url + ".wav");
            }
        }
    },
    play: function play(filename) {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.pauseAll();
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoicePlayer", "play", "(Ljava/lang/String;)V", filename);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "play:", filename);
        } else {}
    },
    stop: function stop() {
        if (!cc.sys.isNative) {
            return;
        }
        cc.vv.audioMgr.resumeAll();
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoicePlayer", "stop", "()V");
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "stopPlay");
        } else {}
    },
    getVoiceLevel: function getVoiceLevel(maxLevel) {
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            return jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "getVoiceLevel", "(I)I", maxLevel);
        } else if (cc.sys.os == cc.sys.OS_IOS) {} else {
            return Math.floor(Math.random() * maxLevel + 1);
        }
    },
    getVoiceData: function getVoiceData(filename) {
        if (cc.sys.isNative) {
            var url = this._voiceMediaPath + filename;
            console.log("getVoiceData:" + url);
            var fileData = jsb.fileUtils.getDataFromFile(url);
            if (fileData) {
                var content = encode(fileData);
                return content;
            }
        }
        return "";
    },
    download: function download() {},
    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {
    // },
    setStorageDir: function setStorageDir(dir) {
        if (!cc.sys.isNative) {
            return;
        }
        if (cc.sys.os == cc.sys.OS_ANDROID) {
            jsb.reflection.callStaticMethod("com/vivigames/voicesdk/VoiceRecorder", "setStorageDir", "(Ljava/lang/String;)V", dir);
        } else if (cc.sys.os == cc.sys.OS_IOS) {
            jsb.reflection.callStaticMethod("VoiceSDK", "setStorageDir:", dir);
            if (!jsb.fileUtils.isDirectoryExist(dir)) {
                jsb.fileUtils.createDirectory(dir);
            }
        }
    }
});

cc._RFpop();
},{}],"Voice":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f6db9z0CxdEzpRVgU569dDu', 'Voice');
// scripts/components/Voice.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _lastTouchTime: null,
        _voice: null,
        _volume: null,
        _voice_failed: null,
        _lastCheckTime: -1,
        _timeBar: null,
        MAX_TIME: 15000,
        _voiceTime: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        this._voice = cc.find("Canvas/voice");
        this._voice.active = false;
        this._voice_failed = cc.find("Canvas/voice/voice_failed");
        this._voice_failed.active = false;
        this._timeBar = cc.find("Canvas/voice/time");
        this._timeBar.scaleX = 0.0;
        this._volume = cc.find("Canvas/voice/volume");
        for (var i = 1; i < this._volume.children.length; ++i) {
            this._volume.children[i].active = false;
        }
        var btnVoice = cc.find("Canvas/voice/voice_failed/btn_ok");
        if (btnVoice) {
            cc.vv.utils.addClickEvent(btnVoice, this.node, "Voice", "onBtnOKClicked");
        }
        var self = this;
        var btnVoice = cc.find("Canvas/btn_voice");
        if (btnVoice) {
            btnVoice.on(cc.Node.EventType.TOUCH_START, function () {
                console.log("cc.Node.EventType.TOUCH_START");
                // 关掉所有音乐
                cc.vv.voiceMgr.prepare("record.amr");
                self._lastTouchTime = Date.now();
                self._voice.active = true;
                self._voice_failed.active = false;
            });
            btnVoice.on(cc.Node.EventType.TOUCH_MOVE, function () {
                console.log("cc.Node.EventType.TOUCH_MOVE");
            });
            btnVoice.on(cc.Node.EventType.TOUCH_END, function () {
                console.log("cc.Node.EventType.TOUCH_END");
                if (Date.now() - self._lastTouchTime < 1000) {
                    self._voice_failed.active = true;
                    cc.vv.voiceMgr.cancel();
                } else {
                    // 录音结束并上传
                    cc.vv.voiceMgr.release();
                    self.onVoiceOK();
                }
            });
            btnVoice.on(cc.Node.EventType.TOUCH_CANCEL, function () {
                console.log("cc.Node.EventType.TOUCH_CANCEL");
                cc.vv.voiceMgr.cancel();
                this._voice.active = false;
                self._lastTouchTime = null;
                self._voice.active = false;
            });
        }
    },
    onVoiceOK: function onVoiceOK() {
        console.log("onVoiceOK!!!!" + this._lastTouchTime);
        this._voice.active = false;
        if (this._lastTouchTime != null) {
            this._voiceTime = Date.now() - this._lastTouchTime;
            console.log('时长是多少' + this._voiceTime);
        }
        self._lastTouchTime = null;
    },
    // 发送语音到服务器
    sendVoice: function sendVoice() {
        if (window.voice.serverId && this._voiceTime) {
            console.log("发送语音消息到服务器");
            cc.vv.net.send("voice_msg", {
                msg: window.voice.serverId,
                time: this._voiceTime
            });
        }
        this._voiceTime = null;
        window.voice.serverId = null;
    },
    onBtnOKClicked: function onBtnOKClicked() {
        this._voice.active = false;
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._voice.active == true && this._voice_failed.active == false) {
            if (Date.now() - this._lastCheckTime > 300) {
                for (var i = 0; i < this._volume.children.length; ++i) {
                    this._volume.children[i].active = false;
                }
                var v = cc.vv.voiceMgr.getVoiceLevel(7);
                if (v >= 1 && v <= 7) {
                    this._volume.children[v - 1].active = true;
                }
                this._lastCheckTime = Date.now();
            }
        }
        if (this._lastTouchTime) {
            var time = Date.now() - this._lastTouchTime;
            if (time >= this.MAX_TIME) {
                cc.vv.voiceMgr.release();
                this.onVoiceOK();
                this._voice.active = false;
                this._lastTouchTime = null;
            } else {
                var percent = time / this.MAX_TIME;
                this._timeBar.scaleX = 1 - percent;
            }
        };
        if (window.voice && window.voice.serverId != null) {
            console.log("id是多少" + window.voice.serverId);
            this.sendVoice();
        };
    }
});

cc._RFpop();
},{}],"WaitingConnection":[function(require,module,exports){
"use strict";
cc._RFpush(module, '10e32jDstpLhIGHWrQEq2vN', 'WaitingConnection');
// scripts/components/WaitingConnection.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        target: cc.Node,
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _isShow: false,
        lblContent: cc.Label
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return null;
        }
        cc.vv.wc = this;
        this.node.active = this._isShow;
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        this.target.rotation = this.target.rotation - dt * 45;
    },
    show: function show(content) {
        this._isShow = true;
        if (this.node) {
            this.node.active = this._isShow;
        }
        if (this.lblContent) {
            if (content == null) {
                content = "";
            }
            this.lblContent.string = content;
        }
    },
    hide: function hide() {
        this._isShow = false;
        if (this.node) {
            this.node.active = this._isShow;
        }
    }
});

cc._RFpop();
},{}],"ZjhChat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6fd6eAhiXpJLozuKlsRJdZY', 'ZjhChat');
// scripts/components/ZjhChat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        _chatRoot: null,
        _tabQuick: null,
        _tabEmoji: null,
        _iptChat: null,
        _quickChatInfo: null,
        _btnChat: null
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        cc.vv.zjhchat = this;
        // this._btnChat = this.node.getChildByName("xinxi");
        // this._btnChat.active = cc.vv.replayMgr.isReplay() == false;
        this._chatRoot = this.node.getChildByName("chat");
        this._chatRoot.active = false;
        this._tabQuick = this._chatRoot.getChildByName("quickchatlist");
        this._tabEmoji = this._chatRoot.getChildByName("emojis");
        this._iptChat = this._chatRoot.getChildByName("iptChat").getComponent(cc.EditBox);
        this._quickChatInfo = {};
        this._quickChatInfo["item0"] = {
            index: 0,
            content: "快点啊，都等到我花儿都谢谢了！",
            sound: "fix_msg_1.mp3"
        };
        this._quickChatInfo["item1"] = {
            index: 1,
            content: "怎么又断线了，网络怎么这么差啊！",
            sound: "fix_msg_2.mp3"
        };
        this._quickChatInfo["item2"] = {
            index: 2,
            content: "不要走，决战到天亮！",
            sound: "fix_msg_3.mp3"
        };
        this._quickChatInfo["item3"] = {
            index: 3,
            content: "你的牌打得也太好了！",
            sound: "fix_msg_4.mp3"
        };
        this._quickChatInfo["item4"] = {
            index: 4,
            content: "你是妹妹还是哥哥啊？",
            sound: "fix_msg_5.mp3"
        };
        this._quickChatInfo["item5"] = {
            index: 5,
            content: "和你合作真是太愉快了！",
            sound: "fix_msg_6.mp3"
        };
        this._quickChatInfo["item6"] = {
            index: 6,
            content: "大家好，很高兴见到各位！",
            sound: "fix_msg_7.mp3"
        };
        this._quickChatInfo["item7"] = {
            index: 7,
            content: "各位，真是不好意思，我得离开一会儿。",
            sound: "fix_msg_8.mp3"
        };
        this._quickChatInfo["item8"] = {
            index: 8,
            content: "不要吵了，专心玩游戏吧！",
            sound: "fix_msg_9.mp3"
        };
    },
    getQuickChatInfo: function getQuickChatInfo(index) {
        var key = "item" + index;
        return this._quickChatInfo[key];
    },

    onBtnChatClicked: function onBtnChatClicked() {
        this._chatRoot.active = true;
    },
    onBgClicked: function onBgClicked() {
        this._chatRoot.active = false;
    },
    onTabClicked: function onTabClicked(event) {
        if (event.target.name == "tabQuick") {
            this._tabQuick.active = true;
            this._tabEmoji.active = false;
        } else if (event.target.name == "tabEmoji") {
            this._tabQuick.active = false;
            this._tabEmoji.active = true;
        }
    },
    onQuickChatItemClicked: function onQuickChatItemClicked(event) {
        this._chatRoot.active = false;
        var info = this._quickChatInfo[event.target.name];
        cc.vv.net.send("quick_chat", info.index);
    },
    onEmojiItemClicked: function onEmojiItemClicked(event) {
        console.log(event.target.name);
        this._chatRoot.active = false;
        cc.vv.net.send("emoji", event.target.name);
    },
    onBtnSendChatClicked: function onBtnSendChatClicked() {
        this._chatRoot.active = false;
        if (this._iptChat.string == "") {
            return;
        }
        cc.vv.net.send("chat", this._iptChat.string);
        this._iptChat.string = "";
    }
});

cc._RFpop();
},{}],"ZjhNetMgr":[function(require,module,exports){
"use strict";
cc._RFpush(module, '716cd2QI4dOx5YesLOt4bWV', 'ZjhNetMgr');
// scripts/ZjhNetMgr.js

"use strict";

cc.Class({
    extends: cc.Component,
    initHandlers: function initHandlers(GameNet) {
        var self = GameNet;
        cc.vv.net.addHandler("login_result", function (data) {
            console.log(data);
            if (data.errcode === 0) {
                var data = data.data;
                self.roomId = data.roomid;
                self.room_type = data.conf.room_type;
                self.conf = data.conf;
                self.maxNumOfGames = data.conf.maxGames;
                self.numOfGames = data.numofgames;
                self.seats = data.seats;
                self.seatIndex = self.getSeatIndexByID(cc.vv.userMgr.userId);
                self.isOver = false;
            } else if (data.errcode === 4) {
                //重新login
                var data = data.data;
                cc.vv.net.send('login', data);
            } else {
                console.log(data.errmsg);
            }
        });
        cc.vv.net.addHandler("login_finished", function (data) {
            cc.director.loadScene("zjhgame");
        });
        cc.vv.net.addHandler("exit_result", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.seats = null;
            if (data) {
                //特殊情况下（锦标赛等）可以设置这里的data，在退出的时候进行操作
                self.actionData = data;
            }
        });
        cc.vv.net.addHandler("exit_notify_push", function (data) {
            var userId = data;
            var s = self.getSeatByID(userId);
            if (s != null) {
                s.userid = 0;
                s.name = "";
                self.dispatchEvent("user_state_changed", s);
            }
        });
        cc.vv.net.addHandler("count_down_push", function (data) {
            self.dispatchEvent("count_down", data);
        });
        cc.vv.net.addHandler("dispress_push", function (data) {
            self.roomId = null;
            self.turn = -1;
            self.seats = null;
        });
        cc.vv.net.addHandler("disconnect", function (data) {
            var actionData = self.actionData;
            self.dispatchEvent("exit_room");
            if (self.roomId == null) {
                if (actionData) {
                    if (actionData.msg) {
                        cc.vv.alert.show("提示", actionData.msg);
                    }
                    setTimeout(function () {
                        self.actionData = null;
                        cc.director.loadScene("newhall");
                    }, actionData.delay * 1000);
                } else {
                    cc.director.loadScene("newhall");
                }
                self.room_type = -1;
            } else {
                if (self.isOver == false) {
                    cc.vv.userMgr.oldRoomId = self.roomId;
                    self.dispatchEvent("disconnect");
                } else {
                    self.roomId = null;
                    self.room_type = -1;
                }
            }
        });
        cc.vv.net.addHandler("chat_push", function (data) {
            self.dispatchEvent("chat_push", data);
        });
        cc.vv.net.addHandler("quick_chat_push", function (data) {
            self.dispatchEvent("quick_chat_push", data);
        });
        cc.vv.net.addHandler("emoji_push", function (data) {
            self.dispatchEvent("emoji_push", data);
        });
        cc.vv.net.addHandler("new_user_comes_push", function (data) {
            var seatIndex = data.seatindex;
            if (self.seats[seatIndex].userid > 0) {
                self.seats[seatIndex].online = true;
            } else {
                data.online = true;
                self.seats[seatIndex] = data;
            }
            self.dispatchEvent('new_user', self.seats[seatIndex]);
        });
        cc.vv.net.addHandler("game_checkPai_push", function (data) {
            console.log(data);
            self.dispatchEvent('kanpai', data);
        });
        cc.vv.net.addHandler("game_losed_push", function (data) {
            self.dispatchEvent('qipai', data);
        });
        cc.vv.net.addHandler("game_wannaToCompare_push", function (data) {
            self.dispatchEvent('game_wannaToCompare_push', data);
        });
        //弃牌通知 game_userInlosed_push
        cc.vv.net.addHandler("game_userInlosed_push", function (data) {
            self.dispatchEvent('qiPai_notify', data);
        });
        cc.vv.net.addHandler("game_myTurn_push", function (data) {
            self.dispatchEvent('game_myTurn_push', data);
        });
        cc.vv.net.addHandler("game_turnChanged_push", function (data) {
            self.dispatchEvent('game_turnChanged_push', data);
        });
        cc.vv.net.addHandler("game_timerInitCounter_push", function (data) {
            self.dispatchEvent('game_timerInitCounter_push', data);
        });
        cc.vv.net.addHandler("guo_notify_push", function (data) {
            self.dispatchEvent('guo_notify_push', data);
        });
        cc.vv.net.addHandler("game_myWin_push", function (data) {
            //我赢了
            // self.dispatchEvent('win', data);
        });
        cc.vv.net.addHandler("gameOver_notify_push", function (data) {
            //游戏结束清除定时器
            self.dispatchEvent('gameOver_notify_push', data);
        });
        cc.vv.net.addHandler("game_oneInWin_push", function (data) {
            //赢了
            self.dispatchEvent('win', data);
        });
        cc.vv.net.addHandler("game_begin_push", function (data) {
            self.button = data;
            self.turn = self.button;
            self.gamestate = "begin";
            self.dispatchEvent('game_begin', {
                currentZhu: data.currentZhu,
                turn: data.turn
            });
        });
        cc.vv.net.addHandler("game_myMoney_push", function (data) {
            console.log('game_myMoney_push');
            console.log(data);
            self.dispatchEvent('game_myMoney', data);
        });
        //没钱了通知前端，让其退出
        cc.vv.net.addHandler("game_noMoney_exit", function (data) {
            self.dispatchEvent('noMoney_exit', data);
        });
        //总注通知
        cc.vv.net.addHandler("game_moneyPool_push", function (data) {
            console.log('game_moneyPool_push');
            console.log(data);
            self.dispatchEvent('game_moneyPool', data);
        });
        //跟注通知
        cc.vv.net.addHandler("genZhu_notify_push", function (data) {
            console.log('genZhu_notify_push');
            console.log(data);
            self.dispatchEvent('genZhu_notify', data);
        });
        //看牌通知 game_oneInCheckPai_push
        cc.vv.net.addHandler("game_oneInCheckPai_push", function (data) {
            console.log('game_oneInCheckPai_push');
            console.log(data);
            self.dispatchEvent('kanPai_notify', data);
        });
        //加注通知 jiaZhu_notify_push
        cc.vv.net.addHandler("jiaZhu_notify_push", function (data) {
            console.log('jiaZhu_notify_push');
            console.log(data);
            self.dispatchEvent('jiaZhu_notify', data);
        });
        //提示消息通知
        cc.vv.net.addHandler("message_notify_push", function (data) {
            console.log('message_notify_push');
            console.log(data);
            self.dispatchEvent('message_notify', data);
        });
        //轮数通知
        cc.vv.net.addHandler("game_circleCount_push", function (data) {
            console.log('game_circleCount_push');
            console.log(data);
            self.dispatchEvent('game_circleCount', data);
        });
        //比牌结果通知 game_userInBipai_result_push
        cc.vv.net.addHandler("game_userInBipai_result_push", function (data) {
            console.log('game_userInBipai_result_push');
            console.log(data);
            self.dispatchEvent('game_userInBipai_result', data);
        });
        cc.vv.net.addHandler("game_actionChanged_push", function (data) {
            self.dispatchEvent('game_actionChanged_push', data);
        });
        cc.vv.net.addHandler("game_AntiResults_push", function (data) {
            self.dispatchEvent('game_AntiResults', data);
        });
        cc.vv.net.addHandler("game_userInfoById_push", function (data) {
            if (data) {
                self.dispatchEvent('game_userInfoById', data);
            }
        });
        cc.vv.net.addHandler("match_exit_error", function (data) {
            self.dispatchEvent('match_exit_error');
        });
        cc.vv.net.addHandler("game_gameInfoById_push", function (data) {
            if (data) {
                self.dispatchEvent('game_gameInfoById', data);
            }
        });
        cc.vv.net.addHandler("game_sbInAllIn_push", function (data) {
            if (data) {
                self.dispatchEvent('game_sbInAllIn', data);
            }
        });
    }
});

cc._RFpop();
},{}],"all":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f97f0CDR71Ceq9Qbzo/gS2o', 'all');
// scripts/zjh/all.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        lblRoomNo: {
            default: null,
            type: cc.Label
        },
        _seats: [],
        _timeLabel: null,
        _voiceMsgQueue: [],
        _lastPlayingSeat: null,
        _playingSeat: null,
        _lastPlayTime: null,
        _shareContent: null,
        paigroup: {
            default: null,
            type: cc.SpriteAtlas
        },
        back: cc.Node,
        fanhui: cc.Node,
        bg: cc.Node,
        helpbtn: cc.Node,
        helpshow: cc.Node,
        addzhudetail: null,
        ops: null,
        zhuobj: null,
        fan: cc.Node,
        backAlert: cc.Node,
        backAlert_no: cc.Node,
        countdown: cc.Label,
        _time: -1
    },
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        for (var i = 0; i < 5; i++) {
            this._seats.push(cc.find("Canvas/seat" + i).getComponent("zjhSeat"));
        }
        this._timeLabel = cc.find("Canvas/time").getComponent(cc.Label);
        this.addComponent("ReConnect");
        this._zhuomian = cc.find("Canvas/zhuomian");
        this.zhuobj = ['zhu0', 'zhu1', 'zhu2', 'zhu3', 'zhu0_hui', 'zhu1_hui', 'zhu2_hui', 'zhu3_hui'];
        this._edit = cc.find("Canvas/edit");
        this._graykanpai = this._edit.getChildByName('graykanpai');
        this._kanpai = this._edit.getChildByName('kanpai');
        this._graygenzhu = this._edit.getChildByName('graygenzhu');
        this._genzhu = this._edit.getChildByName('genzhu');
        this._grayjiazhu = this._edit.getChildByName('grayjiazhu');
        this._jiazhu = this._edit.getChildByName('jiazhu');
        this._grayqipai = this._edit.getChildByName('grayqipai');
        this._qipai = this._edit.getChildByName('qipai');
        this._graybipai = this._edit.getChildByName('graybipai');
        this._bipai = this._edit.getChildByName('bipai');
        this._allin = this._edit.getChildByName('allin');
        this._allZhuLabel = cc.find("Canvas/zongxiazhu/label").getComponent(cc.Label); //牌桌上所有的注
        this._zhu = cc.find("Canvas/zhu"); //加注界面
        this._danzhu = cc.find("Canvas/danzhu").getComponent(cc.Label); //单注显示
        this._lunshu = cc.find("Canvas/lunshu").getComponent(cc.Label); //轮数显示
        this._pkPanel = cc.find("Canvas/pk"); //pk界面
        this._flashAnim = cc.find("Canvas/pk/shandian/pk_shandian").getComponent(cc.Animation); //闪电动画
        this._bipaiAnim = cc.find("Canvas/pk/bipai").getComponent(cc.Animation); //比牌动画
        this._leftLie = this._pkPanel.getChildByName('leftLie');
        this._rightLie = this._pkPanel.getChildByName('rightLie');
        this._tips = cc.find("Canvas/tips").getComponent(cc.Label); //tips显示
        cc.vv.utils.addClickEvent(this._kanpai, this.node, "all", "kanpai");
        cc.vv.utils.addClickEvent(this.back, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.fanhui, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.fan, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.bg, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.helpbtn, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.helpshow, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.backAlert_no, this.node, "all", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._qipai, this.node, "all", "qipai");
        cc.vv.utils.addClickEvent(this._bipai, this.node, "all", "bipai");
        cc.vv.utils.addClickEvent(this._genzhu, this.node, "all", "genzhu");
        cc.vv.utils.addClickEvent(this._jiazhu, this.node, "all", "jiazhu");
        cc.vv.utils.addClickEvent(cc.find('Canvas/zhu/zhu0'), this.node, "all", "addzhu");
        cc.vv.utils.addClickEvent(cc.find('Canvas/zhu/zhu1'), this.node, "all", "addzhu");
        cc.vv.utils.addClickEvent(cc.find('Canvas/zhu/zhu2'), this.node, "all", "addzhu");
        cc.vv.utils.addClickEvent(cc.find('Canvas/zhu/zhu3'), this.node, "all", "addzhu");
        this.initView();
        this.initSeats();
        this.initEventHandlers();
        cc.vv.net.send("getUserInfoByUserid");
        cc.vv.net.send("getGameInfoByUserid");
        cc.vv.net.send("ready");
        cc.vv.audioMgr.playBGM("back.mp3");
    },
    initView: function initView() {
        this._kanpai.active = false;
        this._qipai.active = false;
        this._genzhu.active = false;
        this._allin.active = false;
        this._jiazhu.active = false;
        this._bipai.active = false;
        this._pkPanel.active = false;
        this._zhuomian.active = false;
        this._tips.node.active = true;
    },
    freshUserInfo: function freshUserInfo(data) {
        console.log('获取断线重连后的用户信息', data);
        var self = this;
        var seats = cc.vv.gameNetMgr.seats;
        for (var i = 0; i < seats.length; i++) {
            for (var t = 0; t < 3; t++) {
                cc.find('Canvas/seat' + i + '/fupai' + t).active = true;
            }
        }
        cc.find("Canvas/danzhu").active = true;
        cc.find("Canvas/lunshu").active = true;
        cc.find("Canvas/zongxiazhu").active = true;
        self._tips.node.active = false;
        self.countdown.node.active = false;
        self._kanpai.active = true;
        self._qipai.active = true;
        self._genzhu.active = data.canGenzhu;
        self._jiazhu.active = data.canAddZhu;
        self._bipai.active = data.canBiPai;
        self.ops = data.xiaZhuOptions;
        var holds = data.holds;
        if (holds && holds.length > 0) {
            var seat = self._seats[0];
            var spriteFrames = [];
            for (var i = 0; i < 3; i++) {
                spriteFrames.push(self.getpaiRes(holds[i]));
            }
            seat.fanPai(spriteFrames);
        }
    },
    freshGameInfo: function freshGameInfo(data) {
        console.log('获取断线重连后的游戏信息', data);
        if (this.ops) {
            var self = this;
            this.freshCurrentZhu(data.currentZhu);
            this.freshCircleCount(data.circleCount);
            this._zhuomian.active = true;
            var total = data.moneyPool;
            self._allZhuLabel.string = total; //总数
            //fresh其他人的数据
            var commonInfo = data.players;
            var allZhu = [];
            for (var i in commonInfo) {
                var temp = commonInfo[i];
                var userid = temp.userid;
                var costMoney = temp.costMoney; //下的注
                var money = temp.money; //所有用的钱
                //刷新这个人的信息
                var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userid);
                var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
                var seat = self._seats[localIndex];
                seat.setCostMoney(costMoney);
                seat.setMoney(money);
                var costArr = temp.costArr;
                for (var j in costArr) {
                    allZhu.push(costArr[j]);
                }
            }
            //添加桌面上的注
            for (var i in allZhu) {
                var zhu = allZhu[i];
                var node = self._zhuomian.children[0];
                var newNode = cc.instantiate(node);
                self._zhuomian.addChild(newNode);
                newNode.getChildByName('label').getComponent(cc.Label).string = cc.vv.utils.showJinbi(zhu, 'W');
                var zhuLevel = self.getZhuLevel(zhu);
                var zhuObj = cc.find('Canvas/zhu/' + self.zhuobj[zhuLevel]);
                var zhuFrameCopy = zhuObj.getComponent(cc.Sprite).spriteFrame;
                newNode.getComponent(cc.Sprite).spriteFrame = zhuFrameCopy;
                newNode.x = Math.random() * 200;
                newNode.y = Math.random() * 200;
                newNode.active = true;
            }
        }
    },
    getZhuLevel: function getZhuLevel(zhu) {
        var ops = this.ops;
        var zhuLevel = null;
        for (var i in ops) {
            if (parseInt(ops[i]) == parseInt(zhu)) {
                zhuLevel = i;
                break;
            }
        }
        if (zhuLevel == null) {
            for (var i in ops) {
                if (parseInt(ops[i]) == parseInt(zhu) * 0.5) {
                    zhuLevel = i;
                    break;
                }
            }
        }
        if (zhuLevel == null) {
            for (var i in ops) {
                if (parseInt(ops[i]) == parseInt(zhu) * 2) {
                    zhuLevel = i;
                    break;
                }
            }
        }
        return zhuLevel;
    },
    refreshBtns: function refreshBtns(data) {
        var seats = cc.vv.gameNetMgr.seats;
        for (var i = 0; i < seats.length; i++) {
            for (var t = 0; t < 3; t++) {
                cc.find('Canvas/seat' + i + '/fupai' + t).active = true;
            }
        }
        cc.find("Canvas/danzhu").active = true;
        cc.find("Canvas/lunshu").active = true;
        cc.find("Canvas/zongxiazhu").active = true;
        this._tips.node.active = false;
        this.countdown.node.active = false;
        this.freshCurrentZhu(data.currentZhu);
        this.freshCircleCount(data.turn);
        this._kanpai.active = true;
        this._qipai.active = true;
        this._genzhu.active = false;
        this._jiazhu.active = false;
        this._bipai.active = false;
        this.showXiaDiZhuAnim(data.currentZhu); //下底注动画
    },
    showXiaDiZhuAnim: function showXiaDiZhuAnim(currentZhu) {
        var children_baoliu = [];
        for (var i in this._zhuomian.children) {
            if (i < 5) {
                //只留5个底注的筹码
                children_baoliu.push(this._zhuomian.children[i]);
            }
            this._zhuomian.children[i].active = false;
        }
        this._zhuomian.removeAllChildren();
        for (var j in children_baoliu) {
            this._zhuomian.addChild(children_baoliu[j]);
        }
        this._zhuomian.active = true;
        var addMoney = 100;
        if (currentZhu) {
            addMoney = parseInt(currentZhu) * 0.5;
        }
        for (var k in this._seats) {
            if (!this._seats[k]._userName) {
                continue;
            };
            var data = {
                x: this._seats[k].node.x,
                y: this._seats[k].node.y,
                addMoney: addMoney,
                addMoneyLevel: 0
            };
            this.showZhuAnim(data, k);
        }
    },
    initEventHandlers: function initEventHandlers() {
        cc.vv.gameNetMgr.dataEventHandler = this.node;
        var self = this;
        this.node.on('new_user', function (data) {
            self.initSingleSeat(data.detail);
        });
        this.node.on('user_state_changed', function (data) {
            self.initSingleSeat(data.detail);
        });
        this.node.on('game_begin', function (data) {
            self.refreshBtns(data.detail);
            // self.initSeats();
        });
        this.node.on('game_num', function (data) {
            // self.refreshBtns();
        });
        this.node.on('voice_msg', function (data) {
            var data = data.detail;
            self._voiceMsgQueue.push(data);
            self.playVoice();
        });
        this.node.on('chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            self._seats[localIdx].chat(data.content);
        });
        this.node.on('quick_chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            var index = data.content;
            var info = cc.vv.zjhchat.getQuickChatInfo(index);
            self._seats[localIdx].chat(info.content);
            cc.vv.audioMgr.playSFX(info.sound);
        });
        this.node.on('emoji_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            self._seats[localIdx].emoji(data.content);
        });
        this.node.on('kanpai', function (event) {
            var data = event.detail;
            var holds = data.holds;
            var seat = self._seats[0];
            var spriteFrames = [];
            for (var i = 0; i < 3; i++) {
                spriteFrames.push(self.getpaiRes(holds[i]));
            }
            seat.fanPai(spriteFrames);
            var currentZhu = data.currentZhu;
            self._genzhu.getChildByName('num').getComponent(cc.Label).string = cc.vv.utils.showJinbi(currentZhu, 'W');
        });
        this.node.on('qipai', function (event) {
            var data = event.detail;
            if (data.status == 'shu') {
                cc.find('Canvas/seat0/shuicon').active = true;
            } else {
                cc.find('Canvas/seat0/qiicon').active = true;
            }
            self._grayqipai.active = true;
            self._qipai.active = false;
            var holds = data.holds;
            var seat = self._seats[0];
            var spriteFrames = [];
            for (var i = 0; i < 3; i++) {
                spriteFrames.push(self.getpaiRes(holds[i]));
            }
            seat.fanPai(spriteFrames);
        });
        this.node.on('game_myTurn_push', function (event) {
            var data = event.detail;
            self.addzhudetail = data.xiaZhuOptions;
            self.ops = data.xiaZhuExtra.ops;
            //可操作按钮
            if (data.canAddZhu) {
                self._jiazhu.active = true;
            }
            if (data.canGenzhu) {
                self._genzhu.active = true;
                var currentZhu = data.currentZhu;
                if (!data.hasCheckedPai) {
                    //暗注
                    currentZhu = currentZhu * 0.5;
                }
                self._genzhu.getChildByName('num').getComponent(cc.Label).string = cc.vv.utils.showJinbi(currentZhu, 'W');
            }
            if (data.canBiPai) {
                //满足比牌条件
                self._bipai.active = true;
            }
            if (data.allInFlag) {
                self._allin.active = true;
                // self._graygenzhu.active = false;
            } else {
                self._allin.active = false;
            }
        });
        this.node.on('gameOver_notify_push', function (event) {
            var i = cc.vv.gameNetMgr.getLocalIndexZJH(cc.vv.gameNetMgr.getSeatIndexByID(event.detail));
            cc.find('Canvas/seat' + i + '/toggle').active = false;
        });
        this.node.on('game_turnChanged_push', function (event) {
            var i = cc.vv.gameNetMgr.getLocalIndexZJH(cc.vv.gameNetMgr.getSeatIndexByID(event.detail));
            for (var t = 0; t < 5; t++) {
                cc.find('Canvas/seat' + t + '/toggle').active = false;
            }
            cc.find('Canvas/seat' + i + '/toggle').active = true;
            self._seats[i].setTime();
            if (i != 0) {
                //如果没有轮到自己操作
                self._genzhu.active = false;
                self._jiazhu.active = false;
                self._bipai.active = false;
                self._zhu.active = false;
            }
        });
        this.node.on('game_timerInitCounter_push', function (event) {
            // console.log("ly:timer counter begin");
            var i = cc.vv.gameNetMgr.getLocalIndexZJH(cc.vv.gameNetMgr.getSeatIndexByID(event.detail));
            for (var t = 0; t < 5; t++) {
                cc.find('Canvas/seat' + t + '/toggle').active = false;
            }
            cc.find('Canvas/seat' + i + '/toggle').active = true;
            self._seats[i].setTime();
        });
        this.node.on('game_actionChanged_push', function (event) {
            var bp = cc.find('Canvas/edit/bipai');
            var data = event.detail;
            if (data.xiaZhuOptions) self.addzhudetail = data.xiaZhuOptions;
            if (data.xiaZhuExtra.ops) self.ops = data.xiaZhuExtra.ops;
            if (event.detail.canBiPai) {
                bp.active = true;
            } else {
                bp.active = false;
            }
        });
        this.node.on('guo_notify_push', function (event) {
            cc.find('Canvas/seat0/toggle').active = false;
        });
        this.node.on('genZhu_notify', function (event) {
            var userid = event.detail.userid;
            var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userid);
            var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
            var seat = self._seats[localIndex];
            seat.showGenZhu();
            var currentZhu = event.detail.currentZhu;
            var hasCheckedPai = event.detail.hasCheckedPai;
            var addMoney = event.detail.addMoney;
            var addMoneyLevel = event.detail.addMoneyLevel;
            self.freshCurrentZhu(currentZhu);
            var data = {
                x: seat.node.x,
                y: seat.node.y,
                addMoney: addMoney,
                addMoneyLevel: addMoneyLevel,
                hasCheckedPai: hasCheckedPai
            };
            self.showZhuAnim(data);
        });
        this.node.on('kanPai_notify', function (event) {
            var userid = event.detail;
            var localIndex = cc.vv.gameNetMgr.getLocalIndexByUserIdZJH(userid);
            var seat = self._seats[localIndex];
            seat.showKanPai();
        });
        this.node.on('jiaZhu_notify', function (event) {
            var userid = event.detail.userid;
            var localIndex = cc.vv.gameNetMgr.getLocalIndexByUserIdZJH(userid);
            var seat = self._seats[localIndex];
            seat.showJiaZhu();
            var currentZhu = event.detail.currentZhu;
            var hasCheckedPai = event.detail.hasCheckedPai;
            var addMoney = event.detail.addMoney;
            var addMoneyLevel = event.detail.addMoneyLevel;
            self.freshCurrentZhu(currentZhu);
            var data = {
                x: seat.node.x,
                y: seat.node.y,
                addMoney: addMoney,
                addMoneyLevel: addMoneyLevel,
                hasCheckedPai: hasCheckedPai
            };
            self.showZhuAnim(data);
        });
        this.node.on('qiPai_notify', function (event) {
            var data = event.detail;
            var userid = data.userId;
            var localIndex = cc.vv.gameNetMgr.getLocalIndexByUserIdZJH(userid);
            var seat = self._seats[localIndex];
            seat.showQiPai(data.status);
        });
        this.node.on('win', function (data) {
            //赢了一局
            var data = data.detail;
            console.log('赢了一局', data);
            //赢的人显示手牌
            var userid = data.winer;
            var localIndex = cc.vv.gameNetMgr.getLocalIndexByUserIdZJH(userid);
            var seat = self._seats[localIndex];
            var holds = data.holds;
            var spriteFrames = [];
            for (var i = 0; i < 3; i++) {
                spriteFrames.push(self.getpaiRes(holds[i]));
            }
            seat.fanPai(spriteFrames);
            //赢了的动画
            self.endData = data;
            self.isEnd = true;
            if (!self._pkPanel.active) {
                self.showEndAnim();
            }
        });
        this.node.on('game_moneyPool', function (data) {
            //刷新总注
            data = data.detail;
            var total = data.moneyPool;
            self._allZhuLabel.string = total; //总数
            //fresh其他人的数据
            var commonInfo = data.commonInfo;
            for (var i in commonInfo) {
                var userid = i;
                var temp = commonInfo[i];
                var costMoney = temp.costMoney; //下的注
                var money = temp.money; //所有用的钱
                //刷新这个人的信息
                var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userid);
                var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
                var seats = cc.vv.gameNetMgr.seats;
                seats[seatIndex].score = money;
                var seat = self._seats[localIndex];
                seat.setCostMoney(costMoney);
                seat.setMoney(money);
            }
        });
        this.node.on('message_notify', function (data) {
            //消息显示
            data = data.detail;
            var message = data.message;
            cc.vv.alert.show("注意", message);
        });
        this.node.on('game_circleCount', function (data) {
            //刷新轮数
            var circleCount = data.detail;
            self.freshCircleCount(circleCount);
        });
        this.node.on('clickPkButton', function (data) {
            var userId2 = data.detail;
            self.clickPkButton(userId2);
        });
        this.node.on('game_userInBipai_result', function (data) {
            data = data.detail;
            var winer = data.winer;
            var loser = data.loser;
            self.bipaiAnimQueue = [{
                winer: winer,
                loser: loser
            }]; //比牌队列
            self.bipaiAnimIndex = 0;
            self.showBipaiAnim();
        });
        this.node.on('game_wannaToCompare_push', function (data) {
            data = data.detail;
            if (!data || data.length < 1) {
                self._tips.node.active = false;
                return;
            }
            self._tips.string = "请选择比牌玩家";
            self._tips.node.active = true;
            for (var i in data) {
                var userid = data[i].userid;
                var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userid);
                var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
                var seat = self._seats[localIndex];
                seat.showPkButton();
            }
        });
        this.node.on('count_down', function (data) {
            if (self._tips.node.active) {
                self._tips.node.active = false;
            }
            var data = data.detail;
            self.countdown.string = data.countDown;
            self.countdown.node.active = true;
            if (data.countDown <= 0) {
                self.countdown.node.active = false;
            }
        });
        this.node.on('game_AntiResults', function (data) {
            //最后一轮的比牌
            data = data.detail;
            self.bipaiAnimQueue = [];
            for (var i in data) {
                var bipaiData = data[i];
                var winer = bipaiData['winUserid'];
                var loser = bipaiData['loseUserid'];
                self.bipaiAnimQueue.push({
                    winer: winer,
                    loser: loser
                }); //比牌队列
            }
            self.bipaiAnimIndex = 0;
            self.showBipaiAnim();
        });
        this.node.on('game_userInfoById', function (data) {
            //获取断线重连后的用户信息
            data = data.detail;
            self.freshUserInfo(data);
        });
        this.node.on('game_gameInfoById', function (data) {
            //获取断线重连后的游戏信息
            data = data.detail;
            self.freshGameInfo(data);
        });
        this.node.on('exit_room', function (data) {
            //刷新用户钱币数量
            self.getGemsAndCoins();
        });
        this.node.on('noMoney_exit', function (data) {
            //提示金钱不足
            cc.vv.alert.show("提示", "金钱不足，您将退出房间，请在活动领取每日金币补助");
        });
        this.node.on('match_exit_error', function (data) {
            //锦标赛不能退出游戏
            cc.vv.alert.show("提示", "锦标赛中不能退出游戏");
        });
        this.node.on('game_sbInAllIn', function (data) {
            //有人allin了
            console.log('game_sbInAllIn=====>', data.detail);
            data = data.detail;
            self.doAllin(data, function () {
                cc.vv.net.send('allInActiveFromClient'); //触发下一步
            });
        });
    },
    //设置金币钻石数量
    getGemsAndCoins: function getGemsAndCoins() {
        var self = this;
        cc.vv.userMgr.getGemsAndCoins(function (data) {
            cc.vv.userMgr.gems = data.gems;
            cc.vv.userMgr.coins = data.coins;
        });
    },
    initSeats: function initSeats() {
        var seats = cc.vv.gameNetMgr.seats;
        if (!seats) return;
        for (var i = 0; i < seats.length; ++i) {
            this.initSingleSeat(seats[i]);
        }
    },
    initSingleSeat: function initSingleSeat(seat) {
        var index = cc.vv.gameNetMgr.getLocalIndexZJH(seat.seatindex);
        var isOffline = !seat.online;
        // var isZhuang = seat.seatindex == cc.vv.gameNetMgr.button;
        this._seats[index].setInfo(seat.name, seat.score);
        this._seats[index].setReady(seat.ready);
        this._seats[index].setOffline(isOffline);
        this._seats[index].setID(seat.userid);
        this._seats[index].voiceMsg(false);
    },
    onBtnSettingsClicked: function onBtnSettingsClicked() {
        cc.vv.popupMgr.showSettings();
    },
    onBtnBackClicked: function onBtnBackClicked() {
        cc.vv.alert.show("返回大厅", "返回大厅房间仍会保留，快去邀请大伙来玩吧！", function () {
            cc.director.loadScene("hall");
        }, true);
    },
    onBtnChatClicked: function onBtnChatClicked() {},
    // 点击分享按钮，使用微信分享
    onBtnWeichatClicked: function onBtnWeichatClicked() {
        cc.vv.share.show();
    },
    onBtnDissolveClicked: function onBtnDissolveClicked() {
        cc.vv.alert.show("解散房间", "解散房间不扣金币，是否确定解散？", function () {
            cc.vv.net.send("dispress");
        }, true);
    },
    onBtnExit: function onBtnExit() {
        this.backAlert.active = false;
        cc.vv.net.send("exit");
    },
    onBtnExchange: function onBtnExchange() {
        this.backAlert.active = false;
        cc.vv.userMgr.exchange = 1;
        cc.vv.net.send("exit");
    },
    playVoice: function playVoice() {
        if (this._playingSeat == null && this._voiceMsgQueue.length) {
            console.log("playVoice");
            var data = this._voiceMsgQueue.shift();
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            this._playingSeat = localIndex;
            this._seats[localIndex].voiceMsg(true);
            var msgInfo = JSON.parse(data.content);
            var msgfile = "voicemsg.amr";
            this._lastPlayTime = Date.now() + msgInfo.time;
            if (!cc.sys.isNative) {
                var serverid = msgInfo['msg'];
                window.downloadVoice(serverid);
                return;
            }
            cc.vv.voiceMgr.writeVoice(msgfile, msgInfo.msg);
            cc.vv.voiceMgr.play(msgfile);
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (window.voice && window.voice.localId != null) {
            var localId = window.voice.localId;
            window.voice.localId = null;
            cc.vv.audioMgr.pauseAll();
            window.playVoice(localId);
        }
        var minutes = Math.floor(Date.now() / 1000 / 60);
        if (this._lastMinute != minutes) {
            this._lastMinute = minutes;
            var date = new Date();
            var h = date.getHours();
            h = h < 10 ? "0" + h : h;
            var m = date.getMinutes();
            m = m < 10 ? "0" + m : m;
            this._timeLabel.string = "" + h + ":" + m;
        }
        if (this._lastPlayTime != null) {
            if (Date.now() > this._lastPlayTime + 200) {
                this.onPlayerOver();
                this._lastPlayTime = null;
            }
        } else {
            this.playVoice();
        }
    },
    onPlayerOver: function onPlayerOver() {
        if (!cc.sys.isNative) {
            window.stopPlayVoice();
        };
        cc.vv.audioMgr.resumeAll();
        console.log("onPlayCallback:" + this._playingSeat);
        var localIndex = this._playingSeat;
        this._playingSeat = null;
        this._seats[localIndex].voiceMsg(false);
    },
    onDestroy: function onDestroy() {
        cc.vv.voiceMgr.stop();
        //        cc.vv.voiceMgr.onPlayCallback = null;
    },
    //点击看牌按钮
    kanpai: function kanpai() {
        cc.vv.net.send('kanpai');
    },
    //点击加注按钮，打开加注界面
    jiazhu: function jiazhu() {
        var self = this;
        for (var d in self.zhuobj) {
            cc.find('Canvas/zhu/' + self.zhuobj[d]).active = false;
        }
        self._zhu.active = true;
        for (var i in self.addzhudetail) {
            if (self.inObject(self.addzhudetail[i], self.ops)) {
                self._zhu.getChildByName('zhu' + i).active = true;
                self._zhu.getChildByName('zhu' + i).getChildByName('label').getComponent(cc.Label).string = cc.vv.utils.showJinbi(self.addzhudetail[i], 'W');
            } else {
                self._zhu.getChildByName('zhu' + i + '_hui').active = true;
                self._zhu.getChildByName('zhu' + i + '_hui').getChildByName('label').getComponent(cc.Label).string = cc.vv.utils.showJinbi(self.addzhudetail[i], 'W');
            };
        }
    },
    //点击比牌按钮
    bipai: function bipai() {
        cc.vv.net.send('wannaToComparePai');
        //显示其他人的pk按钮，选择和谁比牌
        // this.showOthersPkButton();
    },
    clickPkButton: function clickPkButton(userId2) {
        this.hideOhersPkButton();
        var userId1 = cc.vv.userMgr.userId; //自己
        cc.vv.net.send('bipai', {
            userId1: userId1,
            userId2: userId2
        });
    },
    //点击弃牌按钮
    qipai: function qipai() {
        cc.vv.net.send('qipai');
    },
    //点击跟注按钮
    genzhu: function genzhu() {
        cc.vv.net.send('genzhu');
    },
    addzhu: function addzhu(e) {
        var self = this,
            num;
        var index = e.target.name.split('zhu')[1];
        num = self.addzhudetail[index];
        console.log(num);
        cc.vv.net.send('addzhu', num);
        this._zhu.active = false;
    },
    getpaiRes: function getpaiRes(data) {
        var self = this;
        data = data + 1;
        var type, num, huase_big, huase_small;
        num = (data % 100).toString();
        if (data > 0 && data < 14) {
            type = '04'; //黑桃
            num = num + '-1'; //黑牌
        } else if (data > 100 && data < 114) {
            type = '03'; //红桃
            num = num + '-2'; //红牌
        } else if (data > 200 && data < 214) {
            type = '02'; //梅花
            num = num + '-1'; //黑牌
        } else if (data > 300 && data < 314) {
            type = '01'; //方块
            num = num + '-2'; //红牌
        }
        huase_big = "huase_big" + type;
        huase_small = "huase_small" + type;
        var result = {
            num: self.paigroup.getSpriteFrame(num),
            huase_big: self.paigroup.getSpriteFrame(huase_big),
            huase_small: self.paigroup.getSpriteFrame(huase_small)
        };
        // if (num == '1') num = 'A';
        // if (num == '11') num = 'J';
        // if (num == '12') num = 'Q';
        // if (num == '13') num = 'K';
        return result;
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name != "zhu") {
            cc.find('Canvas/zhu').active = false;
        }
        if (event.target.name == "back") {
            this.fanhui.active = true;
            this.helpshow.active = false;
            this.helpbtn.active = true;
        }
        if (event.target.name == "bg") {
            this.fanhui.active = false;
            this.helpshow.active = false;
            this.helpbtn.active = true;
        }
        if (event.target.name == "helpbtn") {
            this.helpshow.active = true;
            this.helpbtn.active = false;
            this.fanhui.active = false;
        }
        if (event.target.name == "fan") {
            this.fanhui.active = false;
            this.helpshow.active = false;
            this.helpbtn.active = true;
            this.backAlert.active = true;
        }
        if (event.target.name == "no") {
            this.fanhui.active = false;
            this.helpshow.active = false;
            this.helpbtn.active = true;
            this.backAlert.active = false;
        }
    },
    freshCurrentZhu: function freshCurrentZhu(current_zhu) {
        this._danzhu.string = "单注：" + current_zhu;
    },
    freshNumOfLun: function freshNumOfLun(num) {},
    restart: function restart() {
        this.clearEnd();
        this.initView();
        this.initSeats();
    },
    freshCircleCount: function freshCircleCount(circleCount) {
        this._lunshu.string = "轮数：" + (circleCount + 1) + "/15";
    },
    showPk: function showPk() {
        this._leftLie.active = false;
        this._rightLie.active = false;
        this._pkPanel.active = true;
        //播放比牌动画
        this._flashAnim.play('pk_shandian');
        this._bipaiAnim.play('bipai');
    },
    hidePk: function hidePk(data) {
        var self = this;
        setTimeout(function () {
            self.showLie(data);
            setTimeout(function () {
                self._pkPanel.active = false;
                self.bipaiAnimIndex++; //下一个比牌动画
                if (self.bipaiAnimIndex >= self.bipaiAnimQueue.length) {
                    //没有下一个动画了
                    if (self.isEnd) {
                        //如果标识为游戏结束
                        self.showEndAnim();
                    } else {
                        //如果没有结束,执行比牌系列动画结束后的回调函数
                        if (self.bipaiAnimCallback) {
                            self.bipaiAnimCallback();
                        }
                    }
                } else {
                    self.showBipaiAnim(); //执行下一个比牌动画
                }
            }, 1000);
        }, 1000);
    },
    showLie: function showLie(data) {
        //0-显示左边裂牌 1-显示右边裂牌
        if (data == 1) {
            this._rightLie.active = true;
        } else {
            this._leftLie.active = true;
        }
    },
    hideLie: function hideLie() {
        this._leftLie.active = false;
        this._rightLie.active = false;
    },
    showOthersPkButton: function showOthersPkButton() {
        for (var i in this._seats) {
            if (i == 0) continue;
            var seat = this._seats[i];
            seat.showPkButton();
        }
    },
    showZhuAnim: function showZhuAnim(data, dizhuLevel) {
        //下注动画
        if (!data) return;
        var x = data.x; //起始点X
        var y = data.y; //起始点Y
        var random_diff = Math.random() * 50;
        var endX = x * 0.2 + random_diff;
        var endY = y * 0.2 + random_diff;
        var addMoney = data.addMoney;
        var addMoneyLevel = data.addMoneyLevel;
        var node = this._zhuomian.children[0];
        var newNode = cc.instantiate(node);
        if (typeof dizhuLevel != 'undefined') {
            //如果是底注本身
            newNode = this._zhuomian.children[dizhuLevel];
            endX = newNode.x;
            endY = newNode.y;
        } else {
            this._zhuomian.addChild(newNode);
        }
        newNode.getChildByName('label').getComponent(cc.Label).string = cc.vv.utils.showJinbi(addMoney, 'W');
        var zhuObj = cc.find('Canvas/zhu/' + this.zhuobj[addMoneyLevel]);
        var zhuFrameCopy = zhuObj.getComponent(cc.Sprite).spriteFrame;
        newNode.getComponent(cc.Sprite).spriteFrame = zhuFrameCopy;
        newNode.x = x;
        newNode.y = y;
        newNode.active = true;
        var action = cc.moveTo(0.4, cc.p(endX, endY));
        newNode.runAction(action);
    },
    hideOhersPkButton: function hideOhersPkButton() {
        var self = this;
        self._tips.node.active = false;
        for (var i in this._seats) {
            if (i == 0) continue;
            var seat = this._seats[i];
            seat.hidePkButton();
        }
    },
    inObject: function inObject(data, obj) {
        var f = false;
        for (var i in obj) {
            if (data == obj[i]) {
                f = true;
                break;
            }
        }
        return f;
    },
    //结束动画
    showEndAnim: function showEndAnim() {
        var self = this;
        var data = self.endData;
        if (data) {
            var win_userid = data.winer;
            var holds = data.holds;
            var win_seatIndex = cc.vv.gameNetMgr.getLocalIndexZJH(cc.vv.gameNetMgr.getSeatIndexByID(win_userid));
            //取得座位
            var win_seat = self._seats[win_seatIndex];
            win_seat.showYanhua(); //放烟花
            //筹码移动动画
            // self._zhuomian.active = true;
            for (var i in self._zhuomian.children) {
                var node = self._zhuomian.children[i];
                var action = cc.moveTo(2, cc.p(win_seat.node.x, win_seat.node.y));
                node.oldX = node.x;
                node.oldY = node.y;
                node.runAction(action);
            }
            setTimeout(function () {
                // self._zhuomian.active = false;
                if (self._zhuomian) {
                    for (var i in self._zhuomian.children) {
                        var node = self._zhuomian.children[i];
                        if (node.oldX) {
                            node.x = node.oldX;
                        }
                        if (node.oldY) {
                            node.y = node.oldY;
                        }
                    }
                    //重新开始一局
                    self.restart();
                }
            }, 1500);
        }
    },
    clearEnd: function clearEnd() {
        var self = this;
        self.isEnd = false;
        self.endData = null;
        self._tips.string = "正在等待下一局游戏";
        self._tips.node.active = true;
        setTimeout(function () {
            cc.vv.net.send('ready');
        }, 1000);
    },
    //比牌动画
    showBipaiAnim: function showBipaiAnim() {
        var self = this;
        var bipaiData = self.bipaiAnimQueue[self.bipaiAnimIndex];
        var winer = bipaiData['winer'];
        var loser = bipaiData['loser'];
        var lpx = cc.find('Canvas/pk/leftPai').x,
            lpy = cc.find('Canvas/pk/leftPai').y,
            rpx = cc.find('Canvas/pk/rightPai').x,
            rpy = cc.find('Canvas/pk/rightPai').y;
        var WseatIndex = cc.vv.gameNetMgr.getSeatIndexByID(winer),
            LseatIndex = cc.vv.gameNetMgr.getSeatIndexByID(loser);
        var WlocalIndex = cc.vv.gameNetMgr.getLocalIndexZJH(WseatIndex),
            LlocalIndex = cc.vv.gameNetMgr.getLocalIndexZJH(LseatIndex);
        var b1 = cc.find('Canvas/seat' + WlocalIndex),
            b2 = cc.find('Canvas/seat' + LlocalIndex);
        cc.find('Canvas/pk/leftPai').x = b1.x;
        cc.find('Canvas/pk/leftPai').y = b1.y;
        cc.find('Canvas/pk').active = true;
        cc.find('Canvas/pk/leftPai').active = true;
        cc.find('Canvas/pk/rightPai').x = b2.x;
        cc.find('Canvas/pk/rightPai').y = b2.y;
        cc.find('Canvas/pk/rightPai').active = true;
        var action1 = cc.moveTo(0.4, cc.p(lpx, lpy)),
            action2 = cc.moveTo(0.4, cc.p(rpx, rpy));
        cc.find('Canvas/pk/leftPai').runAction(action1);
        cc.find('Canvas/pk/rightPai').runAction(action2);
        self.hideLie();
        setTimeout(function () {
            self.showPk();
            self.hidePk(1);
        }, 400);
    },
    //孤注一掷
    allin: function allin() {
        cc.vv.net.send('all_in');
    },
    //孤注一掷动画
    doAllin: function doAllin(data, callback) {
        var userid = data.userid; //发起孤注一掷的那个人
        var status = data.status; //0-输了 1-赢了
        var self = this;
        self.bipaiAnimQueue = [];
        for (var i in self._seats) {
            var seatData = self._seats[i];
            var seatUserId = seatData['_userId'];
            if (!seatUserId || seatUserId == userid) continue;
            var winer, loser;
            if (status == 0) {
                winer = seatUserId;
                loser = userid;
            } else {
                winer = userid;
                loser = seatUserId;
            }
            self.bipaiAnimQueue.push({
                winer: winer,
                loser: loser
            }); //比牌队列
        }
        self.bipaiAnimIndex = 0;
        self.showBipaiAnim();
        if (callback) {
            self.bipaiAnimCallback = callback;
        }
    }
});

cc._RFpop();
},{}],"dnAll":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5d3d7MtJTxAp5XWAMAAK+RL', 'dnAll');
// scripts/dn/dnAll.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        lblRoomNo: {
            default: null,
            type: cc.Label
        },
        _seats: [],
        _timeLabel: null,
        _voiceMsgQueue: [],
        _lastPlayingSeat: null,
        _playingSeat: null,
        _lastPlayTime: null,
        _shareContent: null,
        paigroup: {
            default: null,
            type: cc.SpriteAtlas
        },
        back: cc.Node,
        fanhui: cc.Node,
        bg: cc.Node,
        backAlert: cc.Node,
        backAlert_no: cc.Node,
        fan: cc.Node,
        jinbi: cc.Node,
        countdown: cc.Label
    },
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        for (var i = 0; i < 5; i++) {
            this._seats.push(cc.find("Canvas/seat" + i).getComponent("dnSeat"));
        }
        this._timeLabel = cc.find("Canvas/time").getComponent(cc.Label);
        this._tips = cc.find("Canvas/tips").getComponent(cc.Label);
        this._difen = cc.find("Canvas/difen").getComponent(cc.Label);
        this._qiangZhuTips = cc.find("Canvas/text1").getComponent(cc.Label);
        this._xiaBeiTips = cc.find("Canvas/text3").getComponent(cc.Label);
        this._lastResult = cc.find("Canvas/lastResult");
        this.addComponent("ReConnect");
        cc.vv.utils.addClickEvent(this.back, this.node, "dnAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.fanhui, this.node, "dnAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.fan, this.node, "dnAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.bg, this.node, "dnAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.backAlert_no, this.node, "dnAll", "onBtnClicked");
        this.initView();
        this.initSeats();
        this.initEventHandlers();
        cc.vv.net.send("ready");
        cc.vv.audioMgr.playBGM("back.mp3");
        this.qiangZhuLevel = [0, 1, 2, 3, 4]; //抢注的档次
        this.jinbi_node_arr = [];
    },
    initView: function initView() {
        this._tips.node.active = true;
        this._lastResult.active = false;
    },
    initSeats: function initSeats() {
        var seats = cc.vv.gameNetMgr.seats;
        for (var i = 0; i < seats.length; ++i) {
            this.initSingleSeat(seats[i]);
        }
    },
    initSingleSeat: function initSingleSeat(seat) {
        var index = cc.vv.gameNetMgr.getLocalIndexZJH(seat.seatindex);
        var isOffline = !seat.online;
        // var isZhuang = seat.seatindex == cc.vv.gameNetMgr.button;
        this._seats[index].setInfo(seat.name, seat.score);
        this._seats[index].setReady(seat.ready);
        this._seats[index].setOffline(isOffline);
        this._seats[index].setID(seat.userid);
        this._seats[index].voiceMsg(false);
    },
    onBtnSettingsClicked: function onBtnSettingsClicked() {
        cc.vv.popupMgr.showSettings();
    },
    // 点击分享按钮，使用微信分享
    onBtnWeichatClicked: function onBtnWeichatClicked() {
        cc.vv.share.show();
    },
    onBtnDissolveClicked: function onBtnDissolveClicked() {
        cc.vv.alert.show("解散房间", "解散房间不扣金币，是否确定解散？", function () {
            cc.vv.net.send("dispress");
        }, true);
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "back") {
            this.fanhui.active = true;
        }
        if (event.target.name == "bg") {
            this.fanhui.active = false;
        }
        if (event.target.name == "fan") {
            this.fanhui.active = false;
            this.backAlert.active = true;
        }
        if (event.target.name == "no") {
            this.fanhui.active = false;
            this.backAlert.active = false;
        }
    },
    onBtnExit: function onBtnExit() {
        this.backAlert.active = false;
        cc.vv.net.send("exit");
    },
    onBtnExchange: function onBtnExchange() {
        this.backAlert.active = false;
        this.fanhui.active = false;
        cc.vv.userMgr.exchange = 1;
        cc.vv.net.send("exit");
    },
    playVoice: function playVoice() {
        if (this._playingSeat == null && this._voiceMsgQueue.length) {
            console.log("playVoice");
            var data = this._voiceMsgQueue.shift();
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            this._playingSeat = localIndex;
            this._seats[localIndex].voiceMsg(true);
            var msgInfo = JSON.parse(data.content);
            var msgfile = "voicemsg.amr";
            this._lastPlayTime = Date.now() + msgInfo.time;
            if (!cc.sys.isNative) {
                var serverid = msgInfo['msg'];
                window.downloadVoice(serverid);
                return;
            }
            cc.vv.voiceMgr.writeVoice(msgfile, msgInfo.msg);
            cc.vv.voiceMgr.play(msgfile);
        }
    },
    initEventHandlers: function initEventHandlers() {
        cc.vv.gameNetMgr.dataEventHandler = this.node;
        var self = this;
        this.node.on('new_user', function (data) {
            //新人加入房间
            self.initSingleSeat(data.detail);
        });
        this.node.on('user_state_changed', function (data) {
            var seat = data.detail;
            var index = cc.vv.gameNetMgr.getLocalIndexZJH(seat.seatindex);
            self._seats[index].seatHide();
        });
        this.node.on('game_init', function (data) {
            var gameInfo = data.detail;
            if (!gameInfo) return;
            self.showDiFen(gameInfo.baseFen);
            self._tips.node.active = false;
            var seatDatas = {};
            if (gameInfo['players']) {
                for (var i in gameInfo['players']) {
                    var seatData = gameInfo['players'][i];
                    seatDatas[seatData['userid']] = seatData;
                }
            }

            self.refreshSeats(seatDatas);
        });
        this.node.on('not_exit', function (data) {
            cc.vv.userMgr.exchange = 0;
            cc.vv.alert.show('提示', '游戏进行中，无法退出房间');
        });
        this.node.on('game_begin', function (data) {
            self.countdown.node.active = false;
            var data = data.detail;
            //游戏开始
            console.log('游戏开始', data);
            var holds = data.holds;
            var maxQiangZhuangBeiShu = data.maxQiangZhuangBeiShu;
            console.log('holds===>', holds);
            self.showSelfPai(holds); //展示自己手上的四张手牌
            self.showQiangZhu(maxQiangZhuangBeiShu); //展示抢庄倍数
            self.showOtherSeat();
            self.showQiangZhuTips();
        });
        this.node.on('voice_msg', function (data) {
            var data = data.detail;
            self._voiceMsgQueue.push(data);
            self.playVoice();
        });
        this.node.on('chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            self._seats[localIdx].chat(data.content);
        });
        this.node.on('quick_chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            var index = data.content;
            var info = cc.vv.zjhchat.getQuickChatInfo(index);
            self._seats[localIdx].chat(info.content);
            cc.vv.audioMgr.playSFX(info.sound);
        });
        this.node.on('emoji_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.gameNetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.gameNetMgr.getLocalIndexZJH(idx);
            self._seats[localIdx].emoji(data.content);
        });
        this.node.on('show_qiang', function (data) {
            //有人抢庄
            var data = data.detail;
            var userId = data.userid;
            var beishu = data.beiShu;
            var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userId);
            var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
            var seat = self._seats[localIndex];
            seat.showQiangZhuText(beishu);
        });
        this.node.on('count_down', function (data) {
            if (self._tips.node.active) {
                self._tips.node.active = false;
            }
            var data = data.detail;
            self.countdown.string = data.countDown;
            self.countdown.node.active = true;
            if (data.countDown <= 0) {
                self.countdown.node.active = false;
            }
        });
        this.node.on('game_zhuangSelected', function (data) {
            //抢庄结束
            self.hideQiangZhuTips();
            self._seats[0].hideQiangZhu();
            //定庄
            var userId = data.detail;
            for (var i in self._seats) {
                var seat = self._seats[i];
                seat.hideQiangZhuText();
            }
            var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userId);
            var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
            var localSeat = self._seats[localIndex];
            localSeat.showZhuang();
            //定完庄后，激活服务器
            cc.vv.net.send('zhuangEndFromClient');
        });
        this.node.on('game_myXzBegin', function (data) {
            //下注
            self.showXiaZhuTips(); //显示下注提示
            var data = data.detail;
            var seat = self._seats[0];
            seat.showXiaBei(data);
        });
        this.node.on('game_myXzEnd', function (data) {
            //下注结束
            self.hideXiaZhuTips();
            self._seats[0].hideXiaBei();
        });
        this.node.on('show_beiShuText', function (data) {
            //显示下的倍数
            var data = data.detail;
            var userId = data.userid;
            var beiShu = data.beiShu;
            self.showBeiShuText(userId, beiShu);
        });
        this.node.on('game_myHoldsUpdate', function (data) {
            //发最后一张手牌
            var holds = data.detail;
            self.showSelfPai(holds); //展示手牌
            self.showYouShi();
            self.showCount();
        });
        this.node.on('game_b_OneSnEnd', function (data) {
            //算牛结束
            var userId = data.detail;
            var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userId);
            var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
            var localSeat = self._seats[localIndex];
            localSeat.snEnd();
        });
        this.node.on('match_exit_error', function (data) {
            //锦标赛不能退出游戏
            cc.vv.alert.show("提示", "锦标赛中不能退出游戏");
        });
        this.node.on('game_showAllUser', function (data) {
            //游戏结束
            var data = data.detail;
            var moneyFlows = data.moneyFlows;
            var players = data.players;
            var zhuang_userId = null;
            var type = null;
            for (var i in players) {
                var player = players[i];
                if (player.isZhuang) {
                    zhuang_userId = player.userid;
                }
                if (cc.vv.userMgr.userId == player.userid) {
                    //判断自己的输赢
                    if (player.status == 'win') {
                        type = 1;
                    } else {
                        type = 2;
                    }
                }
            }
            var user_arr_toZhuang = []; //流向庄
            var user_arr_fromZhuang = []; //从庄来
            for (var j in moneyFlows) {
                var moneyFlow = moneyFlows[j];
                if (moneyFlow.to == zhuang_userId) {
                    user_arr_toZhuang.push(moneyFlow);
                }
                if (moneyFlow.from == zhuang_userId) {
                    user_arr_fromZhuang.push(moneyFlow);
                }
            }
            self.showLastPai(players, function () {
                self.showLastResult(type); //显示本人输赢
                setTimeout(function () {
                    self.hideLastResult();
                    self.hideLastPai();
                    if (self._tips) {
                        self._tips.node.active = true;
                    }
                    self.showMoneyFlowsAnim(user_arr_toZhuang, user_arr_fromZhuang, function () {
                        self.showMoneyChange(players);
                        setTimeout(function () {
                            //showMoneyChange执行时间为2秒
                            cc.vv.net.send('ready');
                        }, 2000);
                    });
                }, 1500); //显示输赢的时间
            });
        });
        this.node.on('exit_room', function (data) {
            //刷新用户钱币数量
            self.getGemsAndCoins();
        });
    },
    refreshSeats: function refreshSeats(seatDatas) {
        for (var i in this._seats) {
            var seat = this._seats[i];
            var seatData = seatDatas[seat._userId];
            if (seatData) {
                seat._score = seatData['money'];
            }
            seat.refresh();
        }
    },
    //设置金币钻石数量
    getGemsAndCoins: function getGemsAndCoins() {
        var self = this;
        cc.vv.userMgr.getGemsAndCoins(function (data) {
            cc.vv.userMgr.gems = data.gems;
            cc.vv.userMgr.coins = data.coins;
        });
    },
    showLastPai: function showLastPai(players, callback) {
        var self = this;
        //显示每个人的牌
        // var players_num = players.length;
        var player_index = 0;
        var fun = function fun() {
            if (player_index > players.length - 1) {
                clearInterval(interval);
                if (callback) {
                    callback();
                }
                return;
            }
            var player = players[player_index];
            var userId = player.userid;
            var holds = player.holds;
            var seat = self.getSeatByUserId(userId);
            var spriteFrames = [];
            for (var i in holds) {
                spriteFrames.push(self.getpaiRes(holds[i]));
            }
            seat.showLastPai(spriteFrames, player.score);
            player_index++;
        };
        var interval = setInterval(fun, 1000); //1秒显示一个
        fun();
    },
    hideLastPai: function hideLastPai() {
        for (var i in this._seats) {
            var seat = this._seats[i];
            seat.hideLastPai();
            seat.hideBeiShuText();
        }
    },
    showMoneyChange: function showMoneyChange(players) {
        var self = this;
        for (var i in players) {
            var player = players[i];
            var userId = player.userid;
            var seat = self.getSeatByUserId(userId);
            var money = player.money;
            if (seat) {
                seat.changeMoney(money);
            }
        }
    },
    getSeatByUserId: function getSeatByUserId(userId) {
        var self = this;
        var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userId);
        var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
        if (!self._seats) return null;
        var localSeat = self._seats[localIndex];
        return localSeat;
    },
    showMoneyFlowsAnim: function showMoneyFlowsAnim(user_arr_toZhuang, user_arr_fromZhuang, callback) {
        var self = this;
        //资金流动画
        //流向庄的金币动画
        self.buildMoneyFlowsAnimData(user_arr_toZhuang);
        self.execMoneyFlowsAnim(function () {
            //从庄流出的金币动画
            self.buildMoneyFlowsAnimData(user_arr_fromZhuang);
            self.execMoneyFlowsAnim(function () {
                if (callback) {
                    callback();
                }
            });
        });
    },
    buildMoneyFlowsAnimData: function buildMoneyFlowsAnimData(user_arr) {
        var self = this;
        //构造金币流数据
        for (var i in user_arr) {
            //起点
            var from_userId = user_arr[i].from;
            var fromSeat = self.getSeatByUserId(from_userId);
            var from_node = fromSeat.node;
            var start_x = from_node.x;
            var start_y = from_node.y;
            //终点
            var to_userId = user_arr[i].to;
            var toSeat = self.getSeatByUserId(to_userId);
            var to_node = toSeat.node;
            var end_x = to_node.x;
            var end_y = to_node.y;
            var dis_x = end_x - start_x;
            var dis_y = end_y - start_y;
            var jin_num = 15;
            var per_x = Math.floor(dis_x / jin_num);
            var per_y = Math.floor(dis_y / jin_num);
            var new_node_arr = [];
            // if (type == 1) {
            for (var j = 0; j <= jin_num; j++) {
                var new_x = start_x + j * per_x;
                var new_y = start_y + j * per_y;
                var new_node = cc.instantiate(self.jinbi);
                new_node.active = false;
                new_node.x = new_x;
                new_node.y = new_y;
                cc.find("Canvas").addChild(new_node);
                new_node_arr.push(new_node);
            }
            self.jinbi_node_arr.push(new_node_arr);
        }
    },
    execMoneyFlowsAnim: function execMoneyFlowsAnim(callback) {
        //执行金币流动画
        var self = this;
        if (!self.jinbi_node_arr) return;
        if (self.jinbi_node_arr.length == 0) {
            self.clearFlowAnim();
            if (callback) {
                callback();
            }
            return;
        }
        var interVal = setInterval(function () {
            if (!self.showJinbiIndex) {
                self.showJinbiIndex = 0;
            }
            for (var i in self.jinbi_node_arr) {
                var new_node_arr = self.jinbi_node_arr[i];
                new_node_arr[self.showJinbiIndex].active = true;
            }
            if (self.showJinbiIndex >= 10) {
                self.showJinbiIndex = 0;
                self.flowEndAnim(callback);
                clearInterval(interVal);
            } else {
                self.showJinbiIndex++;
            }
        }, 100);
    },
    flowEndAnim: function flowEndAnim(callback) {
        var self = this;
        var duration = 0.4;
        for (var i in self.jinbi_node_arr) {
            var node_arr = self.jinbi_node_arr[i];
            var endNode = node_arr[node_arr.length - 1];
            for (var j in node_arr) {
                var node = node_arr[j];
                var action = cc.moveTo(duration, cc.p(endNode.x, endNode.y));
                node.runAction(action);
            }
        }
        setTimeout(function () {
            //清理金币
            self.clearFlowAnim();
            if (callback) {
                callback();
            }
        }, duration * 1000);
    },
    clearFlowAnim: function clearFlowAnim() {
        var self = this;
        for (var i in self.jinbi_node_arr) {
            var node_arr = self.jinbi_node_arr[i];
            for (var j in node_arr) {
                var node = node_arr[j];
                cc.find("Canvas").removeChild(node);
            }
        }
        self.jinbi_node_arr = [];
    },
    showBeiShuText: function showBeiShuText(userId, beiShu) {
        var self = this;
        var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(userId);
        var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
        var seat = self._seats[localIndex];
        seat.showBeiShuText(beiShu);
    },
    showCount: function showCount() {
        this._seats[0].showCount();
    },
    showYouShi: function showYouShi() {
        this._seats[0].showYouShi();
    },
    showQiangZhuTips: function showQiangZhuTips() {
        //显示抢主tips
        this._qiangZhuTips.node.active = true;
    },
    hideQiangZhuTips: function hideQiangZhuTips() {
        this._qiangZhuTips.node.active = false;
    },
    showXiaZhuTips: function showXiaZhuTips() {
        this._xiaBeiTips.node.active = true;
    },
    hideXiaZhuTips: function hideXiaZhuTips() {
        this._xiaBeiTips.node.active = false;
    },
    showOtherSeat: function showOtherSeat() {
        var self = this;
        for (var i = 1; i < 5; i++) {
            var seat = self._seats[i];
            seat.showBeiPai(4); //显示牌的背面
        }
    },
    showQiangZhu: function showQiangZhu(maxQiangZhuangBeiShu) {
        var self = this;
        var level = 0;
        for (var i in self.qiangZhuLevel) {
            if (self.qiangZhuLevel[i] <= maxQiangZhuangBeiShu) {
                level = i;
            }
        }
        var seat = self._seats[0];
        seat.showQiangZhu(level);
    },
    showSelfPai: function showSelfPai(holds) {
        var self = this;
        var seat = self._seats[0];
        var spriteFrames = [];
        for (var i in holds) {
            spriteFrames.push(self.getpaiRes(holds[i]));
        }
        seat.showSelfPai(spriteFrames);
    },
    getpaiRes: function getpaiRes(data) {
        var self = this;
        data = data + 1;
        var type, num, huase_big, huase_small;
        num = (data % 100).toString();
        if (data > 0 && data < 14) {
            type = '04'; //黑桃
            num = num + '-1'; //黑牌
        } else if (data > 100 && data < 114) {
            type = '03'; //红桃
            num = num + '-2'; //红牌
        } else if (data > 200 && data < 214) {
            type = '02'; //梅花
            num = num + '-1'; //黑牌
        } else if (data > 300 && data < 314) {
            type = '01'; //方块
            num = num + '-2'; //红牌
        }
        huase_big = "huase_big" + type;
        huase_small = "huase_small" + type;
        var hold = data - 1;
        var result = {
            num: self.paigroup.getSpriteFrame(num),
            huase_big: self.paigroup.getSpriteFrame(huase_big),
            huase_small: self.paigroup.getSpriteFrame(huase_small),
            hold: hold
        };
        return result;
    },
    showDiFen: function showDiFen(difen) {
        var self = this;
        self._difen.node.active = true;
        self._difen.string = "底分：" + difen;
    },
    showLastResult: function showLastResult(type) {
        var seatIndex = cc.vv.gameNetMgr.getSeatIndexByID(cc.vv.userMgr.userId);
        var localIndex = cc.vv.gameNetMgr.getLocalIndexZJH(seatIndex);
        if (!this._seats) return;
        var seat = this._seats[localIndex];
        if (this._lastResult && seat._lastpai.active) {
            this._lastResult.active = true;
        }
        if (type == 1) {
            this._lastResult.getChildByName('win').active = true;
            this._lastResult.getChildByName('lose').active = false;
        } else if (type == 2) {
            this._lastResult.getChildByName('win').active = false;
            this._lastResult.getChildByName('lose').active = true;
        }
    },
    hideLastResult: function hideLastResult() {
        if (this._lastResult) {
            this._lastResult.active = false;
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (window.voice && window.voice.localId != null) {
            var localId = window.voice.localId;
            window.voice.localId = null;
            cc.vv.audioMgr.pauseAll();
            window.playVoice(localId);
        }
        var minutes = Math.floor(Date.now() / 1000 / 60);
        if (this._lastMinute != minutes) {
            this._lastMinute = minutes;
            var date = new Date();
            var h = date.getHours();
            h = h < 10 ? "0" + h : h;
            var m = date.getMinutes();
            m = m < 10 ? "0" + m : m;
            this._timeLabel.string = "" + h + ":" + m;
        }
        if (this._lastPlayTime != null) {
            if (Date.now() > this._lastPlayTime + 200) {
                this.onPlayerOver();
                this._lastPlayTime = null;
            }
        } else {
            this.playVoice();
        }
    },
    onPlayerOver: function onPlayerOver() {
        if (!cc.sys.isNative) {
            window.stopPlayVoice();
        };
        cc.vv.audioMgr.resumeAll();
        console.log("onPlayCallback:" + this._playingSeat);
        var localIndex = this._playingSeat;
        this._playingSeat = null;
        this._seats[localIndex].voiceMsg(false);
    },
    onDestroy: function onDestroy() {
        cc.vv.voiceMgr.stop();
        //        cc.vv.voiceMgr.onPlayCallback = null;
    },
    onQiangZhuangClick: function onQiangZhuangClick(e) {
        var self = this;
        var node = e.target;
        var opacity = node.opacity;
        if (opacity == 255) {
            var beishu = 0;
            var nodeName = node.name;
            beishu = nodeName.replace('qiang', '');
            cc.vv.net.send("qiang_zhuang", beishu);
            self.hideQiangZhuTips();
            self._seats[0].hideQiangZhu();
        }
    },
    onXiaZhuClick: function onXiaZhuClick(e) {
        var self = this;
        var node = e.target;
        var opacity = node.opacity;
        if (opacity == 255) {
            var beishu = 0;
            var str = node.getChildByName('num').getComponent(cc.Label).string;
            beishu = str.replace('倍', '');
            cc.vv.net.send("xia_zhu", beishu);
            self.hideXiaZhuTips();
            self._seats[0].hideXiaBei();
        }
    },
    onYouShiClick: function onYouShiClick(e) {
        console.log('有十', e.target);
        var niu_arr = this._seats[0].getNiuArr();
        console.log('niu_arr', niu_arr);
        cc.vv.net.send("you_shi", niu_arr);
    },
    onSanPaiClick: function onSanPaiClick(e) {
        console.log('散牌', e.target);
        cc.vv.net.send("san_pai");
    },
    onPaiClick: function onPaiClick(e) {
        if (!this._seats[0]._count.active) return;
        var node = e.target;
        var nodeName = node.name;
        var hold = node.hold;
        var num = hold % 100;
        console.log('hold', hold);
        if (node.isClicked) {
            node.isClicked = false;
            node.y -= 20;
            this._seats[0].unsetCount(nodeName);
        } else {
            node.isClicked = true;
            node.y += 20;
            this._seats[0].setCount(num, nodeName);
        }
    }
});

cc._RFpop();
},{}],"dnSeat":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e73acaoMZZMCoeZBmvABtFo', 'dnSeat');
// scripts/dn/dnSeat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _sprIcon: null,
        _zhuang: null,
        _ready: null,
        _offline: null,
        _lblName: null,
        _lblScore: null,
        _scoreBg: null,
        _voicemsg: null,
        _chatBubble: null,
        _emoji: null,
        _lastChatTime: -1,
        _userName: "",
        _score: 0,
        _isOffline: false,
        _isReady: false,
        _isZhuang: false,
        _userId: null,
        _isKanPai: false,
        _isQiPai: false,
        _isShu: false,
        // _timeLabel: null,
        _time: -1
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._sprIcon = this.node.getChildByName("head").getComponent("ImageLoader");
        this._lblName = this.node.getChildByName("name").getComponent(cc.Label);
        this._lblScore = this.node.getChildByName("money").getComponent(cc.Label);
        this._diff_money = this.node.getChildByName("diff_money").getComponent(cc.Label);
        this._chatBubble = this.node.getChildByName("ChatBubble");
        this._lastpai = this.node.getChildByName("lastpai");
        this._complete = this.node.getChildByName("complete");
        this._qiangzhu = this.node.getChildByName("qiangzhu");
        this._qiangzhuText = this.node.getChildByName("qiangzhuText");
        this._douniu_zhu = this.node.getChildByName("douniu_zhu");
        this._pai = this.node.getChildByName("pai"); //只有seat0才会有
        this._emoji = this.node.getChildByName("emoji");
        this._xiabei = this.node.getChildByName('xiabei');
        this._beishuText = this.node.getChildByName("beishuText");
        this._youshi = this.node.getChildByName('youshi');
        this._count = this.node.getChildByName('count');
        this.refresh();
        if (this._sprIcon && this._userId) {
            this._sprIcon.setUserID(this._userId);
        }
    },
    onIconClicked: function onIconClicked() {
        var iconSprite = this._sprIcon.node.getComponent(cc.Sprite);
        if (this._userId != null && this._userId > 0) {
            var seat = cc.vv.gameNetMgr.getSeatByID(this._userId);
            var sex = 0;
            if (cc.vv.baseInfoMap) {
                var info = cc.vv.baseInfoMap[this._userId];
                if (info) {
                    sex = info.sex;
                }
            }
        }
    },
    refresh: function refresh() {
        if (this._lblName != null) {
            this._lblName.string = this._userName;
        }
        if (this._lblScore != null) {
            this._lblScore.string = this._score;
        }
        if (this._diff_money != null) {
            this._diff_money.node.active = false;
        }
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
        if (this._zhuang) {
            this._zhuang.active = false;
        }
        this.node.active = this._userName != null && this._userName != "";
        if (this._chatBubble) {
            this._chatBubble.active = false;
        }
        if (this._emoji) {
            this._emoji.active = false;
        }
        if (this._lastpai) {
            this._lastpai.active = false;
        }
        if (this._complete) {
            // this._complete.getChildByName('douniu_bg1').active = false;
            // this._complete.getChildByName('wancheng').active = false;
            this._complete.active = false;
        }
        if (this._beishuText) {
            this._beishuText.active = false;
        }
        if (this._qiangzhu) {
            this._qiangzhu.active = false;
        }
        if (this._qiangzhuText) {
            this._qiangzhuText.active = false;
        }
        if (this._douniu_zhu) {
            this._douniu_zhu.active = false;
        }
        if (this._pai) {
            this._pai.active = false;
        }
        if (this._xiabei) {
            this._xiabei.active = false;
        }
        if (this._youshi) {
            this._youshi.active = false;
        }
    },
    setInfo: function setInfo(name, score) {
        this._userName = name;
        this._score = score;
        if (this._score == null) {
            this._score = 0;
        }
        if (this._scoreBg != null) {
            this._scoreBg.active = this._score != null;
        }
        if (this._lblScore != null) {
            this._lblScore.node.active = this._score != null;
        }
        this.refresh();
    },
    seatHide: function seatHide() {
        this.node.active = false;
        this._userName = "";
        this._userId = 0;
    },
    setZhuang: function setZhuang(value) {
        this._isZhuang = value;
        if (this._zhuang) {
            this._zhuang.active = value;
        } else {
            this._zhuang = this.node.getChildByName("zhuang");
            this._zhuang.active = value;
        }
    },
    setReady: function setReady(isReady) {
        this._isReady = isReady;
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
    },
    setID: function setID(id) {
        var idNode = this.node.getChildByName("id");
        if (idNode) {
            var lbl = idNode.getComponent(cc.Label);
            lbl.string = "ID:" + id;
        }
        this._userId = id;
        if (this._sprIcon) {
            this._sprIcon.setUserID(id);
        }
    },
    getID: function getID() {
        return this._userId;
    },
    setOffline: function setOffline(isOffline) {
        this._isOffline = isOffline;
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
    },
    chat: function chat(content) {
        if (this._chatBubble == null) {
            return;
        }
        this._emoji.active = false;
        this._chatBubble.active = true;
        this._chatBubble.getComponent(cc.Label).string = content;
        this._chatBubble.getChildByName("New Label").getComponent(cc.Label).string = content;
        this._lastChatTime = 3;
    },
    emoji: function emoji(_emoji) {
        //emoji = JSON.parse(emoji);
        if (this._emoji == null) {
            return;
        }
        console.log(_emoji);
        this._chatBubble.active = false;
        this._emoji.active = true;
        this._emoji.getComponent(cc.Animation).play(_emoji);
        this._lastChatTime = 3;
    },
    voiceMsg: function voiceMsg(show) {
        if (this._voicemsg) {
            this._voicemsg.active = show;
        }
    },
    setMoney: function setMoney(data) {
        //设置该玩家所拥有的的钱
        this._lblScore.string = data;
        this._score = data;
    },
    setTime: function setTime(o) {
        if (o) {
            this._time = 0;
        } else {
            this._time = 30;
        }
    },
    showQiangZhu: function showQiangZhu(level) {
        var self = this;
        if (!self._qiangzhu) return;
        self._qiangzhu.active = true;
        for (var i in self._qiangzhu.children) {
            if (level < i) {
                self._qiangzhu.children[i].opacity = 128;
            } else {
                self._qiangzhu.children[i].opacity = 255;
            }
        }
    },
    hideQiangZhu: function hideQiangZhu() {
        this._qiangzhu.active = false;
    },
    showSelfPai: function showSelfPai(spriteFrames) {
        var self = this;
        if (self._pai) {
            self._pai.active = true;
            for (var i in self._pai.children) {
                var pai = self._pai.children[i];
                var paiObj = spriteFrames[i];
                if (paiObj) {
                    //如果有资源则显示，没有则隐藏
                    pai.active = true;
                    self.setPai(pai, paiObj);
                } else {
                    pai.active = false;
                }
            }
        }
    },
    /**
     * [setPai description]
     * @param {[type]} pai    [牌的node]
     * @param {[type]} paiObj [牌的资源]
     */
    setPai: function setPai(pai, paiObj) {
        var numRes = paiObj['num'];
        var huase_bigRes = paiObj['huase_big'];
        var huase_smallRes = paiObj['huase_small'];
        var hold = paiObj['hold'];
        pai.getChildByName('num').getComponent(cc.Sprite).spriteFrame = numRes;
        pai.getChildByName('hua2').getComponent(cc.Sprite).spriteFrame = huase_bigRes;
        pai.getChildByName('hua1').getComponent(cc.Sprite).spriteFrame = huase_smallRes;
        pai.hold = hold;
    },
    showBeiPai: function showBeiPai(num) {
        var self = this;
        if (!self._complete) return;
        self._complete.active = true;
        for (var i in self._complete.children) {
            if (i < num) {
                self._complete.children[i].active = true;
            } else {
                self._complete.children[i].active = false;
            }
        }
    },
    showQiangZhuText: function showQiangZhuText(beishu) {
        var self = this;
        if (!self._qiangzhuText) return;
        self._qiangzhuText.active = true;
        for (var i in self._qiangzhuText.children) {
            if (i == beishu) {
                self._qiangzhuText.children[i].active = true;
            } else {
                self._qiangzhuText.children[i].active = false;
            }
        }
    },
    hideQiangZhuText: function hideQiangZhuText() {
        var self = this;
        if (!self._qiangzhuText) return;
        self._qiangzhuText.active = false;
    },
    showZhuang: function showZhuang() {
        //庄的显示
        var self = this;
        if (!self._douniu_zhu) return;
        self._douniu_zhu.active = true;
    },
    hideZhuang: function hideZhuang() {
        //隐藏庄
        var self = this;
        if (!self._douniu_zhu) return;
        self._douniu_zhu.active = false;
    },
    showXiaBei: function showXiaBei(data) {
        //下注
        var self = this;
        if (!self._xiabei) return;
        self._xiabei.active = true;
        var maxBeishu = data.maxXiaZhuBeiShu;
        var xiaZhuOps = data.xiaZhuOps;
        for (var i in self._xiabei.children) {
            var temp = self._xiabei.children[i];
            if (xiaZhuOps[i] <= maxBeishu) {
                temp.opacity = 255;
            } else {
                temp.opacity = 128;
            }
            temp.getChildByName('num').getComponent(cc.Label).string = xiaZhuOps[i] + "倍";
        }
    },
    hideXiaBei: function hideXiaBei() {
        var self = this;
        if (!self._xiabei) return;
        self._xiabei.active = false;
    },
    showYouShi: function showYouShi() {
        var self = this;
        if (!self._youshi) return;
        self._youshi.active = true;
    },
    hideYouShi: function hideYouShi() {
        var self = this;
        if (!self._youshi) return;
        self._youshi.active = false;
    },
    showCount: function showCount() {
        var self = this;
        if (!self._count) return;
        self._count.active = true;
        for (var i in self._count.children) {
            self._count.children[i].active = false;
        }
    },
    hideCount: function hideCount() {
        var self = this;
        if (!self._count) return;
        self._count.active = false;
    },
    setCount: function setCount(num, nodeName) {
        var self = this;
        if (!self._count) return;
        var index = null;
        for (var i in self._count.children) {
            if (i > 2) continue;
            var temp = self._count.children[i];
            if (temp.active == false) {
                index = i;
                break;
            }
        }
        if (index == null) return;
        var child = self._count.children[index];
        child.active = true;
        child.nodeName = nodeName;
        if (num > 9) {
            num = 9;
        }
        child.num = num;
        for (var i in child.children) {
            var temp = child.children[i];
            if (i == num) {
                temp.active = true;
            } else {
                temp.active = false;
            }
        }
        if (index == 2) {
            //如果前三个填满了，则在第四格算出
            var num0 = parseInt(self._count.children[0].num);
            var num1 = parseInt(self._count.children[1].num);
            var num2 = parseInt(self._count.children[2].num);
            var total_num = num0 + num1 + num2 + 3; //+3算出真实的值
            var total_num_shi = Math.floor(total_num / 10); //十位数
            var total_num_ge = total_num % 10; //个位数
            self._count.getChildByName('result').active = true;
            //子元素先全部隐藏
            var result = self._count.getChildByName('result').children;
            for (var i in result) {
                result[i].active = false;
            }
            //分类显示
            if (total_num > 9) {
                var index_shi = total_num_shi - 1;
                var index_ge = total_num_ge;
                var n9 = result[9];
                n9.active = true;
                //n9的子元素
                for (var j in n9.children) {
                    var child_n9 = n9.children[j];
                    for (var k in child_n9.children) {
                        if (j == 0 && k == index_shi) {
                            //显示十位数
                            child_n9.children[k].active = true;
                        } else if (j == 1 && k == index_ge) {
                            //显示个位数
                            child_n9.children[k].active = true;
                        } else {
                            child_n9.children[k].active = false;
                        }
                    }
                }
            } else {
                var index_ge = total_num_ge - 1;
                result[index_ge].active = true;
            }
        }
    },
    unsetCount: function unsetCount(nodeName) {
        var self = this;
        if (!self._count) return;
        var index = null;
        for (var i in self._count.children) {
            var temp = self._count.children[i];
            if (temp.nodeName == nodeName) {
                index = i;
            }
        }
        if (index == null) return;
        self._count.children[index].active = false;
        self._count.getChildByName('result').active = false;
    },
    showBeiShuText: function showBeiShuText(beishu) {
        var self = this;
        if (!self._beishuText || !beishu) return;
        self._beishuText.active = true;
        var num0 = Math.floor(parseInt(beishu) / 10);
        var num1 = parseInt(beishu) % 10;
        var num0_arr = self._beishuText.getChildByName('num0').children;
        var num1_arr = self._beishuText.getChildByName('num1').children;
        for (var i in num0_arr) {
            var temp = num0_arr[i];
            if (i == num0) {
                temp.active = true;
            } else {
                temp.active = false;
            }
        }
        for (var i in num1_arr) {
            var temp = num1_arr[i];
            if (i == num1) {
                temp.active = true;
            } else {
                temp.active = false;
            }
        }
    },
    hideBeiShuText: function hideBeiShuText() {
        var self = this;
        if (!self._beishuText) return;
        self._beishuText.active = false;
    },
    getNiuArr: function getNiuArr() {
        var self = this;
        if (!self._count) return;
        var niu_arr = [];
        for (var i in self._count.children) {
            var niu = self._count.children[i].num;
            if (i > 2 || !niu) return;
            niu_arr.push(niu);
        }
        return niu_arr;
    },
    snEnd: function snEnd() {
        //算牛结束，隐藏count界面，显示已完成
        var self = this;
        if (self._count) {
            self._count.active = false;
        }
        if (self._pai) {
            self._pai.active = false;
            for (var i in self._pai.children) {
                var child = self._pai.children[i];
                child.isClicked = false;
                child.y = -9;
            }
        }
        if (self._youshi) {
            self._youshi.active = false;
        }
        self._complete.active = true;
        for (var i in self._complete.children) {
            self._complete.children[i].active = true;
        }
    },
    changeMoney: function changeMoney(money) {
        if (!this._diff_money) return;
        var old_money = this._score;
        var diff_money = parseInt(money) - parseInt(old_money);
        if (diff_money > 0) {
            diff_money = "+" + diff_money;
        }
        this._diff_money.string = diff_money;
        this._diff_money.node.active = true;
        this._diff_money.node.opacity = 255;
        this.setMoney(money);
        var action = cc.fadeOut(2);
        this._diff_money.node.runAction(action);
    },
    showLastPai: function showLastPai(spriteFrames, score) {
        var self = this;
        if (self._lastpai) {
            self._lastpai.active = true;
            for (var i in self._lastpai.children) {
                if (i <= 4) {
                    //牌
                    var pai = self._lastpai.children[i];
                    var paiObj = spriteFrames[i];
                    if (paiObj) {
                        //如果有资源则显示，没有则隐藏
                        pai.active = true;
                        self.setPai(pai, paiObj);
                    } else {
                        pai.active = false;
                    }
                } else if (i == 6) {
                    //结果，“十带一”之类
                    var jieguo = self._lastpai.children[i];
                    if (score) {
                        jieguo.active = true;
                        for (var j in jieguo.children) {
                            var temp = jieguo.children[j];
                            temp.active = false;
                        }
                        if (score[3] == '1') {
                            //没有牛
                            jieguo.getChildByName('san').active = true;
                        } else if (score[3] == '4') {
                            //单牛
                            var index = parseInt(score[0]);
                            jieguo.getChildByName('jg' + index).active = true;
                        } else if (score[3] == '5') {
                            //双牛
                            jieguo.getChildByName('jg0').active = true;
                        } else if (score[3] == '6') {
                            //炸弹
                            jieguo.getChildByName('zhadan').active = true;
                        } else if (score[3] == '7') {
                            //五花
                            jieguo.getChildByName('wuhua').active = true;
                        } else if (score[3] == '8') {
                            //五小
                            jieguo.getChildByName('wuxiao').active = true;
                        }
                    } else {
                        jieguo.active = false;
                    }
                }
            }
        }
        if (this._complete) {
            this._complete.active = false;
        }
    },
    hideLastPai: function hideLastPai() {
        if (this._lastpai) {
            this._lastpai.active = false;
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._lastChatTime > 0) {
            this._lastChatTime -= dt;
            if (this._lastChatTime < 0) {
                this._chatBubble.active = false;
                this._emoji.active = false;
                this._emoji.getComponent(cc.Animation).stop();
            }
        }
        if (this._time > 0) {
            this._time -= dt;
            var pre = "";
            if (this._time < 0) {
                this._time = 0;
            }
            var t = Math.ceil(this._time);
            if (t < 10) {
                pre = "0";
            }
            this._timeLabel.string = pre + t;
        }
    }
});

cc._RFpop();
},{}],"dzpkAll":[function(require,module,exports){
"use strict";
cc._RFpush(module, '08e464wYzRBLqPzfOdEMOZs', 'dzpkAll');
// scripts/dzpk/dzpkAll.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _seats: [],
        _timeLabel: null,
        _voiceMsgQueue: [],
        _lastPlayingSeat: null,
        _playingSeat: null,
        _lastPlayTime: null,
        _shareContent: null,
        paigroup: {
            default: null,
            type: cc.SpriteAtlas
        },
        back: cc.Node,
        fanhui: cc.Node,
        bg: cc.Node,
        helpshow: cc.Node,
        backAlert: cc.Node,
        backAlert_no: cc.Node,
        fan: cc.Node,
        jinbi: cc.Node,
        countdown: cc.Label,
        win: cc.Node,
        lose: cc.Node,
        _pai: null,
        _pais: [],
        _text: null,
        _zongzhu: null,
        _btnFirst: null,
        _btnSecond: null,
        _btnThird: null,
        _Checkbox: [],
        _secondLeft: [],
        _secondOther: [],
        _thirdLeft: [],
        _thirdOther: [],
        _thirdAllIn: null,
        _thirdJiazhu: null,
        _jiaZhu: null,
        _jiaZhu_cover: null,
        _timeout: null,
        timerCounter: 0
    },
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this.addComponent("ReConnect");
        for (var i = 0; i < 5; i++) {
            this._seats.push(cc.find("Canvas/seat" + i).getComponent("dzpkSeat"));
        }
        this._timeLabel = cc.find("Canvas/time").getComponent(cc.Label);
        this._tips = cc.find("Canvas/tips").getComponent(cc.Label);
        this._difen = cc.find("Canvas/difen").getComponent(cc.Label);
        this._zongzhu = cc.find("Canvas/zongxiazhu/label").getComponent(cc.Label);
        this._text = cc.find("Canvas/text0").getComponent(cc.Label);
        this._text.string = "白手起家(6人)：" + cc.vv.NetMgr.consume_num + "/" + 2 * cc.vv.NetMgr.consume_num + " 扑克牌：5-A 限注(1倍底池)";
        this._pai = cc.find("Canvas/pai");
        for (var i = 0; i < this._pai.childrenCount; i++) {
            this._pais[i] = this._pai.getChildByName("pai" + i);
        };
        this._pai.active = false;
        this._difen.node.active = true;
        this._btnFirst = cc.find("Canvas/buttons/first");
        this._btnSecond = cc.find("Canvas/buttons/second");
        this._btnThird = cc.find("Canvas/buttons/third");
        this._btnThird.active = false;
        this._btnSecond.active = false;
        this._btnFirst.active = false;
        for (var i = 0; i < this._btnFirst.childrenCount; i++) {
            this._Checkbox[i] = this._btnFirst.children[i];
            this._Checkbox[i].getChildByName('button').index = i;
            cc.vv.utils.addClickEvent(this._Checkbox[i].getChildByName('button'), this.node, "dzpkAll", "onBtnClicked");
        };
        for (var i = 0; i < 3; i++) {
            this._secondLeft[i] = this._btnSecond.getChildByName('dichi' + i);
            this._secondLeft[i].index = i;
            cc.vv.utils.addClickEvent(this._secondLeft[i], this.node, "dzpkAll", "onBtnClicked");
        };
        for (var i = 0; i < 3; i++) {
            this._secondOther[i] = this._btnSecond.getChildByName('dichi_cover' + i);
            this._secondOther[i].index = i;
        };
        for (var i = 0; i < 5; i++) {
            this._thirdLeft[i] = this._btnThird.getChildByName('tnum' + i);
            this._thirdLeft[i].index = i;
            cc.vv.utils.addClickEvent(this._thirdLeft[i], this.node, "dzpkAll", "onBtnClicked");
        };
        for (var i = 0; i < 5; i++) {
            this._thirdOther[i] = this._btnThird.getChildByName('tnum_cover' + i);
            this._thirdOther[i].index = i;
        };
        this._thirdJiazhu = this._btnThird.getChildByName('tjiazhu');
        cc.vv.utils.addClickEvent(this._thirdJiazhu, this.node, "dzpkAll", "onBtnClicked");
        this._thirdAllIn = this._btnThird.getChildByName('select').getChildByName('quanxia');
        cc.vv.utils.addClickEvent(this._thirdAllIn, this.node, "dzpkAll", "onBtnClicked");
        this._genPai = this._btnSecond.getChildByName('genpai');
        this._rangPai = this._btnSecond.getChildByName('rangpai');
        this._qiPai = this._btnSecond.getChildByName('qipai');
        this._jiaZhu = this._btnSecond.getChildByName('jiazhu');
        this._jiaZhu_cover = this._btnSecond.getChildByName('jiazhu_cover');
        cc.vv.utils.addClickEvent(this._genPai, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._rangPai, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._qiPai, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this._jiaZhu, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.back, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.fanhui, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.fan, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.bg, this.node, "dzpkAll", "onBtnClicked");
        cc.vv.utils.addClickEvent(this.backAlert_no, this.node, "dzpkAll", "onBtnClicked");
        this.initView();
        this.initSeats();
        this.initEventHandlers();
        cc.vv.net.send("ready");
        if (cc.vv.userMgr.reconnection == 1) {
            //断线重连
            cc.vv.userMgr.reconnection = 0;
            cc.vv.net.send("getGameInfoByUserid");
        }
        cc.vv.audioMgr.playBGM("back.mp3");
        cc.vv.net.send("getUserHolds");
    },
    initView: function initView() {
        this._tips.node.active = true;
        this._zongzhu.string = 0;
        this._difen.string = "底池：" + 0;
        this._difen.money = 0;
    },
    restart: function restart() {
        if (this._zongzhu) this._zongzhu.string = 0;
        if (this._difen) {
            this._difen.string = "底池：" + 0;
            this._difen.money = 0;
        }
        this.win.active = false;
        this.lose.active = false;
        this._pai.active = false;
        this._tips.node.active = true;
        var seats = cc.vv.NetMgr.seats;
        if (seats) {
            for (var i = 0; i < seats.length; ++i) {
                var index = cc.vv.NetMgr.getLocalIndexByUserId(seats[i].userid);
                this._seats[index].restart();
                this._seats[index].status = "";
            }
        }
        cc.vv.net.send("ready");
    },
    initSeats: function initSeats() {
        var seats = cc.vv.NetMgr.seats;
        for (var i = 0; i < seats.length; ++i) {
            this.initSingleSeat(seats[i]);
        }
    },
    initSingleSeat: function initSingleSeat(seat) {
        var index = cc.vv.NetMgr.getLocalIndexByUserId(seat.userid);
        this._seats[index].setInfo(seat.name, seat.score);
        this._seats[index].setReady(seat.ready);
        this._seats[index].setID(seat.userid);
        this._seats[index].voiceMsg(false);
    },
    onBtnSettingsClicked: function onBtnSettingsClicked() {
        cc.vv.popupMgr.showSettings();
    },
    // 点击分享按钮，使用微信分享
    onBtnWeichatClicked: function onBtnWeichatClicked() {
        cc.vv.share.show();
    },
    onBtnClicked: function onBtnClicked(event) {
        if (event.target.name == "back") {
            this.fanhui.active = true;
        }
        if (event.target.name == "bg") {
            this.fanhui.active = false;
            this.helpshow.active = false;
            if (this._btnThird.active) {
                this._btnThird.active = false;
                this._btnSecond.active = true;
            }
        }
        if (event.target.name == "fan") {
            this.fanhui.active = false;
            this.backAlert.active = true;
        }
        if (event.target.name == "pai") {
            this.fanhui.active = false;
            this.helpshow.active = true;
        }
        if (event.target.name == "no") {
            this.fanhui.active = false;
            this.backAlert.active = false;
        }
        if (event.target.name == "button") {
            for (var i = 0; i < this._Checkbox.length; i++) {
                if (event.target.index == i) {
                    continue;
                } else {
                    this._Checkbox[i].getComponent("CheckBox").checked = false;
                    this._Checkbox[i].getComponent("CheckBox").refresh();
                }
            };
        }
        if (event.target.name == "rangpai") {
            cc.vv.net.send("rangpai");
        }
        if (event.target.name == "qipai") {
            cc.vv.net.send("qipai");
        }
        if (event.target.name == "genpai") {
            cc.vv.net.send("genpai", event.target.money);
        }
        if (event.target.name == "jiazhu") {
            this._btnThird.active = true;
            this._btnSecond.active = false;
        }
        if (event.target.name.indexOf('dichi') > -1) {
            cc.vv.net.send("jiazhu", event.target.money);
        }
        if (event.target.name.indexOf('tnum') > -1) {
            cc.vv.net.send("jiazhu", event.target.money);
        }
        if (event.target.name.indexOf('tjiazhu') > -1) {
            cc.vv.net.send("jiazhu", event.target.money);
        }
        if (event.target.name.indexOf('quanxia') > -1) {
            cc.vv.net.send("jiazhu", event.target.money);
        }
    },
    onBtnExit: function onBtnExit() {
        this.backAlert.active = false;
        cc.vv.net.send("exit");
    },
    onBtnExchange: function onBtnExchange() {
        this.backAlert.active = false;
        this.fanhui.active = false;
        cc.vv.userMgr.exchange = 1;
        cc.vv.net.send("exit");
    },
    playVoice: function playVoice() {
        if (this._playingSeat == null && this._voiceMsgQueue.length) {
            console.log("playVoice");
            var data = this._voiceMsgQueue.shift();
            var idx = cc.vv.NetMgr.getSeatIndexByID(data.sender);
            var localIndex = cc.vv.NetMgr.getLocalIndex(idx);
            this._playingSeat = localIndex;
            this._seats[localIndex].voiceMsg(true);
            var msgInfo = JSON.parse(data.content);
            var msgfile = "voicemsg.amr";
            this._lastPlayTime = Date.now() + msgInfo.time;
            if (!cc.sys.isNative) {
                var serverid = msgInfo['msg'];
                window.downloadVoice(serverid);
                return;
            }
            cc.vv.voiceMgr.writeVoice(msgfile, msgInfo.msg);
            cc.vv.voiceMgr.play(msgfile);
        }
    },
    //转换对应的牌
    ConversionCardRes: function ConversionCardRes(n) {
        var type = 4;
        var color = 1;
        if (n >= 13 && n < 26) {
            type = 3;
            n = n - 13;
            color = 2;
        } else if (n >= 26 && n < 39) {
            type = 2;
            n = n - 26;
        } else if (n >= 39 && n < 52) {
            type = 1;
            n = n - 39;
            color = 2;
        } else {
            type = 4;
        }
        var num = 0;
        num = n + 2;
        if (num == 14) {
            num = 1;
        }
        var data = {
            num: this.paigroup.getSpriteFrame(num + "-" + color),
            h_s: this.paigroup.getSpriteFrame("huase_small0" + type),
            h_b: this.paigroup.getSpriteFrame("huase_big0" + type)
        };
        return data;
    },
    showOtherSeat: function showOtherSeat(type) {
        var seats = cc.vv.NetMgr.seats;
        for (var i = 0; i < seats.length; i++) {
            var index = cc.vv.NetMgr.getLocalIndexByUserId(seats[i].userid);
            if (type == 1) {
                this._seats[index].showBeiPai(true); //显示牌的背面
            }
            if (type == 2) {
                this._seats[index].showOps(); //隐藏其他桌子的操作icon
                this._seats[index].hideScore();
            }
        };
    },
    setBtnOps: function setBtnOps(type, obj) {
        if (type == 1) {
            this._btnFirst.active = false;
            this._btnThird.active = false;
            this._btnSecond.active = true;
            this._btnThird.getChildByName("select").getChildByName("slider").getChildByName("Handle").y = -172;
        }
        if (type == 2) {
            this._btnSecond.active = false;
            this._btnFirst.active = true;
            this._btnThird.active = false;
            this._Checkbox[1].active = true;
            this._Checkbox[2].active = false;
            this._Checkbox[3].active = true;
            this._Checkbox[4].active = false;
        }
        if (type == 3) {
            this._btnThird.active = true;
            this._btnSecond.active = false;
            this._btnFirst.active = false;
        }
        if (type == 4) {
            this._btnThird.active = false;
            this._btnSecond.active = false;
            this._btnFirst.active = false;
        }
        if (type == 5) {
            for (var i = 0; i < this._thirdLeft.length; i++) {
                this._thirdLeft[i].getChildByName('num').getComponent(cc.Label).string = obj[i];
                this._thirdLeft[i].money = obj[i];
                this._thirdOther[i].getChildByName('num').getComponent(cc.Label).string = obj[i];
            }
        }
        if (obj && type != 5) {
            if (obj.canGen) {
                this._genPai.active = true;
                this._rangPai.active = false;
                this._genPai.money = obj.GenMoney;
                this._genPai.getChildByName('num').getComponent(cc.Label).string = "跟" + obj.GenMoney;
                if (obj.needAllIn) {
                    this._genPai.getChildByName('num').getComponent(cc.Label).string = "全下";
                    this._jiaZhu.active = false;
                    this._jiaZhu_cover.active = true;
                } else {
                    this._jiaZhu.active = true;
                    this._jiaZhu_cover.active = false;
                }
            } else {
                this._genPai.active = false;
                this._rangPai.active = true;
                this._jiaZhu_cover.active = false;
            }
            for (var i = 0; i < 3; i++) {
                this._secondLeft[i].getChildByName('title').getComponent(cc.Label).string = obj.extraAddOps[i].desc;
                this._secondLeft[i].money = obj.extraAddOps[i].money;
                this._secondOther[i].getChildByName('title').getComponent(cc.Label).string = obj.extraAddOps[i].desc;
                if (obj.addMaxMoney >= obj.extraAddOps[i].money) {
                    this._secondLeft[i].active = true;
                    this._secondOther[i].active = false;
                } else {
                    this._secondLeft[i].active = false;
                    this._secondOther[i].active = true;
                }
                if (obj.needAllIn && this._genPai.money < obj.extraAddOps[i].money) {
                    this._secondLeft[i].active = false;
                    this._secondOther[i].active = true;
                }
            }
            for (var i = 0; i < 5; i++) {
                if (obj.addMaxMoney >= this._thirdLeft[i].money && obj.addMinMoney <= this._thirdLeft[i].money) {
                    this._thirdLeft[i].active = true;
                    this._thirdOther[i].active = false;
                } else {
                    this._thirdLeft[i].active = false;
                    this._thirdOther[i].active = true;
                }
            };
        }
    },
    refreshFirstBtn: function refreshFirstBtn(data) {
        if (parseInt(data.argStatus) == 1) {
            this._Checkbox[1].active = false;
            this._Checkbox[2].getChildByName("text").getComponent(cc.Label).string = "跟" + data.genMoney;
            this._Checkbox[1].getComponent("CheckBox").checked = false;
            this._Checkbox[1].getComponent("CheckBox").refresh();
            this._Checkbox[2].active = true;
        } else if (parseInt(data.argStatus) == 2) {
            this._Checkbox[1].active = false;
            this._Checkbox[2].active = true;
            this._Checkbox[2].getChildByName("text").getComponent(cc.Label).string = "全下";
            this._Checkbox[3].active = false;
            this._Checkbox[4].active = true;
            this._Checkbox[1].getComponent("CheckBox").checked = false;
            this._Checkbox[1].getComponent("CheckBox").refresh();
            this._Checkbox[3].getComponent("CheckBox").checked = false;
            this._Checkbox[3].getComponent("CheckBox").refresh();
        } else {
            this._Checkbox[1].active = true;
            this._Checkbox[2].active = false;
            this._Checkbox[3].active = true;
            this._Checkbox[4].active = false;
        }
        this._Checkbox[2].money = data.genMoney;
        this._Checkbox[2].getComponent("CheckBox").checked = false;
        this._Checkbox[2].getComponent("CheckBox").refresh();
    },
    prepOps: function prepOps(data) {
        for (var i = 0; i < this._btnFirst.childrenCount; i++) {
            if (this._Checkbox[i].getComponent("CheckBox").checked) {
                if (i == 0 && data.canGuo) {
                    cc.vv.net.send("rangpai");
                } else if (i == 0 && !data.canGuo) {
                    cc.vv.net.send("qipai");
                }
                if (i == 1 && data.canGuo) {
                    cc.vv.net.send("rangpai");
                }
                if (i == 2 && data.canGen) {
                    cc.vv.net.send("genpai");
                    // cc.vv.net.send("jiazhu", this._Checkbox[i].money);
                }
                if (i == 3 && data.canGen) {
                    cc.vv.net.send("genpai", this._Checkbox[2].money);
                }
                this._Checkbox[i].getComponent("CheckBox").checked = false;
                this._Checkbox[i].getComponent("CheckBox").refresh();
            }
        }
    },
    unchecked: function unchecked() {
        for (var i = 0; i < this._btnFirst.childrenCount; i++) {
            this._Checkbox[i].getComponent("CheckBox").checked = false;
            this._Checkbox[i].getComponent("CheckBox").refresh();
        }
    },
    onSliderBack: function onSliderBack(event) {
        this._thirdAllIn.active = false;
        var num = 0;
        if (event.progress >= 0.1 && event.progress < 0.2) {
            num = 100;
        } else if (event.progress >= 0.2 && event.progress < 0.3) {
            num = 200;
        } else if (event.progress >= 0.3 && event.progress < 0.4) {
            num = 300;
        } else if (event.progress >= 0.4 && event.progress < 0.5) {
            num = 400;
        } else if (event.progress >= 0.5 && event.progress < 0.6) {
            num = 500;
        } else if (event.progress >= 0.6 && event.progress < 0.7) {
            num = 600;
        } else if (event.progress >= 0.7 && event.progress < 0.8) {
            num = 700;
        } else if (event.progress >= 0.8 && event.progress < 0.9) {
            num = 800;
        } else if (event.progress >= 0.9 && event.progress < 1) {
            num = 900;
        } else if (event.progress == 1) {
            if (this._seats[0]._score == this._thirdJiazhu.maxMoney) {
                this._thirdAllIn.active = true;
                this._thirdAllIn.money = this._thirdJiazhu.maxMoney;
            }
            num = 1000;
        }
        if (this._thirdJiazhu.firstMoney + num >= this._thirdJiazhu.maxMoney) {
            this._thirdJiazhu.money = this._thirdJiazhu.maxMoney;
        } else {
            this._thirdJiazhu.money = this._thirdJiazhu.firstMoney + num;
        }
        this._thirdJiazhu.getChildByName('label').getComponent(cc.Label).string = this._thirdJiazhu.money;
    },
    //断线重连刷新信息
    ReconnectionInfo: function ReconnectionInfo(data) {
        if (data.addOptions.length == 5) this.setBtnOps(5, data.addOptions);
        this._difen.string = "底池：" + data.diChi;
        this._difen.money = data.diChi;
        this._tips.node.active = false;
        if (data.circleHolds.length > 0) {
            for (var i = 0; i < data.circleHolds.length; i++) {
                var paiRes = this.ConversionCardRes(parseInt(data.circleHolds[i]));
                this._pais[i].getChildByName('num').getComponent(cc.Sprite).spriteFrame = paiRes['num'];
                this._pais[i].getChildByName('hua1').getComponent(cc.Sprite).spriteFrame = paiRes['h_s'];
                this._pais[i].getChildByName('hua2').getComponent(cc.Sprite).spriteFrame = paiRes['h_b'];
            };
            if (this._pais[data.circleHolds.length - 1]) this._pais[data.circleHolds.length - 1].active = true;
            if (this._pais[data.circleHolds.length]) this._pais[data.circleHolds.length].active = false;
            if (this._pais[data.circleHolds.length + 1]) this._pais[data.circleHolds.length + 1].active = false;
            this._pai.active = true;
        }
        for (var i = 0; i < data.players.length; i++) {
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.players[i].userid);
            if (data.players[i].canOps) {
                cc.find('Canvas/seat' + index + '/toggle').active = true;
                this._seats[index].setTime(data.timer_Counter);
            } else {
                cc.find('Canvas/seat' + index + '/toggle').active = false;
            }
            var zhu = {
                money: data.players[i].cZhu,
                type: 1
            };
            this._seats[index].setZhu(zhu);
            this._seats[index].setMoney(data.players[i].money);
        }
        this.showOtherSeat(1);
        cc.vv.net.send("getUserInfoByUserid");
    },
    initEventHandlers: function initEventHandlers() {
        cc.vv.NetMgr.dataEventHandler = this.node;
        var self = this;
        this.node.on('new_user', function (data) {
            //新人加入房间
            self.initSingleSeat(data.detail);
        });
        this.node.on('game_begin', function (data) {
            var data = data.detail;
            self._tips.node.active = false;
            for (var i = 0; i < data.players.length; i++) {
                var seat = cc.vv.NetMgr.getSeatByID(data.players[i].userid);
                seat.score = data.players[i].money;
                var index = cc.vv.NetMgr.getLocalIndexByUserId(data.players[i].userid);
                var zhu = {
                    money: data.players[i].cZhu,
                    type: 1
                };
                self._seats[index].setZhu(zhu);
                self._seats[index].setMoney(seat.score);
            };
            if (data.gameInfo.addOptions.length == 5) self.setBtnOps(5, data.gameInfo.addOptions);
        });
        this.node.on('socket_MyHolds', function (data) {
            var data = data.detail;
            if (data) {
                if (!self._seats[0]._pai.active) {
                    self._tips.node.active = false;
                    self._seats[0].setPai(data, self);
                }
            }
        });
        this.node.on('game_diChiUpdate', function (data) {
            self._difen.string = "底池：" + data.detail;
            self._difen.money = data.detail;
        });
        this.node.on('game_myInfo', function (data) {
            var data = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.userid);
            self._seats[index].setPai(data.holds, self);
            self._seats[index].setMoney(data.money);
            self.showOtherSeat(1);
        });
        this.node.on('game_myTurn', function (data) {
            var data = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.userid);
            for (var t = 0; t < 5; t++) {
                cc.find('Canvas/seat' + t + '/toggle').active = false;
            }
            cc.find('Canvas/seat' + index + '/toggle').active = true;
            self._seats[index].setTime();
            self.setBtnOps(1, data);
            self._thirdJiazhu.getChildByName('label').getComponent(cc.Label).string = data.addMinMoney;
            self._thirdJiazhu.money = data.addMinMoney;
            self._thirdJiazhu.firstMoney = data.addMinMoney;
            self._thirdJiazhu.maxMoney = data.addMaxMoney;
            self.prepOps(data);
        });
        this.node.on('game_turnChanged', function (data) {
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.detail);
            for (var t = 0; t < 5; t++) {
                cc.find('Canvas/seat' + t + '/toggle').active = false;
            }
            cc.find('Canvas/seat' + index + '/toggle').active = true;
            self._seats[index].setTime();
            cc.find('Canvas/seat0/toggle').active = false;
            if (self._seats[0]._pai.active) {
                if (self._seats[0].status == "AllIn") {
                    self.setBtnOps(4);
                } else {
                    self.setBtnOps(2);
                }
            }
        });
        this.node.on('game_oneGuo', function (data) {
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.detail);
            cc.find('Canvas/seat' + index + '/toggle').active = false;
            self._seats[index].showOps('rangpai');
            if (self._seats[0]._pai.active) {
                self.setBtnOps(2);
            }
        });
        this.node.on('game_oneGen', function (data) {
            var data = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.userid);
            self._seats[index].showOps('genpai');
            var d = {
                money: data.cZhu,
                type: 1
            };
            self._seats[index].setMoney(data.money);
            self._seats[index].setZhu(d);
            if (self._seats[0]._pai.active) {
                self.setBtnOps(2);
            }
        });
        this.node.on('game_oneAdd', function (data) {
            var data = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.userid);
            self._seats[index].showOps('jiazhu');
            var d = {
                money: data.cZhu,
                type: 1
            };
            self._seats[index].setMoney(data.money);
            self._seats[index].setZhu(d);
            if (self._seats[0]._pai.active) {
                self.setBtnOps(2);
            }
        });
        this.node.on('game_oneAllIn', function (data) {
            var data = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.userid);
            self._seats[index].showOps('quanxia');
            var d = {
                money: data.cZhu,
                type: 1
            };
            self._seats[index].setMoney(data.money);
            self._seats[index].setZhu(d);
            self._seats[index].status = data.status;
            if (self._seats[0]._pai.active) {
                if (cc.vv.userMgr.userId == data.userid) {
                    self.setBtnOps(4);
                }
            }
        });
        this.node.on('game_oneQuit', function (data) {
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.detail);
            cc.find('Canvas/seat' + index + '/toggle').active = false;
            self._seats[index].showOps('qipai');
            self._seats[index].showBeiPai(false);
            if (cc.vv.userMgr.userId == data.detail) self.setBtnOps(4);
        });
        this.node.on('game_allGuo', function (data) {
            for (var i = 0; i < self._seats.length; i++) {
                if (self._seats[i].node.active) {
                    var d = {
                        money: 0,
                        type: 1
                    };
                    self._seats[i].setZhu(d);
                }
            };
        });
        this.node.on('game_playersInNewCircle', function (data) {
            var data = data.detail;
            for (var i = 0; i < data.length; i++) {
                var seat = cc.vv.NetMgr.getSeatByID(data[i].userid);
                if (seat) {
                    seat.score = data.money;
                    var index = cc.vv.NetMgr.getLocalIndexByUserId(data[i].userid);
                    cc.find('Canvas/seat' + index + '/toggle').active = false;
                    if (self._seats[index].status != "AllIn") self._seats[index].showOps();
                    self._seats[index].setMoney(data[i].money);
                    // var d = {
                    //     money: data[i].cZhu,
                    //     type: 1
                    // }
                    // self._seats[index].setZhu(d);
                    if (self._seats[index]._paimian && !self._seats[index]._paimian.active) {
                        self._seats[index].hideScore();
                    }
                    if (self._seats[0]._pai.active) {
                        if (self._seats[index].status == "AllIn") {
                            self.setBtnOps(4);
                        } else {
                            self.setBtnOps(2);
                        }
                    } else {
                        self._seats[0].hideScore();
                    }
                }
            };
        });
        this.node.on('game_newCircle', function (data) {
            self._zongzhu.string = self._difen.money;
            var data = data.detail;
            for (var i = 0; i < data.circleHolds.length; i++) {
                var paiRes = self.ConversionCardRes(parseInt(data.circleHolds[i]));
                self._pais[i].getChildByName('num').getComponent(cc.Sprite).spriteFrame = paiRes['num'];
                self._pais[i].getChildByName('hua1').getComponent(cc.Sprite).spriteFrame = paiRes['h_s'];
                self._pais[i].getChildByName('hua2').getComponent(cc.Sprite).spriteFrame = paiRes['h_b'];
            };
            if (self._pais[data.circleHolds.length - 1]) self._pais[data.circleHolds.length - 1].active = true;
            if (self._pais[data.circleHolds.length]) self._pais[data.circleHolds.length].active = false;
            if (self._pais[data.circleHolds.length + 1]) self._pais[data.circleHolds.length + 1].active = false;
            self._pai.active = true;
        });
        this.node.on('game_caculateResult', function (data) {
            cc.find('Canvas/seat0/toggle').active = false;
        });
        this.node.on('game_myARGStatusChanged', function (data) {
            self.refreshFirstBtn(data.detail);
        });
        this.node.on('game_gameInfoById', function (data) {
            self.ReconnectionInfo(data.detail);
        });
        this.node.on('game_userInfoById', function (data) {
            var data = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(data.userid);
            self._seats[index].setPai(data.holds, self);
            if (data.canOps) {
                self.setBtnOps(1, data);
            } else {
                self.setBtnOps(2, data);
            }
            self._thirdJiazhu.getChildByName('label').getComponent(cc.Label).string = data.addMinMoney;
            self._thirdJiazhu.money = data.addMinMoney;
            self._thirdJiazhu.firstMoney = data.addMinMoney;
            self._thirdJiazhu.maxMoney = data.addMaxMoney;
            self.prepOps(data);
        });
        this.node.on('game_winner', function (data) {
            self.win.active = true;
        });
        this.node.on('game_loser', function (data) {
            self.lose.active = true;
        });
        this.node.on('game_over', function (data) {
            var data = data.detail;
            self.showOtherSeat(2);
            for (var i = 0; i < data.length; i++) {
                var seat = cc.vv.NetMgr.getSeatByID(data[i].userid);
                if (seat) {
                    seat.score = data[i].money;
                    var index = cc.vv.NetMgr.getLocalIndexByUserId(data[i].userid);
                    self._seats[index].showHoldsPai(data[i].holds, self);
                    self._seats[index].setMoney(data[i].money);
                    if (data[i].isWinner) {
                        self._seats[index].showWinText(parseInt(data[i].score[0]));
                    } else {
                        self._seats[index].showWinText();
                    }
                }
            }
            self.setBtnOps(4);
            self._timeout = setTimeout(function () {
                self.restart();
            }, 3000);
        });
        this.node.on('user_state_changed', function (data) {
            var seat = data.detail;
            var index = cc.vv.NetMgr.getLocalIndexByUserId(seat.userid);
            self._seats[index].seatHide();
        });
        this.node.on('exit_result', function (data) {
            clearInterval(self._timeout);
        });
        this.node.on('voice_msg', function (data) {
            var data = data.detail;
            self._voiceMsgQueue.push(data);
            self.playVoice();
        });
        this.node.on('chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.NetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.NetMgr.getLocalIndex(idx);
            self._seats[localIdx].chat(data.content);
        });
        this.node.on('quick_chat_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.NetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.NetMgr.getLocalIndex(idx);
            var index = data.content;
            var info = cc.vv.zjhchat.getQuickChatInfo(index);
            self._seats[localIdx].chat(info.content);
            cc.vv.audioMgr.playSFX(info.sound);
        });
        this.node.on('emoji_push', function (data) {
            var data = data.detail;
            var idx = cc.vv.NetMgr.getSeatIndexByID(data.sender);
            var localIdx = cc.vv.NetMgr.getLocalIndex(idx);
            self._seats[localIdx].emoji(data.content);
        });
        this.node.on('count_down', function (data) {
            var data = data.detail;
            self.countdown.string = data.countDown;
            self.countdown.node.active = true;
            if (data.countDown <= 0) {
                self.countdown.node.active = false;
            }
        });
        this.node.on('exit_room', function (data) {
            clearInterval(self._timeout);
            //刷新用户钱币数量
            self.getGemsAndCoins();
        });
    },
    //设置金币钻石数量
    getGemsAndCoins: function getGemsAndCoins() {
        var self = this;
        cc.vv.userMgr.getGemsAndCoins(function (data) {
            cc.vv.userMgr.gems = data.gems;
            cc.vv.userMgr.coins = data.coins;
        });
    },
    onPlayerOver: function onPlayerOver() {
        if (!cc.sys.isNative) {
            window.stopPlayVoice();
        };
        cc.vv.audioMgr.resumeAll();
        console.log("onPlayCallback:" + this._playingSeat);
        var localIndex = this._playingSeat;
        this._playingSeat = null;
        this._seats[localIndex].voiceMsg(false);
    },
    onDestroy: function onDestroy() {
        cc.vv.voiceMgr.stop();
        //        cc.vv.voiceMgr.onPlayCallback = null;
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (window.voice && window.voice.localId != null) {
            var localId = window.voice.localId;
            window.voice.localId = null;
            cc.vv.audioMgr.pauseAll();
            window.playVoice(localId);
        }
        var minutes = Math.floor(Date.now() / 1000 / 60);
        if (this._lastMinute != minutes) {
            this._lastMinute = minutes;
            var date = new Date();
            var h = date.getHours();
            h = h < 10 ? "0" + h : h;
            var m = date.getMinutes();
            m = m < 10 ? "0" + m : m;
            this._timeLabel.string = "" + h + ":" + m;
        }
        if (this._lastPlayTime != null) {
            if (Date.now() > this._lastPlayTime + 200) {
                this.onPlayerOver();
                this._lastPlayTime = null;
            }
        } else {
            this.playVoice();
        }
    }
});

cc._RFpop();
},{}],"dzpkSeat":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c3d5fiQArFKY7H29sGP47FH', 'dzpkSeat');
// scripts/dzpk/dzpkSeat.js

"use strict";

var _properties;

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

cc.Class({
    extends: cc.Component,
    properties: (_properties = {
        _sprIcon: null,
        _ready: null,
        _lblName: null,
        _lblScore: null,
        _voicemsg: null,
        _chatBubble: null,
        _emoji: null,
        _lastChatTime: -1,
        _userName: "",
        _score: 0,
        _isOffline: false,
        _userId: null,
        _time: -1,
        _op: null,
        _pai: null,
        _pais: [],
        _pai1: null,
        _pais1: [],
        _paimian: null,
        _timeLabel: null
    }, _defineProperty(_properties, "_time", -1), _defineProperty(_properties, "_toggle", null), _properties),
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._sprIcon = this.node.getChildByName("head").getComponent("ImageLoader");
        this._lblName = this.node.getChildByName("name").getComponent(cc.Label);
        this._lblScore = this.node.getChildByName("money").getComponent(cc.Label);
        this._op = this.node.getChildByName("text");
        this._xiazhu = this.node.getChildByName("xiazhu").getChildByName("money").getComponent(cc.Label);
        this._pai = this.node.getChildByName("pai");
        this._pai1 = this.node.getChildByName("jieguo");
        if (this._pai) {
            for (var i = 0; i < this._pai.childrenCount; i++) {
                this._pais[i] = this._pai.getChildByName("pai" + i);
            };
        }
        if (this._pai1) {
            for (var i = 0; i < this._pai1.childrenCount; i++) {
                this._pais1[i] = this._pai1.getChildByName("pai" + i);
            };
        }
        this._paimian = this.node.getChildByName("paimian");
        this._chatBubble = this.node.getChildByName("ChatBubble");
        this._emoji = this.node.getChildByName("emoji");
        this._count = this.node.getChildByName('count');
        this._op.active = false;
        this._xiazhu.string = 0;
        if (this._pai) this._pai.active = false;
        if (this._paimian) this._paimian.active = false;
        if (this._sprIcon && this._userId) {
            this._sprIcon.setUserID(this._userId);
        }
        this._toggle = this.node.getChildByName("toggle");
        this._timeLabel = this.node.getChildByName("toggle").getChildByName("lblTime").getComponent(cc.Label);
        this._timeLabel.string = "00";
        this.refresh();
    },
    refresh: function refresh() {
        if (this._lblName != null) {
            this._lblName.string = this._userName;
        }
        if (this._lblScore != null) {
            this._lblScore.string = this._score;
        }
        if (this._chatBubble) {
            this._chatBubble.active = false;
        }
        if (this._emoji) {
            this._emoji.active = false;
        }
        if (this._paimian) this._paimian.active = false;
        if (this._pai) this._pai.active = false;
        if (this._pai1) this._pai1.active = false;
        this.node.active = this._userName != null && this._userName != "";
    },
    restart: function restart() {
        if (this._paimian) this._paimian.active = false;
        if (this._pai) this._pai.active = false;
        if (this._pai1) this._pai1.active = false;
        if (this._op) this._op.active = false;
        if (this._lblName) this._lblName.node.active = true;
        this.node.getChildByName("cover").active = false;
        this.node.getChildByName("xiazhu").active = false;
    },
    setInfo: function setInfo(name, score) {
        this._userName = name;
        this._score = score;
        if (this._score == null) {
            this._score = 0;
        }
        if (this._lblScore != null) {
            this._lblScore.node.active = this._score != null;
        }
        this.refresh();
    },
    hideScore: function hideScore() {
        this.node.getChildByName("xiazhu").active = false;
    },
    setZhu: function setZhu(data) {
        var self = this;
        var time = 0;
        if (data.money > 0) {
            time = 350;
        }
        var fn = function fn(n) {
            setTimeout(function () {
                n ? n.active = false : null;
                if (!self.node.getChildByName("xiazhu").active) self.node.getChildByName("xiazhu").active = true;
                if (data.money == 0) self.node.getChildByName("xiazhu").active = false;
                if (data.type == 1) {
                    self._xiazhu.string = data.money;
                } else {
                    self._xiazhu.string = parseInt(self._xiazhu.string) + data.money;
                }
            }, time);
        };
        if (data.money > 0) {
            this.showXiaZhuAnim(fn);
        } else {
            fn(null);
        }
    },
    seatHide: function seatHide() {
        this.node.active = false;
        this._xiazhu.string = 0;
        this.node.getChildByName("xiazhu").active = false;
        this._op.active = false;
        this._userName = "";
        for (var i = 0; i < this._op.childrenCount; i++) {
            this._op.children[i].active = false;
        }
    },
    setReady: function setReady(isReady) {
        this._isReady = isReady;
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
    },
    setID: function setID(id) {
        var idNode = this.node.getChildByName("id");
        if (idNode) {
            var lbl = idNode.getComponent(cc.Label);
            lbl.string = "ID:" + id;
        }
        this._userId = id;
        if (this._sprIcon) {
            this._sprIcon.setUserID(id);
        }
    },
    getID: function getID() {
        return this._userId;
    },
    chat: function chat(content) {
        if (this._chatBubble == null) {
            return;
        }
        this._emoji.active = false;
        this._chatBubble.active = true;
        this._chatBubble.getComponent(cc.Label).string = content;
        this._chatBubble.getChildByName("New Label").getComponent(cc.Label).string = content;
        this._lastChatTime = 3;
    },
    emoji: function emoji(_emoji) {
        if (this._emoji == null) {
            return;
        }
        this._chatBubble.active = false;
        this._emoji.active = true;
        this._emoji.getComponent(cc.Animation).play(_emoji);
        this._lastChatTime = 3;
    },
    voiceMsg: function voiceMsg(show) {
        if (this._voicemsg) {
            this._voicemsg.active = show;
        }
    },
    showXiaZhuAnim: function showXiaZhuAnim(callback) {
        var x = this._lblScore.node.x;
        var y = this._lblScore.node.y;
        var endX = this.node.getChildByName("xiazhu").x;
        var endY = this.node.getChildByName("xiazhu").y;
        var node = this.node.getChildByName('chips');
        var newNode = cc.instantiate(node);
        newNode.name = "chips";
        this.node.addChild(newNode);
        newNode.active = true;
        newNode.spriteFrame = node.getComponent(cc.Sprite).spriteFrame;
        newNode.x = x;
        newNode.y = y;
        var action = cc.moveTo(0.35, cc.p(endX, endY));
        newNode.runAction(action);
        callback(newNode);
    },
    showOps: function showOps(type) {
        if (!this._op) return;
        if (type) {
            this._op.active = true;
            for (var i = 0; i < this._op.childrenCount; i++) {
                if (this._op.children[i].name == type) {
                    this._op.children[i].active = true;
                } else {
                    this._op.children[i].active = false;
                }
            };
            if (type == "qipai") {
                this.node.getChildByName("cover").active = true;
            }
            this._lblName.node.active = false;
        } else {
            if (this._op.getChildByName("qipai").active) {
                this._lblName.node.active = false;
            } else {
                this._lblName.node.active = true;
                this._op.active = false;
            }
        }
    },
    setPai: function setPai(data, parent) {
        if (data.length == 2 && this._pais.length > 0) {
            for (var i = 0; i < data.length; i++) {
                var paiRes = parent.ConversionCardRes(parseInt(data[i]));
                this._pais[i].getChildByName('num').getComponent(cc.Sprite).spriteFrame = paiRes['num'];
                this._pais[i].getChildByName('hua1').getComponent(cc.Sprite).spriteFrame = paiRes['h_s'];
                this._pais[i].getChildByName('hua2').getComponent(cc.Sprite).spriteFrame = paiRes['h_b'];
            };
            this._pai.active = true;
        }
    },
    showHoldsPai: function showHoldsPai(data, parent) {
        if (data.length == 2 && this._pais1) {
            for (var i = 0; i < data.length; i++) {
                var paiRes = parent.ConversionCardRes(parseInt(data[i]));
                this._pais1[i].getChildByName('num').getComponent(cc.Sprite).spriteFrame = paiRes['num'];
                this._pais1[i].getChildByName('hua1').getComponent(cc.Sprite).spriteFrame = paiRes['h_s'];
                this._pais1[i].getChildByName('hua2').getComponent(cc.Sprite).spriteFrame = paiRes['h_b'];
            };
            this._pai1.active = true;
            if (this._paimian) this._paimian.active = false;
            if (this._pai) this._pai.active = false;
        }
    },
    showWinText: function showWinText(type) {
        var title = "";
        switch (type) {
            case 9:
                title = "皇家同花顺赢";
                break;
            case 8:
                title = "同花顺赢";
                break;
            case 7:
                title = "金刚赢";
                break;
            case 6:
                title = "葫芦赢";
                break;
            case 5:
                title = "同花赢";
                break;
            case 4:
                title = "顺子赢";
                break;
            case 3:
                title = "三条赢";
                break;
            case 2:
                title = "双对赢";
                break;
            case 1:
                title = "一对赢";
                break;
            case 0:
                title = "高牌赢";
                break;
        }
        if (title == "") {
            this.node.getChildByName("cover").active = true;
            this._lblName.node.active = true;
        } else {
            if (this._pai1.active) {
                this._lblName.node.active = false;
            } else {
                this._lblName.node.active = true;
            }
        }
        this._pai1.getChildByName("text").getComponent(cc.Label).string = title;
        this.node.getChildByName("xiazhu").active = false;
    },
    showBeiPai: function showBeiPai(flag) {
        if (!this._paimian) return;
        this._paimian.active = flag;
    },
    setMoney: function setMoney(data) {
        //设置该玩家所拥有的的钱
        this._lblScore.string = data;
        this._score = data;
    },
    setTime: function setTime(o) {
        if (o) {
            this._time = o;
        } else {
            this._time = 30;
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._lastChatTime > 0) {
            this._lastChatTime -= dt;
            if (this._lastChatTime < 0) {
                this._chatBubble.active = false;
                this._emoji.active = false;
                this._emoji.getComponent(cc.Animation).stop();
            }
        }
        if (this._time > 0) {
            this._time -= dt;
            var pre = "";
            if (this._time < 0) {
                this._time = 0;
            }
            var t = Math.ceil(this._time);
            if (t < 10) {
                pre = "0";
            }
            this._timeLabel.string = pre + t;
        }
    }
});

cc._RFpop();
},{}],"socket-io":[function(require,module,exports){
(function (global){
"use strict";
cc._RFpush(module, '393290vPc1IIYfh8FrmxcNZ', 'socket-io');
// scripts/3rdparty/socket-io.js

"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

if (!CC_JSB && !cc.sys.isNative) {
	(function (f) {
		if ((typeof exports === "undefined" ? "undefined" : _typeof(exports)) === "object" && typeof module !== "undefined") {
			module.exports = f();
		} else if (typeof define === "function" && define.amd) {
			define([], f);
		} else {
			var g;
			if (typeof window !== "undefined") {
				g = window;
			} else if (typeof global !== "undefined") {
				g = global;
			} else if (typeof self !== "undefined") {
				g = self;
			} else {
				g = this;
			}
			g.io = f();
		}
	})(function () {
		var define, module, exports;
		return function e(t, n, r) {
			function s(o, u) {
				if (!n[o]) {
					if (!t[o]) {
						var a = typeof require == "function" && require;
						if (!u && a) return a(o, !0);
						if (i) return i(o, !0);
						var f = new Error("Cannot find module '" + o + "'");
						throw f.code = "MODULE_NOT_FOUND", f;
					}
					var l = n[o] = {
						exports: {}
					};
					t[o][0].call(l.exports, function (e) {
						var n = t[o][1][e];
						return s(n ? n : e);
					}, l, l.exports, e, t, n, r);
				}
				return n[o].exports;
			}
			var i = typeof require == "function" && require;
			for (var o = 0; o < r.length; o++) {
				s(r[o]);
			}return s;
		}({
			1: [function (_dereq_, module, exports) {

				module.exports = _dereq_('./lib/');
			}, {
				"./lib/": 2
			}],
			2: [function (_dereq_, module, exports) {

				module.exports = _dereq_('./socket');

				/**
     * Exports parser
     *
     * @api public
     *
     */
				module.exports.parser = _dereq_('engine.io-parser');
			}, {
				"./socket": 3,
				"engine.io-parser": 19
			}],
			3: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies.
      */

					var transports = _dereq_('./transports');
					var Emitter = _dereq_('component-emitter');
					var debug = _dereq_('debug')('engine.io-client:socket');
					var index = _dereq_('indexof');
					var parser = _dereq_('engine.io-parser');
					var parseuri = _dereq_('parseuri');
					var parsejson = _dereq_('parsejson');
					var parseqs = _dereq_('parseqs');

					/**
      * Module exports.
      */

					module.exports = Socket;

					/**
      * Noop function.
      *
      * @api private
      */

					function noop() {}

					/**
      * Socket constructor.
      *
      * @param {String|Object} uri or options
      * @param {Object} options
      * @api public
      */

					function Socket(uri, opts) {
						if (!(this instanceof Socket)) return new Socket(uri, opts);

						opts = opts || {};

						if (uri && 'object' == (typeof uri === "undefined" ? "undefined" : _typeof(uri))) {
							opts = uri;
							uri = null;
						}

						if (uri) {
							uri = parseuri(uri);
							opts.hostname = uri.host;
							opts.secure = uri.protocol == 'https' || uri.protocol == 'wss';
							opts.port = uri.port;
							if (uri.query) opts.query = uri.query;
						} else if (opts.host) {
							opts.hostname = parseuri(opts.host).host;
						}

						this.secure = null != opts.secure ? opts.secure : global.location && 'https:' == location.protocol;

						if (opts.hostname && !opts.port) {
							// if no port is specified manually, use the protocol default
							opts.port = this.secure ? '443' : '80';
						}

						this.agent = opts.agent || false;
						this.hostname = opts.hostname || (global.location ? location.hostname : 'localhost');
						this.port = opts.port || (global.location && location.port ? location.port : this.secure ? 443 : 80);
						this.query = opts.query || {};
						if ('string' == typeof this.query) this.query = parseqs.decode(this.query);
						this.upgrade = false !== opts.upgrade;
						this.path = (opts.path || '/engine.io').replace(/\/$/, '') + '/';
						this.forceJSONP = !!opts.forceJSONP;
						this.jsonp = false !== opts.jsonp;
						this.forceBase64 = !!opts.forceBase64;
						this.enablesXDR = !!opts.enablesXDR;
						this.timestampParam = opts.timestampParam || 't';
						this.timestampRequests = opts.timestampRequests;
						this.transports = opts.transports || ['polling', 'websocket'];
						this.readyState = '';
						this.writeBuffer = [];
						this.policyPort = opts.policyPort || 843;
						this.rememberUpgrade = opts.rememberUpgrade || false;
						this.binaryType = null;
						this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;
						this.perMessageDeflate = false !== opts.perMessageDeflate ? opts.perMessageDeflate || {} : false;

						if (true === this.perMessageDeflate) this.perMessageDeflate = {};
						if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {
							this.perMessageDeflate.threshold = 1024;
						}

						// SSL options for Node.js client
						this.pfx = opts.pfx || null;
						this.key = opts.key || null;
						this.passphrase = opts.passphrase || null;
						this.cert = opts.cert || null;
						this.ca = opts.ca || null;
						this.ciphers = opts.ciphers || null;
						this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;

						// other options for Node.js client
						var freeGlobal = (typeof global === "undefined" ? "undefined" : _typeof(global)) == 'object' && global;
						if (freeGlobal.global === freeGlobal) {
							if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {
								this.extraHeaders = opts.extraHeaders;
							}
						}

						this.open();
					}

					Socket.priorWebsocketSuccess = false;

					/**
      * Mix in `Emitter`.
      */

					Emitter(Socket.prototype);

					/**
      * Protocol version.
      *
      * @api public
      */

					Socket.protocol = parser.protocol; // this is an int

					/**
      * Expose deps for legacy compatibility
      * and standalone browser access.
      */

					Socket.Socket = Socket;
					Socket.Transport = _dereq_('./transport');
					Socket.transports = _dereq_('./transports');
					Socket.parser = _dereq_('engine.io-parser');

					/**
      * Creates transport of the given type.
      *
      * @param {String} transport name
      * @return {Transport}
      * @api private
      */

					Socket.prototype.createTransport = function (name) {
						debug('creating transport "%s"', name);
						var query = clone(this.query);

						// append engine.io protocol identifier
						query.EIO = parser.protocol;

						// transport name
						query.transport = name;

						// session id if we already have one
						if (this.id) query.sid = this.id;

						var transport = new transports[name]({
							agent: this.agent,
							hostname: this.hostname,
							port: this.port,
							secure: this.secure,
							path: this.path,
							query: query,
							forceJSONP: this.forceJSONP,
							jsonp: this.jsonp,
							forceBase64: this.forceBase64,
							enablesXDR: this.enablesXDR,
							timestampRequests: this.timestampRequests,
							timestampParam: this.timestampParam,
							policyPort: this.policyPort,
							socket: this,
							pfx: this.pfx,
							key: this.key,
							passphrase: this.passphrase,
							cert: this.cert,
							ca: this.ca,
							ciphers: this.ciphers,
							rejectUnauthorized: this.rejectUnauthorized,
							perMessageDeflate: this.perMessageDeflate,
							extraHeaders: this.extraHeaders
						});

						return transport;
					};

					function clone(obj) {
						var o = {};
						for (var i in obj) {
							if (obj.hasOwnProperty(i)) {
								o[i] = obj[i];
							}
						}
						return o;
					}

					/**
      * Initializes transport to use and starts probe.
      *
      * @api private
      */
					Socket.prototype.open = function () {
						var transport;
						if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') != -1) {
							transport = 'websocket';
						} else if (0 === this.transports.length) {
							// Emit error on next tick so it can be listened to
							var self = this;
							setTimeout(function () {
								self.emit('error', 'No transports available');
							}, 0);
							return;
						} else {
							transport = this.transports[0];
						}
						this.readyState = 'opening';

						// Retry with the next transport if the transport is disabled (jsonp: false)
						try {
							transport = this.createTransport(transport);
						} catch (e) {
							this.transports.shift();
							this.open();
							return;
						}

						transport.open();
						this.setTransport(transport);
					};

					/**
      * Sets the current transport. Disables the existing one (if any).
      *
      * @api private
      */

					Socket.prototype.setTransport = function (transport) {
						debug('setting transport %s', transport.name);
						var self = this;

						if (this.transport) {
							debug('clearing existing transport %s', this.transport.name);
							this.transport.removeAllListeners();
						}

						// set up transport
						this.transport = transport;

						// set up transport listeners
						transport.on('drain', function () {
							self.onDrain();
						}).on('packet', function (packet) {
							self.onPacket(packet);
						}).on('error', function (e) {
							self.onError(e);
						}).on('close', function () {
							self.onClose('transport close');
						});
					};

					/**
      * Probes a transport.
      *
      * @param {String} transport name
      * @api private
      */

					Socket.prototype.probe = function (name) {
						debug('probing transport "%s"', name);
						var transport = this.createTransport(name, {
							probe: 1
						}),
						    failed = false,
						    self = this;

						Socket.priorWebsocketSuccess = false;

						function onTransportOpen() {
							if (self.onlyBinaryUpgrades) {
								var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;
								failed = failed || upgradeLosesBinary;
							}
							if (failed) return;

							debug('probe transport "%s" opened', name);
							transport.send([{
								type: 'ping',
								data: 'probe'
							}]);
							transport.once('packet', function (msg) {
								if (failed) return;
								if ('pong' == msg.type && 'probe' == msg.data) {
									debug('probe transport "%s" pong', name);
									self.upgrading = true;
									self.emit('upgrading', transport);
									if (!transport) return;
									Socket.priorWebsocketSuccess = 'websocket' == transport.name;

									debug('pausing current transport "%s"', self.transport.name);
									self.transport.pause(function () {
										if (failed) return;
										if ('closed' == self.readyState) return;
										debug('changing transport and sending upgrade packet');

										cleanup();

										self.setTransport(transport);
										transport.send([{
											type: 'upgrade'
										}]);
										self.emit('upgrade', transport);
										transport = null;
										self.upgrading = false;
										self.flush();
									});
								} else {
									debug('probe transport "%s" failed', name);
									var err = new Error('probe error');
									err.transport = transport.name;
									self.emit('upgradeError', err);
								}
							});
						}

						function freezeTransport() {
							if (failed) return;

							// Any callback called by transport should be ignored since now
							failed = true;

							cleanup();

							transport.close();
							transport = null;
						}

						//Handle any error that happens while probing
						function onerror(err) {
							var error = new Error('probe error: ' + err);
							error.transport = transport.name;

							freezeTransport();

							debug('probe transport "%s" failed because of error: %s', name, err);

							self.emit('upgradeError', error);
						}

						function onTransportClose() {
							onerror("transport closed");
						}

						//When the socket is closed while we're probing
						function onclose() {
							onerror("socket closed");
						}

						//When the socket is upgraded while we're probing
						function onupgrade(to) {
							if (transport && to.name != transport.name) {
								debug('"%s" works - aborting "%s"', to.name, transport.name);
								freezeTransport();
							}
						}

						//Remove all listeners on the transport and on self
						function cleanup() {
							transport.removeListener('open', onTransportOpen);
							transport.removeListener('error', onerror);
							transport.removeListener('close', onTransportClose);
							self.removeListener('close', onclose);
							self.removeListener('upgrading', onupgrade);
						}

						transport.once('open', onTransportOpen);
						transport.once('error', onerror);
						transport.once('close', onTransportClose);

						this.once('close', onclose);
						this.once('upgrading', onupgrade);

						transport.open();
					};

					/**
      * Called when connection is deemed open.
      *
      * @api public
      */

					Socket.prototype.onOpen = function () {
						debug('socket open');
						this.readyState = 'open';
						Socket.priorWebsocketSuccess = 'websocket' == this.transport.name;
						this.emit('open');
						this.flush();

						// we check for `readyState` in case an `open`
						// listener already closed the socket
						if ('open' == this.readyState && this.upgrade && this.transport.pause) {
							debug('starting upgrade probes');
							for (var i = 0, l = this.upgrades.length; i < l; i++) {
								this.probe(this.upgrades[i]);
							}
						}
					};

					/**
      * Handles a packet.
      *
      * @api private
      */

					Socket.prototype.onPacket = function (packet) {
						if ('opening' == this.readyState || 'open' == this.readyState) {
							debug('socket receive: type "%s", data "%s"', packet.type, packet.data);

							this.emit('packet', packet);

							// Socket is live - any packet counts
							this.emit('heartbeat');

							switch (packet.type) {
								case 'open':
									this.onHandshake(parsejson(packet.data));
									break;

								case 'pong':
									this.setPing();
									this.emit('pong');
									break;

								case 'error':
									var err = new Error('server error');
									err.code = packet.data;
									this.onError(err);
									break;

								case 'message':
									this.emit('data', packet.data);
									this.emit('message', packet.data);
									break;
							}
						} else {
							debug('packet received with socket readyState "%s"', this.readyState);
						}
					};

					/**
      * Called upon handshake completion.
      *
      * @param {Object} handshake obj
      * @api private
      */

					Socket.prototype.onHandshake = function (data) {
						this.emit('handshake', data);
						this.id = data.sid;
						this.transport.query.sid = data.sid;
						this.upgrades = this.filterUpgrades(data.upgrades);
						this.pingInterval = data.pingInterval;
						this.pingTimeout = data.pingTimeout;
						this.onOpen();
						// In case open handler closes socket
						if ('closed' == this.readyState) return;
						this.setPing();

						// Prolong liveness of socket on heartbeat
						this.removeListener('heartbeat', this.onHeartbeat);
						this.on('heartbeat', this.onHeartbeat);
					};

					/**
      * Resets ping timeout.
      *
      * @api private
      */

					Socket.prototype.onHeartbeat = function (timeout) {
						clearTimeout(this.pingTimeoutTimer);
						var self = this;
						self.pingTimeoutTimer = setTimeout(function () {
							if ('closed' == self.readyState) return;
							self.onClose('ping timeout');
						}, timeout || self.pingInterval + self.pingTimeout);
					};

					/**
      * Pings server every `this.pingInterval` and expects response
      * within `this.pingTimeout` or closes connection.
      *
      * @api private
      */

					Socket.prototype.setPing = function () {
						var self = this;
						clearTimeout(self.pingIntervalTimer);
						self.pingIntervalTimer = setTimeout(function () {
							debug('writing ping packet - expecting pong within %sms', self.pingTimeout);
							self.ping();
							self.onHeartbeat(self.pingTimeout);
						}, self.pingInterval);
					};

					/**
      * Sends a ping packet.
      *
      * @api private
      */

					Socket.prototype.ping = function () {
						var self = this;
						this.sendPacket('ping', function () {
							self.emit('ping');
						});
					};

					/**
      * Called on `drain` event
      *
      * @api private
      */

					Socket.prototype.onDrain = function () {
						this.writeBuffer.splice(0, this.prevBufferLen);

						// setting prevBufferLen = 0 is very important
						// for example, when upgrading, upgrade packet is sent over,
						// and a nonzero prevBufferLen could cause problems on `drain`
						this.prevBufferLen = 0;

						if (0 === this.writeBuffer.length) {
							this.emit('drain');
						} else {
							this.flush();
						}
					};

					/**
      * Flush write buffers.
      *
      * @api private
      */

					Socket.prototype.flush = function () {
						if ('closed' != this.readyState && this.transport.writable && !this.upgrading && this.writeBuffer.length) {
							debug('flushing %d packets in socket', this.writeBuffer.length);
							this.transport.send(this.writeBuffer);
							// keep track of current length of writeBuffer
							// splice writeBuffer and callbackBuffer on `drain`
							this.prevBufferLen = this.writeBuffer.length;
							this.emit('flush');
						}
					};

					/**
      * Sends a message.
      *
      * @param {String} message.
      * @param {Function} callback function.
      * @param {Object} options.
      * @return {Socket} for chaining.
      * @api public
      */

					Socket.prototype.write = Socket.prototype.send = function (msg, options, fn) {
						this.sendPacket('message', msg, options, fn);
						return this;
					};

					/**
      * Sends a packet.
      *
      * @param {String} packet type.
      * @param {String} data.
      * @param {Object} options.
      * @param {Function} callback function.
      * @api private
      */

					Socket.prototype.sendPacket = function (type, data, options, fn) {
						if ('function' == typeof data) {
							fn = data;
							data = undefined;
						}

						if ('function' == typeof options) {
							fn = options;
							options = null;
						}

						if ('closing' == this.readyState || 'closed' == this.readyState) {
							return;
						}

						options = options || {};
						options.compress = false !== options.compress;

						var packet = {
							type: type,
							data: data,
							options: options
						};
						this.emit('packetCreate', packet);
						this.writeBuffer.push(packet);
						if (fn) this.once('flush', fn);
						this.flush();
					};

					/**
      * Closes the connection.
      *
      * @api private
      */

					Socket.prototype.close = function () {
						if ('opening' == this.readyState || 'open' == this.readyState) {
							this.readyState = 'closing';

							var self = this;

							if (this.writeBuffer.length) {
								this.once('drain', function () {
									if (this.upgrading) {
										waitForUpgrade();
									} else {
										close();
									}
								});
							} else if (this.upgrading) {
								waitForUpgrade();
							} else {
								close();
							}
						}

						function close() {
							self.onClose('forced close');
							debug('socket closing - telling transport to close');
							self.transport.close();
						}

						function cleanupAndClose() {
							self.removeListener('upgrade', cleanupAndClose);
							self.removeListener('upgradeError', cleanupAndClose);
							close();
						}

						function waitForUpgrade() {
							// wait for upgrade to finish since we can't send packets while pausing a transport
							self.once('upgrade', cleanupAndClose);
							self.once('upgradeError', cleanupAndClose);
						}

						return this;
					};

					/**
      * Called upon transport error
      *
      * @api private
      */

					Socket.prototype.onError = function (err) {
						debug('socket error %j', err);
						Socket.priorWebsocketSuccess = false;
						this.emit('error', err);
						this.onClose('transport error', err);
					};

					/**
      * Called upon transport close.
      *
      * @api private
      */

					Socket.prototype.onClose = function (reason, desc) {
						if ('opening' == this.readyState || 'open' == this.readyState || 'closing' == this.readyState) {
							debug('socket close with reason: "%s"', reason);
							var self = this;

							// clear timers
							clearTimeout(this.pingIntervalTimer);
							clearTimeout(this.pingTimeoutTimer);

							// stop event from firing again for transport
							this.transport.removeAllListeners('close');

							// ensure transport won't stay open
							this.transport.close();

							// ignore further transport communication
							this.transport.removeAllListeners();

							// set ready state
							this.readyState = 'closed';

							// clear session id
							this.id = null;

							// emit close event
							this.emit('close', reason, desc);

							// clean buffers after, so users can still
							// grab the buffers on `close` event
							self.writeBuffer = [];
							self.prevBufferLen = 0;
						}
					};

					/**
      * Filters upgrades, returning only those matching client transports.
      *
      * @param {Array} server upgrades
      * @api private
      *
      */

					Socket.prototype.filterUpgrades = function (upgrades) {
						var filteredUpgrades = [];
						for (var i = 0, j = upgrades.length; i < j; i++) {
							if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);
						}
						return filteredUpgrades;
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"./transport": 4,
				"./transports": 5,
				"component-emitter": 15,
				"debug": 17,
				"engine.io-parser": 19,
				"indexof": 23,
				"parsejson": 26,
				"parseqs": 27,
				"parseuri": 28
			}],
			4: [function (_dereq_, module, exports) {
				/**
     * Module dependencies.
     */

				var parser = _dereq_('engine.io-parser');
				var Emitter = _dereq_('component-emitter');

				/**
     * Module exports.
     */

				module.exports = Transport;

				/**
     * Transport abstract constructor.
     *
     * @param {Object} options.
     * @api private
     */

				function Transport(opts) {
					this.path = opts.path;
					this.hostname = opts.hostname;
					this.port = opts.port;
					this.secure = opts.secure;
					this.query = opts.query;
					this.timestampParam = opts.timestampParam;
					this.timestampRequests = opts.timestampRequests;
					this.readyState = '';
					this.agent = opts.agent || false;
					this.socket = opts.socket;
					this.enablesXDR = opts.enablesXDR;

					// SSL options for Node.js client
					this.pfx = opts.pfx;
					this.key = opts.key;
					this.passphrase = opts.passphrase;
					this.cert = opts.cert;
					this.ca = opts.ca;
					this.ciphers = opts.ciphers;
					this.rejectUnauthorized = opts.rejectUnauthorized;

					// other options for Node.js client
					this.extraHeaders = opts.extraHeaders;
				}

				/**
     * Mix in `Emitter`.
     */

				Emitter(Transport.prototype);

				/**
     * Emits an error.
     *
     * @param {String} str
     * @return {Transport} for chaining
     * @api public
     */

				Transport.prototype.onError = function (msg, desc) {
					var err = new Error(msg);
					err.type = 'TransportError';
					err.description = desc;
					this.emit('error', err);
					return this;
				};

				/**
     * Opens the transport.
     *
     * @api public
     */

				Transport.prototype.open = function () {
					if ('closed' == this.readyState || '' == this.readyState) {
						this.readyState = 'opening';
						this.doOpen();
					}

					return this;
				};

				/**
     * Closes the transport.
     *
     * @api private
     */

				Transport.prototype.close = function () {
					if ('opening' == this.readyState || 'open' == this.readyState) {
						this.doClose();
						this.onClose();
					}

					return this;
				};

				/**
     * Sends multiple packets.
     *
     * @param {Array} packets
     * @api private
     */

				Transport.prototype.send = function (packets) {
					if ('open' == this.readyState) {
						this.write(packets);
					} else {
						throw new Error('Transport not open');
					}
				};

				/**
     * Called upon open
     *
     * @api private
     */

				Transport.prototype.onOpen = function () {
					this.readyState = 'open';
					this.writable = true;
					this.emit('open');
				};

				/**
     * Called with data.
     *
     * @param {String} data
     * @api private
     */

				Transport.prototype.onData = function (data) {
					var packet = parser.decodePacket(data, this.socket.binaryType);
					this.onPacket(packet);
				};

				/**
     * Called with a decoded packet.
     */

				Transport.prototype.onPacket = function (packet) {
					this.emit('packet', packet);
				};

				/**
     * Called upon close.
     *
     * @api private
     */

				Transport.prototype.onClose = function () {
					this.readyState = 'closed';
					this.emit('close');
				};
			}, {
				"component-emitter": 15,
				"engine.io-parser": 19
			}],
			5: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies
      */

					var XMLHttpRequest = _dereq_('xmlhttprequest-ssl');
					var XHR = _dereq_('./polling-xhr');
					var JSONP = _dereq_('./polling-jsonp');
					var websocket = _dereq_('./websocket');

					/**
      * Export transports.
      */

					exports.polling = polling;
					exports.websocket = websocket;

					/**
      * Polling transport polymorphic constructor.
      * Decides on xhr vs jsonp based on feature detection.
      *
      * @api private
      */

					function polling(opts) {
						var xhr;
						var xd = false;
						var xs = false;
						var jsonp = false !== opts.jsonp;

						if (global.location) {
							var isSSL = 'https:' == location.protocol;
							var port = location.port;

							// some user agents have empty `location.port`
							if (!port) {
								port = isSSL ? 443 : 80;
							}

							xd = opts.hostname != location.hostname || port != opts.port;
							xs = opts.secure != isSSL;
						}

						opts.xdomain = xd;
						opts.xscheme = xs;
						xhr = new XMLHttpRequest(opts);

						if ('open' in xhr && !opts.forceJSONP) {
							return new XHR(opts);
						} else {
							if (!jsonp) throw new Error('JSONP disabled');
							return new JSONP(opts);
						}
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"./polling-jsonp": 6,
				"./polling-xhr": 7,
				"./websocket": 9,
				"xmlhttprequest-ssl": 10
			}],
			6: [function (_dereq_, module, exports) {
				(function (global) {

					/**
      * Module requirements.
      */

					var Polling = _dereq_('./polling');
					var inherit = _dereq_('component-inherit');

					/**
      * Module exports.
      */

					module.exports = JSONPPolling;

					/**
      * Cached regular expressions.
      */

					var rNewline = /\n/g;
					var rEscapedNewline = /\\n/g;

					/**
      * Global JSONP callbacks.
      */

					var callbacks;

					/**
      * Callbacks count.
      */

					var index = 0;

					/**
      * Noop.
      */

					function empty() {}

					/**
      * JSONP Polling constructor.
      *
      * @param {Object} opts.
      * @api public
      */

					function JSONPPolling(opts) {
						Polling.call(this, opts);

						this.query = this.query || {};

						// define global callbacks array if not present
						// we do this here (lazily) to avoid unneeded global pollution
						if (!callbacks) {
							// we need to consider multiple engines in the same page
							if (!global.___eio) global.___eio = [];
							callbacks = global.___eio;
						}

						// callback identifier
						this.index = callbacks.length;

						// add callback to jsonp global
						var self = this;
						callbacks.push(function (msg) {
							self.onData(msg);
						});

						// append to query string
						this.query.j = this.index;

						// prevent spurious errors from being emitted when the window is unloaded
						if (global.document && global.addEventListener) {
							global.addEventListener('beforeunload', function () {
								if (self.script) self.script.onerror = empty;
							}, false);
						}
					}

					/**
      * Inherits from Polling.
      */

					inherit(JSONPPolling, Polling);

					/*
      * JSONP only supports binary as base64 encoded strings
      */

					JSONPPolling.prototype.supportsBinary = false;

					/**
      * Closes the socket.
      *
      * @api private
      */

					JSONPPolling.prototype.doClose = function () {
						if (this.script) {
							this.script.parentNode.removeChild(this.script);
							this.script = null;
						}

						if (this.form) {
							this.form.parentNode.removeChild(this.form);
							this.form = null;
							this.iframe = null;
						}

						Polling.prototype.doClose.call(this);
					};

					/**
      * Starts a poll cycle.
      *
      * @api private
      */

					JSONPPolling.prototype.doPoll = function () {
						var self = this;
						var script = document.createElement('script');

						if (this.script) {
							this.script.parentNode.removeChild(this.script);
							this.script = null;
						}

						script.async = true;
						script.src = this.uri();
						script.onerror = function (e) {
							self.onError('jsonp poll error', e);
						};

						var insertAt = document.getElementsByTagName('script')[0];
						if (insertAt) {
							insertAt.parentNode.insertBefore(script, insertAt);
						} else {
							(document.head || document.body).appendChild(script);
						}
						this.script = script;

						var isUAgecko = 'undefined' != typeof navigator && /gecko/i.test(navigator.userAgent);

						if (isUAgecko) {
							setTimeout(function () {
								var iframe = document.createElement('iframe');
								document.body.appendChild(iframe);
								document.body.removeChild(iframe);
							}, 100);
						}
					};

					/**
      * Writes with a hidden iframe.
      *
      * @param {String} data to send
      * @param {Function} called upon flush.
      * @api private
      */

					JSONPPolling.prototype.doWrite = function (data, fn) {
						var self = this;

						if (!this.form) {
							var form = document.createElement('form');
							var area = document.createElement('textarea');
							var id = this.iframeId = 'eio_iframe_' + this.index;
							var iframe;

							form.className = 'socketio';
							form.style.position = 'absolute';
							form.style.top = '-1000px';
							form.style.left = '-1000px';
							form.target = id;
							form.method = 'POST';
							form.setAttribute('accept-charset', 'utf-8');
							area.name = 'd';
							form.appendChild(area);
							document.body.appendChild(form);

							this.form = form;
							this.area = area;
						}

						this.form.action = this.uri();

						function complete() {
							initIframe();
							fn();
						}

						function initIframe() {
							if (self.iframe) {
								try {
									self.form.removeChild(self.iframe);
								} catch (e) {
									self.onError('jsonp polling iframe removal error', e);
								}
							}

							try {
								// ie6 dynamic iframes with target="" support (thanks Chris Lambacher)
								var html = '<iframe src="javascript:0" name="' + self.iframeId + '">';
								iframe = document.createElement(html);
							} catch (e) {
								iframe = document.createElement('iframe');
								iframe.name = self.iframeId;
								iframe.src = 'javascript:0';
							}

							iframe.id = self.iframeId;

							self.form.appendChild(iframe);
							self.iframe = iframe;
						}

						initIframe();

						// escape \n to prevent it from being converted into \r\n by some UAs
						// double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side
						data = data.replace(rEscapedNewline, '\\\n');
						this.area.value = data.replace(rNewline, '\\n');

						try {
							this.form.submit();
						} catch (e) {}

						if (this.iframe.attachEvent) {
							this.iframe.onreadystatechange = function () {
								if (self.iframe.readyState == 'complete') {
									complete();
								}
							};
						} else {
							this.iframe.onload = complete;
						}
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"./polling": 8,
				"component-inherit": 16
			}],
			7: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module requirements.
      */

					var XMLHttpRequest = _dereq_('xmlhttprequest-ssl');
					var Polling = _dereq_('./polling');
					var Emitter = _dereq_('component-emitter');
					var inherit = _dereq_('component-inherit');
					var debug = _dereq_('debug')('engine.io-client:polling-xhr');

					/**
      * Module exports.
      */

					module.exports = XHR;
					module.exports.Request = Request;

					/**
      * Empty function
      */

					function empty() {}

					/**
      * XHR Polling constructor.
      *
      * @param {Object} opts
      * @api public
      */

					function XHR(opts) {
						Polling.call(this, opts);

						if (global.location) {
							var isSSL = 'https:' == location.protocol;
							var port = location.port;

							// some user agents have empty `location.port`
							if (!port) {
								port = isSSL ? 443 : 80;
							}

							this.xd = opts.hostname != global.location.hostname || port != opts.port;
							this.xs = opts.secure != isSSL;
						} else {
							this.extraHeaders = opts.extraHeaders;
						}
					}

					/**
      * Inherits from Polling.
      */

					inherit(XHR, Polling);

					/**
      * XHR supports binary
      */

					XHR.prototype.supportsBinary = true;

					/**
      * Creates a request.
      *
      * @param {String} method
      * @api private
      */

					XHR.prototype.request = function (opts) {
						opts = opts || {};
						opts.uri = this.uri();
						opts.xd = this.xd;
						opts.xs = this.xs;
						opts.agent = this.agent || false;
						opts.supportsBinary = this.supportsBinary;
						opts.enablesXDR = this.enablesXDR;

						// SSL options for Node.js client
						opts.pfx = this.pfx;
						opts.key = this.key;
						opts.passphrase = this.passphrase;
						opts.cert = this.cert;
						opts.ca = this.ca;
						opts.ciphers = this.ciphers;
						opts.rejectUnauthorized = this.rejectUnauthorized;

						// other options for Node.js client
						opts.extraHeaders = this.extraHeaders;

						return new Request(opts);
					};

					/**
      * Sends data.
      *
      * @param {String} data to send.
      * @param {Function} called upon flush.
      * @api private
      */

					XHR.prototype.doWrite = function (data, fn) {
						var isBinary = typeof data !== 'string' && data !== undefined;
						var req = this.request({
							method: 'POST',
							data: data,
							isBinary: isBinary
						});
						var self = this;
						req.on('success', fn);
						req.on('error', function (err) {
							self.onError('xhr post error', err);
						});
						this.sendXhr = req;
					};

					/**
      * Starts a poll cycle.
      *
      * @api private
      */

					XHR.prototype.doPoll = function () {
						debug('xhr poll');
						var req = this.request();
						var self = this;
						req.on('data', function (data) {
							self.onData(data);
						});
						req.on('error', function (err) {
							self.onError('xhr poll error', err);
						});
						this.pollXhr = req;
					};

					/**
      * Request constructor
      *
      * @param {Object} options
      * @api public
      */

					function Request(opts) {
						this.method = opts.method || 'GET';
						this.uri = opts.uri;
						this.xd = !!opts.xd;
						this.xs = !!opts.xs;
						this.async = false !== opts.async;
						this.data = undefined != opts.data ? opts.data : null;
						this.agent = opts.agent;
						this.isBinary = opts.isBinary;
						this.supportsBinary = opts.supportsBinary;
						this.enablesXDR = opts.enablesXDR;

						// SSL options for Node.js client
						this.pfx = opts.pfx;
						this.key = opts.key;
						this.passphrase = opts.passphrase;
						this.cert = opts.cert;
						this.ca = opts.ca;
						this.ciphers = opts.ciphers;
						this.rejectUnauthorized = opts.rejectUnauthorized;

						// other options for Node.js client
						this.extraHeaders = opts.extraHeaders;

						this.create();
					}

					/**
      * Mix in `Emitter`.
      */

					Emitter(Request.prototype);

					/**
      * Creates the XHR object and sends the request.
      *
      * @api private
      */

					Request.prototype.create = function () {
						var opts = {
							agent: this.agent,
							xdomain: this.xd,
							xscheme: this.xs,
							enablesXDR: this.enablesXDR
						};

						// SSL options for Node.js client
						opts.pfx = this.pfx;
						opts.key = this.key;
						opts.passphrase = this.passphrase;
						opts.cert = this.cert;
						opts.ca = this.ca;
						opts.ciphers = this.ciphers;
						opts.rejectUnauthorized = this.rejectUnauthorized;

						var xhr = this.xhr = new XMLHttpRequest(opts);
						var self = this;

						try {
							debug('xhr open %s: %s', this.method, this.uri);
							xhr.open(this.method, this.uri, this.async);
							try {
								if (this.extraHeaders) {
									xhr.setDisableHeaderCheck(true);
									for (var i in this.extraHeaders) {
										if (this.extraHeaders.hasOwnProperty(i)) {
											xhr.setRequestHeader(i, this.extraHeaders[i]);
										}
									}
								}
							} catch (e) {}
							if (this.supportsBinary) {
								// This has to be done after open because Firefox is stupid
								// http://stackoverflow.com/questions/13216903/get-binary-data-with-xmlhttprequest-in-a-firefox-extension
								xhr.responseType = 'arraybuffer';
							}

							if ('POST' == this.method) {
								try {
									if (this.isBinary) {
										xhr.setRequestHeader('Content-type', 'application/octet-stream');
									} else {
										xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');
									}
								} catch (e) {}
							}

							// ie6 check
							if ('withCredentials' in xhr) {
								xhr.withCredentials = true;
							}

							if (this.hasXDR()) {
								xhr.onload = function () {
									self.onLoad();
								};
								xhr.onerror = function () {
									self.onError(xhr.responseText);
								};
							} else {
								xhr.onreadystatechange = function () {
									if (4 != xhr.readyState) return;
									if (200 == xhr.status || 1223 == xhr.status) {
										self.onLoad();
									} else {
										// make sure the `error` event handler that's user-set
										// does not throw in the same tick and gets caught here
										setTimeout(function () {
											self.onError(xhr.status);
										}, 0);
									}
								};
							}

							debug('xhr data %s', this.data);
							xhr.send(this.data);
						} catch (e) {
							// Need to defer since .create() is called directly fhrom the constructor
							// and thus the 'error' event can only be only bound *after* this exception
							// occurs.  Therefore, also, we cannot throw here at all.
							setTimeout(function () {
								self.onError(e);
							}, 0);
							return;
						}

						if (global.document) {
							this.index = Request.requestsCount++;
							Request.requests[this.index] = this;
						}
					};

					/**
      * Called upon successful response.
      *
      * @api private
      */

					Request.prototype.onSuccess = function () {
						this.emit('success');
						this.cleanup();
					};

					/**
      * Called if we have data.
      *
      * @api private
      */

					Request.prototype.onData = function (data) {
						this.emit('data', data);
						this.onSuccess();
					};

					/**
      * Called upon error.
      *
      * @api private
      */

					Request.prototype.onError = function (err) {
						this.emit('error', err);
						this.cleanup(true);
					};

					/**
      * Cleans up house.
      *
      * @api private
      */

					Request.prototype.cleanup = function (fromError) {
						if ('undefined' == typeof this.xhr || null === this.xhr) {
							return;
						}
						// xmlhttprequest
						if (this.hasXDR()) {
							this.xhr.onload = this.xhr.onerror = empty;
						} else {
							this.xhr.onreadystatechange = empty;
						}

						if (fromError) {
							try {
								this.xhr.abort();
							} catch (e) {}
						}

						if (global.document) {
							delete Request.requests[this.index];
						}

						this.xhr = null;
					};

					/**
      * Called upon load.
      *
      * @api private
      */

					Request.prototype.onLoad = function () {
						var data;
						try {
							var contentType;
							try {
								contentType = this.xhr.getResponseHeader('Content-Type').split(';')[0];
							} catch (e) {}
							if (contentType === 'application/octet-stream') {
								data = this.xhr.response;
							} else {
								if (!this.supportsBinary) {
									data = this.xhr.responseText;
								} else {
									try {
										data = String.fromCharCode.apply(null, new Uint8Array(this.xhr.response));
									} catch (e) {
										var ui8Arr = new Uint8Array(this.xhr.response);
										var dataArray = [];
										for (var idx = 0, length = ui8Arr.length; idx < length; idx++) {
											dataArray.push(ui8Arr[idx]);
										}

										data = String.fromCharCode.apply(null, dataArray);
									}
								}
							}
						} catch (e) {
							this.onError(e);
						}
						if (null != data) {
							this.onData(data);
						}
					};

					/**
      * Check if it has XDomainRequest.
      *
      * @api private
      */

					Request.prototype.hasXDR = function () {
						return 'undefined' !== typeof global.XDomainRequest && !this.xs && this.enablesXDR;
					};

					/**
      * Aborts the request.
      *
      * @api public
      */

					Request.prototype.abort = function () {
						this.cleanup();
					};

					/**
      * Aborts pending requests when unloading the window. This is needed to prevent
      * memory leaks (e.g. when using IE) and to ensure that no spurious error is
      * emitted.
      */

					if (global.document) {
						Request.requestsCount = 0;
						Request.requests = {};
						if (global.attachEvent) {
							global.attachEvent('onunload', unloadHandler);
						} else if (global.addEventListener) {
							global.addEventListener('beforeunload', unloadHandler, false);
						}
					}

					function unloadHandler() {
						for (var i in Request.requests) {
							if (Request.requests.hasOwnProperty(i)) {
								Request.requests[i].abort();
							}
						}
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"./polling": 8,
				"component-emitter": 15,
				"component-inherit": 16,
				"debug": 17,
				"xmlhttprequest-ssl": 10
			}],
			8: [function (_dereq_, module, exports) {
				/**
     * Module dependencies.
     */

				var Transport = _dereq_('../transport');
				var parseqs = _dereq_('parseqs');
				var parser = _dereq_('engine.io-parser');
				var inherit = _dereq_('component-inherit');
				var yeast = _dereq_('yeast');
				var debug = _dereq_('debug')('engine.io-client:polling');

				/**
     * Module exports.
     */

				module.exports = Polling;

				/**
     * Is XHR2 supported?
     */

				var hasXHR2 = function () {
					var XMLHttpRequest = _dereq_('xmlhttprequest-ssl');
					var xhr = new XMLHttpRequest({
						xdomain: false
					});
					return null != xhr.responseType;
				}();

				/**
     * Polling interface.
     *
     * @param {Object} opts
     * @api private
     */

				function Polling(opts) {
					var forceBase64 = opts && opts.forceBase64;
					if (!hasXHR2 || forceBase64) {
						this.supportsBinary = false;
					}
					Transport.call(this, opts);
				}

				/**
     * Inherits from Transport.
     */

				inherit(Polling, Transport);

				/**
     * Transport name.
     */

				Polling.prototype.name = 'polling';

				/**
     * Opens the socket (triggers polling). We write a PING message to determine
     * when the transport is open.
     *
     * @api private
     */

				Polling.prototype.doOpen = function () {
					this.poll();
				};

				/**
     * Pauses polling.
     *
     * @param {Function} callback upon buffers are flushed and transport is paused
     * @api private
     */

				Polling.prototype.pause = function (onPause) {
					var pending = 0;
					var self = this;

					this.readyState = 'pausing';

					function pause() {
						debug('paused');
						self.readyState = 'paused';
						onPause();
					}

					if (this.polling || !this.writable) {
						var total = 0;

						if (this.polling) {
							debug('we are currently polling - waiting to pause');
							total++;
							this.once('pollComplete', function () {
								debug('pre-pause polling complete');
								--total || pause();
							});
						}

						if (!this.writable) {
							debug('we are currently writing - waiting to pause');
							total++;
							this.once('drain', function () {
								debug('pre-pause writing complete');
								--total || pause();
							});
						}
					} else {
						pause();
					}
				};

				/**
     * Starts polling cycle.
     *
     * @api public
     */

				Polling.prototype.poll = function () {
					debug('polling');
					this.polling = true;
					this.doPoll();
					this.emit('poll');
				};

				/**
     * Overloads onData to detect payloads.
     *
     * @api private
     */

				Polling.prototype.onData = function (data) {
					var self = this;
					debug('polling got data %s', data);
					var callback = function callback(packet, index, total) {
						// if its the first message we consider the transport open
						if ('opening' == self.readyState) {
							self.onOpen();
						}

						// if its a close packet, we close the ongoing requests
						if ('close' == packet.type) {
							self.onClose();
							return false;
						}

						// otherwise bypass onData and handle the message
						self.onPacket(packet);
					};

					// decode payload
					parser.decodePayload(data, this.socket.binaryType, callback);

					// if an event did not trigger closing
					if ('closed' != this.readyState) {
						// if we got data we're not polling
						this.polling = false;
						this.emit('pollComplete');

						if ('open' == this.readyState) {
							this.poll();
						} else {
							debug('ignoring poll - transport state "%s"', this.readyState);
						}
					}
				};

				/**
     * For polling, send a close packet.
     *
     * @api private
     */

				Polling.prototype.doClose = function () {
					var self = this;

					function close() {
						debug('writing close packet');
						self.write([{
							type: 'close'
						}]);
					}

					if ('open' == this.readyState) {
						debug('transport open - closing');
						close();
					} else {
						// in case we're trying to close while
						// handshaking is in progress (GH-164)
						debug('transport not open - deferring close');
						this.once('open', close);
					}
				};

				/**
     * Writes a packets payload.
     *
     * @param {Array} data packets
     * @param {Function} drain callback
     * @api private
     */

				Polling.prototype.write = function (packets) {
					var self = this;
					this.writable = false;
					var callbackfn = function callbackfn() {
						self.writable = true;
						self.emit('drain');
					};

					var self = this;
					parser.encodePayload(packets, this.supportsBinary, function (data) {
						self.doWrite(data, callbackfn);
					});
				};

				/**
     * Generates uri for connection.
     *
     * @api private
     */

				Polling.prototype.uri = function () {
					var query = this.query || {};
					var schema = this.secure ? 'https' : 'http';
					var port = '';

					// cache busting is forced
					if (false !== this.timestampRequests) {
						query[this.timestampParam] = yeast();
					}

					if (!this.supportsBinary && !query.sid) {
						query.b64 = 1;
					}

					query = parseqs.encode(query);

					// avoid port if default for schema
					if (this.port && ('https' == schema && this.port != 443 || 'http' == schema && this.port != 80)) {
						port = ':' + this.port;
					}

					// prepend ? to query
					if (query.length) {
						query = '?' + query;
					}

					var ipv6 = this.hostname.indexOf(':') !== -1;
					return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;
				};
			}, {
				"../transport": 4,
				"component-inherit": 16,
				"debug": 17,
				"engine.io-parser": 19,
				"parseqs": 27,
				"xmlhttprequest-ssl": 10,
				"yeast": 30
			}],
			9: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies.
      */

					var Transport = _dereq_('../transport');
					var parser = _dereq_('engine.io-parser');
					var parseqs = _dereq_('parseqs');
					var inherit = _dereq_('component-inherit');
					var yeast = _dereq_('yeast');
					var debug = _dereq_('debug')('engine.io-client:websocket');
					var BrowserWebSocket = global.WebSocket || global.MozWebSocket;

					/**
      * Get either the `WebSocket` or `MozWebSocket` globals
      * in the browser or try to resolve WebSocket-compatible
      * interface exposed by `ws` for Node-like environment.
      */

					var WebSocket = BrowserWebSocket;
					if (!WebSocket && typeof window === 'undefined') {
						try {
							WebSocket = _dereq_('ws');
						} catch (e) {}
					}

					/**
      * Module exports.
      */

					module.exports = WS;

					/**
      * WebSocket transport constructor.
      *
      * @api {Object} connection options
      * @api public
      */

					function WS(opts) {
						var forceBase64 = opts && opts.forceBase64;
						if (forceBase64) {
							this.supportsBinary = false;
						}
						this.perMessageDeflate = opts.perMessageDeflate;
						Transport.call(this, opts);
					}

					/**
      * Inherits from Transport.
      */

					inherit(WS, Transport);

					/**
      * Transport name.
      *
      * @api public
      */

					WS.prototype.name = 'websocket';

					/*
      * WebSockets support binary
      */

					WS.prototype.supportsBinary = true;

					/**
      * Opens socket.
      *
      * @api private
      */

					WS.prototype.doOpen = function () {
						if (!this.check()) {
							// let probe timeout
							return;
						}

						var self = this;
						var uri = this.uri();
						var protocols = void 0;
						var opts = {
							agent: this.agent,
							perMessageDeflate: this.perMessageDeflate
						};

						// SSL options for Node.js client
						opts.pfx = this.pfx;
						opts.key = this.key;
						opts.passphrase = this.passphrase;
						opts.cert = this.cert;
						opts.ca = this.ca;
						opts.ciphers = this.ciphers;
						opts.rejectUnauthorized = this.rejectUnauthorized;
						if (this.extraHeaders) {
							opts.headers = this.extraHeaders;
						}

						this.ws = BrowserWebSocket ? new WebSocket(uri) : new WebSocket(uri, protocols, opts);

						if (this.ws.binaryType === undefined) {
							this.supportsBinary = false;
						}

						if (this.ws.supports && this.ws.supports.binary) {
							this.supportsBinary = true;
							this.ws.binaryType = 'buffer';
						} else {
							this.ws.binaryType = 'arraybuffer';
						}

						this.addEventListeners();
					};

					/**
      * Adds event listeners to the socket
      *
      * @api private
      */

					WS.prototype.addEventListeners = function () {
						var self = this;

						this.ws.onopen = function () {
							self.onOpen();
						};
						this.ws.onclose = function () {
							self.onClose();
						};
						this.ws.onmessage = function (ev) {
							self.onData(ev.data);
						};
						this.ws.onerror = function (e) {
							self.onError('websocket error', e);
						};
					};

					/**
      * Override `onData` to use a timer on iOS.
      * See: https://gist.github.com/mloughran/2052006
      *
      * @api private
      */

					if ('undefined' != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent)) {
						WS.prototype.onData = function (data) {
							var self = this;
							setTimeout(function () {
								Transport.prototype.onData.call(self, data);
							}, 0);
						};
					}

					/**
      * Writes data to socket.
      *
      * @param {Array} array of packets.
      * @api private
      */

					WS.prototype.write = function (packets) {
						var self = this;
						this.writable = false;

						// encodePacket efficient as it uses WS framing
						// no need for encodePayload
						var total = packets.length;
						for (var i = 0, l = total; i < l; i++) {
							(function (packet) {
								parser.encodePacket(packet, self.supportsBinary, function (data) {
									if (!BrowserWebSocket) {
										// always create a new object (GH-437)
										var opts = {};
										if (packet.options) {
											opts.compress = packet.options.compress;
										}

										if (self.perMessageDeflate) {
											var len = 'string' == typeof data ? global.Buffer.byteLength(data) : data.length;
											if (len < self.perMessageDeflate.threshold) {
												opts.compress = false;
											}
										}
									}

									//Sometimes the websocket has already been closed but the browser didn't
									//have a chance of informing us about it yet, in that case send will
									//throw an error
									try {
										if (BrowserWebSocket) {
											// TypeError is thrown when passing the second argument on Safari
											self.ws.send(data);
										} else {
											self.ws.send(data, opts);
										}
									} catch (e) {
										debug('websocket closed before onclose event');
									}

									--total || done();
								});
							})(packets[i]);
						}

						function done() {
							self.emit('flush');

							// fake drain
							// defer to next tick to allow Socket to clear writeBuffer
							setTimeout(function () {
								self.writable = true;
								self.emit('drain');
							}, 0);
						}
					};

					/**
      * Called upon close
      *
      * @api private
      */

					WS.prototype.onClose = function () {
						Transport.prototype.onClose.call(this);
					};

					/**
      * Closes socket.
      *
      * @api private
      */

					WS.prototype.doClose = function () {
						if (typeof this.ws !== 'undefined') {
							this.ws.close();
						}
					};

					/**
      * Generates uri for connection.
      *
      * @api private
      */

					WS.prototype.uri = function () {
						var query = this.query || {};
						var schema = this.secure ? 'wss' : 'ws';
						var port = '';

						// avoid port if default for schema
						if (this.port && ('wss' == schema && this.port != 443 || 'ws' == schema && this.port != 80)) {
							port = ':' + this.port;
						}

						// append timestamp to URI
						if (this.timestampRequests) {
							query[this.timestampParam] = yeast();
						}

						// communicate binary support capabilities
						if (!this.supportsBinary) {
							query.b64 = 1;
						}

						query = parseqs.encode(query);

						// prepend ? to query
						if (query.length) {
							query = '?' + query;
						}

						var ipv6 = this.hostname.indexOf(':') !== -1;
						return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;
					};

					/**
      * Feature detection for WebSocket.
      *
      * @return {Boolean} whether this transport is available.
      * @api public
      */

					WS.prototype.check = function () {
						return !!WebSocket && !('__initialize' in WebSocket && this.name === WS.prototype.name);
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"../transport": 4,
				"component-inherit": 16,
				"debug": 17,
				"engine.io-parser": 19,
				"parseqs": 27,
				"ws": undefined,
				"yeast": 30
			}],
			10: [function (_dereq_, module, exports) {
				// browser shim for xmlhttprequest module
				var hasCORS = _dereq_('has-cors');

				module.exports = function (opts) {
					var xdomain = opts.xdomain;

					// scheme must be same when usign XDomainRequest
					// http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx
					var xscheme = opts.xscheme;

					// XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.
					// https://github.com/Automattic/engine.io-client/pull/217
					var enablesXDR = opts.enablesXDR;

					// XMLHttpRequest can be disabled on IE
					try {
						if ('undefined' != typeof XMLHttpRequest && (!xdomain || hasCORS)) {
							return new XMLHttpRequest();
						}
					} catch (e) {}

					// Use XDomainRequest for IE8 if enablesXDR is true
					// because loading bar keeps flashing when using jsonp-polling
					// https://github.com/yujiosaka/socke.io-ie8-loading-example
					try {
						if ('undefined' != typeof XDomainRequest && !xscheme && enablesXDR) {
							return new XDomainRequest();
						}
					} catch (e) {}

					if (!xdomain) {
						try {
							return new ActiveXObject('Microsoft.XMLHTTP');
						} catch (e) {}
					}
				};
			}, {
				"has-cors": 22
			}],
			11: [function (_dereq_, module, exports) {
				module.exports = after;

				function after(count, callback, err_cb) {
					var bail = false;
					err_cb = err_cb || noop;
					proxy.count = count;

					return count === 0 ? callback() : proxy;

					function proxy(err, result) {
						if (proxy.count <= 0) {
							throw new Error('after called too many times');
						}
						--proxy.count;

						// after first error, rest are passed to err_cb
						if (err) {
							bail = true;
							callback(err);
							// future error callbacks will go to error handler
							callback = err_cb;
						} else if (proxy.count === 0 && !bail) {
							callback(null, result);
						}
					}
				}

				function noop() {}
			}, {}],
			12: [function (_dereq_, module, exports) {
				/**
     * An abstraction for slicing an arraybuffer even when
     * ArrayBuffer.prototype.slice is not supported
     *
     * @api public
     */

				module.exports = function (arraybuffer, start, end) {
					var bytes = arraybuffer.byteLength;
					start = start || 0;
					end = end || bytes;

					if (arraybuffer.slice) {
						return arraybuffer.slice(start, end);
					}

					if (start < 0) {
						start += bytes;
					}
					if (end < 0) {
						end += bytes;
					}
					if (end > bytes) {
						end = bytes;
					}

					if (start >= bytes || start >= end || bytes === 0) {
						return new ArrayBuffer(0);
					}

					var abv = new Uint8Array(arraybuffer);
					var result = new Uint8Array(end - start);
					for (var i = start, ii = 0; i < end; i++, ii++) {
						result[ii] = abv[i];
					}
					return result.buffer;
				};
			}, {}],
			13: [function (_dereq_, module, exports) {
				/*
     * base64-arraybuffer
     * https://github.com/niklasvh/base64-arraybuffer
     *
     * Copyright (c) 2012 Niklas von Hertzen
     * Licensed under the MIT license.
     */
				(function (chars) {
					"use strict";

					exports.encode = function (arraybuffer) {
						var bytes = new Uint8Array(arraybuffer),
						    i,
						    len = bytes.length,
						    base64 = "";

						for (i = 0; i < len; i += 3) {
							base64 += chars[bytes[i] >> 2];
							base64 += chars[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];
							base64 += chars[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];
							base64 += chars[bytes[i + 2] & 63];
						}

						if (len % 3 === 2) {
							base64 = base64.substring(0, base64.length - 1) + "=";
						} else if (len % 3 === 1) {
							base64 = base64.substring(0, base64.length - 2) + "==";
						}

						return base64;
					};

					exports.decode = function (base64) {
						var bufferLength = base64.length * 0.75,
						    len = base64.length,
						    i,
						    p = 0,
						    encoded1,
						    encoded2,
						    encoded3,
						    encoded4;

						if (base64[base64.length - 1] === "=") {
							bufferLength--;
							if (base64[base64.length - 2] === "=") {
								bufferLength--;
							}
						}

						var arraybuffer = new ArrayBuffer(bufferLength),
						    bytes = new Uint8Array(arraybuffer);

						for (i = 0; i < len; i += 4) {
							encoded1 = chars.indexOf(base64[i]);
							encoded2 = chars.indexOf(base64[i + 1]);
							encoded3 = chars.indexOf(base64[i + 2]);
							encoded4 = chars.indexOf(base64[i + 3]);

							bytes[p++] = encoded1 << 2 | encoded2 >> 4;
							bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;
							bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;
						}

						return arraybuffer;
					};
				})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");
			}, {}],
			14: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Create a blob builder even when vendor prefixes exist
      */

					var BlobBuilder = global.BlobBuilder || global.WebKitBlobBuilder || global.MSBlobBuilder || global.MozBlobBuilder;

					/**
      * Check if Blob constructor is supported
      */

					var blobSupported = function () {
						try {
							var a = new Blob(['hi']);
							return a.size === 2;
						} catch (e) {
							return false;
						}
					}();

					/**
      * Check if Blob constructor supports ArrayBufferViews
      * Fails in Safari 6, so we need to map to ArrayBuffers there.
      */

					var blobSupportsArrayBufferView = blobSupported && function () {
						try {
							var b = new Blob([new Uint8Array([1, 2])]);
							return b.size === 2;
						} catch (e) {
							return false;
						}
					}();

					/**
      * Check if BlobBuilder is supported
      */

					var blobBuilderSupported = BlobBuilder && BlobBuilder.prototype.append && BlobBuilder.prototype.getBlob;

					/**
      * Helper function that maps ArrayBufferViews to ArrayBuffers
      * Used by BlobBuilder constructor and old browsers that didn't
      * support it in the Blob constructor.
      */

					function mapArrayBufferViews(ary) {
						for (var i = 0; i < ary.length; i++) {
							var chunk = ary[i];
							if (chunk.buffer instanceof ArrayBuffer) {
								var buf = chunk.buffer;

								// if this is a subarray, make a copy so we only
								// include the subarray region from the underlying buffer
								if (chunk.byteLength !== buf.byteLength) {
									var copy = new Uint8Array(chunk.byteLength);
									copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));
									buf = copy.buffer;
								}

								ary[i] = buf;
							}
						}
					}

					function BlobBuilderConstructor(ary, options) {
						options = options || {};

						var bb = new BlobBuilder();
						mapArrayBufferViews(ary);

						for (var i = 0; i < ary.length; i++) {
							bb.append(ary[i]);
						}

						return options.type ? bb.getBlob(options.type) : bb.getBlob();
					};

					function BlobConstructor(ary, options) {
						mapArrayBufferViews(ary);
						return new Blob(ary, options || {});
					};

					module.exports = function () {
						if (blobSupported) {
							return blobSupportsArrayBufferView ? global.Blob : BlobConstructor;
						} else if (blobBuilderSupported) {
							return BlobBuilderConstructor;
						} else {
							return undefined;
						}
					}();
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}],
			15: [function (_dereq_, module, exports) {

				/**
     * Expose `Emitter`.
     */

				module.exports = Emitter;

				/**
     * Initialize a new `Emitter`.
     *
     * @api public
     */

				function Emitter(obj) {
					if (obj) return mixin(obj);
				};

				/**
     * Mixin the emitter properties.
     *
     * @param {Object} obj
     * @return {Object}
     * @api private
     */

				function mixin(obj) {
					for (var key in Emitter.prototype) {
						obj[key] = Emitter.prototype[key];
					}
					return obj;
				}

				/**
     * Listen on the given `event` with `fn`.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};
					(this._callbacks[event] = this._callbacks[event] || []).push(fn);
					return this;
				};

				/**
     * Adds an `event` listener that will be invoked a single
     * time then automatically removed.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.once = function (event, fn) {
					var self = this;
					this._callbacks = this._callbacks || {};

					function on() {
						self.off(event, on);
						fn.apply(this, arguments);
					}

					on.fn = fn;
					this.on(event, on);
					return this;
				};

				/**
     * Remove the given callback for `event` or all
     * registered callbacks.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};

					// all
					if (0 == arguments.length) {
						this._callbacks = {};
						return this;
					}

					// specific event
					var callbacks = this._callbacks[event];
					if (!callbacks) return this;

					// remove all handlers
					if (1 == arguments.length) {
						delete this._callbacks[event];
						return this;
					}

					// remove specific handler
					var cb;
					for (var i = 0; i < callbacks.length; i++) {
						cb = callbacks[i];
						if (cb === fn || cb.fn === fn) {
							callbacks.splice(i, 1);
							break;
						}
					}
					return this;
				};

				/**
     * Emit `event` with the given args.
     *
     * @param {String} event
     * @param {Mixed} ...
     * @return {Emitter}
     */

				Emitter.prototype.emit = function (event) {
					this._callbacks = this._callbacks || {};
					var args = [].slice.call(arguments, 1),
					    callbacks = this._callbacks[event];

					if (callbacks) {
						callbacks = callbacks.slice(0);
						for (var i = 0, len = callbacks.length; i < len; ++i) {
							callbacks[i].apply(this, args);
						}
					}

					return this;
				};

				/**
     * Return array of callbacks for `event`.
     *
     * @param {String} event
     * @return {Array}
     * @api public
     */

				Emitter.prototype.listeners = function (event) {
					this._callbacks = this._callbacks || {};
					return this._callbacks[event] || [];
				};

				/**
     * Check if this emitter has `event` handlers.
     *
     * @param {String} event
     * @return {Boolean}
     * @api public
     */

				Emitter.prototype.hasListeners = function (event) {
					return !!this.listeners(event).length;
				};
			}, {}],
			16: [function (_dereq_, module, exports) {

				module.exports = function (a, b) {
					var fn = function fn() {};
					fn.prototype = b.prototype;
					a.prototype = new fn();
					a.prototype.constructor = a;
				};
			}, {}],
			17: [function (_dereq_, module, exports) {

				/**
     * This is the web browser implementation of `debug()`.
     *
     * Expose `debug()` as the module.
     */

				exports = module.exports = _dereq_('./debug');
				exports.log = log;
				exports.formatArgs = formatArgs;
				exports.save = save;
				exports.load = load;
				exports.useColors = useColors;
				exports.storage = 'undefined' != typeof chrome && 'undefined' != typeof chrome.storage ? chrome.storage.local : localstorage();

				/**
     * Colors.
     */

				exports.colors = ['lightseagreen', 'forestgreen', 'goldenrod', 'dodgerblue', 'darkorchid', 'crimson'];

				/**
     * Currently only WebKit-based Web Inspectors, Firefox >= v31,
     * and the Firebug extension (any Firefox version) are known
     * to support "%c" CSS customizations.
     *
     * TODO: add a `localStorage` variable to explicitly enable/disable colors
     */

				function useColors() {
					// is webkit? http://stackoverflow.com/a/16459606/376773
					return 'WebkitAppearance' in document.documentElement.style ||
					// is firebug? http://stackoverflow.com/a/398120/376773
					window.console && (console.firebug || console.exception && console.table) ||
					// is firefox >= v31?
					// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages
					navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31;
				}

				/**
     * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.
     */

				exports.formatters.j = function (v) {
					return JSON.stringify(v);
				};

				/**
     * Colorize log arguments if enabled.
     *
     * @api public
     */

				function formatArgs() {
					var args = arguments;
					var useColors = this.useColors;

					args[0] = (useColors ? '%c' : '') + this.namespace + (useColors ? ' %c' : ' ') + args[0] + (useColors ? '%c ' : ' ') + '+' + exports.humanize(this.diff);

					if (!useColors) return args;

					var c = 'color: ' + this.color;
					args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));

					// the final "%c" is somewhat tricky, because there could be other
					// arguments passed either before or after the %c, so we need to
					// figure out the correct index to insert the CSS into
					var index = 0;
					var lastC = 0;
					args[0].replace(/%[a-z%]/g, function (match) {
						if ('%%' === match) return;
						index++;
						if ('%c' === match) {
							// we only are interested in the *last* %c
							// (the user may have provided their own)
							lastC = index;
						}
					});

					args.splice(lastC, 0, c);
					return args;
				}

				/**
     * Invokes `console.log()` when available.
     * No-op when `console.log` is not a "function".
     *
     * @api public
     */

				function log() {
					// this hackery is required for IE8/9, where
					// the `console.log` function doesn't have 'apply'
					return 'object' === (typeof console === "undefined" ? "undefined" : _typeof(console)) && console.log && Function.prototype.apply.call(console.log, console, arguments);
				}

				/**
     * Save `namespaces`.
     *
     * @param {String} namespaces
     * @api private
     */

				function save(namespaces) {
					try {
						if (null == namespaces) {
							exports.storage.removeItem('debug');
						} else {
							exports.storage.debug = namespaces;
						}
					} catch (e) {}
				}

				/**
     * Load `namespaces`.
     *
     * @return {String} returns the previously persisted debug modes
     * @api private
     */

				function load() {
					var r;
					try {
						r = exports.storage.debug;
					} catch (e) {}
					return r;
				}

				/**
     * Enable namespaces listed in `localStorage.debug` initially.
     */

				exports.enable(load());

				/**
     * Localstorage attempts to return the localstorage.
     *
     * This is necessary because safari throws
     * when a user disables cookies/localstorage
     * and you attempt to access it.
     *
     * @return {LocalStorage}
     * @api private
     */

				function localstorage() {
					try {
						return window.localStorage;
					} catch (e) {}
				}
			}, {
				"./debug": 18
			}],
			18: [function (_dereq_, module, exports) {

				/**
     * This is the common logic for both the Node.js and web browser
     * implementations of `debug()`.
     *
     * Expose `debug()` as the module.
     */

				exports = module.exports = debug;
				exports.coerce = coerce;
				exports.disable = disable;
				exports.enable = enable;
				exports.enabled = enabled;
				exports.humanize = _dereq_('ms');

				/**
     * The currently active debug mode names, and names to skip.
     */

				exports.names = [];
				exports.skips = [];

				/**
     * Map of special "%n" handling functions, for the debug "format" argument.
     *
     * Valid key names are a single, lowercased letter, i.e. "n".
     */

				exports.formatters = {};

				/**
     * Previously assigned color.
     */

				var prevColor = 0;

				/**
     * Previous log timestamp.
     */

				var prevTime;

				/**
     * Select a color.
     *
     * @return {Number}
     * @api private
     */

				function selectColor() {
					return exports.colors[prevColor++ % exports.colors.length];
				}

				/**
     * Create a debugger with the given `namespace`.
     *
     * @param {String} namespace
     * @return {Function}
     * @api public
     */

				function debug(namespace) {

					// define the `disabled` version
					function disabled() {}
					disabled.enabled = false;

					// define the `enabled` version
					function enabled() {

						var self = enabled;

						// set `diff` timestamp
						var curr = +new Date();
						var ms = curr - (prevTime || curr);
						self.diff = ms;
						self.prev = prevTime;
						self.curr = curr;
						prevTime = curr;

						// add the `color` if not set
						if (null == self.useColors) self.useColors = exports.useColors();
						if (null == self.color && self.useColors) self.color = selectColor();

						var args = Array.prototype.slice.call(arguments);

						args[0] = exports.coerce(args[0]);

						if ('string' !== typeof args[0]) {
							// anything else let's inspect with %o
							args = ['%o'].concat(args);
						}

						// apply any `formatters` transformations
						var index = 0;
						args[0] = args[0].replace(/%([a-z%])/g, function (match, format) {
							// if we encounter an escaped % then don't increase the array index
							if (match === '%%') return match;
							index++;
							var formatter = exports.formatters[format];
							if ('function' === typeof formatter) {
								var val = args[index];
								match = formatter.call(self, val);

								// now we need to remove `args[index]` since it's inlined in the `format`
								args.splice(index, 1);
								index--;
							}
							return match;
						});

						if ('function' === typeof exports.formatArgs) {
							args = exports.formatArgs.apply(self, args);
						}
						var logFn = enabled.log || exports.log || console.log.bind(console);
						logFn.apply(self, args);
					}
					enabled.enabled = true;

					var fn = exports.enabled(namespace) ? enabled : disabled;

					fn.namespace = namespace;

					return fn;
				}

				/**
     * Enables a debug mode by namespaces. This can include modes
     * separated by a colon and wildcards.
     *
     * @param {String} namespaces
     * @api public
     */

				function enable(namespaces) {
					exports.save(namespaces);

					var split = (namespaces || '').split(/[\s,]+/);
					var len = split.length;

					for (var i = 0; i < len; i++) {
						if (!split[i]) continue; // ignore empty strings
						namespaces = split[i].replace(/\*/g, '.*?');
						if (namespaces[0] === '-') {
							exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));
						} else {
							exports.names.push(new RegExp('^' + namespaces + '$'));
						}
					}
				}

				/**
     * Disable debug output.
     *
     * @api public
     */

				function disable() {
					exports.enable('');
				}

				/**
     * Returns true if the given mode name is enabled, false otherwise.
     *
     * @param {String} name
     * @return {Boolean}
     * @api public
     */

				function enabled(name) {
					var i, len;
					for (i = 0, len = exports.skips.length; i < len; i++) {
						if (exports.skips[i].test(name)) {
							return false;
						}
					}
					for (i = 0, len = exports.names.length; i < len; i++) {
						if (exports.names[i].test(name)) {
							return true;
						}
					}
					return false;
				}

				/**
     * Coerce `val`.
     *
     * @param {Mixed} val
     * @return {Mixed}
     * @api private
     */

				function coerce(val) {
					if (val instanceof Error) return val.stack || val.message;
					return val;
				}
			}, {
				"ms": 25
			}],
			19: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * Module dependencies.
      */

					var keys = _dereq_('./keys');
					var hasBinary = _dereq_('has-binary');
					var sliceBuffer = _dereq_('arraybuffer.slice');
					var base64encoder = _dereq_('base64-arraybuffer');
					var after = _dereq_('after');
					var utf8 = _dereq_('utf8');

					/**
      * Check if we are running an android browser. That requires us to use
      * ArrayBuffer with polling transports...
      *
      * http://ghinda.net/jpeg-blob-ajax-android/
      */

					var isAndroid = navigator.userAgent.match(/Android/i);

					/**
      * Check if we are running in PhantomJS.
      * Uploading a Blob with PhantomJS does not work correctly, as reported here:
      * https://github.com/ariya/phantomjs/issues/11395
      * @type boolean
      */
					var isPhantomJS = /PhantomJS/i.test(navigator.userAgent);

					/**
      * When true, avoids using Blobs to encode payloads.
      * @type boolean
      */
					var dontSendBlobs = isAndroid || isPhantomJS;

					/**
      * Current protocol version.
      */

					exports.protocol = 3;

					/**
      * Packet types.
      */

					var packets = exports.packets = {
						open: 0 // non-ws

						, close: 1 // non-ws

						, ping: 2,
						pong: 3,
						message: 4,
						upgrade: 5,
						noop: 6
					};

					var packetslist = keys(packets);

					/**
      * Premade error packet.
      */

					var err = {
						type: 'error',
						data: 'parser error'
					};

					/**
      * Create a blob api even for blob builder when vendor prefixes exist
      */

					var Blob = _dereq_('blob');

					/**
      * Encodes a packet.
      *
      *     <packet type id> [ <data> ]
      *
      * Example:
      *
      *     5hello world
      *     3
      *     4
      *
      * Binary is encoded in an identical principle
      *
      * @api private
      */

					exports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {
						if ('function' == typeof supportsBinary) {
							callback = supportsBinary;
							supportsBinary = false;
						}

						if ('function' == typeof utf8encode) {
							callback = utf8encode;
							utf8encode = null;
						}

						var data = packet.data === undefined ? undefined : packet.data.buffer || packet.data;

						if (global.ArrayBuffer && data instanceof ArrayBuffer) {
							return encodeArrayBuffer(packet, supportsBinary, callback);
						} else if (Blob && data instanceof global.Blob) {
							return encodeBlob(packet, supportsBinary, callback);
						}

						// might be an object with { base64: true, data: dataAsBase64String }
						if (data && data.base64) {
							return encodeBase64Object(packet, callback);
						}

						// Sending data as a utf-8 string
						var encoded = packets[packet.type];

						// data fragment is optional
						if (undefined !== packet.data) {
							encoded += utf8encode ? utf8.encode(String(packet.data)) : String(packet.data);
						}

						return callback('' + encoded);
					};

					function encodeBase64Object(packet, callback) {
						// packet data is an object { base64: true, data: dataAsBase64String }
						var message = 'b' + exports.packets[packet.type] + packet.data.data;
						return callback(message);
					}

					/**
      * Encode packet helpers for binary types
      */

					function encodeArrayBuffer(packet, supportsBinary, callback) {
						if (!supportsBinary) {
							return exports.encodeBase64Packet(packet, callback);
						}

						var data = packet.data;
						var contentArray = new Uint8Array(data);
						var resultBuffer = new Uint8Array(1 + data.byteLength);

						resultBuffer[0] = packets[packet.type];
						for (var i = 0; i < contentArray.length; i++) {
							resultBuffer[i + 1] = contentArray[i];
						}

						return callback(resultBuffer.buffer);
					}

					function encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {
						if (!supportsBinary) {
							return exports.encodeBase64Packet(packet, callback);
						}

						var fr = new FileReader();
						fr.onload = function () {
							packet.data = fr.result;
							exports.encodePacket(packet, supportsBinary, true, callback);
						};
						return fr.readAsArrayBuffer(packet.data);
					}

					function encodeBlob(packet, supportsBinary, callback) {
						if (!supportsBinary) {
							return exports.encodeBase64Packet(packet, callback);
						}

						if (dontSendBlobs) {
							return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);
						}

						var length = new Uint8Array(1);
						length[0] = packets[packet.type];
						var blob = new Blob([length.buffer, packet.data]);

						return callback(blob);
					}

					/**
      * Encodes a packet with binary data in a base64 string
      *
      * @param {Object} packet, has `type` and `data`
      * @return {String} base64 encoded message
      */

					exports.encodeBase64Packet = function (packet, callback) {
						var message = 'b' + exports.packets[packet.type];
						if (Blob && packet.data instanceof global.Blob) {
							var fr = new FileReader();
							fr.onload = function () {
								var b64 = fr.result.split(',')[1];
								callback(message + b64);
							};
							return fr.readAsDataURL(packet.data);
						}

						var b64data;
						try {
							b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));
						} catch (e) {
							// iPhone Safari doesn't let you apply with typed arrays
							var typed = new Uint8Array(packet.data);
							var basic = new Array(typed.length);
							for (var i = 0; i < typed.length; i++) {
								basic[i] = typed[i];
							}
							b64data = String.fromCharCode.apply(null, basic);
						}
						message += global.btoa(b64data);
						return callback(message);
					};

					/**
      * Decodes a packet. Changes format to Blob if requested.
      *
      * @return {Object} with `type` and `data` (if any)
      * @api private
      */

					exports.decodePacket = function (data, binaryType, utf8decode) {
						// String data
						if (typeof data == 'string' || data === undefined) {
							if (data.charAt(0) == 'b') {
								return exports.decodeBase64Packet(data.substr(1), binaryType);
							}

							if (utf8decode) {
								try {
									data = utf8.decode(data);
								} catch (e) {
									return err;
								}
							}
							var type = data.charAt(0);

							if (Number(type) != type || !packetslist[type]) {
								return err;
							}

							if (data.length > 1) {
								return {
									type: packetslist[type],
									data: data.substring(1)
								};
							} else {
								return {
									type: packetslist[type]
								};
							}
						}

						var asArray = new Uint8Array(data);
						var type = asArray[0];
						var rest = sliceBuffer(data, 1);
						if (Blob && binaryType === 'blob') {
							rest = new Blob([rest]);
						}
						return {
							type: packetslist[type],
							data: rest
						};
					};

					/**
      * Decodes a packet encoded in a base64 string
      *
      * @param {String} base64 encoded message
      * @return {Object} with `type` and `data` (if any)
      */

					exports.decodeBase64Packet = function (msg, binaryType) {
						var type = packetslist[msg.charAt(0)];
						if (!global.ArrayBuffer) {
							return {
								type: type,
								data: {
									base64: true,
									data: msg.substr(1)
								}
							};
						}

						var data = base64encoder.decode(msg.substr(1));

						if (binaryType === 'blob' && Blob) {
							data = new Blob([data]);
						}

						return {
							type: type,
							data: data
						};
					};

					/**
      * Encodes multiple messages (payload).
      *
      *     <length>:data
      *
      * Example:
      *
      *     11:hello world2:hi
      *
      * If any contents are binary, they will be encoded as base64 strings. Base64
      * encoded strings are marked with a b before the length specifier
      *
      * @param {Array} packets
      * @api private
      */

					exports.encodePayload = function (packets, supportsBinary, callback) {
						if (typeof supportsBinary == 'function') {
							callback = supportsBinary;
							supportsBinary = null;
						}

						var isBinary = hasBinary(packets);

						if (supportsBinary && isBinary) {
							if (Blob && !dontSendBlobs) {
								return exports.encodePayloadAsBlob(packets, callback);
							}

							return exports.encodePayloadAsArrayBuffer(packets, callback);
						}

						if (!packets.length) {
							return callback('0:');
						}

						function setLengthHeader(message) {
							return message.length + ':' + message;
						}

						function encodeOne(packet, doneCallback) {
							exports.encodePacket(packet, !isBinary ? false : supportsBinary, true, function (message) {
								doneCallback(null, setLengthHeader(message));
							});
						}

						map(packets, encodeOne, function (err, results) {
							return callback(results.join(''));
						});
					};

					/**
      * Async array map using after
      */

					function map(ary, each, done) {
						var result = new Array(ary.length);
						var next = after(ary.length, done);

						var eachWithIndex = function eachWithIndex(i, el, cb) {
							each(el, function (error, msg) {
								result[i] = msg;
								cb(error, result);
							});
						};

						for (var i = 0; i < ary.length; i++) {
							eachWithIndex(i, ary[i], next);
						}
					}

					/*
      * Decodes data when a payload is maybe expected. Possible binary contents are
      * decoded from their base64 representation
      *
      * @param {String} data, callback method
      * @api public
      */

					exports.decodePayload = function (data, binaryType, callback) {
						if (typeof data != 'string') {
							return exports.decodePayloadAsBinary(data, binaryType, callback);
						}

						if (typeof binaryType === 'function') {
							callback = binaryType;
							binaryType = null;
						}

						var packet;
						if (data == '') {
							// parser error - ignoring payload
							return callback(err, 0, 1);
						}

						var length = '',
						    n,
						    msg;

						for (var i = 0, l = data.length; i < l; i++) {
							var chr = data.charAt(i);

							if (':' != chr) {
								length += chr;
							} else {
								if ('' == length || length != (n = Number(length))) {
									// parser error - ignoring payload
									return callback(err, 0, 1);
								}

								msg = data.substr(i + 1, n);

								if (length != msg.length) {
									// parser error - ignoring payload
									return callback(err, 0, 1);
								}

								if (msg.length) {
									packet = exports.decodePacket(msg, binaryType, true);

									if (err.type == packet.type && err.data == packet.data) {
										// parser error in individual packet - ignoring payload
										return callback(err, 0, 1);
									}

									var ret = callback(packet, i + n, l);
									if (false === ret) return;
								}

								// advance cursor
								i += n;
								length = '';
							}
						}

						if (length != '') {
							// parser error - ignoring payload
							return callback(err, 0, 1);
						}
					};

					/**
      * Encodes multiple messages (payload) as binary.
      *
      * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number
      * 255><data>
      *
      * Example:
      * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers
      *
      * @param {Array} packets
      * @return {ArrayBuffer} encoded payload
      * @api private
      */

					exports.encodePayloadAsArrayBuffer = function (packets, callback) {
						if (!packets.length) {
							return callback(new ArrayBuffer(0));
						}

						function encodeOne(packet, doneCallback) {
							exports.encodePacket(packet, true, true, function (data) {
								return doneCallback(null, data);
							});
						}

						map(packets, encodeOne, function (err, encodedPackets) {
							var totalLength = encodedPackets.reduce(function (acc, p) {
								var len;
								if (typeof p === 'string') {
									len = p.length;
								} else {
									len = p.byteLength;
								}
								return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2
							}, 0);

							var resultArray = new Uint8Array(totalLength);

							var bufferIndex = 0;
							encodedPackets.forEach(function (p) {
								var isString = typeof p === 'string';
								var ab = p;
								if (isString) {
									var view = new Uint8Array(p.length);
									for (var i = 0; i < p.length; i++) {
										view[i] = p.charCodeAt(i);
									}
									ab = view.buffer;
								}

								if (isString) {
									// not true binary
									resultArray[bufferIndex++] = 0;
								} else {
									// true binary
									resultArray[bufferIndex++] = 1;
								}

								var lenStr = ab.byteLength.toString();
								for (var i = 0; i < lenStr.length; i++) {
									resultArray[bufferIndex++] = parseInt(lenStr[i]);
								}
								resultArray[bufferIndex++] = 255;

								var view = new Uint8Array(ab);
								for (var i = 0; i < view.length; i++) {
									resultArray[bufferIndex++] = view[i];
								}
							});

							return callback(resultArray.buffer);
						});
					};

					/**
      * Encode as Blob
      */

					exports.encodePayloadAsBlob = function (packets, callback) {
						function encodeOne(packet, doneCallback) {
							exports.encodePacket(packet, true, true, function (encoded) {
								var binaryIdentifier = new Uint8Array(1);
								binaryIdentifier[0] = 1;
								if (typeof encoded === 'string') {
									var view = new Uint8Array(encoded.length);
									for (var i = 0; i < encoded.length; i++) {
										view[i] = encoded.charCodeAt(i);
									}
									encoded = view.buffer;
									binaryIdentifier[0] = 0;
								}

								var len = encoded instanceof ArrayBuffer ? encoded.byteLength : encoded.size;

								var lenStr = len.toString();
								var lengthAry = new Uint8Array(lenStr.length + 1);
								for (var i = 0; i < lenStr.length; i++) {
									lengthAry[i] = parseInt(lenStr[i]);
								}
								lengthAry[lenStr.length] = 255;

								if (Blob) {
									var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);
									doneCallback(null, blob);
								}
							});
						}

						map(packets, encodeOne, function (err, results) {
							return callback(new Blob(results));
						});
					};

					/*
      * Decodes data when a payload is maybe expected. Strings are decoded by
      * interpreting each byte as a key code for entries marked to start with 0. See
      * description of encodePayloadAsBinary
      *
      * @param {ArrayBuffer} data, callback method
      * @api public
      */

					exports.decodePayloadAsBinary = function (data, binaryType, callback) {
						if (typeof binaryType === 'function') {
							callback = binaryType;
							binaryType = null;
						}

						var bufferTail = data;
						var buffers = [];

						var numberTooLong = false;
						while (bufferTail.byteLength > 0) {
							var tailArray = new Uint8Array(bufferTail);
							var isString = tailArray[0] === 0;
							var msgLength = '';

							for (var i = 1;; i++) {
								if (tailArray[i] == 255) break;

								if (msgLength.length > 310) {
									numberTooLong = true;
									break;
								}

								msgLength += tailArray[i];
							}

							if (numberTooLong) return callback(err, 0, 1);

							bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);
							msgLength = parseInt(msgLength);

							var msg = sliceBuffer(bufferTail, 0, msgLength);
							if (isString) {
								try {
									msg = String.fromCharCode.apply(null, new Uint8Array(msg));
								} catch (e) {
									// iPhone Safari doesn't let you apply to typed arrays
									var typed = new Uint8Array(msg);
									msg = '';
									for (var i = 0; i < typed.length; i++) {
										msg += String.fromCharCode(typed[i]);
									}
								}
							}

							buffers.push(msg);
							bufferTail = sliceBuffer(bufferTail, msgLength);
						}

						var total = buffers.length;
						buffers.forEach(function (buffer, i) {
							callback(exports.decodePacket(buffer, binaryType, true), i, total);
						});
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"./keys": 20,
				"after": 11,
				"arraybuffer.slice": 12,
				"base64-arraybuffer": 13,
				"blob": 14,
				"has-binary": 21,
				"utf8": 29
			}],
			20: [function (_dereq_, module, exports) {

				/**
     * Gets the keys for an object.
     *
     * @return {Array} keys
     * @api private
     */

				module.exports = Object.keys || function keys(obj) {
					var arr = [];
					var has = Object.prototype.hasOwnProperty;

					for (var i in obj) {
						if (has.call(obj, i)) {
							arr.push(i);
						}
					}
					return arr;
				};
			}, {}],
			21: [function (_dereq_, module, exports) {
				(function (global) {

					/*
      * Module requirements.
      */

					var isArray = _dereq_('isarray');

					/**
      * Module exports.
      */

					module.exports = hasBinary;

					/**
      * Checks for binary data.
      *
      * Right now only Buffer and ArrayBuffer are supported..
      *
      * @param {Object} anything
      * @api public
      */

					function hasBinary(data) {

						function _hasBinary(obj) {
							if (!obj) return false;

							if (global.Buffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer || global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
								return true;
							}

							if (isArray(obj)) {
								for (var i = 0; i < obj.length; i++) {
									if (_hasBinary(obj[i])) {
										return true;
									}
								}
							} else if (obj && 'object' == (typeof obj === "undefined" ? "undefined" : _typeof(obj))) {
								if (obj.toJSON) {
									obj = obj.toJSON();
								}

								for (var key in obj) {
									if (Object.prototype.hasOwnProperty.call(obj, key) && _hasBinary(obj[key])) {
										return true;
									}
								}
							}

							return false;
						}

						return _hasBinary(data);
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"isarray": 24
			}],
			22: [function (_dereq_, module, exports) {

				/**
     * Module exports.
     *
     * Logic borrowed from Modernizr:
     *
     *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js
     */

				try {
					module.exports = typeof XMLHttpRequest !== 'undefined' && 'withCredentials' in new XMLHttpRequest();
				} catch (err) {
					// if XMLHttp support is disabled in IE then it will throw
					// when trying to create
					module.exports = false;
				}
			}, {}],
			23: [function (_dereq_, module, exports) {

				var indexOf = [].indexOf;

				module.exports = function (arr, obj) {
					if (indexOf) return arr.indexOf(obj);
					for (var i = 0; i < arr.length; ++i) {
						if (arr[i] === obj) return i;
					}
					return -1;
				};
			}, {}],
			24: [function (_dereq_, module, exports) {
				module.exports = Array.isArray || function (arr) {
					return Object.prototype.toString.call(arr) == '[object Array]';
				};
			}, {}],
			25: [function (_dereq_, module, exports) {
				/**
     * Helpers.
     */

				var s = 1000;
				var m = s * 60;
				var h = m * 60;
				var d = h * 24;
				var y = d * 365.25;

				/**
     * Parse or format the given `val`.
     *
     * Options:
     *
     *  - `long` verbose formatting [false]
     *
     * @param {String|Number} val
     * @param {Object} options
     * @return {String|Number}
     * @api public
     */

				module.exports = function (val, options) {
					options = options || {};
					if ('string' == typeof val) return parse(val);
					return options.long ? long(val) : short(val);
				};

				/**
     * Parse the given `str` and return milliseconds.
     *
     * @param {String} str
     * @return {Number}
     * @api private
     */

				function parse(str) {
					str = '' + str;
					if (str.length > 10000) return;
					var match = /^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);
					if (!match) return;
					var n = parseFloat(match[1]);
					var type = (match[2] || 'ms').toLowerCase();
					switch (type) {
						case 'years':
						case 'year':
						case 'yrs':
						case 'yr':
						case 'y':
							return n * y;
						case 'days':
						case 'day':
						case 'd':
							return n * d;
						case 'hours':
						case 'hour':
						case 'hrs':
						case 'hr':
						case 'h':
							return n * h;
						case 'minutes':
						case 'minute':
						case 'mins':
						case 'min':
						case 'm':
							return n * m;
						case 'seconds':
						case 'second':
						case 'secs':
						case 'sec':
						case 's':
							return n * s;
						case 'milliseconds':
						case 'millisecond':
						case 'msecs':
						case 'msec':
						case 'ms':
							return n;
					}
				}

				/**
     * Short format for `ms`.
     *
     * @param {Number} ms
     * @return {String}
     * @api private
     */

				function short(ms) {
					if (ms >= d) return Math.round(ms / d) + 'd';
					if (ms >= h) return Math.round(ms / h) + 'h';
					if (ms >= m) return Math.round(ms / m) + 'm';
					if (ms >= s) return Math.round(ms / s) + 's';
					return ms + 'ms';
				}

				/**
     * Long format for `ms`.
     *
     * @param {Number} ms
     * @return {String}
     * @api private
     */

				function long(ms) {
					return plural(ms, d, 'day') || plural(ms, h, 'hour') || plural(ms, m, 'minute') || plural(ms, s, 'second') || ms + ' ms';
				}

				/**
     * Pluralization helper.
     */

				function plural(ms, n, name) {
					if (ms < n) return;
					if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;
					return Math.ceil(ms / n) + ' ' + name + 's';
				}
			}, {}],
			26: [function (_dereq_, module, exports) {
				(function (global) {
					/**
      * JSON parse.
      *
      * @see Based on jQuery#parseJSON (MIT) and JSON2
      * @api private
      */

					var rvalidchars = /^[\],:{}\s]*$/;
					var rvalidescape = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
					var rvalidtokens = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
					var rvalidbraces = /(?:^|:|,)(?:\s*\[)+/g;
					var rtrimLeft = /^\s+/;
					var rtrimRight = /\s+$/;

					module.exports = function parsejson(data) {
						if ('string' != typeof data || !data) {
							return null;
						}

						data = data.replace(rtrimLeft, '').replace(rtrimRight, '');

						// Attempt to parse using the native JSON parser first
						if (global.JSON && JSON.parse) {
							return JSON.parse(data);
						}

						if (rvalidchars.test(data.replace(rvalidescape, '@').replace(rvalidtokens, ']').replace(rvalidbraces, ''))) {
							return new Function('return ' + data)();
						}
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}],
			27: [function (_dereq_, module, exports) {
				/**
     * Compiles a querystring
     * Returns string representation of the object
     *
     * @param {Object}
     * @api private
     */

				exports.encode = function (obj) {
					var str = '';

					for (var i in obj) {
						if (obj.hasOwnProperty(i)) {
							if (str.length) str += '&';
							str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);
						}
					}

					return str;
				};

				/**
     * Parses a simple querystring into an object
     *
     * @param {String} qs
     * @api private
     */

				exports.decode = function (qs) {
					var qry = {};
					var pairs = qs.split('&');
					for (var i = 0, l = pairs.length; i < l; i++) {
						var pair = pairs[i].split('=');
						qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
					}
					return qry;
				};
			}, {}],
			28: [function (_dereq_, module, exports) {
				/**
     * Parses an URI
     *
     * @author Steven Levithan <stevenlevithan.com> (MIT license)
     * @api private
     */

				var re = /^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;

				var parts = ['source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'];

				module.exports = function parseuri(str) {
					var src = str,
					    b = str.indexOf('['),
					    e = str.indexOf(']');

					if (b != -1 && e != -1) {
						str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);
					}

					var m = re.exec(str || ''),
					    uri = {},
					    i = 14;

					while (i--) {
						uri[parts[i]] = m[i] || '';
					}

					if (b != -1 && e != -1) {
						uri.source = src;
						uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');
						uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');
						uri.ipv6uri = true;
					}

					return uri;
				};
			}, {}],
			29: [function (_dereq_, module, exports) {
				(function (global) {
					/*! https://mths.be/utf8js v2.0.0 by @mathias */
					;
					(function (root) {

						// Detect free variables `exports`
						var freeExports = (typeof exports === "undefined" ? "undefined" : _typeof(exports)) == 'object' && exports;

						// Detect free variable `module`
						var freeModule = (typeof module === "undefined" ? "undefined" : _typeof(module)) == 'object' && module && module.exports == freeExports && module;

						// Detect free variable `global`, from Node.js or Browserified code,
						// and use it as `root`
						var freeGlobal = (typeof global === "undefined" ? "undefined" : _typeof(global)) == 'object' && global;
						if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {
							root = freeGlobal;
						}

						/*--------------------------------------------------------------------------*/

						var stringFromCharCode = String.fromCharCode;

						// Taken from https://mths.be/punycode
						function ucs2decode(string) {
							var output = [];
							var counter = 0;
							var length = string.length;
							var value;
							var extra;
							while (counter < length) {
								value = string.charCodeAt(counter++);
								if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
									// high surrogate, and there is a next character
									extra = string.charCodeAt(counter++);
									if ((extra & 0xFC00) == 0xDC00) {
										// low surrogate
										output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
									} else {
										// unmatched surrogate; only append this code unit, in case the next
										// code unit is the high surrogate of a surrogate pair
										output.push(value);
										counter--;
									}
								} else {
									output.push(value);
								}
							}
							return output;
						}

						// Taken from https://mths.be/punycode
						function ucs2encode(array) {
							var length = array.length;
							var index = -1;
							var value;
							var output = '';
							while (++index < length) {
								value = array[index];
								if (value > 0xFFFF) {
									value -= 0x10000;
									output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
									value = 0xDC00 | value & 0x3FF;
								}
								output += stringFromCharCode(value);
							}
							return output;
						}

						function checkScalarValue(codePoint) {
							if (codePoint >= 0xD800 && codePoint <= 0xDFFF) {
								throw Error('Lone surrogate U+' + codePoint.toString(16).toUpperCase() + ' is not a scalar value');
							}
						}
						/*--------------------------------------------------------------------------*/

						function createByte(codePoint, shift) {
							return stringFromCharCode(codePoint >> shift & 0x3F | 0x80);
						}

						function encodeCodePoint(codePoint) {
							if ((codePoint & 0xFFFFFF80) == 0) {
								// 1-byte sequence
								return stringFromCharCode(codePoint);
							}
							var symbol = '';
							if ((codePoint & 0xFFFFF800) == 0) {
								// 2-byte sequence
								symbol = stringFromCharCode(codePoint >> 6 & 0x1F | 0xC0);
							} else if ((codePoint & 0xFFFF0000) == 0) {
								// 3-byte sequence
								checkScalarValue(codePoint);
								symbol = stringFromCharCode(codePoint >> 12 & 0x0F | 0xE0);
								symbol += createByte(codePoint, 6);
							} else if ((codePoint & 0xFFE00000) == 0) {
								// 4-byte sequence
								symbol = stringFromCharCode(codePoint >> 18 & 0x07 | 0xF0);
								symbol += createByte(codePoint, 12);
								symbol += createByte(codePoint, 6);
							}
							symbol += stringFromCharCode(codePoint & 0x3F | 0x80);
							return symbol;
						}

						function utf8encode(string) {
							var codePoints = ucs2decode(string);
							var length = codePoints.length;
							var index = -1;
							var codePoint;
							var byteString = '';
							while (++index < length) {
								codePoint = codePoints[index];
								byteString += encodeCodePoint(codePoint);
							}
							return byteString;
						}

						/*--------------------------------------------------------------------------*/

						function readContinuationByte() {
							if (byteIndex >= byteCount) {
								throw Error('Invalid byte index');
							}

							var continuationByte = byteArray[byteIndex] & 0xFF;
							byteIndex++;

							if ((continuationByte & 0xC0) == 0x80) {
								return continuationByte & 0x3F;
							}

							// If we end up here, it’s not a continuation byte
							throw Error('Invalid continuation byte');
						}

						function decodeSymbol() {
							var byte1;
							var byte2;
							var byte3;
							var byte4;
							var codePoint;

							if (byteIndex > byteCount) {
								throw Error('Invalid byte index');
							}

							if (byteIndex == byteCount) {
								return false;
							}

							// Read first byte
							byte1 = byteArray[byteIndex] & 0xFF;
							byteIndex++;

							// 1-byte sequence (no continuation bytes)
							if ((byte1 & 0x80) == 0) {
								return byte1;
							}

							// 2-byte sequence
							if ((byte1 & 0xE0) == 0xC0) {
								var byte2 = readContinuationByte();
								codePoint = (byte1 & 0x1F) << 6 | byte2;
								if (codePoint >= 0x80) {
									return codePoint;
								} else {
									throw Error('Invalid continuation byte');
								}
							}

							// 3-byte sequence (may include unpaired surrogates)
							if ((byte1 & 0xF0) == 0xE0) {
								byte2 = readContinuationByte();
								byte3 = readContinuationByte();
								codePoint = (byte1 & 0x0F) << 12 | byte2 << 6 | byte3;
								if (codePoint >= 0x0800) {
									checkScalarValue(codePoint);
									return codePoint;
								} else {
									throw Error('Invalid continuation byte');
								}
							}

							// 4-byte sequence
							if ((byte1 & 0xF8) == 0xF0) {
								byte2 = readContinuationByte();
								byte3 = readContinuationByte();
								byte4 = readContinuationByte();
								codePoint = (byte1 & 0x0F) << 0x12 | byte2 << 0x0C | byte3 << 0x06 | byte4;
								if (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {
									return codePoint;
								}
							}

							throw Error('Invalid UTF-8 detected');
						}

						var byteArray;
						var byteCount;
						var byteIndex;

						function utf8decode(byteString) {
							byteArray = ucs2decode(byteString);
							byteCount = byteArray.length;
							byteIndex = 0;
							var codePoints = [];
							var tmp;
							while ((tmp = decodeSymbol()) !== false) {
								codePoints.push(tmp);
							}
							return ucs2encode(codePoints);
						}

						/*--------------------------------------------------------------------------*/

						var utf8 = {
							'version': '2.0.0',
							'encode': utf8encode,
							'decode': utf8decode
						};

						// Some AMD build optimizers, like r.js, check for specific condition patterns
						// like the following:
						if (typeof define == 'function' && _typeof(define.amd) == 'object' && define.amd) {
							define(function () {
								return utf8;
							});
						} else if (freeExports && !freeExports.nodeType) {
							if (freeModule) {
								// in Node.js or RingoJS v0.8.0+
								freeModule.exports = utf8;
							} else {
								// in Narwhal or RingoJS v0.7.0-
								var object = {};
								var hasOwnProperty = object.hasOwnProperty;
								for (var key in utf8) {
									hasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);
								}
							}
						} else {
							// in Rhino or a web browser
							root.utf8 = utf8;
						}
					})(this);
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}],
			30: [function (_dereq_, module, exports) {
				'use strict';

				var alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split(''),
				    length = 64,
				    map = {},
				    seed = 0,
				    i = 0,
				    prev;

				/**
     * Return a string representing the specified number.
     *
     * @param {Number} num The number to convert.
     * @returns {String} The string representation of the number.
     * @api public
     */
				function encode(num) {
					var encoded = '';

					do {
						encoded = alphabet[num % length] + encoded;
						num = Math.floor(num / length);
					} while (num > 0);

					return encoded;
				}

				/**
     * Return the integer value specified by the given string.
     *
     * @param {String} str The string to convert.
     * @returns {Number} The integer value represented by the string.
     * @api public
     */
				function decode(str) {
					var decoded = 0;

					for (i = 0; i < str.length; i++) {
						decoded = decoded * length + map[str.charAt(i)];
					}

					return decoded;
				}

				/**
     * Yeast: A tiny growing id generator.
     *
     * @returns {String} A unique id.
     * @api public
     */
				function yeast() {
					var now = encode(+new Date());

					if (now !== prev) return seed = 0, prev = now;
					return now + '.' + encode(seed++);
				}

				//
				// Map each character to its index.
				//
				for (; i < length; i++) {
					map[alphabet[i]] = i;
				} //
				// Expose the `yeast`, `encode` and `decode` functions.
				//
				yeast.encode = encode;
				yeast.decode = decode;
				module.exports = yeast;
			}, {}],
			31: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var url = _dereq_('./url');
				var parser = _dereq_('socket.io-parser');
				var Manager = _dereq_('./manager');
				var debug = _dereq_('debug')('socket.io-client');

				/**
     * Module exports.
     */

				module.exports = exports = lookup;

				/**
     * Managers cache.
     */

				var cache = exports.managers = {};

				/**
     * Looks up an existing `Manager` for multiplexing.
     * If the user summons:
     *
     *   `io('http://localhost/a');`
     *   `io('http://localhost/b');`
     *
     * We reuse the existing instance based on same scheme/port/host,
     * and we initialize sockets for each namespace.
     *
     * @api public
     */

				function lookup(uri, opts) {
					if ((typeof uri === "undefined" ? "undefined" : _typeof(uri)) == 'object') {
						opts = uri;
						uri = undefined;
					}

					opts = opts || {};

					var parsed = url(uri);
					var source = parsed.source;
					var id = parsed.id;
					var path = parsed.path;
					var sameNamespace = cache[id] && path in cache[id].nsps;
					var newConnection = opts.forceNew || opts['force new connection'] || false === opts.multiplex || sameNamespace;

					var io;

					if (newConnection) {
						debug('ignoring socket cache for %s', source);
						io = Manager(source, opts);
					} else {
						if (!cache[id]) {
							debug('new io instance for %s', source);
							cache[id] = Manager(source, opts);
						}
						io = cache[id];
					}

					return io.socket(parsed.path);
				}

				/**
     * Protocol version.
     *
     * @api public
     */

				exports.protocol = parser.protocol;

				/**
     * `connect`.
     *
     * @param {String} uri
     * @api public
     */

				exports.connect = lookup;

				/**
     * Expose constructors for standalone build.
     *
     * @api public
     */

				exports.Manager = _dereq_('./manager');
				exports.Socket = _dereq_('./socket');
			}, {
				"./manager": 32,
				"./socket": 34,
				"./url": 35,
				"debug": 39,
				"socket.io-parser": 47
			}],
			32: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var eio = _dereq_('engine.io-client');
				var Socket = _dereq_('./socket');
				var Emitter = _dereq_('component-emitter');
				var parser = _dereq_('socket.io-parser');
				var on = _dereq_('./on');
				var bind = _dereq_('component-bind');
				var debug = _dereq_('debug')('socket.io-client:manager');
				var indexOf = _dereq_('indexof');
				var Backoff = _dereq_('backo2');

				/**
     * IE6+ hasOwnProperty
     */

				var has = Object.prototype.hasOwnProperty;

				/**
     * Module exports
     */

				module.exports = Manager;

				/**
     * `Manager` constructor.
     *
     * @param {String} engine instance or engine uri/opts
     * @param {Object} options
     * @api public
     */

				function Manager(uri, opts) {
					if (!(this instanceof Manager)) return new Manager(uri, opts);
					if (uri && 'object' == (typeof uri === "undefined" ? "undefined" : _typeof(uri))) {
						opts = uri;
						uri = undefined;
					}
					opts = opts || {};

					opts.path = opts.path || '/socket.io';
					this.nsps = {};
					this.subs = [];
					this.opts = opts;
					this.reconnection(opts.reconnection !== false);
					this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);
					this.reconnectionDelay(opts.reconnectionDelay || 1000);
					this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);
					this.randomizationFactor(opts.randomizationFactor || 0.5);
					this.backoff = new Backoff({
						min: this.reconnectionDelay(),
						max: this.reconnectionDelayMax(),
						jitter: this.randomizationFactor()
					});
					this.timeout(null == opts.timeout ? 20000 : opts.timeout);
					this.readyState = 'closed';
					this.uri = uri;
					this.connecting = [];
					this.lastPing = null;
					this.encoding = false;
					this.packetBuffer = [];
					this.encoder = new parser.Encoder();
					this.decoder = new parser.Decoder();
					this.autoConnect = opts.autoConnect !== false;
					if (this.autoConnect) this.open();
				}

				/**
     * Propagate given event to sockets and emit on `this`
     *
     * @api private
     */

				Manager.prototype.emitAll = function () {
					this.emit.apply(this, arguments);
					for (var nsp in this.nsps) {
						if (has.call(this.nsps, nsp)) {
							this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);
						}
					}
				};

				/**
     * Update `socket.id` of all sockets
     *
     * @api private
     */

				Manager.prototype.updateSocketIds = function () {
					for (var nsp in this.nsps) {
						if (has.call(this.nsps, nsp)) {
							this.nsps[nsp].id = this.engine.id;
						}
					}
				};

				/**
     * Mix in `Emitter`.
     */

				Emitter(Manager.prototype);

				/**
     * Sets the `reconnection` config.
     *
     * @param {Boolean} true/false if it should automatically reconnect
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnection = function (v) {
					if (!arguments.length) return this._reconnection;
					this._reconnection = !!v;
					return this;
				};

				/**
     * Sets the reconnection attempts config.
     *
     * @param {Number} max reconnection attempts before giving up
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnectionAttempts = function (v) {
					if (!arguments.length) return this._reconnectionAttempts;
					this._reconnectionAttempts = v;
					return this;
				};

				/**
     * Sets the delay between reconnections.
     *
     * @param {Number} delay
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnectionDelay = function (v) {
					if (!arguments.length) return this._reconnectionDelay;
					this._reconnectionDelay = v;
					this.backoff && this.backoff.setMin(v);
					return this;
				};

				Manager.prototype.randomizationFactor = function (v) {
					if (!arguments.length) return this._randomizationFactor;
					this._randomizationFactor = v;
					this.backoff && this.backoff.setJitter(v);
					return this;
				};

				/**
     * Sets the maximum delay between reconnections.
     *
     * @param {Number} delay
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.reconnectionDelayMax = function (v) {
					if (!arguments.length) return this._reconnectionDelayMax;
					this._reconnectionDelayMax = v;
					this.backoff && this.backoff.setMax(v);
					return this;
				};

				/**
     * Sets the connection timeout. `false` to disable
     *
     * @return {Manager} self or value
     * @api public
     */

				Manager.prototype.timeout = function (v) {
					if (!arguments.length) return this._timeout;
					this._timeout = v;
					return this;
				};

				/**
     * Starts trying to reconnect if reconnection is enabled and we have not
     * started reconnecting yet
     *
     * @api private
     */

				Manager.prototype.maybeReconnectOnOpen = function () {
					// Only try to reconnect if it's the first time we're connecting
					if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {
						// keeps reconnection from firing twice for the same reconnection loop
						this.reconnect();
					}
				};

				/**
     * Sets the current transport `socket`.
     *
     * @param {Function} optional, callback
     * @return {Manager} self
     * @api public
     */

				Manager.prototype.open = Manager.prototype.connect = function (fn) {
					debug('readyState %s', this.readyState);
					if (~this.readyState.indexOf('open')) return this;

					debug('opening %s', this.uri);
					this.engine = eio(this.uri, this.opts);
					var socket = this.engine;
					var self = this;
					this.readyState = 'opening';
					this.skipReconnect = false;

					// emit `open`
					var openSub = on(socket, 'open', function () {
						self.onopen();
						fn && fn();
					});

					// emit `connect_error`
					var errorSub = on(socket, 'error', function (data) {
						debug('connect_error');
						self.cleanup();
						self.readyState = 'closed';
						self.emitAll('connect_error', data);
						if (fn) {
							var err = new Error('Connection error');
							err.data = data;
							fn(err);
						} else {
							// Only do this if there is no fn to handle the error
							self.maybeReconnectOnOpen();
						}
					});

					// emit `connect_timeout`
					if (false !== this._timeout) {
						var timeout = this._timeout;
						debug('connect attempt will timeout after %d', timeout);

						// set timer
						var timer = setTimeout(function () {
							debug('connect attempt timed out after %d', timeout);
							openSub.destroy();
							socket.close();
							socket.emit('error', 'timeout');
							self.emitAll('connect_timeout', timeout);
						}, timeout);

						this.subs.push({
							destroy: function destroy() {
								clearTimeout(timer);
							}
						});
					}

					this.subs.push(openSub);
					this.subs.push(errorSub);

					return this;
				};

				/**
     * Called upon transport open.
     *
     * @api private
     */

				Manager.prototype.onopen = function () {
					debug('open');

					// clear old subs
					this.cleanup();

					// mark as open
					this.readyState = 'open';
					this.emit('open');

					// add new subs
					var socket = this.engine;
					this.subs.push(on(socket, 'data', bind(this, 'ondata')));
					this.subs.push(on(socket, 'ping', bind(this, 'onping')));
					this.subs.push(on(socket, 'pong', bind(this, 'onpong')));
					this.subs.push(on(socket, 'error', bind(this, 'onerror')));
					this.subs.push(on(socket, 'close', bind(this, 'onclose')));
					this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));
				};

				/**
     * Called upon a ping.
     *
     * @api private
     */

				Manager.prototype.onping = function () {
					this.lastPing = new Date();
					this.emitAll('ping');
				};

				/**
     * Called upon a packet.
     *
     * @api private
     */

				Manager.prototype.onpong = function () {
					this.emitAll('pong', new Date() - this.lastPing);
				};

				/**
     * Called with data.
     *
     * @api private
     */

				Manager.prototype.ondata = function (data) {
					this.decoder.add(data);
				};

				/**
     * Called when parser fully decodes a packet.
     *
     * @api private
     */

				Manager.prototype.ondecoded = function (packet) {
					this.emit('packet', packet);
				};

				/**
     * Called upon socket error.
     *
     * @api private
     */

				Manager.prototype.onerror = function (err) {
					debug('error', err);
					this.emitAll('error', err);
				};

				/**
     * Creates a new socket for the given `nsp`.
     *
     * @return {Socket}
     * @api public
     */

				Manager.prototype.socket = function (nsp) {
					var socket = this.nsps[nsp];
					if (!socket) {
						socket = new Socket(this, nsp);
						this.nsps[nsp] = socket;
						var self = this;
						socket.on('connecting', onConnecting);
						socket.on('connect', function () {
							socket.id = self.engine.id;
						});

						if (this.autoConnect) {
							// manually call here since connecting evnet is fired before listening
							onConnecting();
						}
					}

					function onConnecting() {
						if (!~indexOf(self.connecting, socket)) {
							self.connecting.push(socket);
						}
					}

					return socket;
				};

				/**
     * Called upon a socket close.
     *
     * @param {Socket} socket
     */

				Manager.prototype.destroy = function (socket) {
					var index = indexOf(this.connecting, socket);
					if (~index) this.connecting.splice(index, 1);
					if (this.connecting.length) return;

					this.close();
				};

				/**
     * Writes a packet.
     *
     * @param {Object} packet
     * @api private
     */

				Manager.prototype.packet = function (packet) {
					debug('writing packet %j', packet);
					var self = this;

					if (!self.encoding) {
						// encode, then write to engine with result
						self.encoding = true;
						this.encoder.encode(packet, function (encodedPackets) {
							for (var i = 0; i < encodedPackets.length; i++) {
								self.engine.write(encodedPackets[i], packet.options);
							}
							self.encoding = false;
							self.processPacketQueue();
						});
					} else {
						// add packet to the queue
						self.packetBuffer.push(packet);
					}
				};

				/**
     * If packet buffer is non-empty, begins encoding the
     * next packet in line.
     *
     * @api private
     */

				Manager.prototype.processPacketQueue = function () {
					if (this.packetBuffer.length > 0 && !this.encoding) {
						var pack = this.packetBuffer.shift();
						this.packet(pack);
					}
				};

				/**
     * Clean up transport subscriptions and packet buffer.
     *
     * @api private
     */

				Manager.prototype.cleanup = function () {
					debug('cleanup');

					var sub;
					while (sub = this.subs.shift()) {
						sub.destroy();
					}this.packetBuffer = [];
					this.encoding = false;
					this.lastPing = null;

					this.decoder.destroy();
				};

				/**
     * Close the current socket.
     *
     * @api private
     */

				Manager.prototype.close = Manager.prototype.disconnect = function () {
					debug('disconnect');
					this.skipReconnect = true;
					this.reconnecting = false;
					if ('opening' == this.readyState) {
						// `onclose` will not fire because
						// an open event never happened
						this.cleanup();
					}
					this.backoff.reset();
					this.readyState = 'closed';
					if (this.engine) this.engine.close();
				};

				/**
     * Called upon engine close.
     *
     * @api private
     */

				Manager.prototype.onclose = function (reason) {
					debug('onclose');

					this.cleanup();
					this.backoff.reset();
					this.readyState = 'closed';
					this.emit('close', reason);

					if (this._reconnection && !this.skipReconnect) {
						this.reconnect();
					}
				};

				/**
     * Attempt a reconnection.
     *
     * @api private
     */

				Manager.prototype.reconnect = function () {
					if (this.reconnecting || this.skipReconnect) return this;

					var self = this;

					if (this.backoff.attempts >= this._reconnectionAttempts) {
						debug('reconnect failed');
						this.backoff.reset();
						this.emitAll('reconnect_failed');
						this.reconnecting = false;
					} else {
						var delay = this.backoff.duration();
						debug('will wait %dms before reconnect attempt', delay);

						this.reconnecting = true;
						var timer = setTimeout(function () {
							if (self.skipReconnect) return;

							debug('attempting reconnect');
							self.emitAll('reconnect_attempt', self.backoff.attempts);
							self.emitAll('reconnecting', self.backoff.attempts);

							// check again for the case socket closed in above events
							if (self.skipReconnect) return;

							self.open(function (err) {
								if (err) {
									debug('reconnect attempt error');
									self.reconnecting = false;
									self.reconnect();
									self.emitAll('reconnect_error', err.data);
								} else {
									debug('reconnect success');
									self.onreconnect();
								}
							});
						}, delay);

						this.subs.push({
							destroy: function destroy() {
								clearTimeout(timer);
							}
						});
					}
				};

				/**
     * Called upon successful reconnect.
     *
     * @api private
     */

				Manager.prototype.onreconnect = function () {
					var attempt = this.backoff.attempts;
					this.reconnecting = false;
					this.backoff.reset();
					this.updateSocketIds();
					this.emitAll('reconnect', attempt);
				};
			}, {
				"./on": 33,
				"./socket": 34,
				"backo2": 36,
				"component-bind": 37,
				"component-emitter": 38,
				"debug": 39,
				"engine.io-client": 1,
				"indexof": 42,
				"socket.io-parser": 47
			}],
			33: [function (_dereq_, module, exports) {

				/**
     * Module exports.
     */

				module.exports = on;

				/**
     * Helper for subscriptions.
     *
     * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`
     * @param {String} event name
     * @param {Function} callback
     * @api public
     */

				function on(obj, ev, fn) {
					obj.on(ev, fn);
					return {
						destroy: function destroy() {
							obj.removeListener(ev, fn);
						}
					};
				}
			}, {}],
			34: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var parser = _dereq_('socket.io-parser');
				var Emitter = _dereq_('component-emitter');
				var toArray = _dereq_('to-array');
				var on = _dereq_('./on');
				var bind = _dereq_('component-bind');
				var debug = _dereq_('debug')('socket.io-client:socket');
				var hasBin = _dereq_('has-binary');

				/**
     * Module exports.
     */

				module.exports = exports = Socket;

				/**
     * Internal events (blacklisted).
     * These events can't be emitted by the user.
     *
     * @api private
     */

				var events = {
					connect: 1,
					connect_error: 1,
					connect_timeout: 1,
					connecting: 1,
					disconnect: 1,
					error: 1,
					reconnect: 1,
					reconnect_attempt: 1,
					reconnect_failed: 1,
					reconnect_error: 1,
					reconnecting: 1,
					ping: 1,
					pong: 1
				};

				/**
     * Shortcut to `Emitter#emit`.
     */

				var emit = Emitter.prototype.emit;

				/**
     * `Socket` constructor.
     *
     * @api public
     */

				function Socket(io, nsp) {
					this.io = io;
					this.nsp = nsp;
					this.json = this; // compat
					this.ids = 0;
					this.acks = {};
					this.receiveBuffer = [];
					this.sendBuffer = [];
					this.connected = false;
					this.disconnected = true;
					if (this.io.autoConnect) this.open();
				}

				/**
     * Mix in `Emitter`.
     */

				Emitter(Socket.prototype);

				/**
     * Subscribe to open, close and packet events
     *
     * @api private
     */

				Socket.prototype.subEvents = function () {
					if (this.subs) return;

					var io = this.io;
					this.subs = [on(io, 'open', bind(this, 'onopen')), on(io, 'packet', bind(this, 'onpacket')), on(io, 'close', bind(this, 'onclose'))];
				};

				/**
     * "Opens" the socket.
     *
     * @api public
     */

				Socket.prototype.open = Socket.prototype.connect = function () {
					if (this.connected) return this;

					this.subEvents();
					this.io.open(); // ensure open
					if ('open' == this.io.readyState) this.onopen();
					this.emit('connecting');
					return this;
				};

				/**
     * Sends a `message` event.
     *
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.send = function () {
					var args = toArray(arguments);
					args.unshift('message');
					this.emit.apply(this, args);
					return this;
				};

				/**
     * Override `emit`.
     * If the event is in `events`, it's emitted normally.
     *
     * @param {String} event name
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.emit = function (ev) {
					if (events.hasOwnProperty(ev)) {
						emit.apply(this, arguments);
						return this;
					}

					var args = toArray(arguments);
					var parserType = parser.EVENT; // default
					if (hasBin(args)) {
						parserType = parser.BINARY_EVENT;
					} // binary
					var packet = {
						type: parserType,
						data: args
					};

					packet.options = {};
					packet.options.compress = !this.flags || false !== this.flags.compress;

					// event ack callback
					if ('function' == typeof args[args.length - 1]) {
						debug('emitting packet with ack id %d', this.ids);
						this.acks[this.ids] = args.pop();
						packet.id = this.ids++;
					}

					if (this.connected) {
						this.packet(packet);
					} else {
						this.sendBuffer.push(packet);
					}

					delete this.flags;

					return this;
				};

				/**
     * Sends a packet.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.packet = function (packet) {
					packet.nsp = this.nsp;
					this.io.packet(packet);
				};

				/**
     * Called upon engine `open`.
     *
     * @api private
     */

				Socket.prototype.onopen = function () {
					debug('transport is open - connecting');

					// write connect packet if necessary
					if ('/' != this.nsp) {
						this.packet({
							type: parser.CONNECT
						});
					}
				};

				/**
     * Called upon engine `close`.
     *
     * @param {String} reason
     * @api private
     */

				Socket.prototype.onclose = function (reason) {
					debug('close (%s)', reason);
					this.connected = false;
					this.disconnected = true;
					delete this.id;
					this.emit('disconnect', reason);
				};

				/**
     * Called with socket packet.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.onpacket = function (packet) {
					if (packet.nsp != this.nsp) return;

					switch (packet.type) {
						case parser.CONNECT:
							this.onconnect();
							break;

						case parser.EVENT:
							this.onevent(packet);
							break;

						case parser.BINARY_EVENT:
							this.onevent(packet);
							break;

						case parser.ACK:
							this.onack(packet);
							break;

						case parser.BINARY_ACK:
							this.onack(packet);
							break;

						case parser.DISCONNECT:
							this.ondisconnect();
							break;

						case parser.ERROR:
							this.emit('error', packet.data);
							break;
					}
				};

				/**
     * Called upon a server event.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.onevent = function (packet) {
					var args = packet.data || [];
					debug('emitting event %j', args);

					if (null != packet.id) {
						debug('attaching ack callback to event');
						args.push(this.ack(packet.id));
					}

					if (this.connected) {
						emit.apply(this, args);
					} else {
						this.receiveBuffer.push(args);
					}
				};

				/**
     * Produces an ack callback to emit with an event.
     *
     * @api private
     */

				Socket.prototype.ack = function (id) {
					var self = this;
					var sent = false;
					return function () {
						// prevent double callbacks
						if (sent) return;
						sent = true;
						var args = toArray(arguments);
						debug('sending ack %j', args);

						var type = hasBin(args) ? parser.BINARY_ACK : parser.ACK;
						self.packet({
							type: type,
							id: id,
							data: args
						});
					};
				};

				/**
     * Called upon a server acknowlegement.
     *
     * @param {Object} packet
     * @api private
     */

				Socket.prototype.onack = function (packet) {
					var ack = this.acks[packet.id];
					if ('function' == typeof ack) {
						debug('calling ack %s with %j', packet.id, packet.data);
						ack.apply(this, packet.data);
						delete this.acks[packet.id];
					} else {
						debug('bad ack %s', packet.id);
					}
				};

				/**
     * Called upon server connect.
     *
     * @api private
     */

				Socket.prototype.onconnect = function () {
					this.connected = true;
					this.disconnected = false;
					this.emit('connect');
					this.emitBuffered();
				};

				/**
     * Emit buffered events (received and emitted).
     *
     * @api private
     */

				Socket.prototype.emitBuffered = function () {
					var i;
					for (i = 0; i < this.receiveBuffer.length; i++) {
						emit.apply(this, this.receiveBuffer[i]);
					}
					this.receiveBuffer = [];

					for (i = 0; i < this.sendBuffer.length; i++) {
						this.packet(this.sendBuffer[i]);
					}
					this.sendBuffer = [];
				};

				/**
     * Called upon server disconnect.
     *
     * @api private
     */

				Socket.prototype.ondisconnect = function () {
					debug('server disconnect (%s)', this.nsp);
					this.destroy();
					this.onclose('io server disconnect');
				};

				/**
     * Called upon forced client/server side disconnections,
     * this method ensures the manager stops tracking us and
     * that reconnections don't get triggered for this.
     *
     * @api private.
     */

				Socket.prototype.destroy = function () {
					if (this.subs) {
						// clean subscriptions to avoid reconnections
						for (var i = 0; i < this.subs.length; i++) {
							this.subs[i].destroy();
						}
						this.subs = null;
					}

					this.io.destroy(this);
				};

				/**
     * Disconnects the socket manually.
     *
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.close = Socket.prototype.disconnect = function () {
					if (this.connected) {
						debug('performing disconnect (%s)', this.nsp);
						this.packet({
							type: parser.DISCONNECT
						});
					}

					// remove socket from pool
					this.destroy();

					if (this.connected) {
						// fire events
						this.onclose('io client disconnect');
					}
					return this;
				};

				/**
     * Sets the compress flag.
     *
     * @param {Boolean} if `true`, compresses the sending data
     * @return {Socket} self
     * @api public
     */

				Socket.prototype.compress = function (compress) {
					this.flags = this.flags || {};
					this.flags.compress = compress;
					return this;
				};
			}, {
				"./on": 33,
				"component-bind": 37,
				"component-emitter": 38,
				"debug": 39,
				"has-binary": 41,
				"socket.io-parser": 47,
				"to-array": 51
			}],
			35: [function (_dereq_, module, exports) {
				(function (global) {

					/**
      * Module dependencies.
      */

					var parseuri = _dereq_('parseuri');
					var debug = _dereq_('debug')('socket.io-client:url');

					/**
      * Module exports.
      */

					module.exports = url;

					/**
      * URL parser.
      *
      * @param {String} url
      * @param {Object} An object meant to mimic window.location.
      *                 Defaults to window.location.
      * @api public
      */

					function url(uri, loc) {
						var obj = uri;

						// default to window.location
						var loc = loc || global.location;
						if (null == uri) uri = loc.protocol + '//' + loc.host;

						// relative path support
						if ('string' == typeof uri) {
							if ('/' == uri.charAt(0)) {
								if ('/' == uri.charAt(1)) {
									uri = loc.protocol + uri;
								} else {
									uri = loc.host + uri;
								}
							}

							if (!/^(https?|wss?):\/\//.test(uri)) {
								debug('protocol-less url %s', uri);
								if ('undefined' != typeof loc) {
									uri = loc.protocol + '//' + uri;
								} else {
									uri = 'https://' + uri;
								}
							}

							// parse
							debug('parse %s', uri);
							obj = parseuri(uri);
						}

						// make sure we treat `localhost:80` and `localhost` equally
						if (!obj.port) {
							if (/^(http|ws)$/.test(obj.protocol)) {
								obj.port = '80';
							} else if (/^(http|ws)s$/.test(obj.protocol)) {
								obj.port = '443';
							}
						}

						obj.path = obj.path || '/';

						var ipv6 = obj.host.indexOf(':') !== -1;
						var host = ipv6 ? '[' + obj.host + ']' : obj.host;

						// define unique id
						obj.id = obj.protocol + '://' + host + ':' + obj.port;
						// define href
						obj.href = obj.protocol + '://' + host + (loc && loc.port == obj.port ? '' : ':' + obj.port);

						return obj;
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"debug": 39,
				"parseuri": 45
			}],
			36: [function (_dereq_, module, exports) {

				/**
     * Expose `Backoff`.
     */

				module.exports = Backoff;

				/**
     * Initialize backoff timer with `opts`.
     *
     * - `min` initial timeout in milliseconds [100]
     * - `max` max timeout [10000]
     * - `jitter` [0]
     * - `factor` [2]
     *
     * @param {Object} opts
     * @api public
     */

				function Backoff(opts) {
					opts = opts || {};
					this.ms = opts.min || 100;
					this.max = opts.max || 10000;
					this.factor = opts.factor || 2;
					this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;
					this.attempts = 0;
				}

				/**
     * Return the backoff duration.
     *
     * @return {Number}
     * @api public
     */

				Backoff.prototype.duration = function () {
					var ms = this.ms * Math.pow(this.factor, this.attempts++);
					if (this.jitter) {
						var rand = Math.random();
						var deviation = Math.floor(rand * this.jitter * ms);
						ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;
					}
					return Math.min(ms, this.max) | 0;
				};

				/**
     * Reset the number of attempts.
     *
     * @api public
     */

				Backoff.prototype.reset = function () {
					this.attempts = 0;
				};

				/**
     * Set the minimum duration
     *
     * @api public
     */

				Backoff.prototype.setMin = function (min) {
					this.ms = min;
				};

				/**
     * Set the maximum duration
     *
     * @api public
     */

				Backoff.prototype.setMax = function (max) {
					this.max = max;
				};

				/**
     * Set the jitter
     *
     * @api public
     */

				Backoff.prototype.setJitter = function (jitter) {
					this.jitter = jitter;
				};
			}, {}],
			37: [function (_dereq_, module, exports) {
				/**
     * Slice reference.
     */

				var slice = [].slice;

				/**
     * Bind `obj` to `fn`.
     *
     * @param {Object} obj
     * @param {Function|String} fn or string
     * @return {Function}
     * @api public
     */

				module.exports = function (obj, fn) {
					if ('string' == typeof fn) fn = obj[fn];
					if ('function' != typeof fn) throw new Error('bind() requires a function');
					var args = slice.call(arguments, 2);
					return function () {
						return fn.apply(obj, args.concat(slice.call(arguments)));
					};
				};
			}, {}],
			38: [function (_dereq_, module, exports) {

				/**
     * Expose `Emitter`.
     */

				module.exports = Emitter;

				/**
     * Initialize a new `Emitter`.
     *
     * @api public
     */

				function Emitter(obj) {
					if (obj) return mixin(obj);
				};

				/**
     * Mixin the emitter properties.
     *
     * @param {Object} obj
     * @return {Object}
     * @api private
     */

				function mixin(obj) {
					for (var key in Emitter.prototype) {
						obj[key] = Emitter.prototype[key];
					}
					return obj;
				}

				/**
     * Listen on the given `event` with `fn`.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};
					(this._callbacks['$' + event] = this._callbacks['$' + event] || []).push(fn);
					return this;
				};

				/**
     * Adds an `event` listener that will be invoked a single
     * time then automatically removed.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.once = function (event, fn) {
					function on() {
						this.off(event, on);
						fn.apply(this, arguments);
					}

					on.fn = fn;
					this.on(event, on);
					return this;
				};

				/**
     * Remove the given callback for `event` or all
     * registered callbacks.
     *
     * @param {String} event
     * @param {Function} fn
     * @return {Emitter}
     * @api public
     */

				Emitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {
					this._callbacks = this._callbacks || {};

					// all
					if (0 == arguments.length) {
						this._callbacks = {};
						return this;
					}

					// specific event
					var callbacks = this._callbacks['$' + event];
					if (!callbacks) return this;

					// remove all handlers
					if (1 == arguments.length) {
						delete this._callbacks['$' + event];
						return this;
					}

					// remove specific handler
					var cb;
					for (var i = 0; i < callbacks.length; i++) {
						cb = callbacks[i];
						if (cb === fn || cb.fn === fn) {
							callbacks.splice(i, 1);
							break;
						}
					}
					return this;
				};

				/**
     * Emit `event` with the given args.
     *
     * @param {String} event
     * @param {Mixed} ...
     * @return {Emitter}
     */

				Emitter.prototype.emit = function (event) {
					this._callbacks = this._callbacks || {};
					var args = [].slice.call(arguments, 1),
					    callbacks = this._callbacks['$' + event];

					if (callbacks) {
						callbacks = callbacks.slice(0);
						for (var i = 0, len = callbacks.length; i < len; ++i) {
							callbacks[i].apply(this, args);
						}
					}

					return this;
				};

				/**
     * Return array of callbacks for `event`.
     *
     * @param {String} event
     * @return {Array}
     * @api public
     */

				Emitter.prototype.listeners = function (event) {
					this._callbacks = this._callbacks || {};
					return this._callbacks['$' + event] || [];
				};

				/**
     * Check if this emitter has `event` handlers.
     *
     * @param {String} event
     * @return {Boolean}
     * @api public
     */

				Emitter.prototype.hasListeners = function (event) {
					return !!this.listeners(event).length;
				};
			}, {}],
			39: [function (_dereq_, module, exports) {
				arguments[4][17][0].apply(exports, arguments);
			}, {
				"./debug": 40,
				"dup": 17
			}],
			40: [function (_dereq_, module, exports) {
				arguments[4][18][0].apply(exports, arguments);
			}, {
				"dup": 18,
				"ms": 44
			}],
			41: [function (_dereq_, module, exports) {
				(function (global) {

					/*
      * Module requirements.
      */

					var isArray = _dereq_('isarray');

					/**
      * Module exports.
      */

					module.exports = hasBinary;

					/**
      * Checks for binary data.
      *
      * Right now only Buffer and ArrayBuffer are supported..
      *
      * @param {Object} anything
      * @api public
      */

					function hasBinary(data) {

						function _hasBinary(obj) {
							if (!obj) return false;

							if (global.Buffer && global.Buffer.isBuffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer || global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
								return true;
							}

							if (isArray(obj)) {
								for (var i = 0; i < obj.length; i++) {
									if (_hasBinary(obj[i])) {
										return true;
									}
								}
							} else if (obj && 'object' == (typeof obj === "undefined" ? "undefined" : _typeof(obj))) {
								// see: https://github.com/Automattic/has-binary/pull/4
								if (obj.toJSON && 'function' == typeof obj.toJSON) {
									obj = obj.toJSON();
								}

								for (var key in obj) {
									if (Object.prototype.hasOwnProperty.call(obj, key) && _hasBinary(obj[key])) {
										return true;
									}
								}
							}

							return false;
						}

						return _hasBinary(data);
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"isarray": 43
			}],
			42: [function (_dereq_, module, exports) {
				arguments[4][23][0].apply(exports, arguments);
			}, {
				"dup": 23
			}],
			43: [function (_dereq_, module, exports) {
				arguments[4][24][0].apply(exports, arguments);
			}, {
				"dup": 24
			}],
			44: [function (_dereq_, module, exports) {
				arguments[4][25][0].apply(exports, arguments);
			}, {
				"dup": 25
			}],
			45: [function (_dereq_, module, exports) {
				arguments[4][28][0].apply(exports, arguments);
			}, {
				"dup": 28
			}],
			46: [function (_dereq_, module, exports) {
				(function (global) {
					/*global Blob,File*/

					/**
      * Module requirements
      */

					var isArray = _dereq_('isarray');
					var isBuf = _dereq_('./is-buffer');

					/**
      * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.
      * Anything with blobs or files should be fed through removeBlobs before coming
      * here.
      *
      * @param {Object} packet - socket.io event packet
      * @return {Object} with deconstructed packet and list of buffers
      * @api public
      */

					exports.deconstructPacket = function (packet) {
						var buffers = [];
						var packetData = packet.data;

						function _deconstructPacket(data) {
							if (!data) return data;

							if (isBuf(data)) {
								var placeholder = {
									_placeholder: true,
									num: buffers.length
								};
								buffers.push(data);
								return placeholder;
							} else if (isArray(data)) {
								var newData = new Array(data.length);
								for (var i = 0; i < data.length; i++) {
									newData[i] = _deconstructPacket(data[i]);
								}
								return newData;
							} else if ('object' == (typeof data === "undefined" ? "undefined" : _typeof(data)) && !(data instanceof Date)) {
								var newData = {};
								for (var key in data) {
									newData[key] = _deconstructPacket(data[key]);
								}
								return newData;
							}
							return data;
						}

						var pack = packet;
						pack.data = _deconstructPacket(packetData);
						pack.attachments = buffers.length; // number of binary 'attachments'
						return {
							packet: pack,
							buffers: buffers
						};
					};

					/**
      * Reconstructs a binary packet from its placeholder packet and buffers
      *
      * @param {Object} packet - event packet with placeholders
      * @param {Array} buffers - binary buffers to put in placeholder positions
      * @return {Object} reconstructed packet
      * @api public
      */

					exports.reconstructPacket = function (packet, buffers) {
						var curPlaceHolder = 0;

						function _reconstructPacket(data) {
							if (data && data._placeholder) {
								var buf = buffers[data.num]; // appropriate buffer (should be natural order anyway)
								return buf;
							} else if (isArray(data)) {
								for (var i = 0; i < data.length; i++) {
									data[i] = _reconstructPacket(data[i]);
								}
								return data;
							} else if (data && 'object' == (typeof data === "undefined" ? "undefined" : _typeof(data))) {
								for (var key in data) {
									data[key] = _reconstructPacket(data[key]);
								}
								return data;
							}
							return data;
						}

						packet.data = _reconstructPacket(packet.data);
						packet.attachments = undefined; // no longer useful
						return packet;
					};

					/**
      * Asynchronously removes Blobs or Files from data via
      * FileReader's readAsArrayBuffer method. Used before encoding
      * data as msgpack. Calls callback with the blobless data.
      *
      * @param {Object} data
      * @param {Function} callback
      * @api private
      */

					exports.removeBlobs = function (data, callback) {
						function _removeBlobs(obj, curKey, containingObject) {
							if (!obj) return obj;

							// convert any blob
							if (global.Blob && obj instanceof Blob || global.File && obj instanceof File) {
								pendingBlobs++;

								// async filereader
								var fileReader = new FileReader();
								fileReader.onload = function () {
									// this.result == arraybuffer
									if (containingObject) {
										containingObject[curKey] = this.result;
									} else {
										bloblessData = this.result;
									}

									// if nothing pending its callback time
									if (! --pendingBlobs) {
										callback(bloblessData);
									}
								};

								fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer
							} else if (isArray(obj)) {
								// handle array
								for (var i = 0; i < obj.length; i++) {
									_removeBlobs(obj[i], i, obj);
								}
							} else if (obj && 'object' == (typeof obj === "undefined" ? "undefined" : _typeof(obj)) && !isBuf(obj)) {
								// and object
								for (var key in obj) {
									_removeBlobs(obj[key], key, obj);
								}
							}
						}

						var pendingBlobs = 0;
						var bloblessData = data;
						_removeBlobs(bloblessData);
						if (!pendingBlobs) {
							callback(bloblessData);
						}
					};
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {
				"./is-buffer": 48,
				"isarray": 43
			}],
			47: [function (_dereq_, module, exports) {

				/**
     * Module dependencies.
     */

				var debug = _dereq_('debug')('socket.io-parser');
				var json = _dereq_('json3');
				var isArray = _dereq_('isarray');
				var Emitter = _dereq_('component-emitter');
				var binary = _dereq_('./binary');
				var isBuf = _dereq_('./is-buffer');

				/**
     * Protocol version.
     *
     * @api public
     */

				exports.protocol = 4;

				/**
     * Packet types.
     *
     * @api public
     */

				exports.types = ['CONNECT', 'DISCONNECT', 'EVENT', 'BINARY_EVENT', 'ACK', 'BINARY_ACK', 'ERROR'];

				/**
     * Packet type `connect`.
     *
     * @api public
     */

				exports.CONNECT = 0;

				/**
     * Packet type `disconnect`.
     *
     * @api public
     */

				exports.DISCONNECT = 1;

				/**
     * Packet type `event`.
     *
     * @api public
     */

				exports.EVENT = 2;

				/**
     * Packet type `ack`.
     *
     * @api public
     */

				exports.ACK = 3;

				/**
     * Packet type `error`.
     *
     * @api public
     */

				exports.ERROR = 4;

				/**
     * Packet type 'binary event'
     *
     * @api public
     */

				exports.BINARY_EVENT = 5;

				/**
     * Packet type `binary ack`. For acks with binary arguments.
     *
     * @api public
     */

				exports.BINARY_ACK = 6;

				/**
     * Encoder constructor.
     *
     * @api public
     */

				exports.Encoder = Encoder;

				/**
     * Decoder constructor.
     *
     * @api public
     */

				exports.Decoder = Decoder;

				/**
     * A socket.io Encoder instance
     *
     * @api public
     */

				function Encoder() {}

				/**
     * Encode a packet as a single string if non-binary, or as a
     * buffer sequence, depending on packet type.
     *
     * @param {Object} obj - packet object
     * @param {Function} callback - function to handle encodings (likely engine.write)
     * @return Calls callback with Array of encodings
     * @api public
     */

				Encoder.prototype.encode = function (obj, callback) {
					debug('encoding packet %j', obj);

					if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {
						encodeAsBinary(obj, callback);
					} else {
						var encoding = encodeAsString(obj);
						callback([encoding]);
					}
				};

				/**
     * Encode packet as string.
     *
     * @param {Object} packet
     * @return {String} encoded
     * @api private
     */

				function encodeAsString(obj) {
					var str = '';
					var nsp = false;

					// first is type
					str += obj.type;

					// attachments if we have them
					if (exports.BINARY_EVENT == obj.type || exports.BINARY_ACK == obj.type) {
						str += obj.attachments;
						str += '-';
					}

					// if we have a namespace other than `/`
					// we append it followed by a comma `,`
					if (obj.nsp && '/' != obj.nsp) {
						nsp = true;
						str += obj.nsp;
					}

					// immediately followed by the id
					if (null != obj.id) {
						if (nsp) {
							str += ',';
							nsp = false;
						}
						str += obj.id;
					}

					// json data
					if (null != obj.data) {
						if (nsp) str += ',';
						str += json.stringify(obj.data);
					}

					debug('encoded %j as %s', obj, str);
					return str;
				}

				/**
     * Encode packet as 'buffer sequence' by removing blobs, and
     * deconstructing packet into object with placeholders and
     * a list of buffers.
     *
     * @param {Object} packet
     * @return {Buffer} encoded
     * @api private
     */

				function encodeAsBinary(obj, callback) {

					function writeEncoding(bloblessData) {
						var deconstruction = binary.deconstructPacket(bloblessData);
						var pack = encodeAsString(deconstruction.packet);
						var buffers = deconstruction.buffers;

						buffers.unshift(pack); // add packet info to beginning of data list
						callback(buffers); // write all the buffers
					}

					binary.removeBlobs(obj, writeEncoding);
				}

				/**
     * A socket.io Decoder instance
     *
     * @return {Object} decoder
     * @api public
     */

				function Decoder() {
					this.reconstructor = null;
				}

				/**
     * Mix in `Emitter` with Decoder.
     */

				Emitter(Decoder.prototype);

				/**
     * Decodes an ecoded packet string into packet JSON.
     *
     * @param {String} obj - encoded packet
     * @return {Object} packet
     * @api public
     */

				Decoder.prototype.add = function (obj) {
					var packet;
					if ('string' == typeof obj) {
						packet = decodeString(obj);
						if (exports.BINARY_EVENT == packet.type || exports.BINARY_ACK == packet.type) {
							// binary packet's json
							this.reconstructor = new BinaryReconstructor(packet);

							// no attachments, labeled binary but no binary data to follow
							if (this.reconstructor.reconPack.attachments === 0) {
								this.emit('decoded', packet);
							}
						} else {
							// non-binary full packet
							this.emit('decoded', packet);
						}
					} else if (isBuf(obj) || obj.base64) {
						// raw binary data
						if (!this.reconstructor) {
							throw new Error('got binary data when not reconstructing a packet');
						} else {
							packet = this.reconstructor.takeBinaryData(obj);
							if (packet) {
								// received final buffer
								this.reconstructor = null;
								this.emit('decoded', packet);
							}
						}
					} else {
						throw new Error('Unknown type: ' + obj);
					}
				};

				/**
     * Decode a packet String (JSON data)
     *
     * @param {String} str
     * @return {Object} packet
     * @api private
     */

				function decodeString(str) {
					var p = {};
					var i = 0;

					// look up type
					p.type = Number(str.charAt(0));
					if (null == exports.types[p.type]) return error();

					// look up attachments if type binary
					if (exports.BINARY_EVENT == p.type || exports.BINARY_ACK == p.type) {
						var buf = '';
						while (str.charAt(++i) != '-') {
							buf += str.charAt(i);
							if (i == str.length) break;
						}
						if (buf != Number(buf) || str.charAt(i) != '-') {
							throw new Error('Illegal attachments');
						}
						p.attachments = Number(buf);
					}

					// look up namespace (if any)
					if ('/' == str.charAt(i + 1)) {
						p.nsp = '';
						while (++i) {
							var c = str.charAt(i);
							if (',' == c) break;
							p.nsp += c;
							if (i == str.length) break;
						}
					} else {
						p.nsp = '/';
					}

					// look up id
					var next = str.charAt(i + 1);
					if ('' !== next && Number(next) == next) {
						p.id = '';
						while (++i) {
							var c = str.charAt(i);
							if (null == c || Number(c) != c) {
								--i;
								break;
							}
							p.id += str.charAt(i);
							if (i == str.length) break;
						}
						p.id = Number(p.id);
					}

					// look up json data
					if (str.charAt(++i)) {
						try {
							p.data = json.parse(str.substr(i));
						} catch (e) {
							return error();
						}
					}

					debug('decoded %s as %j', str, p);
					return p;
				}

				/**
     * Deallocates a parser's resources
     *
     * @api public
     */

				Decoder.prototype.destroy = function () {
					if (this.reconstructor) {
						this.reconstructor.finishedReconstruction();
					}
				};

				/**
     * A manager of a binary event's 'buffer sequence'. Should
     * be constructed whenever a packet of type BINARY_EVENT is
     * decoded.
     *
     * @param {Object} packet
     * @return {BinaryReconstructor} initialized reconstructor
     * @api private
     */

				function BinaryReconstructor(packet) {
					this.reconPack = packet;
					this.buffers = [];
				}

				/**
     * Method to be called when binary data received from connection
     * after a BINARY_EVENT packet.
     *
     * @param {Buffer | ArrayBuffer} binData - the raw binary data received
     * @return {null | Object} returns null if more binary data is expected or
     *   a reconstructed packet object if all buffers have been received.
     * @api private
     */

				BinaryReconstructor.prototype.takeBinaryData = function (binData) {
					this.buffers.push(binData);
					if (this.buffers.length == this.reconPack.attachments) {
						// done with buffer list
						var packet = binary.reconstructPacket(this.reconPack, this.buffers);
						this.finishedReconstruction();
						return packet;
					}
					return null;
				};

				/**
     * Cleans up binary packet reconstruction variables.
     *
     * @api private
     */

				BinaryReconstructor.prototype.finishedReconstruction = function () {
					this.reconPack = null;
					this.buffers = [];
				};

				function error(data) {
					return {
						type: exports.ERROR,
						data: 'parser error'
					};
				}
			}, {
				"./binary": 46,
				"./is-buffer": 48,
				"component-emitter": 49,
				"debug": 39,
				"isarray": 43,
				"json3": 50
			}],
			48: [function (_dereq_, module, exports) {
				(function (global) {

					module.exports = isBuf;

					/**
      * Returns true if obj is a buffer or an arraybuffer.
      *
      * @api private
      */

					function isBuf(obj) {
						return global.Buffer && global.Buffer.isBuffer(obj) || global.ArrayBuffer && obj instanceof ArrayBuffer;
					}
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}],
			49: [function (_dereq_, module, exports) {
				arguments[4][15][0].apply(exports, arguments);
			}, {
				"dup": 15
			}],
			50: [function (_dereq_, module, exports) {
				(function (global) {
					/*! JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org */
					;
					(function () {
						// Detect the `define` function exposed by asynchronous module loaders. The
						// strict `define` check is necessary for compatibility with `r.js`.
						var isLoader = typeof define === "function" && define.amd;

						// A set of types used to distinguish objects from primitives.
						var objectTypes = {
							"function": true,
							"object": true
						};

						// Detect the `exports` object exposed by CommonJS implementations.
						var freeExports = objectTypes[typeof exports === "undefined" ? "undefined" : _typeof(exports)] && exports && !exports.nodeType && exports;

						// Use the `global` object exposed by Node (including Browserify via
						// `insert-module-globals`), Narwhal, and Ringo as the default context,
						// and the `window` object in browsers. Rhino exports a `global` function
						// instead.
						var root = objectTypes[typeof window === "undefined" ? "undefined" : _typeof(window)] && window || this,
						    freeGlobal = freeExports && objectTypes[typeof module === "undefined" ? "undefined" : _typeof(module)] && module && !module.nodeType && (typeof global === "undefined" ? "undefined" : _typeof(global)) == "object" && global;

						if (freeGlobal && (freeGlobal["global"] === freeGlobal || freeGlobal["window"] === freeGlobal || freeGlobal["self"] === freeGlobal)) {
							root = freeGlobal;
						}

						// Public: Initializes JSON 3 using the given `context` object, attaching the
						// `stringify` and `parse` functions to the specified `exports` object.
						function runInContext(context, exports) {
							context || (context = root["Object"]());
							exports || (exports = root["Object"]());

							// Native constructor aliases.
							var Number = context["Number"] || root["Number"],
							    String = context["String"] || root["String"],
							    Object = context["Object"] || root["Object"],
							    Date = context["Date"] || root["Date"],
							    SyntaxError = context["SyntaxError"] || root["SyntaxError"],
							    TypeError = context["TypeError"] || root["TypeError"],
							    Math = context["Math"] || root["Math"],
							    nativeJSON = context["JSON"] || root["JSON"];

							// Delegate to the native `stringify` and `parse` implementations.
							if ((typeof nativeJSON === "undefined" ? "undefined" : _typeof(nativeJSON)) == "object" && nativeJSON) {
								exports.stringify = nativeJSON.stringify;
								exports.parse = nativeJSON.parse;
							}

							// Convenience aliases.
							var objectProto = Object.prototype,
							    getClass = objectProto.toString,
							    _isProperty,
							    _forEach,
							    undef;

							// Test the `Date#getUTC*` methods. Based on work by @Yaffle.
							var isExtended = new Date(-3509827334573292);
							try {
								// The `getUTCFullYear`, `Month`, and `Date` methods return nonsensical
								// results for certain dates in Opera >= 10.53.
								isExtended = isExtended.getUTCFullYear() == -109252 && isExtended.getUTCMonth() === 0 && isExtended.getUTCDate() === 1 &&
								// Safari < 2.0.2 stores the internal millisecond time value correctly,
								// but clips the values returned by the date methods to the range of
								// signed 32-bit integers ([-2 ** 31, 2 ** 31 - 1]).
								isExtended.getUTCHours() == 10 && isExtended.getUTCMinutes() == 37 && isExtended.getUTCSeconds() == 6 && isExtended.getUTCMilliseconds() == 708;
							} catch (exception) {}

							// Internal: Determines whether the native `JSON.stringify` and `parse`
							// implementations are spec-compliant. Based on work by Ken Snyder.
							function has(name) {
								if (has[name] !== undef) {
									// Return cached feature test result.
									return has[name];
								}
								var isSupported;
								if (name == "bug-string-char-index") {
									// IE <= 7 doesn't support accessing string characters using square
									// bracket notation. IE 8 only supports this for primitives.
									isSupported = "a"[0] != "a";
								} else if (name == "json") {
									// Indicates whether both `JSON.stringify` and `JSON.parse` are
									// supported.
									isSupported = has("json-stringify") && has("json-parse");
								} else {
									var value,
									    serialized = "{\"a\":[1,true,false,null,\"\\u0000\\b\\n\\f\\r\\t\"]}";
									// Test `JSON.stringify`.
									if (name == "json-stringify") {
										var stringify = exports.stringify,
										    stringifySupported = typeof stringify == "function" && isExtended;
										if (stringifySupported) {
											// A test function object with a custom `toJSON` method.
											(value = function value() {
												return 1;
											}).toJSON = value;
											try {
												stringifySupported =
												// Firefox 3.1b1 and b2 serialize string, number, and boolean
												// primitives as object literals.
												stringify(0) === "0" &&
												// FF 3.1b1, b2, and JSON 2 serialize wrapped primitives as object
												// literals.
												stringify(new Number()) === "0" && stringify(new String()) == '""' &&
												// FF 3.1b1, 2 throw an error if the value is `null`, `undefined`, or
												// does not define a canonical JSON representation (this applies to
												// objects with `toJSON` properties as well, *unless* they are nested
												// within an object or array).
												stringify(getClass) === undef &&
												// IE 8 serializes `undefined` as `"undefined"`. Safari <= 5.1.7 and
												// FF 3.1b3 pass this test.
												stringify(undef) === undef &&
												// Safari <= 5.1.7 and FF 3.1b3 throw `Error`s and `TypeError`s,
												// respectively, if the value is omitted entirely.
												stringify() === undef &&
												// FF 3.1b1, 2 throw an error if the given value is not a number,
												// string, array, object, Boolean, or `null` literal. This applies to
												// objects with custom `toJSON` methods as well, unless they are nested
												// inside object or array literals. YUI 3.0.0b1 ignores custom `toJSON`
												// methods entirely.
												stringify(value) === "1" && stringify([value]) == "[1]" &&
												// Prototype <= 1.6.1 serializes `[undefined]` as `"[]"` instead of
												// `"[null]"`.
												stringify([undef]) == "[null]" &&
												// YUI 3.0.0b1 fails to serialize `null` literals.
												stringify(null) == "null" &&
												// FF 3.1b1, 2 halts serialization if an array contains a function:
												// `[1, true, getClass, 1]` serializes as "[1,true,],". FF 3.1b3
												// elides non-JSON values from objects and arrays, unless they
												// define custom `toJSON` methods.
												stringify([undef, getClass, null]) == "[null,null,null]" &&
												// Simple serialization test. FF 3.1b1 uses Unicode escape sequences
												// where character escape codes are expected (e.g., `\b` => `\u0008`).
												stringify({
													"a": [value, true, false, null, "\x00\b\n\f\r\t"]
												}) == serialized &&
												// FF 3.1b1 and b2 ignore the `filter` and `width` arguments.
												stringify(null, value) === "1" && stringify([1, 2], null, 1) == "[\n 1,\n 2\n]" &&
												// JSON 2, Prototype <= 1.7, and older WebKit builds incorrectly
												// serialize extended years.
												stringify(new Date(-8.64e15)) == '"-271821-04-20T00:00:00.000Z"' &&
												// The milliseconds are optional in ES 5, but required in 5.1.
												stringify(new Date(8.64e15)) == '"+275760-09-13T00:00:00.000Z"' &&
												// Firefox <= 11.0 incorrectly serializes years prior to 0 as negative
												// four-digit years instead of six-digit years. Credits: @Yaffle.
												stringify(new Date(-621987552e5)) == '"-000001-01-01T00:00:00.000Z"' &&
												// Safari <= 5.1.5 and Opera >= 10.53 incorrectly serialize millisecond
												// values less than 1000. Credits: @Yaffle.
												stringify(new Date(-1)) == '"1969-12-31T23:59:59.999Z"';
											} catch (exception) {
												stringifySupported = false;
											}
										}
										isSupported = stringifySupported;
									}
									// Test `JSON.parse`.
									if (name == "json-parse") {
										var parse = exports.parse;
										if (typeof parse == "function") {
											try {
												// FF 3.1b1, b2 will throw an exception if a bare literal is provided.
												// Conforming implementations should also coerce the initial argument to
												// a string prior to parsing.
												if (parse("0") === 0 && !parse(false)) {
													// Simple parsing test.
													value = parse(serialized);
													var parseSupported = value["a"].length == 5 && value["a"][0] === 1;
													if (parseSupported) {
														try {
															// Safari <= 5.1.2 and FF 3.1b1 allow unescaped tabs in strings.
															parseSupported = !parse('"\t"');
														} catch (exception) {}
														if (parseSupported) {
															try {
																// FF 4.0 and 4.0.1 allow leading `+` signs and leading
																// decimal points. FF 4.0, 4.0.1, and IE 9-10 also allow
																// certain octal literals.
																parseSupported = parse("01") !== 1;
															} catch (exception) {}
														}
														if (parseSupported) {
															try {
																// FF 4.0, 4.0.1, and Rhino 1.7R3-R4 allow trailing decimal
																// points. These environments, along with FF 3.1b1 and 2,
																// also allow trailing commas in JSON objects and arrays.
																parseSupported = parse("1.") !== 1;
															} catch (exception) {}
														}
													}
												}
											} catch (exception) {
												parseSupported = false;
											}
										}
										isSupported = parseSupported;
									}
								}
								return has[name] = !!isSupported;
							}

							if (!has("json")) {
								// Common `[[Class]]` name aliases.
								var functionClass = "[object Function]",
								    dateClass = "[object Date]",
								    numberClass = "[object Number]",
								    stringClass = "[object String]",
								    arrayClass = "[object Array]",
								    booleanClass = "[object Boolean]";

								// Detect incomplete support for accessing string characters by index.
								var charIndexBuggy = has("bug-string-char-index");

								// Define additional utility methods if the `Date` methods are buggy.
								if (!isExtended) {
									var floor = Math.floor;
									// A mapping between the months of the year and the number of days between
									// January 1st and the first of the respective month.
									var Months = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
									// Internal: Calculates the number of days between the Unix epoch and the
									// first day of the given month.
									var getDay = function getDay(year, month) {
										return Months[month] + 365 * (year - 1970) + floor((year - 1969 + (month = +(month > 1))) / 4) - floor((year - 1901 + month) / 100) + floor((year - 1601 + month) / 400);
									};
								}

								// Internal: Determines if a property is a direct property of the given
								// object. Delegates to the native `Object#hasOwnProperty` method.
								if (!(_isProperty = objectProto.hasOwnProperty)) {
									_isProperty = function isProperty(property) {
										var members = {},
										    constructor;
										if ((members.__proto__ = null, members.__proto__ = {
											// The *proto* property cannot be set multiple times in recent
											// versions of Firefox and SeaMonkey.
											"toString": 1
										}, members).toString != getClass) {
											// Safari <= 2.0.3 doesn't implement `Object#hasOwnProperty`, but
											// supports the mutable *proto* property.
											_isProperty = function isProperty(property) {
												// Capture and break the object's prototype chain (see section 8.6.2
												// of the ES 5.1 spec). The parenthesized expression prevents an
												// unsafe transformation by the Closure Compiler.
												var original = this.__proto__,
												    result = property in (this.__proto__ = null, this);
												// Restore the original prototype chain.
												this.__proto__ = original;
												return result;
											};
										} else {
											// Capture a reference to the top-level `Object` constructor.
											constructor = members.constructor;
											// Use the `constructor` property to simulate `Object#hasOwnProperty` in
											// other environments.
											_isProperty = function isProperty(property) {
												var parent = (this.constructor || constructor).prototype;
												return property in this && !(property in parent && this[property] === parent[property]);
											};
										}
										members = null;
										return _isProperty.call(this, property);
									};
								}

								// Internal: Normalizes the `for...in` iteration algorithm across
								// environments. Each enumerated key is yielded to a `callback` function.
								_forEach = function forEach(object, callback) {
									var size = 0,
									    Properties,
									    members,
									    property;

									// Tests for bugs in the current environment's `for...in` algorithm. The
									// `valueOf` property inherits the non-enumerable flag from
									// `Object.prototype` in older versions of IE, Netscape, and Mozilla.
									(Properties = function Properties() {
										this.valueOf = 0;
									}).prototype.valueOf = 0;

									// Iterate over a new instance of the `Properties` class.
									members = new Properties();
									for (property in members) {
										// Ignore all properties inherited from `Object.prototype`.
										if (_isProperty.call(members, property)) {
											size++;
										}
									}
									Properties = members = null;

									// Normalize the iteration algorithm.
									if (!size) {
										// A list of non-enumerable properties inherited from `Object.prototype`.
										members = ["valueOf", "toString", "toLocaleString", "propertyIsEnumerable", "isPrototypeOf", "hasOwnProperty", "constructor"];
										// IE <= 8, Mozilla 1.0, and Netscape 6.2 ignore shadowed non-enumerable
										// properties.
										_forEach = function forEach(object, callback) {
											var isFunction = getClass.call(object) == functionClass,
											    property,
											    length;
											var hasProperty = !isFunction && typeof object.constructor != "function" && objectTypes[_typeof(object.hasOwnProperty)] && object.hasOwnProperty || _isProperty;
											for (property in object) {
												// Gecko <= 1.0 enumerates the `prototype` property of functions under
												// certain conditions; IE does not.
												if (!(isFunction && property == "prototype") && hasProperty.call(object, property)) {
													callback(property);
												}
											}
											// Manually invoke the callback for each non-enumerable property.
											for (length = members.length; property = members[--length]; hasProperty.call(object, property) && callback(property)) {}
										};
									} else if (size == 2) {
										// Safari <= 2.0.4 enumerates shadowed properties twice.
										_forEach = function forEach(object, callback) {
											// Create a set of iterated properties.
											var members = {},
											    isFunction = getClass.call(object) == functionClass,
											    property;
											for (property in object) {
												// Store each property name to prevent double enumeration. The
												// `prototype` property of functions is not enumerated due to cross-
												// environment inconsistencies.
												if (!(isFunction && property == "prototype") && !_isProperty.call(members, property) && (members[property] = 1) && _isProperty.call(object, property)) {
													callback(property);
												}
											}
										};
									} else {
										// No bugs detected; use the standard `for...in` algorithm.
										_forEach = function forEach(object, callback) {
											var isFunction = getClass.call(object) == functionClass,
											    property,
											    isConstructor;
											for (property in object) {
												if (!(isFunction && property == "prototype") && _isProperty.call(object, property) && !(isConstructor = property === "constructor")) {
													callback(property);
												}
											}
											// Manually invoke the callback for the `constructor` property due to
											// cross-environment inconsistencies.
											if (isConstructor || _isProperty.call(object, property = "constructor")) {
												callback(property);
											}
										};
									}
									return _forEach(object, callback);
								};

								// Public: Serializes a JavaScript `value` as a JSON string. The optional
								// `filter` argument may specify either a function that alters how object and
								// array members are serialized, or an array of strings and numbers that
								// indicates which properties should be serialized. The optional `width`
								// argument may be either a string or number that specifies the indentation
								// level of the output.
								if (!has("json-stringify")) {
									// Internal: A map of control characters and their escaped equivalents.
									var Escapes = {
										92: "\\\\",
										34: '\\"',
										8: "\\b",
										12: "\\f",
										10: "\\n",
										13: "\\r",
										9: "\\t"
									};

									// Internal: Converts `value` into a zero-padded string such that its
									// length is at least equal to `width`. The `width` must be <= 6.
									var leadingZeroes = "000000";
									var toPaddedString = function toPaddedString(width, value) {
										// The `|| 0` expression is necessary to work around a bug in
										// Opera <= 7.54u2 where `0 == -0`, but `String(-0) !== "0"`.
										return (leadingZeroes + (value || 0)).slice(-width);
									};

									// Internal: Double-quotes a string `value`, replacing all ASCII control
									// characters (characters with code unit values between 0 and 31) with
									// their escaped equivalents. This is an implementation of the
									// `Quote(value)` operation defined in ES 5.1 section 15.12.3.
									var unicodePrefix = "\\u00";
									var quote = function quote(value) {
										var result = '"',
										    index = 0,
										    length = value.length,
										    useCharIndex = !charIndexBuggy || length > 10;
										var symbols = useCharIndex && (charIndexBuggy ? value.split("") : value);
										for (; index < length; index++) {
											var charCode = value.charCodeAt(index);
											// If the character is a control character, append its Unicode or
											// shorthand escape sequence; otherwise, append the character as-is.
											switch (charCode) {
												case 8:
												case 9:
												case 10:
												case 12:
												case 13:
												case 34:
												case 92:
													result += Escapes[charCode];
													break;
												default:
													if (charCode < 32) {
														result += unicodePrefix + toPaddedString(2, charCode.toString(16));
														break;
													}
													result += useCharIndex ? symbols[index] : value.charAt(index);
											}
										}
										return result + '"';
									};

									// Internal: Recursively serializes an object. Implements the
									// `Str(key, holder)`, `JO(value)`, and `JA(value)` operations.
									var serialize = function serialize(property, object, callback, properties, whitespace, indentation, stack) {
										var value, className, year, month, date, time, hours, minutes, seconds, milliseconds, results, element, index, length, prefix, result;
										try {
											// Necessary for host object support.
											value = object[property];
										} catch (exception) {}
										if ((typeof value === "undefined" ? "undefined" : _typeof(value)) == "object" && value) {
											className = getClass.call(value);
											if (className == dateClass && !_isProperty.call(value, "toJSON")) {
												if (value > -1 / 0 && value < 1 / 0) {
													// Dates are serialized according to the `Date#toJSON` method
													// specified in ES 5.1 section 15.9.5.44. See section 15.9.1.15
													// for the ISO 8601 date time string format.
													if (getDay) {
														// Manually compute the year, month, date, hours, minutes,
														// seconds, and milliseconds if the `getUTC*` methods are
														// buggy. Adapted from @Yaffle's `date-shim` project.
														date = floor(value / 864e5);
														for (year = floor(date / 365.2425) + 1970 - 1; getDay(year + 1, 0) <= date; year++) {}
														for (month = floor((date - getDay(year, 0)) / 30.42); getDay(year, month + 1) <= date; month++) {}
														date = 1 + date - getDay(year, month);
														// The `time` value specifies the time within the day (see ES
														// 5.1 section 15.9.1.2). The formula `(A % B + B) % B` is used
														// to compute `A modulo B`, as the `%` operator does not
														// correspond to the `modulo` operation for negative numbers.
														time = (value % 864e5 + 864e5) % 864e5;
														// The hours, minutes, seconds, and milliseconds are obtained by
														// decomposing the time within the day. See section 15.9.1.10.
														hours = floor(time / 36e5) % 24;
														minutes = floor(time / 6e4) % 60;
														seconds = floor(time / 1e3) % 60;
														milliseconds = time % 1e3;
													} else {
														year = value.getUTCFullYear();
														month = value.getUTCMonth();
														date = value.getUTCDate();
														hours = value.getUTCHours();
														minutes = value.getUTCMinutes();
														seconds = value.getUTCSeconds();
														milliseconds = value.getUTCMilliseconds();
													}
													// Serialize extended years correctly.
													value = (year <= 0 || year >= 1e4 ? (year < 0 ? "-" : "+") + toPaddedString(6, year < 0 ? -year : year) : toPaddedString(4, year)) + "-" + toPaddedString(2, month + 1) + "-" + toPaddedString(2, date) +
													// Months, dates, hours, minutes, and seconds should have two
													// digits; milliseconds should have three.
													"T" + toPaddedString(2, hours) + ":" + toPaddedString(2, minutes) + ":" + toPaddedString(2, seconds) +
													// Milliseconds are optional in ES 5.0, but required in 5.1.
													"." + toPaddedString(3, milliseconds) + "Z";
												} else {
													value = null;
												}
											} else if (typeof value.toJSON == "function" && (className != numberClass && className != stringClass && className != arrayClass || _isProperty.call(value, "toJSON"))) {
												// Prototype <= 1.6.1 adds non-standard `toJSON` methods to the
												// `Number`, `String`, `Date`, and `Array` prototypes. JSON 3
												// ignores all `toJSON` methods on these objects unless they are
												// defined directly on an instance.
												value = value.toJSON(property);
											}
										}
										if (callback) {
											// If a replacement function was provided, call it to obtain the value
											// for serialization.
											value = callback.call(object, property, value);
										}
										if (value === null) {
											return "null";
										}
										className = getClass.call(value);
										if (className == booleanClass) {
											// Booleans are represented literally.
											return "" + value;
										} else if (className == numberClass) {
											// JSON numbers must be finite. `Infinity` and `NaN` are serialized as
											// `"null"`.
											return value > -1 / 0 && value < 1 / 0 ? "" + value : "null";
										} else if (className == stringClass) {
											// Strings are double-quoted and escaped.
											return quote("" + value);
										}
										// Recursively serialize objects and arrays.
										if ((typeof value === "undefined" ? "undefined" : _typeof(value)) == "object") {
											// Check for cyclic structures. This is a linear search; performance
											// is inversely proportional to the number of unique nested objects.
											for (length = stack.length; length--;) {
												if (stack[length] === value) {
													// Cyclic structures cannot be serialized by `JSON.stringify`.
													throw TypeError();
												}
											}
											// Add the object to the stack of traversed objects.
											stack.push(value);
											results = [];
											// Save the current indentation level and indent one additional level.
											prefix = indentation;
											indentation += whitespace;
											if (className == arrayClass) {
												// Recursively serialize array elements.
												for (index = 0, length = value.length; index < length; index++) {
													element = serialize(index, value, callback, properties, whitespace, indentation, stack);
													results.push(element === undef ? "null" : element);
												}
												result = results.length ? whitespace ? "[\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "]" : "[" + results.join(",") + "]" : "[]";
											} else {
												// Recursively serialize object members. Members are selected from
												// either a user-specified list of property names, or the object
												// itself.
												_forEach(properties || value, function (property) {
													var element = serialize(property, value, callback, properties, whitespace, indentation, stack);
													if (element !== undef) {
														// According to ES 5.1 section 15.12.3: "If `gap` {whitespace}
														// is not the empty string, let `member` {quote(property) + ":"}
														// be the concatenation of `member` and the `space` character."
														// The "`space` character" refers to the literal space
														// character, not the `space` {width} argument provided to
														// `JSON.stringify`.
														results.push(quote(property) + ":" + (whitespace ? " " : "") + element);
													}
												});
												result = results.length ? whitespace ? "{\n" + indentation + results.join(",\n" + indentation) + "\n" + prefix + "}" : "{" + results.join(",") + "}" : "{}";
											}
											// Remove the object from the traversed object stack.
											stack.pop();
											return result;
										}
									};

									// Public: `JSON.stringify`. See ES 5.1 section 15.12.3.
									exports.stringify = function (source, filter, width) {
										var whitespace, callback, properties, className;
										if (objectTypes[typeof filter === "undefined" ? "undefined" : _typeof(filter)] && filter) {
											if ((className = getClass.call(filter)) == functionClass) {
												callback = filter;
											} else if (className == arrayClass) {
												// Convert the property names array into a makeshift set.
												properties = {};
												for (var index = 0, length = filter.length, value; index < length; value = filter[index++], (className = getClass.call(value), className == stringClass || className == numberClass) && (properties[value] = 1)) {}
											}
										}
										if (width) {
											if ((className = getClass.call(width)) == numberClass) {
												// Convert the `width` to an integer and create a string containing
												// `width` number of space characters.
												if ((width -= width % 1) > 0) {
													for (whitespace = "", width > 10 && (width = 10); whitespace.length < width; whitespace += " ") {}
												}
											} else if (className == stringClass) {
												whitespace = width.length <= 10 ? width : width.slice(0, 10);
											}
										}
										// Opera <= 7.54u2 discards the values associated with empty string keys
										// (`""`) only if they are used directly within an object member list
										// (e.g., `!("" in { "": 1})`).
										return serialize("", (value = {}, value[""] = source, value), callback, properties, whitespace, "", []);
									};
								}

								// Public: Parses a JSON source string.
								if (!has("json-parse")) {
									var fromCharCode = String.fromCharCode;

									// Internal: A map of escaped control characters and their unescaped
									// equivalents.
									var Unescapes = {
										92: "\\",
										34: '"',
										47: "/",
										98: "\b",
										116: "\t",
										110: "\n",
										102: "\f",
										114: "\r"
									};

									// Internal: Stores the parser state.
									var Index, Source;

									// Internal: Resets the parser state and throws a `SyntaxError`.
									var abort = function abort() {
										Index = Source = null;
										throw SyntaxError();
									};

									// Internal: Returns the next token, or `"$"` if the parser has reached
									// the end of the source string. A token may be a string, number, `null`
									// literal, or Boolean literal.
									var lex = function lex() {
										var source = Source,
										    length = source.length,
										    value,
										    begin,
										    position,
										    isSigned,
										    charCode;
										while (Index < length) {
											charCode = source.charCodeAt(Index);
											switch (charCode) {
												case 9:
												case 10:
												case 13:
												case 32:
													// Skip whitespace tokens, including tabs, carriage returns, line
													// feeds, and space characters.
													Index++;
													break;
												case 123:
												case 125:
												case 91:
												case 93:
												case 58:
												case 44:
													// Parse a punctuator token (`{`, `}`, `[`, `]`, `:`, or `,`) at
													// the current position.
													value = charIndexBuggy ? source.charAt(Index) : source[Index];
													Index++;
													return value;
												case 34:
													// `"` delimits a JSON string; advance to the next character and
													// begin parsing the string. String tokens are prefixed with the
													// sentinel `@` character to distinguish them from punctuators and
													// end-of-string tokens.
													for (value = "@", Index++; Index < length;) {
														charCode = source.charCodeAt(Index);
														if (charCode < 32) {
															// Unescaped ASCII control characters (those with a code unit
															// less than the space character) are not permitted.
															abort();
														} else if (charCode == 92) {
															// A reverse solidus (`\`) marks the beginning of an escaped
															// control character (including `"`, `\`, and `/`) or Unicode
															// escape sequence.
															charCode = source.charCodeAt(++Index);
															switch (charCode) {
																case 92:
																case 34:
																case 47:
																case 98:
																case 116:
																case 110:
																case 102:
																case 114:
																	// Revive escaped control characters.
																	value += Unescapes[charCode];
																	Index++;
																	break;
																case 117:
																	// `\u` marks the beginning of a Unicode escape sequence.
																	// Advance to the first character and validate the
																	// four-digit code point.
																	begin = ++Index;
																	for (position = Index + 4; Index < position; Index++) {
																		charCode = source.charCodeAt(Index);
																		// A valid sequence comprises four hexdigits (case-
																		// insensitive) that form a single hexadecimal value.
																		if (!(charCode >= 48 && charCode <= 57 || charCode >= 97 && charCode <= 102 || charCode >= 65 && charCode <= 70)) {
																			// Invalid Unicode escape sequence.
																			abort();
																		}
																	}
																	// Revive the escaped character.
																	value += fromCharCode("0x" + source.slice(begin, Index));
																	break;
																default:
																	// Invalid escape sequence.
																	abort();
															}
														} else {
															if (charCode == 34) {
																// An unescaped double-quote character marks the end of the
																// string.
																break;
															}
															charCode = source.charCodeAt(Index);
															begin = Index;
															// Optimize for the common case where a string is valid.
															while (charCode >= 32 && charCode != 92 && charCode != 34) {
																charCode = source.charCodeAt(++Index);
															}
															// Append the string as-is.
															value += source.slice(begin, Index);
														}
													}
													if (source.charCodeAt(Index) == 34) {
														// Advance to the next character and return the revived string.
														Index++;
														return value;
													}
													// Unterminated string.
													abort();
												default:
													// Parse numbers and literals.
													begin = Index;
													// Advance past the negative sign, if one is specified.
													if (charCode == 45) {
														isSigned = true;
														charCode = source.charCodeAt(++Index);
													}
													// Parse an integer or floating-point value.
													if (charCode >= 48 && charCode <= 57) {
														// Leading zeroes are interpreted as octal literals.
														if (charCode == 48 && (charCode = source.charCodeAt(Index + 1), charCode >= 48 && charCode <= 57)) {
															// Illegal octal literal.
															abort();
														}
														isSigned = false;
														// Parse the integer component.
														for (; Index < length && (charCode = source.charCodeAt(Index), charCode >= 48 && charCode <= 57); Index++) {}
														// Floats cannot contain a leading decimal point; however, this
														// case is already accounted for by the parser.
														if (source.charCodeAt(Index) == 46) {
															position = ++Index;
															// Parse the decimal component.
															for (; position < length && (charCode = source.charCodeAt(position), charCode >= 48 && charCode <= 57); position++) {}
															if (position == Index) {
																// Illegal trailing decimal.
																abort();
															}
															Index = position;
														}
														// Parse exponents. The `e` denoting the exponent is
														// case-insensitive.
														charCode = source.charCodeAt(Index);
														if (charCode == 101 || charCode == 69) {
															charCode = source.charCodeAt(++Index);
															// Skip past the sign following the exponent, if one is
															// specified.
															if (charCode == 43 || charCode == 45) {
																Index++;
															}
															// Parse the exponential component.
															for (position = Index; position < length && (charCode = source.charCodeAt(position), charCode >= 48 && charCode <= 57); position++) {}
															if (position == Index) {
																// Illegal empty exponent.
																abort();
															}
															Index = position;
														}
														// Coerce the parsed value to a JavaScript number.
														return +source.slice(begin, Index);
													}
													// A negative sign may only precede numbers.
													if (isSigned) {
														abort();
													}
													// `true`, `false`, and `null` literals.
													if (source.slice(Index, Index + 4) == "true") {
														Index += 4;
														return true;
													} else if (source.slice(Index, Index + 5) == "false") {
														Index += 5;
														return false;
													} else if (source.slice(Index, Index + 4) == "null") {
														Index += 4;
														return null;
													}
													// Unrecognized token.
													abort();
											}
										}
										// Return the sentinel `$` character if the parser has reached the end
										// of the source string.
										return "$";
									};

									// Internal: Parses a JSON `value` token.
									var get = function get(value) {
										var results, hasMembers;
										if (value == "$") {
											// Unexpected end of input.
											abort();
										}
										if (typeof value == "string") {
											if ((charIndexBuggy ? value.charAt(0) : value[0]) == "@") {
												// Remove the sentinel `@` character.
												return value.slice(1);
											}
											// Parse object and array literals.
											if (value == "[") {
												// Parses a JSON array, returning a new JavaScript array.
												results = [];
												for (;; hasMembers || (hasMembers = true)) {
													value = lex();
													// A closing square bracket marks the end of the array literal.
													if (value == "]") {
														break;
													}
													// If the array literal contains elements, the current token
													// should be a comma separating the previous element from the
													// next.
													if (hasMembers) {
														if (value == ",") {
															value = lex();
															if (value == "]") {
																// Unexpected trailing `,` in array literal.
																abort();
															}
														} else {
															// A `,` must separate each array element.
															abort();
														}
													}
													// Elisions and leading commas are not permitted.
													if (value == ",") {
														abort();
													}
													results.push(get(value));
												}
												return results;
											} else if (value == "{") {
												// Parses a JSON object, returning a new JavaScript object.
												results = {};
												for (;; hasMembers || (hasMembers = true)) {
													value = lex();
													// A closing curly brace marks the end of the object literal.
													if (value == "}") {
														break;
													}
													// If the object literal contains members, the current token
													// should be a comma separator.
													if (hasMembers) {
														if (value == ",") {
															value = lex();
															if (value == "}") {
																// Unexpected trailing `,` in object literal.
																abort();
															}
														} else {
															// A `,` must separate each object member.
															abort();
														}
													}
													// Leading commas are not permitted, object property names must be
													// double-quoted strings, and a `:` must separate each property
													// name and value.
													if (value == "," || typeof value != "string" || (charIndexBuggy ? value.charAt(0) : value[0]) != "@" || lex() != ":") {
														abort();
													}
													results[value.slice(1)] = get(lex());
												}
												return results;
											}
											// Unexpected token encountered.
											abort();
										}
										return value;
									};

									// Internal: Updates a traversed object member.
									var update = function update(source, property, callback) {
										var element = walk(source, property, callback);
										if (element === undef) {
											delete source[property];
										} else {
											source[property] = element;
										}
									};

									// Internal: Recursively traverses a parsed JSON object, invoking the
									// `callback` function for each value. This is an implementation of the
									// `Walk(holder, name)` operation defined in ES 5.1 section 15.12.2.
									var walk = function walk(source, property, callback) {
										var value = source[property],
										    length;
										if ((typeof value === "undefined" ? "undefined" : _typeof(value)) == "object" && value) {
											// `forEach` can't be used to traverse an array in Opera <= 8.54
											// because its `Object#hasOwnProperty` implementation returns `false`
											// for array indices (e.g., `![1, 2, 3].hasOwnProperty("0")`).
											if (getClass.call(value) == arrayClass) {
												for (length = value.length; length--;) {
													update(value, length, callback);
												}
											} else {
												_forEach(value, function (property) {
													update(value, property, callback);
												});
											}
										}
										return callback.call(source, property, value);
									};

									// Public: `JSON.parse`. See ES 5.1 section 15.12.2.
									exports.parse = function (source, callback) {
										var result, value;
										Index = 0;
										Source = "" + source;
										result = get(lex());
										// If a JSON string contains multiple tokens, it is invalid.
										if (lex() != "$") {
											abort();
										}
										// Reset the parser state.
										Index = Source = null;
										return callback && getClass.call(callback) == functionClass ? walk((value = {}, value[""] = result, value), "", callback) : result;
									};
								}
							}

							exports["runInContext"] = runInContext;
							return exports;
						}

						if (freeExports && !isLoader) {
							// Export for CommonJS environments.
							runInContext(root, freeExports);
						} else {
							// Export for web browsers and JavaScript engines.
							var nativeJSON = root.JSON,
							    previousJSON = root["JSON3"],
							    isRestored = false;

							var JSON3 = runInContext(root, root["JSON3"] = {
								// Public: Restores the original value of the global `JSON` object and
								// returns a reference to the `JSON3` object.
								"noConflict": function noConflict() {
									if (!isRestored) {
										isRestored = true;
										root.JSON = nativeJSON;
										root["JSON3"] = previousJSON;
										nativeJSON = previousJSON = null;
									}
									return JSON3;
								}
							});

							root.JSON = {
								"parse": JSON3.parse,
								"stringify": JSON3.stringify
							};
						}

						// Export for asynchronous module loaders.
						if (isLoader) {
							define(function () {
								return JSON3;
							});
						}
					}).call(this);
				}).call(this, typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
			}, {}],
			51: [function (_dereq_, module, exports) {
				module.exports = toArray;

				function toArray(list, index) {
					var array = [];

					index = index || 0;

					for (var i = index || 0; i < list.length; i++) {
						array[i - index] = list[i];
					}

					return array;
				}
			}, {}]
		}, {}, [31])(31);
	});
}

cc._RFpop();
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],"zjhSeat":[function(require,module,exports){
"use strict";
cc._RFpush(module, '020adKLAxlBQpYhX6DfXNDM', 'zjhSeat');
// scripts/zjh/zjhSeat.js

"use strict";

cc.Class({
    extends: cc.Component,
    properties: {
        _sprIcon: null,
        _zhuang: null,
        _ready: null,
        _offline: null,
        _lblName: null,
        _lblScore: null,
        _nddayingjia: null,
        _voicemsg: null,
        _chatBubble: null,
        _emoji: null,
        _lastChatTime: -1,
        _userName: "",
        _score: 0,
        _dayingjia: false,
        _isOffline: false,
        _isReady: false,
        _isZhuang: false,
        _userId: null,
        _isKanPai: false,
        _isQiPai: false,
        _isShu: false,
        _timeLabel: null,
        _time: -1
    },
    // use this for initialization
    onLoad: function onLoad() {
        if (cc.vv == null) {
            return;
        }
        this._sprIcon = this.node.getChildByName("head").getComponent("ImageLoader");
        this._lblName = this.node.getChildByName("name").getComponent(cc.Label);
        this._lblScore = this.node.getChildByName("money").getComponent(cc.Label);
        this._costMoney = this.node.getChildByName("zjh14").getChildByName("xiazhu").getComponent(cc.Label);
        this._kanicon = this.node.getChildByName("kanicon");
        this._shuicon = this.node.getChildByName("shuicon");
        this._qiicon = this.node.getChildByName("qiicon");
        this._kanpai = this.node.getChildByName("kanpai");
        this._saykanpai = this.node.getChildByName("saykanpai");
        this._genzhu = this.node.getChildByName("genzhu");
        this._jiazhu = this.node.getChildByName("jiazhu");
        this._fangqi = this.node.getChildByName("fangqi");
        this._pkButton = this.node.getChildByName("pk_button");
        this._chatBubble = this.node.getChildByName("ChatBubble");
        this._yanhua = this.node.getChildByName("yanhua");
        this._yanhuaAnim = this._yanhua.getComponent(cc.Animation);
        this._timeLabel = this.node.getChildByName("toggle").getChildByName("lblTime").getComponent(cc.Label);
        this._timeLabel.string = "00";
        cc.vv.utils.addClickEvent(this._pkButton, this.node, "zjhSeat", "onClickPkButton");
        // this._voicemsg = this.node.getChildByName("voicemsg");
        // if (this._voicemsg) {
        //     this._voicemsg.active = false;
        // }
        // if (this._sprIcon && this._sprIcon.getComponent(cc.Button)) {
        //     cc.vv.utils.addClickEvent(this._sprIcon, this.node, "Seat", "onIconClicked");
        // }
        // this._offline = this.node.getChildByName("offline");
        // this._ready = this.node.getChildByName("ready");
        this._zhuang = this.node.getChildByName("zhuang");
        // this._nddayingjia = this.node.getChildByName("dayingjia");
        this._emoji = this.node.getChildByName("emoji");
        this.refresh();
        if (this._sprIcon && this._userId) {
            this._sprIcon.setUserID(this._userId);
        }
    },
    onIconClicked: function onIconClicked() {
        var iconSprite = this._sprIcon.node.getComponent(cc.Sprite);
        if (this._userId != null && this._userId > 0) {
            var seat = cc.vv.gameNetMgr.getSeatByID(this._userId);
            var sex = 0;
            if (cc.vv.baseInfoMap) {
                var info = cc.vv.baseInfoMap[this._userId];
                if (info) {
                    sex = info.sex;
                }
            }
        }
    },
    refresh: function refresh() {
        if (this._lblName != null) {
            this._lblName.string = this._userName;
        }
        if (this._lblScore != null) {
            this._lblScore.string = this._score;
        }
        if (this._nddayingjia != null) {
            this._nddayingjia.active = this._dayingjia == true;
        }
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
        if (this._zhuang) {
            this._zhuang.active = this._isZhuang;
        }
        this.node.active = this._userName != null && this._userName != "";
        if (this._kanicon) {
            this._kanicon.active = this._isKanPai;
        }
        if (this._shuicon) {
            this._shuicon.active = this._isShu;
        }
        if (this._qiicon) {
            this._qiicon.active = this._isQiPai;
        }
        if (this._kanpai) {
            this._kanpai.active = false;
        }
        if (this._saykanpai) {
            this._saykanpai.active = false;
        }
        if (this._genzhu) {
            this._genzhu.active = false;
        }
        if (this._jiazhu) {
            this._jiazhu.active = false;
        }
        if (this._fangqi) {
            this._fangqi.active = false;
        }
        if (this._pkButton) {
            this._pkButton.active = false;
        }
        if (this._chatBubble) {
            this._chatBubble.active = false;
        }
        if (this._emoji) {
            this._emoji.active = false;
        }
        if (this._yanhua) {
            this._yanhua.active = false;
        }
    },
    setInfo: function setInfo(name, score) {
        this._userName = name;
        this._score = score;
        if (this._score == null) {
            this._score = 0;
        }
        if (this._lblScore != null) {
            this._lblScore.node.active = this._score != null;
        }
        this.refresh();
    },
    setZhuang: function setZhuang(value) {
        this._isZhuang = value;
        if (this._zhuang) {
            this._zhuang.active = value;
        } else {
            this._zhuang = this.node.getChildByName("zhuang");
            this._zhuang.active = value;
        }
    },
    setReady: function setReady(isReady) {
        this._isReady = isReady;
        if (this._ready) {
            this._ready.active = this._isReady && cc.vv.gameNetMgr.numOfGames > 0;
        }
    },
    setID: function setID(id) {
        var idNode = this.node.getChildByName("id");
        if (idNode) {
            var lbl = idNode.getComponent(cc.Label);
            lbl.string = "ID:" + id;
        }
        this._userId = id;
        if (this._sprIcon) {
            this._sprIcon.setUserID(id);
        }
    },
    getID: function getID() {
        return this._userId;
    },
    setOffline: function setOffline(isOffline) {
        this._isOffline = isOffline;
        if (this._offline) {
            this._offline.active = this._isOffline && this._userName != "";
        }
    },
    chat: function chat(content) {
        if (this._chatBubble == null) {
            return;
        }
        this._emoji.active = false;
        this._chatBubble.active = true;
        this._chatBubble.getComponent(cc.Label).string = content;
        this._chatBubble.getChildByName("New Label").getComponent(cc.Label).string = content;
        this._lastChatTime = 3;
    },
    emoji: function emoji(_emoji) {
        //emoji = JSON.parse(emoji);
        if (this._emoji == null) {
            return;
        }
        console.log(_emoji);
        this._chatBubble.active = false;
        this._emoji.active = true;
        this._emoji.getComponent(cc.Animation).play(_emoji);
        this._lastChatTime = 3;
    },
    voiceMsg: function voiceMsg(show) {
        if (this._voicemsg) {
            this._voicemsg.active = show;
        }
    },
    setMoney: function setMoney(data) {
        //设置该玩家所拥有的的钱
        this._lblScore.string = data;
        this._score = data;
    },
    setCostMoney: function setCostMoney(data) {
        //设置该玩家本局所压的注
        if (data) {
            this._costMoney.string = data;
        }
        if (!this.node.getChildByName("zjh14").active) this.node.getChildByName("zjh14").active = true;
    },
    showGenZhu: function showGenZhu() {
        var self = this;
        self._genzhu.active = true;
        setTimeout(function () {
            self._genzhu.active = false;
        }, 1000);
    },
    showKanPai: function showKanPai() {
        var self = this;
        self._kanicon.active = true;
        self._saykanpai.active = true;
        setTimeout(function () {
            self._saykanpai.active = false;
        }, 1000);
    },
    showJiaZhu: function showJiaZhu() {
        var self = this;
        self._jiazhu.active = true;
        setTimeout(function () {
            self._jiazhu.active = false;
        }, 1000);
    },
    showQiPai: function showQiPai(status) {
        var self = this;
        if (status == 'shu') {
            self._shuicon.active = true;
        } else {
            self._qiicon.active = true;
            self._fangqi.active = true;
            setTimeout(function () {
                if (self._fangqi) {
                    self._fangqi.active = false;
                }
            }, 1000);
        }
    },
    showPkButton: function showPkButton() {
        if (this._pkButton) {
            this._pkButton.active = true;
        }
    },
    hidePkButton: function hidePkButton() {
        if (this._pkButton) {
            this._pkButton.active = false;
        }
    },
    onClickPkButton: function onClickPkButton() {
        cc.vv.gameNetMgr.dispatchEvent('clickPkButton', this._userId);
    },
    showYanhua: function showYanhua() {
        if (this._yanhua) {
            this._yanhua.active = true;
            this._yanhuaAnim.play('yanhua');
        }
    },
    setTime: function setTime(o) {
        if (o) {
            this._time = 0;
        } else {
            this._time = 30;
        }
    },
    fanPai: function fanPai(spriteFrames) {
        var self = this;
        for (var i = 0; i < 3; i++) {
            var zhengpai = self._kanpai.getChildByName('zhengpai' + i);
            var paiObj = spriteFrames[i];
            var numRes = paiObj['num'];
            var huase_bigRes = paiObj['huase_big'];
            var huase_smallRes = paiObj['huase_small'];
            zhengpai.getChildByName('num').getComponent(cc.Sprite).spriteFrame = numRes;
            zhengpai.getChildByName('huase_big').getComponent(cc.Sprite).spriteFrame = huase_bigRes;
            zhengpai.getChildByName('huase_small').getComponent(cc.Sprite).spriteFrame = huase_smallRes;
            // zhengpai.getComponent(cc.Sprite).spriteFrame = spriteFrames[i];
        }
        self.hideFupai();
        self._kanpai.active = true;
    },
    hideFupai: function hideFupai() {
        var self = this;
        for (var i = 0; i < 3; i++) {
            var fupai = self.node.getChildByName('fupai' + i);
            fupai.active = false;
        }
    },
    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        if (this._lastChatTime > 0) {
            this._lastChatTime -= dt;
            if (this._lastChatTime < 0) {
                this._chatBubble.active = false;
                this._emoji.active = false;
                this._emoji.getComponent(cc.Animation).stop();
            }
        }
        if (this._time > 0) {
            this._time -= dt;
            var pre = "";
            if (this._time < 0) {
                this._time = 0;
            }
            var t = Math.ceil(this._time);
            if (t < 10) {
                pre = "0";
            }
            this._timeLabel.string = pre + t;
        }
    }
});

cc._RFpop();
},{}]},{},["socket-io","AnysdkMgr","AudioMgr","Collapse","CqNetMgr","DnNetMgr","DzpkNetMgr","GameNetMgr","Global","HTTP","JbsNetMgr","MahjongMgr","MatchNet","MjNetMgr","Net","ReplayMgr","UserMgr","Utils","VoiceMgr","ZjhNetMgr","Alert","Announcement","Charge","ChargeType","Chat","CheckBox","CreateRoom","DnChat","DzpkChat","Folds","GameOver","GameResult","Hall","History","ImageLoader","Jbs","JoinGameInput","Login","MJGame","MJRoom","Morra","MorraGame","NewHall","NoticeTip","OnBack","PengGangs","PopupMgr","RadioButton","RadioGroupMgr","ReConnect","ReplayCtrl","Seat","SelectDn","SelectDzpk","SelectMj","SelectZjh","Set","Settings","Share","TimePointer","UserSign","Voice","WaitingConnection","ZjhChat","dnAll","dnSeat","dzpkAll","dzpkSeat","all","zjhSeat"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvQWxlcnQuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0Fubm91bmNlbWVudC5qcyIsImFzc2V0cy9zY3JpcHRzL0FueXNka01nci5qcyIsImFzc2V0cy9zY3JpcHRzL0F1ZGlvTWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9DaGFyZ2VUeXBlLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9DaGFyZ2UuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0NoYXQuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0NoZWNrQm94LmpzIiwiYXNzZXRzL3NjcmlwdHMvQ29sbGFwc2UuanMiLCJhc3NldHMvc2NyaXB0cy9DcU5ldE1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvQ3JlYXRlUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvRG5DaGF0LmpzIiwiYXNzZXRzL3NjcmlwdHMvRG5OZXRNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0R6cGtDaGF0LmpzIiwiYXNzZXRzL3NjcmlwdHMvRHpwa05ldE1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvRm9sZHMuanMiLCJhc3NldHMvc2NyaXB0cy9HYW1lTmV0TWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9HYW1lT3Zlci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0dsb2JhbC5qcyIsImFzc2V0cy9zY3JpcHRzL0hUVFAuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0hhbGwuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0hpc3RvcnkuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0ltYWdlTG9hZGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvSmJzTmV0TWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9KYnMuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0pvaW5HYW1lSW5wdXQuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL0xvZ2luLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9NSkdhbWUuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL01KUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL01haGpvbmdNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9NYXRjaE5ldC5qcyIsImFzc2V0cy9zY3JpcHRzL01qTmV0TWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9Nb3JyYUdhbWUuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL01vcnJhLmpzIiwiYXNzZXRzL3NjcmlwdHMvTmV0LmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9OZXdIYWxsLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9Ob3RpY2VUaXAuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL09uQmFjay5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvUGVuZ0dhbmdzLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cE1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvUmFkaW9CdXR0b24uanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1JhZGlvR3JvdXBNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1JlQ29ubmVjdC5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvUmVwbGF5Q3RybC5qcyIsImFzc2V0cy9zY3JpcHRzL1JlcGxheU1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvU2VhdC5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvU2VsZWN0RG4uanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1NlbGVjdER6cGsuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1NlbGVjdE1qLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9TZWxlY3RaamguanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1NldHRpbmdzLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9TZXQuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1NoYXJlLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9UaW1lUG9pbnRlci5qcyIsImFzc2V0cy9zY3JpcHRzL1VzZXJNZ3IuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1VzZXJTaWduLmpzIiwiYXNzZXRzL3NjcmlwdHMvVXRpbHMuanMiLCJhc3NldHMvc2NyaXB0cy9Wb2ljZU1nci5qcyIsImFzc2V0cy9zY3JpcHRzL2NvbXBvbmVudHMvVm9pY2UuanMiLCJhc3NldHMvc2NyaXB0cy9jb21wb25lbnRzL1dhaXRpbmdDb25uZWN0aW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvY29tcG9uZW50cy9aamhDaGF0LmpzIiwiYXNzZXRzL3NjcmlwdHMvWmpoTmV0TWdyLmpzIiwiYXNzZXRzL3NjcmlwdHMvempoL2FsbC5qcyIsImFzc2V0cy9zY3JpcHRzL2RuL2RuQWxsLmpzIiwiYXNzZXRzL3NjcmlwdHMvZG4vZG5TZWF0LmpzIiwiYXNzZXRzL3NjcmlwdHMvZHpway9kenBrQWxsLmpzIiwiYXNzZXRzL3NjcmlwdHMvZHpway9kenBrU2VhdC5qcyIsImFzc2V0cy9zY3JpcHRzLzNyZHBhcnR5L3NvY2tldC1pby5qcyIsImFzc2V0cy9zY3JpcHRzL3pqaC96amhTZWF0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaEJRO0FBa0JaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBakVLOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBRkU7QUFJTjtBQUNJO0FBQ0E7QUFGRTtBQUlOO0FBQ0E7QUFWUTtBQVlaO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBMUVLOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhRO0FBYVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0g7QUFDRztBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUptQztBQU0xQztBQXRHSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUhRO0FBS1o7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjs7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFoRkk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJRO0FBc0JaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0o7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMTztBQU9YO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUEzSUk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJRO0FBc0JaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMTztBQU9YO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUE5SUk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmUTtBQWlCWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLL0I7QUFDSTtBQUNBO0FBQ0E7QUFIMkI7QUFLbEM7QUFDRDtBQUNJO0FBQ0E7QUFDSDs7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFuSEk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJRO0FBZVo7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFuQ0s7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRkU7QUFJTjtBQUNJO0FBQ0E7QUFGRTtBQWJFO0FBa0JaO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFGTztBQUlYO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDSDtBQUNEO0FBakhLOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBL0ZJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBT1o7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMTztBQU9YO0FBQ0k7QUFDQTtBQUNBO0FBSE87QUFLWDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQWpHSzs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZRO0FBaUJaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUtsQztBQUNEO0FBQ0k7QUFDQTtBQUNIOztBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQW5ISTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0c7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQWxKSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZRO0FBaUJaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUtsQztBQUNEO0FBQ0k7QUFDQTtBQUNIOztBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQW5ISTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRRO0FBV1o7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBbE5JOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWUTtBQVlaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRk07QUFJVjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQXpISTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaEJRO0FBa0JaO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKOztBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjs7QUFFRDtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQURRO0FBR1o7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBRjZCO0FBSXBDO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUZxQztBQUk1QztBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0c7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUY4QjtBQUlyQztBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFGTztBQUlYO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSks7QUFNVDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFuWEM7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBRO0FBU1o7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0c7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBL1VLOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhRO0FBYVo7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUF2Rkk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBLO0FBRlM7Ozs7Ozs7Ozs7QUNBdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0c7QUFDQTtBQUNIO0FBQ0c7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBL0NJO0FBRk87Ozs7Ozs7Ozs7QUNQcEI7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZRO0FBaUJaO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUZtQjtBQUkxQjtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBRm9CO0FBSTNCO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFGTztBQUlYO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFKTztBQU1YO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpPO0FBTVg7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBRG9DO0FBRzNDO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBdFFJOzs7Ozs7Ozs7OztBQ0ZUO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUZlO0FBSW5CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEJRO0FBc0JaO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBek1JOzs7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRztBQUNJO0FBRGlDO0FBR2pDO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFITztBQUtYO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0c7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBOUNJOzs7Ozs7Ozs7O0FDL0JUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0o7QUExREk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQVpSO0FBY0E7QUFDQTtBQUVIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFaUjtBQWVIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSlk7QUFNaEI7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUZlO0FBSW5CO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSlk7QUFNaEI7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIOztBQUVEO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFGZTtBQUluQjtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFUUjtBQVdBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7O0FBRUE7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDSDs7QUFFRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNIOztBQUVEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQURjO0FBR3JCO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFqU0k7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFGRTtBQUlOO0FBTFE7QUFnQlo7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpPO0FBTVg7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ1E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBMUhDOzs7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGUTtBQUlaO0FBQ0E7QUFWUTtBQVlaO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQURtQztBQUcxQztBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUFoT0k7Ozs7Ozs7Ozs7QUN2QlQ7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBRk07QUFJVjtBQUNJO0FBQ0E7QUFGUztBQUliO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6QlE7QUEyQlo7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRk87QUFJWDtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRztBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNHO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRztBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRztBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNHO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBbEJSO0FBb0JBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBQ0c7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUFpQztBQUM3QjtBQUNJO0FBQ0k7QUFDQTtBQUZNO0FBSVY7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGd0I7QUFJL0I7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0c7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0g7QUFDRztBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFGTztBQUlYO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBbnhDSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpRO0FBY1o7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFuTkk7Ozs7Ozs7Ozs7QUNBVDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDSTtBQUNBO0FBRlE7QUFJWjtBQUNJO0FBQ0E7QUFGUztBQUliO0FBQ0k7QUFDQTtBQUZhO0FBSWpCO0FBQ0k7QUFDQTtBQUZZO0FBSWhCO0FBQ0k7QUFDQTtBQUZZO0FBSWhCO0FBQ0k7QUFDQTtBQUZRO0FBSVo7QUFDSTtBQUNBO0FBRlE7QUFJWjtBQUNBO0FBQ0E7QUFuQ1E7QUFxQ1o7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQXlCO0FBQ3JCO0FBQ0g7QUFBZ0M7QUFDN0I7QUFDSDtBQUFpQztBQUM5QjtBQUNIO0FBQWlDO0FBQzlCO0FBQ0g7QUFBaUM7QUFDOUI7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBMUpJOzs7Ozs7Ozs7Ozs7QUNEVDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBSE87QUFLWDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpPO0FBTVg7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQTVISTtBQUZTOzs7Ozs7Ozs7O0FDSHRCO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0c7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0g7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFGOEI7QUFJckM7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFoVEk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCUTtBQThCWjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBc0M7QUFDbEM7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0c7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRztBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFBb0Q7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUF1RDtBQUNuRDtBQUNBO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFBOEI7QUFDMUI7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQTJCO0FBQ3ZCO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUEyQjtBQUN2QjtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNHO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBcGRJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUo7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUVKO0FBQ0k7QUFDQTtBQUNBO0FBSE87QUFLWDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSk87QUFNWDtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUEzTUk7Ozs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFITztBQUtYO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSk87QUFNWDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBNUhJO0FBRlM7Ozs7Ozs7Ozs7QUNIdEI7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQlE7QUFzQlo7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBRm1CO0FBSTFCO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFGb0I7QUFJM0I7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNEOzs7Ozs7Ozs7O0FBVUE7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFKTztBQU1YO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQXRCUjtBQXdCSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUhPO0FBS1g7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNHO0FBQ0g7QUFDSjtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQTdCUjtBQStCSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQURvQztBQUczQztBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSk87QUFNWDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSk87QUFNWDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUhPO0FBS1g7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUhZO0FBS2hCO0FBQ0k7QUFDSDtBQUNKO0FBOVhJOzs7Ozs7Ozs7O0FDRlQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFiUTtBQWVaO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBdENJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWUTtBQVlaO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBMUJLOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVFE7QUFXWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBak5JOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZlE7QUFpQlo7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQXZISTs7Ozs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBT1o7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUExQ0k7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQURRO0FBR1o7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBOUNJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFiUTtBQWVaO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBbERJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWlE7QUFjWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQTlDSTs7Ozs7Ozs7OztBQ0FUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWlE7QUFjWjtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBSEc7QUFLVjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFIa0I7QUFLdEI7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUE5R0s7Ozs7Ozs7Ozs7QUNQVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CUTtBQXFCWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSDs7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUE3S0k7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE5QlE7QUFnQ1o7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFITztBQUtYO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFKTztBQU1YO0FBQ0k7QUFDQTtBQUNBO0FBSE87QUFLWDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSDtBQXpJSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlCUTtBQWdDWjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUhPO0FBS1g7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpPO0FBTVg7QUFDSTtBQUNBO0FBQ0E7QUFITztBQUtYO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUE3SUk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpRO0FBTVo7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0o7QUFDSTtBQUNBO0FBaEJSO0FBa0JIO0FBQ0Q7QUFDSTtBQUNIO0FBbkRJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBOUJRO0FBZ0NaO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBSE87QUFLWDtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSk87QUFNWDtBQUNJO0FBQ0E7QUFDQTtBQUhPO0FBS1g7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSDtBQTdJSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFkUTtBQWdCWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBM0ZLOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTlE7QUFRWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBckRJOzs7Ozs7Ozs7O0FDQVQ7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGTTtBQUlWO0FBQ0k7QUFDQTtBQUZRO0FBSVo7QUFDQTtBQUNBO0FBakJRO0FBbUJaO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQXhHSTs7Ozs7Ozs7OztBQ0RUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMUTtBQWdCWjtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBekVJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBM0JRO0FBNkJaO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUQ2QjtBQUdwQztBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNJO0FBRGlDO0FBR2pDO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBRjZCO0FBSXBDO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNHO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNHO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBSE87QUFLWDtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBRk87QUFJWDtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBRk87QUFJWDtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBRk87QUFJWDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUhPO0FBS1g7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpPO0FBTVg7QUFDSDtBQTNRSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5RO0FBUVo7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ0s7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0g7QUFDSjtBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFyRkk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZRO0FBWVo7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUE3REk7Ozs7Ozs7Ozs7QUNBVDtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpRO0FBY1o7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQS9JSTs7Ozs7Ozs7OztBQ3JFVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsQlE7QUFvQlo7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBRndCO0FBSS9CO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUE5SEk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaUTtBQWNaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQTdDSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZRO0FBaUJaO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUsvQjtBQUNJO0FBQ0E7QUFDQTtBQUgyQjtBQUtsQztBQUNEO0FBQ0k7QUFDQTtBQUNIOztBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQW5ISTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNHO0FBQ0g7QUFDRDtBQUNIO0FBQ0c7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGNkI7QUFJcEM7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQTVOSTs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUZPO0FBSVg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGTTtBQUlWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJRO0FBOEJaO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFKTztBQU1YO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMTztBQU9YO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxPO0FBT1g7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUZtQjtBQUl2QjtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRnFCO0FBSTVCO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRm9CO0FBSTNCO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUhTO0FBS2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFJQTtBQUFBO0FBRUE7QUFBQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFGcUI7QUFJNUI7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFuaENJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBRk87QUFJWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUZNO0FBSVY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCUTtBQXlCWjtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpTO0FBTWI7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQTVzQkk7Ozs7Ozs7Ozs7QUNBVDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQXdCWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDs7Ozs7QUFLQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRztBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUE1a0JJOzs7Ozs7Ozs7O0FDQVQ7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGTTtBQUlWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4Q1E7QUEwQ1o7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUhPO0FBS1g7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0c7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNIO0FBQ0c7QUFDSDtBQUNHO0FBQ0g7QUFDRztBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0Q7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNHO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFGTTtBQUlWO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGTTtBQUlWO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGSTtBQUlSO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRkk7QUFJUjtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUZJO0FBSVI7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFGSTtBQUlSO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDRztBQUNIO0FBQ0o7QUE3MEJJOzs7Ozs7Ozs7Ozs7OztBQ0FUO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQko7QUF3QkE7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNHO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRztBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBOUJSO0FBZ0NBO0FBQ0k7QUFDQTtBQUNIO0FBQ0c7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDRztBQUNIO0FBQ0o7QUFDRDtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNKO0FBN1VJOzs7Ozs7Ozs7Ozs7O0FDQVQ7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNDO0FBRGM7QUFHZjtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNEO0FBQ0E7QUFBbUM7QUFBbkM7QUFFQTtBQUNBOztBQUVDO0FBRUE7QUFDQTtBQURFO0FBR0g7O0FBRUM7O0FBRUE7Ozs7OztBQU1BO0FBRUE7QUFDQTtBQUNBO0FBRkU7QUFJSDtBQUNDO0FBQ0M7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7OztBQU1BOztBQUVBOzs7Ozs7OztBQVFBO0FBQ0M7O0FBRUE7O0FBRUE7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVEOztBQUdBO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNEOztBQUVEO0FBQ0E7O0FBRUQ7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7Ozs7O0FBTUE7O0FBRUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCb0M7O0FBMEJyQztBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7QUFDQTs7QUFFRDs7Ozs7QUFLQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7QUFFRTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0Y7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDRTtBQUR5QztBQUEzQztBQUFBOztBQU1BOztBQUVBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDRDs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUZlO0FBSWhCO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0M7QUFEZTtBQUdoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDs7QUFFRDtBQUNDOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUQ7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFFQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNDOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQW5CRjtBQXFCQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDs7QUFFRDs7Ozs7O0FBTUE7QUFDQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFFQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7Ozs7Ozs7O0FBVUE7QUFFRTtBQUNBO0FBQ0E7O0FBRUY7Ozs7Ozs7Ozs7QUFVQTtBQUNDO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0M7QUFDQTs7QUFFRDtBQUNBOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBSFk7QUFLYjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0M7O0FBRUE7O0FBRUE7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFFRDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEU7QUFXSDtBQUNDOzs7O0FBSUE7QUFDQTs7QUFFQTs7OztBQUlBOztBQUVBOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVEOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDs7OztBQUlBO0FBQ0M7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7QUFFRDtBQUNBO0FBQ0E7QUFGRTtBQUlIO0FBQ0M7QUFDQzs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBSUE7QUFDQTs7QUFFQTs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQztBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFFRDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKRTtBQU1IO0FBQ0M7O0FBRUM7Ozs7QUFJQTtBQUNBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTtBQUNBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7OztBQUlBOztBQUVBOzs7Ozs7O0FBT0E7QUFDQzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDs7QUFFRDs7OztBQUlBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7O0FBRUE7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBO0FBQ0M7QUFDQTs7QUFFRDtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFQTs7QUFFQTtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7O0FBRUE7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUQ7O0FBRUE7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDRDtBQUVEO0FBQ0Q7QUFDQTtBQUNBO0FBRkU7QUFJSDtBQUNDO0FBQ0M7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBSUE7QUFDQTs7QUFFQTs7OztBQUlBOztBQUVBOzs7Ozs7O0FBT0E7QUFDQzs7QUFFQTtBQUNDO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBSHNCO0FBS3ZCO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVEOzs7O0FBSUE7O0FBRUE7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUpVOztBQU9YO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7QUFDRDtBQUNEO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEOztBQUVEO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7O0FBRUQ7QUFDQztBQUNBOztBQUVEO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTs7QUFFRDtBQUNBO0FBQ0Q7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0M7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNEO0FBRUQ7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMRTtBQU9IO0FBQ0M7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7OztBQUlBO0FBQ0M7QUFDQTtBQUNDO0FBRDRCO0FBRzdCO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQTs7QUFFRDs7OztBQUlBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNDOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNBOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDOztBQUVBO0FBQ0M7QUFDQTtBQUNDO0FBRFc7QUFHWjs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDs7Ozs7Ozs7QUFRQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0M7QUFDQTtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7O0FBRUQ7O0FBRUE7QUFDQTtBQUVDO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBO0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBFO0FBU0g7QUFDQztBQUNDOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7OztBQU1BO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDRDs7QUFFRDs7OztBQUlBOztBQUVBOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTs7QUFFRDs7OztBQUlBOztBQUVBOzs7Ozs7QUFNQTs7QUFFQTs7OztBQUlBOztBQUVBOzs7Ozs7QUFNQTtBQUNDO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUZVOztBQUtYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7O0FBRUE7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDOztBQUVBO0FBQ0M7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEOztBQUVEOzs7Ozs7O0FBT0E7QUFFQztBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0M7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNEO0FBQ0Q7O0FBRUQ7QUFDQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQztBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBOztBQUVEOztBQUVBO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUVEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBFO0FBU0g7QUFDQztBQUNBOztBQUVBO0FBQ0M7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7QUFFRDtBQUNBO0FBREU7QUFHSDtBQUNDOztBQUVBO0FBQ0M7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDs7QUFFRDtBQUVBO0FBQ0Q7QUFDQzs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNBOztBQUVBO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDRDtBQUNDO0FBQ0E7QUFDRDtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBRUQ7QUFDRDtBQUNDOzs7Ozs7O0FBT0E7QUFDQzs7QUFFQTtBQUNDO0FBQUE7QUFBQTtBQUFBOztBQUlBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0E7O0FBRUQ7QUFDQztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUtBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUFBOztBQUdBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNEO0FBRUQ7QUFDRDtBQUNDO0FBQ0M7Ozs7QUFJQTs7QUFLQTs7OztBQUlBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7O0FBS0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDs7OztBQUlBOztBQUlBOzs7Ozs7QUFNQTtBQUNDO0FBQ0M7QUFDQTtBQUNDOztBQUVBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDRDtBQUNEOztBQUVEO0FBQ0M7O0FBRUE7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFFRDtBQUNEO0FBQ0Q7O0FBRUM7Ozs7QUFJQTs7QUFFQTs7Ozs7O0FBTUE7QUFDQztBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDQTs7QUFFRDs7Ozs7Ozs7O0FBU0E7QUFFRTtBQUNBO0FBRUE7QUFDQTs7QUFFRjs7Ozs7Ozs7OztBQVVBO0FBQ0M7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7Ozs7OztBQVVBO0FBSUU7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNBOztBQUVGOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUFBOztBQUdBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUVEO0FBQ0Q7O0FBRUM7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDs7QUFFQzs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBS0E7Ozs7QUFJQTs7QUFTQTs7Ozs7Ozs7QUFRQTtBQUNDO0FBQ0E7QUFDQztBQUNDO0FBQ0Q7QUFDQTtBQUNDO0FBQ0Y7O0FBRUQ7Ozs7QUFJQTtBQUNDO0FBQ0E7O0FBR0Q7Ozs7OztBQU1BO0FBQ0M7QUFDQTs7QUFFQTs7QUFPQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0E7QUFHQTs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBOztBQUVEOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7Ozs7O0FBV0E7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUVEO0FBQ0E7QUFERTtBQUdIOztBQUVDOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBSUE7QUFDQTs7QUFFQTs7Ozs7O0FBTUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7OztBQUlBOztBQUVBOzs7Ozs7O0FBT0E7QUFDQztBQUNBOztBQUVEOzs7Ozs7OztBQVFBOztBQUVDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFRDs7Ozs7Ozs7QUFRQTtBQUNDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTs7QUFFRDs7Ozs7Ozs7QUFRQTtBQUNDO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNEO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUNBO0FBRUQ7QUFDQTtBQURFO0FBR0g7QUFDQztBQUNDOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7O0FBT0E7O0FBRUE7Ozs7OztBQU1BOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7OztBQUlBO0FBQ0M7O0FBRCtCOztBQUFBO0FBTS9CO0FBQ0E7QUFDQTtBQUNBO0FBVCtCOztBQVloQzs7QUFFQTs7OztBQUlBO0FBQ0M7QUFDQTtBQUZTOztBQUtWOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7QUFDQztBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTs7QUFFRDs7QUFJQTtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFFQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEOzs7O0FBSUE7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0Q7QUFDQTtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0M7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7O0FBRUE7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQztBQUNBO0FBRk07QUFJUDtBQUNBO0FBQ0M7QUFETTtBQUdQO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQztBQUNBO0FBRk07QUFJUDs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFGSztBQUZBO0FBT1A7O0FBRUQ7O0FBRUE7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUZNO0FBSVA7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUFnQkE7QUFDQztBQUNDO0FBQ0E7QUFDQTs7QUFFRDs7QUFFQTtBQUNDO0FBQ0M7QUFDQTs7QUFFRDtBQUNBOztBQUVEO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0E7QUFDRDs7QUFFRDs7OztBQUlBO0FBQ0M7QUFDQTs7QUFFQTtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQztBQUNBO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUFBO0FBQUE7O0FBR0E7QUFDQzs7QUFFQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNDOztBQUVBO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0M7QUFDQTtBQUNBO0FBRUQ7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7O0FBY0E7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTs7QUFFRDs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBOztBQUVEO0FBQWdCO0FBQ2Y7QUFDQTtBQUFRO0FBQ1I7QUFDQTs7QUFFRDtBQUNBO0FBQ0M7QUFDQTtBQUNEOztBQUVBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNEOztBQUVEOzs7O0FBSUE7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7O0FBRUQ7O0FBSUE7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDRDs7QUFFRDtBQUNDO0FBQ0E7QUFDRDs7QUFFRDs7Ozs7Ozs7O0FBU0E7QUFDQztBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7O0FBRUE7QUFDQzs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFFRDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQRTtBQVNIOztBQUVDOzs7Ozs7O0FBT0E7QUFDQztBQUNBOztBQUVBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBRUQ7QUFDRDtBQUNDOztBQUVDOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7Ozs7Ozs7O0FBU0E7O0FBRUM7QUFDQzs7QUFFQTtBQUtDO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNEOztBQUVEO0FBQ0E7O0FBRUQ7QUFDQTtBQUVEO0FBQ0Q7QUFDQTtBQURFO0FBR0g7O0FBRUM7Ozs7Ozs7O0FBUUE7QUFDQztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFRDtBQUNEOztBQUVDOztBQUVBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0Q7QUFDRDtBQUNDO0FBQ0M7QUFDQTtBQUVEO0FBQ0Q7QUFDQzs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7QUFhQTtBQUNDO0FBQ0E7QUFDQTtBQUdBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDRDtBQUNBO0FBQ0E7QUFDQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQWxDRjtBQW9DQTs7QUFFRDs7Ozs7Ozs7QUFRQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7Ozs7QUFRQTtBQUNDO0FBS0E7O0FBRUQ7Ozs7QUFJQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBRUQ7QUFDRDtBQUNDO0FBQ0M7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQztBQUNDO0FBQ0E7O0FBRUQ7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFHQztBQUNBO0FBQ0Q7QUFDRDtBQUNEO0FBQ0Q7QUFDQzs7Ozs7Ozs7QUFRQTtBQUNDOztBQUVBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDRDs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBRUQ7QUFDRDtBQUNDOzs7Ozs7O0FBT0E7O0FBRUE7O0FBSUE7QUFDQztBQUFBO0FBQUE7O0FBSUE7QUFDQztBQUNBOztBQUVEO0FBQUE7QUFBQTs7QUFJQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFFRDtBQUNEO0FBQ0M7QUFDQztBQUNBO0FBQ0M7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTs7QUFFRDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUFrQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTs7QUFFRDtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBOztBQUVEO0FBQ0M7QUFDQztBQUlBO0FBQ0Q7QUFDRDs7QUFFQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUFxQztBQUNwQztBQUNBO0FBQ0Q7QUFDQTtBQUFxQztBQUNwQztBQUNBO0FBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDQTs7QUFFRDs7QUFFQTtBQUNDO0FBQ0M7QUFDQTs7QUFFRDtBQUNBOztBQUVBO0FBQ0M7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNBOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBOztBQUVEOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBSFU7O0FBTVg7QUFDQTtBQUNBO0FBS0M7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUFrQjtBQUNqQjtBQUNBO0FBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUFRO0FBQ1I7QUFDQTtBQUVEO0FBRUQ7QUFDRDtBQUNEO0FBQ0M7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQU9BOzs7Ozs7O0FBT0E7QUFDQzs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQzs7QUFFQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFBd0I7QUFBeEI7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDRDs7QUFFQzs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7Ozs7Ozs7Ozs7OztBQWFBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNBOztBQUVEO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BOztBQUVBOzs7Ozs7O0FBT0E7O0FBRUE7Ozs7OztBQU1BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMRTtBQU9IOztBQUVDOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7QUFJQTs7QUFFQTs7Ozs7Ozs7QUFRQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUgwQjtBQUszQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNEOztBQUVEOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7Ozs7QUFRQTtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEOztBQUdEOzs7Ozs7OztBQVFBO0FBRUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0M7QUFDQTtBQUhhO0FBS2Y7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBOztBQUVGOzs7Ozs7QUFNQTtBQUNDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0M7QUFDQTtBQUNEOztBQUVEO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7O0FBRUE7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDRDtBQUFRO0FBQ1I7QUFDQTtBQUNEOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDOztBQUVBO0FBQ0E7QUFBZ0M7QUFBaEM7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBRUU7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVGOzs7Ozs7QUFNQTtBQUNDOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0M7QUFDQTtBQUNEOztBQUVEOzs7Ozs7QUFNQTtBQUNDOztBQUVBOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDs7QUFFRDtBQUNDO0FBQ0M7QUFDQTtBQUhhO0FBS2Y7QUFDRDs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRFO0FBV0g7O0FBRUM7Ozs7QUFJQTs7QUFFQTs7Ozs7Ozs7O0FBU0E7QUFDQztBQUNBO0FBQ0M7QUFDQztBQUNBO0FBSEs7QUFLUDtBQUVEO0FBQ0Q7O0FBRUM7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7OztBQUlBOztBQUVBOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJZOztBQWdCYjs7OztBQUlBOztBQUVBOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7QUFJQTs7QUFFQTs7Ozs7O0FBTUE7QUFDQzs7QUFFQTtBQUNBO0FBS0E7O0FBRUQ7Ozs7OztBQU1BO0FBRUU7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVGOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVEOzs7Ozs7Ozs7QUFTQTtBQUNDO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNDO0FBQ0E7QUFGWTs7QUFLYjtBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEOztBQUVBO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQzs7QUFFQTtBQUNBO0FBQ0M7QUFDQztBQURXO0FBR1o7QUFDRDs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFDQzs7QUFFQTtBQUNDO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNBOztBQUVEO0FBQ0M7QUFDQTtBQTNCRjtBQTZCQTs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBSFc7QUFLWjtBQUNEOztBQUVEOzs7Ozs7O0FBT0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNEOztBQUVBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQTs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7O0FBT0E7QUFFRTtBQUNDO0FBQ0E7QUFDQztBQURXO0FBR1o7O0FBRUQ7QUFDQTs7QUFFQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUY7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQRTtBQVNIO0FBQ0M7O0FBRUM7Ozs7QUFJQTtBQUNBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7OztBQVNBO0FBQ0M7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDs7QUFFRDtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUQ7QUFDRDtBQUNBO0FBQ0E7QUFGRTtBQUlIOztBQUVDOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7Ozs7OztBQVlBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7Ozs7Ozs7QUFPQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBOztBQUVEOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7O0FBRUQ7Ozs7OztBQU1BO0FBQ0M7QUFDQTtBQUdEO0FBQ0Q7QUFDQzs7OztBQUlBOztBQUVBOzs7Ozs7Ozs7QUFTQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBRUQ7QUFDRDs7QUFFQzs7OztBQUlBOztBQUVBOzs7Ozs7QUFNQTtBQUNDO0FBQ0E7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNBOztBQUVEOzs7Ozs7Ozs7QUFTQTtBQUVFO0FBQ0E7QUFFQTtBQUNBOztBQUVGOzs7Ozs7Ozs7O0FBVUE7QUFDQztBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7Ozs7OztBQVVBO0FBSUU7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNBOztBQUVGOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUFBOztBQUdBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUNBOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUVEO0FBQ0Q7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUZFO0FBSUg7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUZFO0FBSUg7QUFDQzs7QUFFQzs7OztBQUlBOztBQUVBOzs7O0FBSUE7O0FBRUE7Ozs7Ozs7OztBQVNBOztBQUVDO0FBQ0M7O0FBRUE7QUFLQztBQUNBOztBQUVEO0FBQ0M7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNEOztBQUVEO0FBQ0E7O0FBRUQ7QUFDQTtBQUVEO0FBQ0Q7QUFDQTtBQURFO0FBR0g7QUFDQztBQUNBO0FBQ0E7QUFERTtBQUdIO0FBQ0M7QUFDQTtBQUNBO0FBREU7QUFHSDtBQUNDO0FBQ0E7QUFDQTtBQURFO0FBR0g7QUFDQztBQUNBO0FBQ0E7QUFERTtBQUdIO0FBQ0M7QUFDQzs7QUFFQTs7OztBQUlBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7QUFVQTtBQUNDO0FBQ0E7O0FBRUE7QUFDQzs7QUFFQTtBQUNDO0FBQ0M7QUFDQTtBQUZpQjtBQUlsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUZNO0FBSVA7O0FBRUQ7Ozs7Ozs7OztBQVNBO0FBQ0M7O0FBRUE7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0Q7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7Ozs7OztBQVVBO0FBQ0M7QUFDQzs7QUFFQTtBQUNBO0FBRUM7O0FBRUE7QUFDQTtBQUNBO0FBQWtDO0FBQ2pDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDRDs7QUFFRDtBQUNBO0FBQTBCO0FBQzFCO0FBQ0M7QUFDQTtBQUNEO0FBQTBEO0FBQzFEO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFFRDtBQUNEO0FBQ0E7QUFDQTtBQUZFO0FBSUg7O0FBRUM7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7OztBQU1BOztBQUVBOzs7Ozs7QUFNQTs7QUFVQTs7Ozs7O0FBTUE7O0FBRUE7Ozs7OztBQU1BOztBQUVBOzs7Ozs7QUFNQTs7QUFFQTs7Ozs7O0FBTUE7O0FBRUE7Ozs7OztBQU1BOztBQUVBOzs7Ozs7QUFNQTs7QUFFQTs7Ozs7O0FBTUE7O0FBRUE7Ozs7OztBQU1BOztBQUVBOzs7Ozs7QUFNQTs7QUFFQTs7Ozs7O0FBTUE7O0FBRUE7Ozs7Ozs7Ozs7QUFVQTtBQUNDOztBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFRDtBQUNBO0FBQ0E7O0FBRUQ7Ozs7Ozs7Ozs7QUFVQTs7QUFFQztBQUNDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTs7QUFFRDs7Ozs7OztBQU9BO0FBQ0M7QUFDQTs7QUFFRDs7OztBQUlBOztBQUVBOzs7Ozs7OztBQVFBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFBZ0Y7QUFDL0U7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUFRO0FBQ1I7QUFDQTtBQUNEO0FBQXNDO0FBQ3RDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFBYztBQUNiO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7Ozs7Ozs7O0FBUUE7QUFDQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7QUFDQTs7QUFFRDtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNDO0FBQ0E7QUFDRDs7QUFFRDs7Ozs7Ozs7OztBQVVBO0FBQ0M7QUFDQTtBQUNBOztBQUVEOzs7Ozs7Ozs7O0FBVUE7QUFDQztBQUNBO0FBQXlEO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTs7QUFFRDs7Ozs7O0FBTUE7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQztBQUNDO0FBQ0E7QUFGTTtBQUlQO0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFORTtBQVFIO0FBQ0M7O0FBRUM7O0FBRUE7Ozs7OztBQU1BO0FBQ0M7QUFFQTtBQUVEO0FBQ0Q7QUFDRDtBQUNDO0FBQ0E7QUFDQTtBQURFO0FBR0g7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUZpQjs7QUFLbEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7O0FBR0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQVNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0M7QUFBQTtBQUVBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFEUztBQUdWO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNEO0FBQ0Q7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQU9BO0FBQ0E7O0FBRUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0M7QUFBQTtBQUVBO0FBQ0U7QUFDQTtBQUNBO0FBSGlEO0FBS2xEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0M7QUFBQTtBQUFBO0FBQUE7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQUE7QUFBQTtBQUdBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNDO0FBQUE7QUFBQTtBQUVBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNEO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQYTs7QUFVZDtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBZkY7QUFpQkE7QUFDRDtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNDO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQztBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNDOztBQUVBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSZTs7QUFXaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0M7QUFDQTtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0Q7QUFDQztBQUNBO0FBaENGO0FBa0NBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNEO0FBQ0Q7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBaEtGO0FBa0tBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDRDtBQUNDO0FBQ0M7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNDO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0Q7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7O0FBRUQ7QUFDQTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFBQTtBQUVBO0FBQ0M7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0Q7QUFDRDtBQUNBOztBQUVEO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDRDtBQUNEOztBQUVEO0FBQ0E7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBOztBQUlBO0FBQ0M7QUFDQTtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Q7QUFDQTtBQVg4Qzs7QUFjaEQ7QUFDQztBQUNBO0FBRlc7QUFJWjs7QUFFRDtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUVEO0FBQ0Q7QUFDRDtBQUNDOztBQUVBO0FBQ0M7O0FBRUE7O0FBRUE7QUFDQztBQUNBOztBQUVEO0FBQ0E7QUFFRDtBQTkxT0M7QUFnMk9IO0FBQ0Q7Ozs7Ozs7Ozs7OztBQzc0T0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCUTtBQXlCWjtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0Q7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNHO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDRztBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDRDtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSDtBQUNEO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDRDtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7QUF6VUkiLCJzb3VyY2VzQ29udGVudCI6WyJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBfYWxlcnQ6IG51bGwsXHJcbiAgICAgICAgX2J0bk9LOiBudWxsLFxyXG4gICAgICAgIF9idG5DYW5jZWw6IG51bGwsXHJcbiAgICAgICAgX3RpdGxlOiBudWxsLFxyXG4gICAgICAgIF9jb250ZW50OiBudWxsLFxyXG4gICAgICAgIF9vbm9rOiBudWxsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2FsZXJ0ID0gY2MuZmluZChcIkNhbnZhcy9hbGVydFwiKTtcclxuICAgICAgICB0aGlzLl90aXRsZSA9IGNjLmZpbmQoXCJDYW52YXMvYWxlcnQvdGl0bGVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl9jb250ZW50ID0gY2MuZmluZChcIkNhbnZhcy9hbGVydC9jb250ZW50XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fYnRuT0sgPSBjYy5maW5kKFwiQ2FudmFzL2FsZXJ0L2J0bl9va1wiKTtcclxuICAgICAgICB0aGlzLl9idG5DYW5jZWwgPSBjYy5maW5kKFwiQ2FudmFzL2FsZXJ0L2J0bl9jYW5jZWxcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9idG5PSywgdGhpcy5ub2RlLCBcIkFsZXJ0XCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fYnRuQ2FuY2VsLCB0aGlzLm5vZGUsIFwiQWxlcnRcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgdGhpcy5fYWxlcnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgY2MudnYuYWxlcnQgPSB0aGlzO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5fb2tcIikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fb25vaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb25vaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2FsZXJ0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX29ub2sgPSBudWxsO1xyXG4gICAgfSxcclxuICAgIHNob3c6IGZ1bmN0aW9uKHRpdGxlLCBjb250ZW50LCBvbm9rLCBuZWVkY2FuY2VsKSB7XHJcbiAgICAgICAgdGhpcy5fYWxlcnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9vbm9rID0gb25vaztcclxuICAgICAgICB0aGlzLl90aXRsZS5zdHJpbmcgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLl9jb250ZW50LnN0cmluZyA9IGNvbnRlbnQ7XHJcbiAgICAgICAgaWYgKG5lZWRjYW5jZWwpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnRuQ2FuY2VsLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0bk9LLnggPSAtMTUwO1xyXG4gICAgICAgICAgICB0aGlzLl9idG5DYW5jZWwueCA9IDE1MDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idG5DYW5jZWwuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0bk9LLnggPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkRlc3Rvcnk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52dikge1xyXG4gICAgICAgICAgICBjYy52di5hbGVydCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcbiAgICAvLyB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgaW1hMToge1xyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW1hMjoge1xyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbENvbnRlbnQ6IGNjLk5vZGUsXHJcbiAgICAgICAgckNvbnRlbnQ6IGNjLk5vZGUsXHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHt9LFxyXG4gICAgb25CdG5Td2l0Y2g6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxDb250ZW50LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChpID09IGV2ZW50LnRhcmdldC5nZXRTaWJsaW5nSW5kZXgoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sQ29udGVudC5jaGlsZHJlbltpXS5nZXRDb21wb25lbnQoXCJjYy5TcHJpdGVcIikuc3ByaXRlRnJhbWUgPSB0aGlzLmltYTE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJDb250ZW50LmNoaWxkcmVuW2ldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxDb250ZW50LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcImNjLlNwcml0ZVwiKS5zcHJpdGVGcmFtZSA9IHRoaXMuaW1hMjtcclxuICAgICAgICAgICAgICAgIHRoaXMuckNvbnRlbnQuY2hpbGRyZW5baV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcmVmcmVzaEFubm91bmNlbWVudDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxDb250ZW50LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5sQ29udGVudC5jaGlsZHJlbltpXSwgdGhpcy5ub2RlLCBcIkFubm91bmNlbWVudFwiLCBcIm9uQnRuU3dpdGNoXCIpO1xyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG4gICAgZ2V0QW5ub3VuY2VtZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLmsqHmnInlhazlkYpcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgeSA9IHNlbGYubENvbnRlbnQuY2hpbGRyZW5bMF0ueTtcclxuICAgICAgICAgICAgICAgIHZhciBoID0gc2VsZi5sQ29udGVudC5jaGlsZHJlblswXS5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZTEgPSBzZWxmLmxDb250ZW50LmNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUyID0gc2VsZi5yQ29udGVudC5jaGlsZHJlblswXTtcclxuICAgICAgICAgICAgICAgIHNlbGYubENvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuckNvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiByZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbjEgPSBjYy5pbnN0YW50aWF0ZShub2RlMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4yID0gY2MuaW5zdGFudGlhdGUobm9kZTIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4xLmdldENoaWxkQnlOYW1lKCdsYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gcmV0W2tleV0udGl0bGU7XHJcbiAgICAgICAgICAgICAgICAgICAgbjIuZ2V0Q2hpbGRCeU5hbWUoJ25vdGljZV90aXRsZTInKS5nZXRDaGlsZEJ5TmFtZSgnbGFiZWwnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHJldFtrZXldLnRpdGxlO1xyXG4gICAgICAgICAgICAgICAgICAgIG4yLmdldENoaWxkQnlOYW1lKCdyaWNodGV4dCcpLmdldENvbXBvbmVudChjYy5SaWNoVGV4dCkuc3RyaW5nID0gcmV0W2tleV0uY29udGVudDtcclxuICAgICAgICAgICAgICAgICAgICBuMS55ID0geSAtIGkgKiAoMjAgKyBoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4yLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuMS5nZXRDb21wb25lbnQoXCJjYy5TcHJpdGVcIikuc3ByaXRlRnJhbWUgPSBzZWxmLmltYTI7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4yLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4xLmdldENvbXBvbmVudChcImNjLlNwcml0ZVwiKS5zcHJpdGVGcmFtZSA9IHNlbGYuaW1hMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sQ29udGVudC5hZGRDaGlsZChuMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yQ29udGVudC5hZGRDaGlsZChuMik7XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5yZWZyZXNoQW5ub3VuY2VtZW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvZ2V0X2Fubm91bmNlbWVudFwiLCBkYXRhLCBmbik7XHJcbiAgICB9LFxyXG4gICAgb25CdG5DbG9zZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHt9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBfaXNDYXB0dXJpbmc6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHt9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcbiAgICAvLyB9LFxyXG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5BTkRST0lEX0FQSSA9IFwiY29tL3ZpdmlnYW1lcy9zY21qL1dYQVBJXCI7XHJcbiAgICAgICAgdGhpcy5JT1NfQVBJID0gXCJBcHBDb250cm9sbGVyXCI7XHJcbiAgICB9LFxyXG4gICAgbG9naW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZCh0aGlzLkFORFJPSURfQVBJLCBcIkxvZ2luXCIsIFwiKClWXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZCh0aGlzLklPU19BUEksIFwibG9naW5cIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJwbGF0Zm9ybTpcIiArIGNjLnN5cy5vcyArIFwiIGRvc24ndCBpbXBsZW1lbnQgc2hhcmUuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaGFyZTogZnVuY3Rpb24odGl0bGUsIGRlc2MpIHtcclxuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QodGhpcy5BTkRST0lEX0FQSSwgXCJTaGFyZVwiLCBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiLCBjYy52di5TSS5hcHB3ZWIsIHRpdGxlLCBkZXNjKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QodGhpcy5JT1NfQVBJLCBcInNoYXJlOnNoYXJlVGl0bGU6c2hhcmVEZXNjOlwiLCBjYy52di5TSS5hcHB3ZWIsIHRpdGxlLCBkZXNjKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXRmb3JtOlwiICsgY2Muc3lzLm9zICsgXCIgZG9zbid0IGltcGxlbWVudCBzaGFyZS5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNoYXJlUmVzdWx0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5faXNDYXB0dXJpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9pc0NhcHR1cmluZyA9IHRydWU7XHJcbiAgICAgICAgdmFyIHNpemUgPSBjYy5kaXJlY3Rvci5nZXRXaW5TaXplKCk7XHJcbiAgICAgICAgdmFyIGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICB2YXIgZmlsZU5hbWUgPSBcInJlc3VsdF9zaGFyZS5qcGdcIjtcclxuICAgICAgICB2YXIgZnVsbFBhdGggPSBqc2IuZmlsZVV0aWxzLmdldFdyaXRhYmxlUGF0aCgpICsgZmlsZU5hbWU7XHJcbiAgICAgICAgaWYgKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QoZnVsbFBhdGgpKSB7XHJcbiAgICAgICAgICAgIGpzYi5maWxlVXRpbHMucmVtb3ZlRmlsZShmdWxsUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0ZXh0dXJlID0gbmV3IGNjLlJlbmRlclRleHR1cmUoTWF0aC5mbG9vcihzaXplLndpZHRoKSwgTWF0aC5mbG9vcihzaXplLmhlaWdodCkpO1xyXG4gICAgICAgIHRleHR1cmUuc2V0UG9zaXRpb24oY2MucChzaXplLndpZHRoIC8gMiwgc2l6ZS5oZWlnaHQgLyAyKSk7XHJcbiAgICAgICAgdGV4dHVyZS5iZWdpbigpO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmdldFJ1bm5pbmdTY2VuZSgpLnZpc2l0KCk7XHJcbiAgICAgICAgdGV4dHVyZS5lbmQoKTtcclxuICAgICAgICB0ZXh0dXJlLnNhdmVUb0ZpbGUoZmlsZU5hbWUsIGNjLklNQUdFX0ZPUk1BVF9KUEcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgdHJ5VGltZXMgPSAwO1xyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSAxMDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSBoZWlnaHQgLyBzaXplLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IE1hdGguZmxvb3Ioc2l6ZS53aWR0aCAqIHNjYWxlKTtcclxuICAgICAgICAgICAgICAgIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpIHtcclxuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKHNlbGYuQU5EUk9JRF9BUEksIFwiU2hhcmVJTUdcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7SUkpVlwiLCBmdWxsUGF0aCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XHJcbiAgICAgICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChzZWxmLklPU19BUEksIFwic2hhcmVJTUc6d2lkdGg6aGVpZ2h0OlwiLCBmdWxsUGF0aCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxhdGZvcm06XCIgKyBjYy5zeXMub3MgKyBcIiBkb3NuJ3QgaW1wbGVtZW50IHNoYXJlLlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYuX2lzQ2FwdHVyaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0cnlUaW1lcysrO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRyeVRpbWVzID4gMTApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRpbWUgb3V0Li4uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZm4sIDUwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzZXRUaW1lb3V0KGZuLCA1MCk7XHJcbiAgICB9LFxyXG4gICAgb25Mb2dpblJlc3A6IGZ1bmN0aW9uKGNvZGUsIHVpZCwgcm9vbWlkKSB7XHJcbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIui/lOWbnueahOW+ruS/oei0puWPt+S/oeaBr+aYrzpcIiArIHJldC5hY2NvdW50LCByZXQuc2lnbiwgcmV0LnNoYXJlUm9vbUlkKTtcclxuICAgICAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInd4X2FjY291bnRcIiwgcmV0LmFjY291bnQpO1xyXG4gICAgICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwid3hfc2lnblwiLCByZXQuc2lnbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5vbkF1dGgocmV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLlkJHlvq7kv6Hlj5HpgIHpqozor4Hor7fmsYJcIik7XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi93ZWNoYXRfYXV0aFwiLCB7XHJcbiAgICAgICAgICAgIGNvZGU6IGNvZGUsXHJcbiAgICAgICAgICAgIHVpZDogdWlkLFxyXG4gICAgICAgICAgICBvczogY2Muc3lzLm9zLFxyXG4gICAgICAgICAgICByb29taWQ6IHJvb21pZFxyXG4gICAgICAgIH0sIGZuKTtcclxuICAgIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBiZ21Wb2x1bWU6IDEuMCxcclxuICAgICAgICBzZnhWb2x1bWU6IDEuMCxcclxuICAgICAgICBiZ21BdWRpb0lEOiAtMSxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB0ID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdtVm9sdW1lXCIpO1xyXG4gICAgICAgIGlmICh0ICE9IG51bGwgJiYgdCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5iZ21Wb2x1bWUgPSBwYXJzZUZsb2F0KHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImJnbVZvbHVtZVwiLCAxLjApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHQgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJzZnhWb2x1bWVcIik7XHJcbiAgICAgICAgaWYgKHQgIT0gbnVsbCAmJiB0ID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnNmeFZvbHVtZSA9IHBhcnNlRmxvYXQodCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwic2Z4Vm9sdW1lXCIsIDEuMCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfSElERSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2MuYXVkaW9FbmdpbmUucGF1c2VBbGxcIik7XHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnBhdXNlQWxsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX1NIT1csIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNjLmF1ZGlvRW5naW5lLnJlc3VtZUFsbFwiKTtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucmVzdW1lQWxsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgZ2V0VXJsOiBmdW5jdGlvbih1cmwpIHtcclxuICAgICAgICByZXR1cm4gY2MudXJsLnJhdyhcInJlc291cmNlcy9zb3VuZHMvXCIgKyB1cmwpO1xyXG4gICAgfSxcclxuICAgIHBsYXlCR00odXJsKSB7XHJcbiAgICAgICAgdmFyIGF1ZGlvVXJsID0gdGhpcy5nZXRVcmwodXJsKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhhdWRpb1VybCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYmdtQXVkaW9JRCA+PSAwKSB7XHJcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnN0b3AodGhpcy5iZ21BdWRpb0lEKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5iZ21BdWRpb0lEID0gY2MuYXVkaW9FbmdpbmUucGxheShhdWRpb1VybCwgdHJ1ZSwgdGhpcy5iZ21Wb2x1bWUpO1xyXG4gICAgICAgIHZhciB0ID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYmdtVm9sdW1lXCIpO1xyXG4gICAgICAgIGlmICh0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgdCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCflvZPliY3pn7Pph4/mmK/lpJrlsJEnICsgdCk7XHJcbiAgICAgICAgdGhpcy5zZXRCR01Wb2x1bWUodCk7XHJcbiAgICAgICAgLy8gYWxlcnQoXCLlvZPliY3nmoRpZOaYry0tXCIrdGhpcy5iZ21BdWRpb0lEKTtcclxuICAgIH0sXHJcbiAgICBwbGF5U0ZYKHVybCkge1xyXG4gICAgICAgIHZhciBhdWRpb1VybCA9IHRoaXMuZ2V0VXJsKHVybCk7XHJcbiAgICAgICAgaWYgKHRoaXMuc2Z4Vm9sdW1lID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgYXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXkoYXVkaW9VcmwsIGZhbHNlLCB0aGlzLnNmeFZvbHVtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldFNGWFZvbHVtZTogZnVuY3Rpb24odikge1xyXG4gICAgICAgIGlmICh0aGlzLnNmeFZvbHVtZSAhPSB2KSB7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInNmeFZvbHVtZVwiLCB2KTtcclxuICAgICAgICAgICAgdGhpcy5zZnhWb2x1bWUgPSB2O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRCR01Wb2x1bWU6IGZ1bmN0aW9uKHYsIGZvcmNlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYmdtQXVkaW9JRCA+PSAwKSB7XHJcbiAgICAgICAgICAgIGlmICh2ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucmVzdW1lKHRoaXMuYmdtQXVkaW9JRCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wYXVzZSh0aGlzLmJnbUF1ZGlvSUQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdtQXVkaW9JRCx0aGlzLmJnbVZvbHVtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmJnbVZvbHVtZSAhPSB2IHx8IGZvcmNlKSB7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImJnbVZvbHVtZVwiLCB2KTtcclxuICAgICAgICAgICAgdGhpcy5iZ21Wb2x1bWUgPSB2O1xyXG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ21BdWRpb0lELCB2KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcGF1c2VBbGw6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnBhdXNlQWxsKCk7XHJcbiAgICB9LFxyXG4gICAgcmVzdW1lQWxsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy5hdWRpb0VuZ2luZS5yZXN1bWVBbGwoKTtcclxuICAgIH1cclxufSk7IiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIF9jaGFyZ2U6IG51bGwsXG4gICAgICAgIC8vIOagh+mimFxuICAgICAgICBfdGl0bGU6IG51bGwsXG4gICAgICAgIC8vIOehruiupOaMiemSrlxuICAgICAgICBfYnRuT0s6IG51bGwsXG4gICAgICAgIC8vIOWPlua2iOaMiemSrlxuICAgICAgICBfYnRuQ2FuY2VsOiBudWxsLFxuICAgICAgICAvLyDovpPlhaXmoYZcbiAgICAgICAgX2VkaXRib3g6IG51bGwsXG4gICAgICAgIC8vIOaYvuekuui+k+WFpeeahOmHkeW4geaVsOmHj1xuICAgICAgICBfY29udGVudDogbnVsbCxcbiAgICAgICAgLy8g5pi+56S65YWR5o2i546HXG4gICAgICAgIF9yYXRlVHh0OiBudWxsLFxuICAgICAgICBfY2hhcmdlQ250OiBudWxsLFxuICAgICAgICBfcmF0ZTogMSxcbiAgICAgICAgX2Nvc3RSTUI6IDAsXG4gICAgICAgIC8vIOacgOWwkeWFheWAvOaVsOmHj1xuICAgICAgICBfTUlOQ09TVDogMSxcbiAgICAgICAgX01BWENPU1RSTUI6IDk5OTk5LFxuICAgICAgICBfcGF5UGFyYW06IG51bGxcbiAgICB9LFxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0VUkoKVxuICAgICAgICAgICAgLy9GSVhNRTogIOW9k+WJjeeahOWFkeaNoueOh+aYr1xuICAgICAgICB0aGlzLnJlZnJlc2hJbmZvKCk7XG4gICAgICAgIGNjLnZ2LmNoYXJnZVR5cGUgPSB0aGlzO1xuICAgIH0sXG4gICAgaW5pdFVJOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fY2hhcmdlID0gY2MuZmluZChcIkNhbnZhcy96dWFuc2hpQ2hhbmdlXCIpO1xuICAgICAgICB0aGlzLl9idG5PSyA9IGNjLmZpbmQoXCJDYW52YXMvenVhbnNoaUNoYW5nZS95ZXNcIikuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIHRoaXMuX2J0bkNhbmNlbCA9IGNjLmZpbmQoXCJDYW52YXMvenVhbnNoaUNoYW5nZS9ub1wiKS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcbiAgICAgICAgdGhpcy5fZWRpdGJveCA9IGNjLmZpbmQoXCJDYW52YXMvenVhbnNoaUNoYW5nZS9lZGl0Ym94XCIpLmdldENvbXBvbmVudChjYy5FZGl0Qm94KTtcbiAgICB9LFxuICAgIG9uQ2xvc2VCdG5DbGlja2VkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCLlhbPpl63nlYzpnaJcIik7XG4gICAgICAgIHRoaXMuX2VkaXRib3guc3RyaW5nID0gXCJcIjtcbiAgICAgICAgdGhpcy5fY2hhcmdlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBjYy52di53Yy5oaWRlKCk7XG4gICAgfSxcbiAgICBvbkNvbmZpcm1CdG5DbGlja2VkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoSW5mbygpO1xuICAgICAgICAvLyDpqozor4HmmK/kuI3mmK/mlbTmlbDvvIzkuI3mmK/mlbTmlbDopoHmsYLph43mlrDovpPlhaVcbiAgICAgICAgY29uc29sZS5sb2coXCLph5Hpop3mmK9cIiwgdGhpcy5fY29zdFJNQik7XG4gICAgICAgIHZhciBmbGFnID0gdGhpcy52YWxpZGF0ZUludE51bSh0aGlzLl9jb3N0Uk1CKVxuICAgICAgICBpZiAoIWZsYWcpIHtcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIuivt+i+k+WFpeaVtOaVsOmHkeminSzkuJTmnIDlsI/lhYXlgLzph5Hpop1cIiArIHRoaXMuX01JTkNPU1QgKyBcIuWFg1wiO1xuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuazqOaEj1wiLCBzdHIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24ocmV0KSB7XG4gICAgICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGlmIChyZXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5rOo5oSPXCIsIFwi5YWF5YC85aSx6LSl6K+356iN5ZCO6YeN6K+VXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZENoYXJnZVJlcXVlc3QocmV0KTtcbiAgICAgICAgICAgICAgICBjYy52di53Yy5zaG93KFwi5q2j5Zyo5YWF5YC877yM6K+356iN5ZCOXCIpO1xuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IucmVmcmVzaFRpbWUgPSAyMDAwO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXG4gICAgICAgICAgICAgICAgdXNlcmlkOiBjYy52di51c2VyTWdyLnVzZXJJZCxcbiAgICAgICAgICAgICAgICBjb3N0Uk1COiB0aGlzLl9jb3N0Uk1CLFxuICAgICAgICAgICAgICAgIHNoaXBfdHlwZTogMVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNjLnZ2LndjLnNob3coXCLmraPlnKjlhYXlgLzvvIzor7fnqI3lkI5cIik7XG4gICAgICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dvX3RvX2NoYXJnZVwiLCBkYXRhLCBmbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX2NoYXJnZS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG4gICAgcmVmcmVzaEluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9yYXRlID0gMSB8fCBjYy52di51c2VyTWdyLmNoYXJnZXJhdGU7XG4gICAgICAgIHRoaXMuX2Nvc3RSTUIgPSBOdW1iZXIodGhpcy5fZWRpdGJveC5zdHJpbmcpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcy5jb3N0JywgdGhpcy5fY29zdFJNQik7XG4gICAgICAgIC8vIHRoaXMuX2NoYXJnZUNudCA9ICh0aGlzLl9jaGFyZ2VDbnQgKiB0aGlzLl9yYXRlKS50b0ZpeGVkKDApO1xuICAgICAgICAvLyBpZiAoIXRoaXMuX2Nvc3RSTUIpIHtcbiAgICAgICAgLy8gICAgIHRoaXMuX2NvbnRlbnQuc3RyaW5nID0gXCLmgqjlvZPliY3mnKrovpPlhaXlhYXlgLzph5Hpop1cIjtcbiAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgLy8gICAgIHRoaXMuX2NvbnRlbnQuc3RyaW5nID0gXCLmgqjovpPlhaXnmoTph5Hpop3mmK86XCIgKyB0aGlzLl9jb3N0Uk1CO1xuICAgICAgICAvLyB9XG4gICAgfSxcbiAgICAvLyDliKTmlq3mmK/kuI3mmK/ovpPlhaXnmoTmraPnoa7nmoTph5Hpop1cbiAgICB2YWxpZGF0ZUludE51bTogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHZhciBwYXR0ZW4gPSAvXlsxLTldXFxkKiQvO1xuICAgICAgICB2YXIgZmxhZyA9IHBhdHRlbi50ZXN0KHZhbClcbiAgICAgICAgaWYgKCFmbGFnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuW9k+WJjei+k+WFpeeahOaVsOWtl+aYr+ato+aVtOaVsFwiLCB2YWwsIHRoaXMuX01JTkNPU1QpO1xuICAgICAgICAgICAgcmV0dXJuICh2YWwgPj0gdGhpcy5fTUlOQ09TVCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIOWPkemAgeeUs+ivt+WFheWAvOivt+axglxuICAgIHNlbmRDaGFyZ2VSZXF1ZXN0OiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhID09IG51bGwpIHtcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLms6jmhI9cIiwgXCLlhYXlgLzlpLHotKXor7fnqI3lkI7ph43or5VcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCLlj5HpgIEg5YWF5YC86K+35rGCXCIpO1xuICAgICAgICB2YXIgdXJsID0gZGF0YS51cmw7XG4gICAgICAgIHZhciB4aHIgPSBjYy5sb2FkZXIuZ2V0WE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgeGhyLm9wZW4oXCJQT1NUXCIsIHVybCwgdHJ1ZSk7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG4gICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0ICYmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDw9IDIwNykpIHtcbiAgICAgICAgICAgICAgICB2YXIgaHR0cFN0YXR1cyA9IHhoci5zdGF0dXNUZXh0O1xuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLov5Tlm57vvIHvvIHvvIHvvIHvvIFcIiArIHJlc3BvbnNlLmVycm1zZyArIFwicmVzcG9uc2UuZXJyY29kZTpcIiArIHJlc3BvbnNlLmVycmNvZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJjb2RlID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IHJlc3BvbnNlLmVycm1zZztcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLov5Tlm57nmoTnu5PmnpzmmK8hISEhISFcIiArIHJldCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BheVBhcmFtID0gcmV0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLmmK9INea4uOaIj1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYXkodGhpcy5fcGF5UGFyYW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIOaOpeaUtuWujOWQju+8jOmakOiXj+WFheWAvOeql+WPo1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2xvc2VCdG5DbGlja2VkKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuazqOaEj1wiLCBcIuWFheWAvOWksei0peivt+eojeWQjumHjeivlVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIui/lOWbnueahOe7k+aenOWHuumUmVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5peg57uT5p6c6L+U5ZueXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LmJpbmQodGhpcyk7XG4gICAgICAgIHhoci50aW1lb3V0ID0gNTAwMDsgLy8gNSBzZWNvbmRzIGZvciB0aW1lb3V0XG4gICAgICAgIHZhciByZXEgPSBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgICB4aHIuc2VuZChyZXEpO1xuICAgIH0sXG59KTsiLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgX2NoYXJnZTogbnVsbCxcbiAgICAgICAgLy8g5qCH6aKYXG4gICAgICAgIF90aXRsZTogbnVsbCxcbiAgICAgICAgLy8g56Gu6K6k5oyJ6ZKuXG4gICAgICAgIF9idG5PSzogbnVsbCxcbiAgICAgICAgLy8g5Y+W5raI5oyJ6ZKuXG4gICAgICAgIF9idG5DYW5jZWw6IG51bGwsXG4gICAgICAgIC8vIOi+k+WFpeahhlxuICAgICAgICBfZWRpdGJveDogbnVsbCxcbiAgICAgICAgLy8g5pi+56S66L6T5YWl55qE6YeR5biB5pWw6YePXG4gICAgICAgIF9jb250ZW50OiBudWxsLFxuICAgICAgICAvLyDmmL7npLrlhZHmjaLnjodcbiAgICAgICAgX3JhdGVUeHQ6IG51bGwsXG4gICAgICAgIF9jaGFyZ2VDbnQ6IG51bGwsXG4gICAgICAgIF9yYXRlOiAxLFxuICAgICAgICBfY29zdFJNQjogMCxcbiAgICAgICAgLy8g5pyA5bCR5YWF5YC85pWw6YePXG4gICAgICAgIF9NSU5DT1NUOiAxLFxuICAgICAgICBfTUFYQ09TVFJNQjogOTk5OTksXG4gICAgICAgIF9wYXlQYXJhbTogbnVsbFxuICAgIH0sXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRVSSgpXG4gICAgICAgIC8vRklYTUU6ICDlvZPliY3nmoTlhZHmjaLnjofmmK9cbiAgICAgICAgdGhpcy5yZWZyZXNoSW5mbygpO1xuICAgICAgICBjYy52di5jaGFyZ2UgPSB0aGlzO1xuICAgIH0sXG4gICAgaW5pdFVJOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fY2hhcmdlID0gY2MuZmluZChcIkNhbnZhcy9jaGFyZ2VcIik7XG4gICAgICAgIHRoaXMuX3RpdGxlID0gY2MuZmluZChcIkNhbnZhcy9jaGFyZ2UvdGl0bGVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgdGhpcy5fYnRuT0sgPSBjYy5maW5kKFwiQ2FudmFzL2NoYXJnZS9idG5fb2tcIikuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIHRoaXMuX2J0bkNhbmNlbCA9IGNjLmZpbmQoXCJDYW52YXMvY2hhcmdlL2J0bl9jYW5jZWxcIikuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIHRoaXMuX2VkaXRib3ggPSBjYy5maW5kKFwiQ2FudmFzL2NoYXJnZS9lZGl0Ym94XCIpLmdldENvbXBvbmVudChjYy5FZGl0Qm94KTtcbiAgICAgICAgdGhpcy5fY29udGVudCA9IGNjLmZpbmQoXCJDYW52YXMvY2hhcmdlL2NvbnRlbnRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgdGhpcy5fcmF0ZVR4dCA9IGNjLmZpbmQoXCJDYW52YXMvY2hhcmdlL3JhdGVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICB9LFxuICAgIG9uQ2xvc2VCdG5DbGlja2VkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCLlhbPpl63nlYzpnaJcIik7XG4gICAgICAgIHRoaXMuX2VkaXRib3guc3RyaW5nID0gXCJcIjtcbiAgICAgICAgdGhpcy5fY2hhcmdlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBjYy52di53Yy5oaWRlKCk7XG4gICAgfSxcbiAgICBvbkNvbmZpcm1CdG5DbGlja2VkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoSW5mbygpO1xuICAgICAgICAvLyDpqozor4HmmK/kuI3mmK/mlbTmlbDvvIzkuI3mmK/mlbTmlbDopoHmsYLph43mlrDovpPlhaVcbiAgICAgICAgY29uc29sZS5sb2coXCLph5Hpop3mmK9cIiwgdGhpcy5fY29zdFJNQik7XG4gICAgICAgIHZhciBmbGFnID0gdGhpcy52YWxpZGF0ZUludE51bSh0aGlzLl9jb3N0Uk1CKVxuICAgICAgICBpZiAoIWZsYWcpIHtcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIuivt+i+k+WFpeaVtOaVsOmHkeminSzkuJTmnIDlsI/lhYXlgLzph5Hpop1cIiArIHRoaXMuX01JTkNPU1QgKyBcIuWFg1wiO1xuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuazqOaEj1wiLCBzdHIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24ocmV0KSB7XG4gICAgICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGlmIChyZXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5rOo5oSPXCIsIFwi5YWF5YC85aSx6LSl6K+356iN5ZCO6YeN6K+VXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZENoYXJnZVJlcXVlc3QocmV0KTtcbiAgICAgICAgICAgICAgICBjYy52di53Yy5zaG93KFwi5q2j5Zyo5YWF5YC877yM6K+356iN5ZCOXCIpO1xuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IucmVmcmVzaFRpbWUgPSAyMDAwO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcbiAgICAgICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXG4gICAgICAgICAgICAgICAgdXNlcmlkOiBjYy52di51c2VyTWdyLnVzZXJJZCxcbiAgICAgICAgICAgICAgICBjb3N0Uk1COiB0aGlzLl9jb3N0Uk1CLFxuICAgICAgICAgICAgICAgIHNoaXBfdHlwZTogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNjLnZ2LndjLnNob3coXCLmraPlnKjlhYXlgLzvvIzor7fnqI3lkI5cIik7XG4gICAgICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dvX3RvX2NoYXJnZVwiLCBkYXRhLCBmbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX2NoYXJnZS5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG4gICAgcmVmcmVzaEluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9yYXRlID0gMSB8fCBjYy52di51c2VyTWdyLmNoYXJnZXJhdGU7XG4gICAgICAgIHRoaXMuX2Nvc3RSTUIgPSBOdW1iZXIodGhpcy5fZWRpdGJveC5zdHJpbmcpO1xuICAgICAgICBjb25zb2xlLmxvZygndGhpcy5jb3N0JywgdGhpcy5fY29zdFJNQik7XG4gICAgICAgIC8vIHRoaXMuX2NoYXJnZUNudCA9ICh0aGlzLl9jaGFyZ2VDbnQgKiB0aGlzLl9yYXRlKS50b0ZpeGVkKDApO1xuICAgICAgICBpZiAoIXRoaXMuX2Nvc3RSTUIpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQuc3RyaW5nID0gXCLmgqjlvZPliY3mnKrovpPlhaXlhYXlgLzph5Hpop1cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQuc3RyaW5nID0gXCLmgqjovpPlhaXnmoTph5Hpop3mmK86XCIgKyB0aGlzLl9jb3N0Uk1CO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyDliKTmlq3mmK/kuI3mmK/ovpPlhaXnmoTmraPnoa7nmoTph5Hpop1cbiAgICB2YWxpZGF0ZUludE51bTogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHZhciBwYXR0ZW4gPSAvXlsxLTldXFxkKiQvO1xuICAgICAgICB2YXIgZmxhZyA9IHBhdHRlbi50ZXN0KHZhbClcbiAgICAgICAgaWYgKCFmbGFnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuW9k+WJjei+k+WFpeeahOaVsOWtl+aYr+ato+aVtOaVsFwiLCB2YWwsIHRoaXMuX01JTkNPU1QpO1xuICAgICAgICAgICAgcmV0dXJuICh2YWwgPj0gdGhpcy5fTUlOQ09TVCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIOWPkemAgeeUs+ivt+WFheWAvOivt+axglxuICAgIHNlbmRDaGFyZ2VSZXF1ZXN0OiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhID09IG51bGwpIHtcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLms6jmhI9cIiwgXCLlhYXlgLzlpLHotKXor7fnqI3lkI7ph43or5VcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coXCLlj5HpgIEg5YWF5YC86K+35rGCXCIpO1xuICAgICAgICB2YXIgdXJsID0gXCJodHRwOi8vbWoueWFqdWdhbWUuY29tL21hbmFnZTEvPy9nby9pbmRleC9wYXlEby9cIjtcbiAgICAgICAgdmFyIHhociA9IGNjLmxvYWRlci5nZXRYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB4aHIub3BlbihcIlBPU1RcIiwgdXJsLCB0cnVlKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTtcbiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQgJiYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPD0gMjA3KSkge1xuICAgICAgICAgICAgICAgIHZhciBodHRwU3RhdHVzID0geGhyLnN0YXR1c1RleHQ7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIui/lOWbnu+8ge+8ge+8ge+8ge+8gVwiICsgcmVzcG9uc2UuZXJybXNnICsgXCJyZXNwb25zZS5lcnJjb2RlOlwiICsgcmVzcG9uc2UuZXJyY29kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycmNvZGUgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0gcmVzcG9uc2UuZXJybXNnO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIui/lOWbnueahOe7k+aenOaYryEhISEhIVwiICsgcmV0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGF5UGFyYW0gPSByZXQ7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuaYr0g15ri45oiPXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBheSh0aGlzLl9wYXlQYXJhbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8g5o6l5pS25a6M5ZCO77yM6ZqQ6JeP5YWF5YC856qX5Y+jXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25DbG9zZUJ0bkNsaWNrZWQoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5rOo5oSPXCIsIFwi5YWF5YC85aSx6LSl6K+356iN5ZCO6YeN6K+VXCIpO1xuICAgICAgICAgICAgICAgICAgICBjYy52di53Yy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi6L+U5Zue55qE57uT5p6c5Ye66ZSZXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLml6Dnu5Pmnpzov5Tlm55cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0uYmluZCh0aGlzKTtcbiAgICAgICAgeGhyLnRpbWVvdXQgPSA1MDAwOyAvLyA1IHNlY29uZHMgZm9yIHRpbWVvdXRcbiAgICAgICAgdmFyIHJlcSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gICAgICAgIHhoci5zZW5kKHJlcSk7XG4gICAgfSxcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2NoYXRSb290OiBudWxsLFxyXG4gICAgICAgIF90YWJRdWljazogbnVsbCxcclxuICAgICAgICBfdGFiRW1vamk6IG51bGwsXHJcbiAgICAgICAgX2lwdENoYXQ6IG51bGwsXHJcbiAgICAgICAgX3F1aWNrQ2hhdEluZm86IG51bGwsXHJcbiAgICAgICAgX2J0bkNoYXQ6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYuY2hhdCA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fYnRuQ2hhdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bl9jaGF0XCIpO1xyXG4gICAgICAgIHRoaXMuX2J0bkNoYXQuYWN0aXZlID0gY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgPT0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fY2hhdFJvb3QgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaGF0XCIpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3RhYlF1aWNrID0gdGhpcy5fY2hhdFJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJxdWlja2NoYXRsaXN0XCIpO1xyXG4gICAgICAgIHRoaXMuX3RhYkVtb2ppID0gdGhpcy5fY2hhdFJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJlbW9qaXNcIik7XHJcbiAgICAgICAgdGhpcy5faXB0Q2hhdCA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwiaXB0Q2hhdFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCk7XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mbyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtMFwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDAsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5b+r54K55ZWK77yM6YO9562J5Yiw5oiR6Iqx5YS/6YO96LCi6LCi5LqG77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfMS5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW0xXCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogMSxcclxuICAgICAgICAgICAgY29udGVudDogXCLmgI7kuYjlj4jmlq3nur/kuobvvIznvZHnu5zmgI7kuYjov5nkuYjlt67llYrvvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ18yLm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTJcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiAyLFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuS4jeimgei1sO+8jOWGs+aImOWIsOWkqeS6ru+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzMubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtM1wiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDMsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5L2g55qE54mM5omT5b6X5Lmf5aSq5aW95LqG77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfNC5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW00XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogNCxcclxuICAgICAgICAgICAgY29udGVudDogXCLkvaDmmK/lprnlprnov5jmmK/lk6Xlk6XllYrvvJ9cIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ181Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTVcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiA1LFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuWSjOS9oOWQiOS9nOecn+aYr+WkquaEieW/q+S6hu+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzYubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtNlwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDYsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5aSn5a625aW977yM5b6I6auY5YW06KeB5Yiw5ZCE5L2N77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfNy5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW03XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogNyxcclxuICAgICAgICAgICAgY29udGVudDogXCLlkITkvY3vvIznnJ/mmK/kuI3lpb3mhI/mgJ3vvIzmiJHlvpfnprvlvIDkuIDkvJrlhL/jgIJcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ184Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbThcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiA4LFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuS4jeimgeWQteS6hu+8jOS4k+W/g+eOqea4uOaIj+WQp++8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzkubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuICAgIGdldFF1aWNrQ2hhdEluZm8oaW5kZXgpIHtcclxuICAgICAgICB2YXIga2V5ID0gXCJpdGVtXCIgKyBpbmRleDtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcXVpY2tDaGF0SW5mb1trZXldO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2hhdENsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgb25CZ0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIG9uVGFiQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0YWJRdWlja1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYlF1aWNrLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYkVtb2ppLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0YWJFbW9qaVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYlF1aWNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl90YWJFbW9qaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvblF1aWNrQ2hhdEl0ZW1DbGlja2VkOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5fcXVpY2tDaGF0SW5mb1tldmVudC50YXJnZXQubmFtZV07XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJxdWlja19jaGF0XCIsIGluZm8uaW5kZXgpO1xyXG4gICAgfSxcclxuICAgIG9uRW1vamlJdGVtQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQubmFtZSk7XHJcbiAgICAgICAgdGhpcy5fY2hhdFJvb3QuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJlbW9qaVwiLCBldmVudC50YXJnZXQubmFtZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5TZW5kQ2hhdENsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9pcHRDaGF0LnN0cmluZyA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJjaGF0XCIsIHRoaXMuX2lwdENoYXQuc3RyaW5nKTtcclxuICAgICAgICB0aGlzLl9pcHRDaGF0LnN0cmluZyA9IFwiXCI7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcbiAgICAvLyB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIHRhcmdldDogY2MuTm9kZSxcclxuICAgICAgICBzcHJpdGU6IGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIGNoZWNrZWRTcHJpdGU6IGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIGNoZWNrZWQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgIH0sXHJcbiAgICBvbkNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICB9LFxyXG4gICAgcmVmcmVzaDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldFNwcml0ZSA9IHRoaXMudGFyZ2V0LmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgdGFyZ2V0U3ByaXRlLnNwcml0ZUZyYW1lID0gdGhpcy5jaGVja2VkU3ByaXRlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRhcmdldFNwcml0ZS5zcHJpdGVGcmFtZSA9IHRoaXMuc3ByaXRlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGJ0aExRMTogY2MuTm9kZSxcclxuICAgICAgICBidGhMUTI6IGNjLk5vZGUsXHJcbiAgICAgICAgYnRoTFEzOiBjYy5Ob2RlLFxyXG4gICAgICAgIGJ0aExRNDogY2MuTm9kZSxcclxuICAgICAgICBidGhTQzE6IGNjLk5vZGUsXHJcbiAgICAgICAgYnRoU0MyOiBjYy5Ob2RlLFxyXG4gICAgICAgIGxlZnRfY29udGVudDogY2MuTm9kZSxcclxuICAgICAgICByaWdodF9jb250ZW50OiBjYy5Ob2RlLFxyXG4gICAgICAgIGltYTE6IHtcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGltYTI6IHtcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuYnRoTFExLCB0aGlzLm5vZGUsIFwiQ29sbGFwc2VcIiwgXCJvbkJ0bkxxXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5idGhMUTMsIHRoaXMubm9kZSwgXCJDb2xsYXBzZVwiLCBcIm9uQnRuTHFcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlZnRfY29udGVudC5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMubGVmdF9jb250ZW50LmNoaWxkcmVuW2ldLCB0aGlzLm5vZGUsIFwiQ29sbGFwc2VcIiwgXCJvbkJ0blN3aXRjaFwiKTtcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuICAgIG9uQnRuU3dpdGNoOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZWZ0X2NvbnRlbnQuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgPT0gZXZlbnQudGFyZ2V0LmdldFNpYmxpbmdJbmRleCgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxlZnRfY29udGVudC5jaGlsZHJlbltpXS5nZXRDb21wb25lbnQoXCJjYy5TcHJpdGVcIikuc3ByaXRlRnJhbWUgPSB0aGlzLmltYTE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0X2NvbnRlbnQuY2hpbGRyZW5baV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGVmdF9jb250ZW50LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcImNjLlNwcml0ZVwiKS5zcHJpdGVGcmFtZSA9IHRoaXMuaW1hMjtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRfY29udGVudC5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICByZWZyZXNoQnRuczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2LnVzZXJNZ3IuY29sbGFwc2VfcHJpc2UgPj0gMikge1xyXG4gICAgICAgICAgICB0aGlzLmJ0aExRMS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5idGhMUTIuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5idGhMUTMuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYnRoTFE0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGNjLnZ2LnVzZXJNZ3IuY29sbGFwc2VfcHJpc2UgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KGNjLnZ2LnVzZXJNZ3IuZ2VtcykgPCAxMDAwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFExLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFEyLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idGhMUTMuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0aExRNC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idGhMUTEuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idGhMUTIuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0aExRMy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0aExRNC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjYy52di51c2VyTWdyLmNvbGxhcHNlX3ByaXNlIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChjYy52di51c2VyTWdyLmdlbXMpIDwgMTAwMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0aExRMS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFEyLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFEzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFE0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFExLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRoTFEyLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idGhMUTMuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idGhMUTQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjYy52di51c2VyTWdyLmlzX2ZpcnN0X2NoYXJnZSA9PSAxKXtcclxuICAgICAgICAgICAgdGhpcy5idGhTQzEuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5idGhTQzIuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYnRoU0MxLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJ0aFNDMi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkxxOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmdlbXMgPSByZXQuZ2VtcztcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuY29pbnMgPSByZXQuY29pbnM7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmNvbGxhcHNlX3ByaXNlID0gcmV0LmNvbGxhcHNlX3ByaXNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYucmVmcmVzaEJ0bnMoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvZ2V0X3VzZXJfY29sbGFwc2VcIiwgZGF0YSwgZm4pO1xyXG4gICAgfSxcclxuICAgIG9uQnRuU0M6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2VtcyA9IHJldC5nZW1zO1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5jb2lucyA9IHJldC5jb2lucztcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuaXNfZmlyc3RfY2hhcmdlID0gcmV0LmlzX2ZpcnN0X2NoYXJnZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLnJlZnJlc2hCdG5zKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF91c2VyX2ZpcnN0X2NoYXJnZVwiLCBkYXRhLCBmbik7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge30sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIGluaXRIYW5kbGVyczogZnVuY3Rpb24oR2FtZU5ldCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gR2FtZU5ldDtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImxvZ2luX3Jlc3VsdFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5fcmVzdWx0PT09PlwiLCBkYXRhKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuZXJyY29kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21JZCA9IGRhdGEucm9vbWlkO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSBkYXRhLmNvbmYucm9vbV90eXBlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jb25mID0gZGF0YS5jb25mO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5tYXhOdW1PZkdhbWVzID0gZGF0YS5jb25mLm1heEdhbWVzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5udW1PZkdhbWVzID0gZGF0YS5udW1vZmdhbWVzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0cyA9IGRhdGEuc2VhdHM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRJbmRleCA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRChjYy52di51c2VyTWdyLnVzZXJJZCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzT3ZlciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jcV9kYXRhID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5lcnJtc2cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJsb2dpbl9maW5pc2hlZFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5fZmluaXNoZWRcIik7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImNhaXF1YW5cIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJleGl0X3Jlc3VsdFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbUlkID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgc2VsZi50dXJuID0gLTE7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZGlzcHJlc3NfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbUlkID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgc2VsZi50dXJuID0gLTE7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZGlzY29ubmVjdFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbUlkID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJkaXNjb25uZWN0XCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiY3FfYmVnaW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3FfYmVnaW5fcHVzaFwiKTtcclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJjcV9iZWdpblwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImNxX25ld191c2VyX2NvbWVzX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNxX25ld191c2VyX2NvbWVzX3B1c2hcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuY3FfZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJjcV9uZXdfdXNlclwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImNxX2dhbWVfb3Zlcl9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjcV9nYW1lX292ZXJfcHVzaFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJjcV9nYW1lX292ZXJcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjcV9nYW1lX3RpbWVfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY3FfZ2FtZV90aW1lX3B1c2hcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuY3FEaXNwYXRjaEV2ZW50KFwiY3FfZ2FtZV90aW1lXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiY3FfZXhpdF9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhO1xyXG4gICAgICAgICAgICBzZWxmLmNxRGlzcGF0Y2hFdmVudChcImNxX2V4aXRfbm90aWZ5XCIsIHVzZXJJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjcV9kaXNwcmVzc19wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbUlkID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgc2VsZi50dXJuID0gLTE7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBudWxsO1xyXG4gICAgICAgICAgICBzZWxmLmNxX2RhdGEgPSBudWxsO1xyXG4gICAgICAgICAgICBzZWxmLmNxRGlzcGF0Y2hFdmVudChcImNxX2Rpc3ByZXNzXCIsIHVzZXJJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjcV9sb3Nlcl9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhO1xyXG4gICAgICAgICAgICBpZiAoY2MudnYudXNlck1nci51c2VySWQgPT0gdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21fdHlwZSA9IC0xO1xyXG4gICAgICAgICAgICAgICAgc2VsZi50dXJuID0gLTE7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHNlbGYuY3FfZGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJjcV9sb3Nlcl9ub3RpZnlcIiwgdXNlcklkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImNxX3dpbm5lcl9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhO1xyXG4gICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbV90eXBlID0gLTE7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IC0xO1xyXG4gICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5jcV9kYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJjcV93aW5uZXJfbm90aWZ5XCIsIHVzZXJJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjcV9jaHVxdWFuX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5jcURpc3BhdGNoRXZlbnQoXCJjcV9jaHVxdWFuX25vdGlmeVwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbn0pIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIF9kaWZlbnh1YW56ZTogbnVsbCxcclxuICAgICAgICBfemltbzogbnVsbCxcclxuICAgICAgICBfd2FuZmF4dWFuemU6IG51bGwsXHJcbiAgICAgICAgX2p1c2h1eHVhbnplOiBudWxsLFxyXG4gICAgICAgIF9kaWFuZ2FuZ2h1YTogbnVsbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZGlmZW54dWFuemUgPSBbXTtcclxuICAgICAgICB2YXIgdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImRpZmVueHVhbnplXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdC5jaGlsZHJlbkNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSB0LmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChcIlJhZGlvQnV0dG9uXCIpO1xyXG4gICAgICAgICAgICBpZiAobiAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaWZlbnh1YW56ZS5wdXNoKG4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX2RpZmVueHVhbnplKTtcclxuICAgICAgICB0aGlzLl93YW5mYXh1YW56ZSA9IFtdO1xyXG4gICAgICAgIHZhciB0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwid2FuZmF4dWFuemVcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0LmNoaWxkcmVuQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgbiA9IHQuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiQ2hlY2tCb3hcIik7XHJcbiAgICAgICAgICAgIGlmIChuICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3dhbmZheHVhbnplLnB1c2gobik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5fd2FuZmF4dWFuemUpO1xyXG4gICAgICAgIHRoaXMuX2p1c2h1eHVhbnplID0gW107XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ4dWFuemVqdXNodVwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQuY2hpbGRyZW5Db3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gdC5jaGlsZHJlbltpXS5nZXRDb21wb25lbnQoXCJSYWRpb0J1dHRvblwiKTtcclxuICAgICAgICAgICAgaWYgKG4gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fanVzaHV4dWFuemUucHVzaChuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkJhY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bk9LOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVSb29tKCk7XHJcbiAgICB9LFxyXG4gICAgY3JlYXRlUm9vbTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkNyZWF0ZSA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgPT0gMjIyMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLph5HluIHkuI3otrPvvIzliJvlu7rmiL/pl7TlpLHotKUhXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5Yib5bu65oi/6Ze05aSx6LSlLOmUmeivr+eggTpcIiArIHJldC5lcnJjb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iucm9vbV90eXBlID0gMDtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY29ubmVjdEdhbWVTZXJ2ZXIocmV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRpZmVuID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX2RpZmVueHVhbnplLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLl9kaWZlbnh1YW56ZVtpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBkaWZlbiA9IGk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgeWlrb3V4aWFuZyA9IHNlbGYuX3dhbmZheHVhbnplWzBdLmNoZWNrZWQ7XHJcbiAgICAgICAgdmFyIHlpcGFvZHVveGlhbmcgPSBzZWxmLl93YW5mYXh1YW56ZVsxXS5jaGVja2VkO1xyXG4gICAgICAgIC8vIOexu+Wei+mAieaLqeS4gOWPo+mmme+8jOm7mOiupOiuvue9ruS4jeWPr+S/ruaUuVxyXG4gICAgICAgIHZhciB0eXBlID0gXCJ5a3hcIjtcclxuICAgICAgICB2YXIganVzaHV4dWFuemUgPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5fanVzaHV4dWFuemUubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX2p1c2h1eHVhbnplW2ldLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgICAgIGp1c2h1eHVhbnplID0gaTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb25mID0ge1xyXG4gICAgICAgICAgICByb29tX3R5cGU6IDAsIC8vMOS7o+ihqOm6u+WwhuaIv+mXtFxyXG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICBkaWZlbjogZGlmZW4sXHJcbiAgICAgICAgICAgIGp1c2h1eHVhbnplOiBqdXNodXh1YW56ZSxcclxuICAgICAgICAgICAgeWlwYW9kdW94aWFuZzogeWlwYW9kdW94aWFuZ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICBjb25mOiBKU09OLnN0cmluZ2lmeShjb25mKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuato+WcqOWIm+W7uuaIv+mXtFwiKTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2NyZWF0ZV9wcml2YXRlX3Jvb21cIiwgZGF0YSwgb25DcmVhdGUpO1xyXG4gICAgfVxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcbiAgICAvLyB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIF9jaGF0Um9vdDogbnVsbCxcclxuICAgICAgICBfdGFiUXVpY2s6IG51bGwsXHJcbiAgICAgICAgX3RhYkVtb2ppOiBudWxsLFxyXG4gICAgICAgIF9pcHRDaGF0OiBudWxsLFxyXG4gICAgICAgIF9xdWlja0NoYXRJbmZvOiBudWxsLFxyXG4gICAgICAgIF9idG5DaGF0OiBudWxsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2LnpqaGNoYXQgPSB0aGlzO1xyXG4gICAgICAgIC8vIHRoaXMuX2J0bkNoYXQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ4aW54aVwiKTtcclxuICAgICAgICAvLyB0aGlzLl9idG5DaGF0LmFjdGl2ZSA9IGNjLnZ2LnJlcGxheU1nci5pc1JlcGxheSgpID09IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY2hhdFwiKTtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl90YWJRdWljayA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwicXVpY2tjaGF0bGlzdFwiKTtcclxuICAgICAgICB0aGlzLl90YWJFbW9qaSA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwiZW1vamlzXCIpO1xyXG4gICAgICAgIHRoaXMuX2lwdENoYXQgPSB0aGlzLl9jaGF0Um9vdC5nZXRDaGlsZEJ5TmFtZShcImlwdENoYXRcIikuZ2V0Q29tcG9uZW50KGNjLkVkaXRCb3gpO1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm8gPSB7fTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTBcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiAwLFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuW/q+eCueWViu+8jOmDveetieWIsOaIkeiKseWEv+mDveiwouiwouS6hu+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzEubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtMVwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDEsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5oCO5LmI5Y+I5pat57q/5LqG77yM572R57uc5oCO5LmI6L+Z5LmI5beu5ZWK77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfMi5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW0yXCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogMixcclxuICAgICAgICAgICAgY29udGVudDogXCLkuI3opoHotbDvvIzlhrPmiJjliLDlpKnkuq7vvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ18zLm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTNcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiAzLFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuS9oOeahOeJjOaJk+W+l+S5n+WkquWlveS6hu+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzQubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtNFwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDQsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5L2g5piv5aa55aa56L+Y5piv5ZOl5ZOl5ZWK77yfXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfNS5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW01XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogNSxcclxuICAgICAgICAgICAgY29udGVudDogXCLlkozkvaDlkIjkvZznnJ/mmK/lpKrmhInlv6vkuobvvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ182Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTZcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiA2LFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuWkp+WutuWlve+8jOW+iOmrmOWFtOingeWIsOWQhOS9je+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzcubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtN1wiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDcsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5ZCE5L2N77yM55yf5piv5LiN5aW95oSP5oCd77yM5oiR5b6X56a75byA5LiA5Lya5YS/44CCXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfOC5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW04XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogOCxcclxuICAgICAgICAgICAgY29udGVudDogXCLkuI3opoHlkLXkuobvvIzkuJPlv4PnjqnmuLjmiI/lkKfvvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ185Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcbiAgICBnZXRRdWlja0NoYXRJbmZvKGluZGV4KSB7XHJcbiAgICAgICAgdmFyIGtleSA9IFwiaXRlbVwiICsgaW5kZXg7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1aWNrQ2hhdEluZm9ba2V5XTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNoYXRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIG9uQmdDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBvblRhYkNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwidGFiUXVpY2tcIikge1xyXG4gICAgICAgICAgICB0aGlzLl90YWJRdWljay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl90YWJFbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwidGFiRW1vamlcIikge1xyXG4gICAgICAgICAgICB0aGlzLl90YWJRdWljay5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fdGFiRW1vamkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25RdWlja0NoYXRJdGVtQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX3F1aWNrQ2hhdEluZm9bZXZlbnQudGFyZ2V0Lm5hbWVdO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwicXVpY2tfY2hhdFwiLCBpbmZvLmluZGV4KTtcclxuICAgIH0sXHJcbiAgICBvbkVtb2ppSXRlbUNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0Lm5hbWUpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZW1vamlcIiwgZXZlbnQudGFyZ2V0Lm5hbWUpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuU2VuZENoYXRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5faXB0Q2hhdC5zdHJpbmcgPT0gXCJcIikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiY2hhdFwiLCB0aGlzLl9pcHRDaGF0LnN0cmluZyk7XHJcbiAgICAgICAgdGhpcy5faXB0Q2hhdC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgaW5pdEhhbmRsZXJzOiBmdW5jdGlvbihHYW1lTmV0KSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSBHYW1lTmV0O1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibG9naW5fcmVzdWx0XCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJsb2dpbl9yZXN1bHQ9PT0+XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5lcnJjb2RlID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgIHNlbGYucm9vbUlkID0gZGF0YS5yb29taWQ7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21fdHlwZSA9IGRhdGEuY29uZi5yb29tX3R5cGU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmYgPSBkYXRhLmNvbmY7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm1heE51bU9mR2FtZXMgPSBkYXRhLmNvbmYubWF4R2FtZXM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm51bU9mR2FtZXMgPSBkYXRhLm51bW9mZ2FtZXM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzID0gZGF0YS5zZWF0cztcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdEluZGV4ID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKGNjLnZ2LnVzZXJNZ3IudXNlcklkKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXNPdmVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNxX2RhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhLmVycm1zZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImxvZ2luX2ZpbmlzaGVkXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJsb2dpbl9maW5pc2hlZFwiKTtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiZG5nYW1lXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZXhpdF9yZXN1bHRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbV90eXBlID0gLTE7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IC0xO1xyXG4gICAgICAgICAgICAvLyBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8v54m55q6K5oOF5Ya15LiL77yI6ZSm5qCH6LWb562J77yJ5Y+v5Lul6K6+572u6L+Z6YeM55qEZGF0Ye+8jOWcqOmAgOWHuueahOaXtuWAmei/m+ihjOaTjeS9nFxyXG4gICAgICAgICAgICAgICAgc2VsZi5hY3Rpb25EYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZXhpdF9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhO1xyXG4gICAgICAgICAgICB2YXIgcyA9IHNlbGYuZ2V0U2VhdEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgaWYgKHMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcy51c2VyaWQgPSAwO1xyXG4gICAgICAgICAgICAgICAgcy5uYW1lID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInVzZXJfc3RhdGVfY2hhbmdlZFwiLCBzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiY2hhdF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiY2hhdF9wdXNoXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwicXVpY2tfY2hhdF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwicXVpY2tfY2hhdF9wdXNoXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZW1vamlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImVtb2ppX3B1c2hcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJub3RfZXhpdF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwibm90X2V4aXRcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjb3VudF9kb3duX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJjb3VudF9kb3duXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibWF0Y2hfZXhpdF9lcnJvclwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnbWF0Y2hfZXhpdF9lcnJvcicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZGlzcHJlc3NfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYucm9vbUlkID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgc2VsZi50dXJuID0gLTE7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZGlzY29ubmVjdFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBhY3Rpb25EYXRhID0gc2VsZi5hY3Rpb25EYXRhO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJleGl0X3Jvb21cIik7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLnJvb21JZCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb25EYXRhLm1zZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIGFjdGlvbkRhdGEubXNnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hY3Rpb25EYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibmV3aGFsbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBhY3Rpb25EYXRhLmRlbGF5ICogMTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld2hhbGxcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21fdHlwZSA9IC0xO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaXNPdmVyID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5vbGRSb29tSWQgPSBzZWxmLnJvb21JZDtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJkaXNjb25uZWN0XCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOaWsOS6uuWKoOWFpeaIv+mXtFxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibmV3X3VzZXJfY29tZXNfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBkYXRhLnNlYXRpbmRleDtcclxuICAgICAgICAgICAgaWYgKHNlbGYuc2VhdHNbc2VhdEluZGV4XS51c2VyaWQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzW3NlYXRJbmRleF0ub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbc2VhdEluZGV4XSA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCduZXdfdXNlcicsIHNlbGYuc2VhdHNbc2VhdEluZGV4XSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/muLjmiI/liJ3lp4vljJYgXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2luaXRJbmZvX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZ2FtZUluZm8gPSBkYXRhLmdhbWVJbmZvO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfaW5pdCcsIGdhbWVJbmZvKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfYmVnaW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2JlZ2luJywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2JfT25lUXpFbmRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnc2hvd19xaWFuZycsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV96aHVhbmdTZWxlY3RlZF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfemh1YW5nU2VsZWN0ZWQnLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbXlYekJlZ2luX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9teVh6QmVnaW4nLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbXlIb2xkc1VwZGF0ZV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfbXlIb2xkc1VwZGF0ZScsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9teVh6RW5kX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9teVh6RW5kJywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2JfT25lWHpFbmRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnc2hvd19iZWlTaHVUZXh0JywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2JfT25lU25FbmRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9iX09uZVNuRW5kJywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3Nob3dBbGxVc2VyX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9zaG93QWxsVXNlcicsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxufSkiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIF9jaGF0Um9vdDogbnVsbCxcclxuICAgICAgICBfdGFiUXVpY2s6IG51bGwsXHJcbiAgICAgICAgX3RhYkVtb2ppOiBudWxsLFxyXG4gICAgICAgIF9pcHRDaGF0OiBudWxsLFxyXG4gICAgICAgIF9xdWlja0NoYXRJbmZvOiBudWxsLFxyXG4gICAgICAgIF9idG5DaGF0OiBudWxsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2LnpqaGNoYXQgPSB0aGlzO1xyXG4gICAgICAgIC8vIHRoaXMuX2J0bkNoYXQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ4aW54aVwiKTtcclxuICAgICAgICAvLyB0aGlzLl9idG5DaGF0LmFjdGl2ZSA9IGNjLnZ2LnJlcGxheU1nci5pc1JlcGxheSgpID09IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY2hhdFwiKTtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl90YWJRdWljayA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwicXVpY2tjaGF0bGlzdFwiKTtcclxuICAgICAgICB0aGlzLl90YWJFbW9qaSA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwiZW1vamlzXCIpO1xyXG4gICAgICAgIHRoaXMuX2lwdENoYXQgPSB0aGlzLl9jaGF0Um9vdC5nZXRDaGlsZEJ5TmFtZShcImlwdENoYXRcIikuZ2V0Q29tcG9uZW50KGNjLkVkaXRCb3gpO1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm8gPSB7fTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTBcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiAwLFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuW/q+eCueWViu+8jOmDveetieWIsOaIkeiKseWEv+mDveiwouiwouS6hu+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzEubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtMVwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDEsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5oCO5LmI5Y+I5pat57q/5LqG77yM572R57uc5oCO5LmI6L+Z5LmI5beu5ZWK77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfMi5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW0yXCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogMixcclxuICAgICAgICAgICAgY29udGVudDogXCLkuI3opoHotbDvvIzlhrPmiJjliLDlpKnkuq7vvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ18zLm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTNcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiAzLFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuS9oOeahOeJjOaJk+W+l+S5n+WkquWlveS6hu+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzQubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtNFwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDQsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5L2g5piv5aa55aa56L+Y5piv5ZOl5ZOl5ZWK77yfXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfNS5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW01XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogNSxcclxuICAgICAgICAgICAgY29udGVudDogXCLlkozkvaDlkIjkvZznnJ/mmK/lpKrmhInlv6vkuobvvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ182Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTZcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiA2LFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuWkp+WutuWlve+8jOW+iOmrmOWFtOingeWIsOWQhOS9je+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzcubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtN1wiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDcsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5ZCE5L2N77yM55yf5piv5LiN5aW95oSP5oCd77yM5oiR5b6X56a75byA5LiA5Lya5YS/44CCXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfOC5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW04XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogOCxcclxuICAgICAgICAgICAgY29udGVudDogXCLkuI3opoHlkLXkuobvvIzkuJPlv4PnjqnmuLjmiI/lkKfvvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ185Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcbiAgICBnZXRRdWlja0NoYXRJbmZvKGluZGV4KSB7XHJcbiAgICAgICAgdmFyIGtleSA9IFwiaXRlbVwiICsgaW5kZXg7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1aWNrQ2hhdEluZm9ba2V5XTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNoYXRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIG9uQmdDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBvblRhYkNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwidGFiUXVpY2tcIikge1xyXG4gICAgICAgICAgICB0aGlzLl90YWJRdWljay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl90YWJFbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwidGFiRW1vamlcIikge1xyXG4gICAgICAgICAgICB0aGlzLl90YWJRdWljay5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fdGFiRW1vamkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25RdWlja0NoYXRJdGVtQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX3F1aWNrQ2hhdEluZm9bZXZlbnQudGFyZ2V0Lm5hbWVdO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwicXVpY2tfY2hhdFwiLCBpbmZvLmluZGV4KTtcclxuICAgIH0sXHJcbiAgICBvbkVtb2ppSXRlbUNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0Lm5hbWUpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZW1vamlcIiwgZXZlbnQudGFyZ2V0Lm5hbWUpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuU2VuZENoYXRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9jaGF0Um9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5faXB0Q2hhdC5zdHJpbmcgPT0gXCJcIikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiY2hhdFwiLCB0aGlzLl9pcHRDaGF0LnN0cmluZyk7XHJcbiAgICAgICAgdGhpcy5faXB0Q2hhdC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHNlYXRJbmRleDogLTEsXHJcbiAgICAgICAgc2VhdHM6IG51bGwsXHJcbiAgICAgICAgdHVybjogLTEsXHJcbiAgICAgICAgYnV0dG9uOiAtMSxcclxuICAgICAgICBjaHU6IC0xLFxyXG4gICAgICAgIG1heE51bU9mR2FtZXM6IDAsXHJcbiAgICAgICAgbnVtT2ZHYW1lczogMCxcclxuICAgICAgICBpc092ZXI6IGZhbHNlLFxyXG4gICAgICAgIGNvbnN1bWVfbnVtOiAwLFxyXG4gICAgfSxcclxuICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnR1cm4gPSAtMTtcclxuICAgICAgICB0aGlzLmNodSA9IC0xO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uID0gLTE7XHJcbiAgICAgICAgdGhpcy5jdXJhY3Rpb24gPSBudWxsO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLm9wID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS5yZWFkeSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjbGVhcjogZnVuY3Rpb24oKSB7fSxcclxuICAgIGdldFNlYXRJbmRleEJ5SUQ6IGZ1bmN0aW9uKHVzZXJJZCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgcyA9IHRoaXMuc2VhdHNbaV07XHJcbiAgICAgICAgICAgIGlmIChzLnVzZXJpZCA9PSB1c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH0sXHJcbiAgICBpc093bmVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWF0SW5kZXggPT0gMDtcclxuICAgIH0sXHJcbiAgICBnZXRTZWF0QnlJRDogZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHNlYXRJbmRleCA9IHRoaXMuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgIHZhciBzZWF0ID0gdGhpcy5zZWF0c1tzZWF0SW5kZXhdO1xyXG4gICAgICAgIHJldHVybiBzZWF0O1xyXG4gICAgfSxcclxuICAgIGdldFNlbGZEYXRhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWF0c1t0aGlzLnNlYXRJbmRleF07XHJcbiAgICB9LFxyXG4gICAgZ2V0TG9jYWxJbmRleDogZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICB2YXIgcmV0ID0gKGluZGV4IC0gdGhpcy5zZWF0SW5kZXggKyA1KSAlIDU7XHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgIH0sXHJcbiAgICBnZXRMb2NhbEluZGV4QnlVc2VySWQ6IGZ1bmN0aW9uKHVzZXJJZCkge1xyXG4gICAgICAgIHZhciBzZWF0SW5kZXggPSB0aGlzLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcclxuICAgICAgICB2YXIgcmV0ID0gdGhpcy5nZXRMb2NhbEluZGV4KHNlYXRJbmRleCk7XHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgIH0sXHJcbiAgICBkaXNwYXRjaEV2ZW50OiBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGFFdmVudEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhRXZlbnRIYW5kbGVyLmVtaXQoZXZlbnQsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0SGFuZGxlcnM6IGZ1bmN0aW9uKEdhbWVOZXQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJsb2dpbl9yZXN1bHRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5lcnJjb2RlID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkID0gZGF0YS5yb29taWQ7XHJcbiAgICAgICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLnJvb21fdHlwZSA9IGRhdGEuY29uZi5yb29tX3R5cGU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm1heE51bU9mR2FtZXMgPSBkYXRhLmNvbmYubWF4R2FtZXM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm51bU9mR2FtZXMgPSBkYXRhLm51bW9mZ2FtZXM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzID0gZGF0YS5zZWF0cztcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdEluZGV4ID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKGNjLnZ2LnVzZXJNZ3IudXNlcklkKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXNPdmVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNvbnN1bWVfbnVtID0gZGF0YS5zY2VuZS5jb25zdW1lX251bSA/IGRhdGEuc2NlbmUuY29uc3VtZV9udW0gOiA1MDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEuZXJybXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibG9naW5fZmluaXNoZWRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJkenBrZ2FtZVwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcInNvY2tldF9NeUhvbGRzXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJzb2NrZXRfTXlIb2xkc1wiLCBkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiY291bnRfZG93bl9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiY291bnRfZG93blwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfYmVnaW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfYmVnaW5cIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2RpQ2hpVXBkYXRlX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX2RpQ2hpVXBkYXRlXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9teUluZm9fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5nZXRTZWF0QnlJRChkYXRhLnVzZXJpZCk7XHJcbiAgICAgICAgICAgIHNlYXQuc2NvcmUgPSBkYXRhLm1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX215SW5mb1wiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbXlUdXJuX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX215VHVyblwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfb25lQ2xpY2tHdW9fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfb25lR3VvXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9vbmVHZW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5nZXRTZWF0QnlJRChkYXRhLnVzZXJpZCk7XHJcbiAgICAgICAgICAgIHNlYXQuc2NvcmUgPSBkYXRhLm1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX29uZUdlblwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfb25lQWxsSW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5nZXRTZWF0QnlJRChkYXRhLnVzZXJpZCk7XHJcbiAgICAgICAgICAgIHNlYXQuc2NvcmUgPSBkYXRhLm1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX29uZUFsbEluXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9vbmVRdWl0X3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX29uZVF1aXRcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3BsYXllcnNJbk5ld0NpcmNsZV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZ2FtZV9wbGF5ZXJzSW5OZXdDaXJjbGVcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX25ld0NpcmNsZV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZ2FtZV9uZXdDaXJjbGVcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3R1cm5DaGFuZ2VkX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoY2MudnYudXNlck1nci51c2VySWQgIT0gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZ2FtZV90dXJuQ2hhbmdlZFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9jYWN1bGF0ZVJlc3VsdF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2MudnYudXNlck1nci51c2VySWQgPT0gZGF0YVtpXS51c2VyaWQgJiYgZGF0YVtpXS5pc1dpbm5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfd2lubmVyXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjYy52di51c2VyTWdyLnVzZXJJZCA9PSBkYXRhW2ldLnVzZXJpZCAmJiAhZGF0YVtpXS5pc1dpbm5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfbG9zZXJcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfY2FjdWxhdGVSZXN1bHRcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX215QVJHU3RhdHVzQ2hhbmdlZF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZ2FtZV9teUFSR1N0YXR1c0NoYW5nZWRcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX292ZXJcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJnYW1lX292ZXJcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2dhbWVJbmZvQnlJZF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfZ2FtZUluZm9CeUlkXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV91c2VySW5mb0J5SWRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfdXNlckluZm9CeUlkXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9hbGxHdW9fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImdhbWVfYWxsR3VvXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZXhpdF9yZXN1bHRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IC0xO1xyXG4gICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZXhpdF9yZXN1bHRcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJleGl0X25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGE7XHJcbiAgICAgICAgICAgIHZhciBzID0gc2VsZi5nZXRTZWF0QnlJRCh1c2VySWQpO1xyXG4gICAgICAgICAgICBpZiAocyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBzLnVzZXJpZCA9IDA7XHJcbiAgICAgICAgICAgICAgICBzLm5hbWUgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwidXNlcl9zdGF0ZV9jaGFuZ2VkXCIsIHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJkaXNwcmVzc19wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBudWxsO1xyXG4gICAgICAgICAgICBzZWxmLnR1cm4gPSAtMTtcclxuICAgICAgICAgICAgc2VsZi5zZWF0cyA9IG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJkaXNjb25uZWN0XCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZXhpdF9yb29tXCIpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5yb29tSWQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibmV3aGFsbFwiKTtcclxuICAgICAgICAgICAgICAgIHNlbGYucm9vbV90eXBlID0gLTE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5pc092ZXIgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLm9sZFJvb21JZCA9IHNlbGYucm9vbUlkO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImRpc2Nvbm5lY3RcIik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucm9vbUlkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb21fdHlwZSA9IC0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJjaGF0X3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJjaGF0X3B1c2hcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJxdWlja19jaGF0X3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJxdWlja19jaGF0X3B1c2hcIiwgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJlbW9qaV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZW1vamlfcHVzaFwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDmlrDkurrliqDlhaXmiL/pl7RcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcIm5ld191c2VyX2NvbWVzX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgc2VhdEluZGV4ID0gZGF0YS5zZWF0aW5kZXg7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLnNlYXRzW3NlYXRJbmRleF0udXNlcmlkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0c1tzZWF0SW5kZXhdLm9ubGluZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzW3NlYXRJbmRleF0ucmVhZHkgPSBkYXRhLnJlYWR5O1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0c1tzZWF0SW5kZXhdLnNjb3JlID0gZGF0YS5zY29yZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbc2VhdEluZGV4XS5zdGF0dXMgPSBkYXRhLnN0YXR1cztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbc2VhdEluZGV4XSA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCduZXdfdXNlcicsIHNlbGYuc2VhdHNbc2VhdEluZGV4XSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0pIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBfZm9sZHM6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0VmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdEV2ZW50SGFuZGxlcigpO1xyXG4gICAgICAgIHRoaXMuaW5pdEFsbEZvbGRzKCk7XHJcbiAgICB9LFxyXG4gICAgaW5pdFZpZXc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2ZvbGRzID0ge307XHJcbiAgICAgICAgdmFyIGdhbWUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xyXG4gICAgICAgIHZhciBzaWRlcyA9IFtcIm15c2VsZlwiLCBcInJpZ2h0XCIsIFwidXBcIiwgXCJsZWZ0XCJdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2lkZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHNpZGVOYW1lID0gc2lkZXNbaV07XHJcbiAgICAgICAgICAgIHZhciBzaWRlUm9vdCA9IGdhbWUuZ2V0Q2hpbGRCeU5hbWUoc2lkZU5hbWUpO1xyXG4gICAgICAgICAgICB2YXIgZm9sZHMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIGZvbGRSb290ID0gc2lkZVJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJmb2xkc1wiKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBmb2xkUm9vdC5jaGlsZHJlbi5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBmb2xkUm9vdC5jaGlsZHJlbltqXTtcclxuICAgICAgICAgICAgICAgIG4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBmb2xkcy5wdXNoKHNwcml0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fZm9sZHNbc2lkZU5hbWVdID0gZm9sZHM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlkZUFsbEZvbGRzKCk7XHJcbiAgICB9LFxyXG4gICAgaGlkZUFsbEZvbGRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMuX2ZvbGRzKSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gdGhpcy5fZm9sZHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZikge1xyXG4gICAgICAgICAgICAgICAgZltpXS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRFdmVudEhhbmRsZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfYmVnaW4nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdEFsbEZvbGRzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX3N5bmMnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdEFsbEZvbGRzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2NodXBhaV9ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdEZvbGRzKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2d1b19ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdEZvbGRzKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBpbml0QWxsRm9sZHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWF0cyA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHM7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWF0cykge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRGb2xkcyhzZWF0c1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRGb2xkczogZnVuY3Rpb24oc2VhdERhdGEpIHtcclxuICAgICAgICB2YXIgZm9sZHMgPSBzZWF0RGF0YS5mb2xkcztcclxuICAgICAgICBpZiAoZm9sZHMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XHJcbiAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcclxuICAgICAgICB2YXIgc2lkZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U2lkZShsb2NhbEluZGV4KTtcclxuICAgICAgICB2YXIgZm9sZHNTcHJpdGVzID0gdGhpcy5fZm9sZHNbc2lkZV07XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmb2xkcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBpO1xyXG4gICAgICAgICAgICBpZiAoc2lkZSA9PSBcInJpZ2h0XCIgfHwgc2lkZSA9PSBcInVwXCIpIHtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gZm9sZHNTcHJpdGVzLmxlbmd0aCAtIGkgLSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBmb2xkc1Nwcml0ZXNbaW5kZXhdO1xyXG4gICAgICAgICAgICB0aGlzLnNldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgc3ByaXRlLCBmb2xkc1tpXSk7XHJcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwibXlzZWxmXCIgJiYgaSA9PSBmb2xkcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAvL+WmguaenOaYr+acgOWQjuS4gOS4qlxyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldF9ub2RlID0gc3ByaXRlLm5vZGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2xkX3ggPSB0YXJnZXRfbm9kZS54O1xyXG4gICAgICAgICAgICAgICAgdmFyIG9sZF95ID0gdGFyZ2V0X25vZGUueTtcclxuICAgICAgICAgICAgICAgIHZhciBwb3MgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogMCxcclxuICAgICAgICAgICAgICAgICAgICB5OiAwXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvbGRzX2RpZmZfeCA9IGNjLmZpbmQoXCJDYW52YXMvZ2FtZS9teXNlbGYvZm9sZHNcIikueDtcclxuICAgICAgICAgICAgICAgIGlmIChwb3MpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRfbm9kZS54ID0gcG9zLnggLyAwLjggLSBmb2xkc19kaWZmX3ggLyAwLjg7IC8v56e75Yiw5Ye654mM5L2N572uXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X25vZGUueSA9IDcwO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5tb3ZlVG8oMC4yLCBjYy5wKG9sZF94LCBvbGRfeSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldF9ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gZm9sZHMubGVuZ3RoOyBpIDwgZm9sZHNTcHJpdGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwicmlnaHRcIiB8fCBzaWRlID09IFwidXBcIikge1xyXG4gICAgICAgICAgICAgICAgaW5kZXggPSBmb2xkc1Nwcml0ZXMubGVuZ3RoIC0gaSAtIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IGZvbGRzU3ByaXRlc1tpbmRleF07XHJcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHNwcml0ZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRTcHJpdGVGcmFtZUJ5TUpJRDogZnVuY3Rpb24ocHJlLCBzcHJpdGUsIG1qaWQpIHtcclxuICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgbWppZCk7XHJcbiAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuICAgIC8vIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBkYXRhRXZlbnRIYW5kbGVyOiBudWxsLFxyXG4gICAgICAgIGNxRXZlbnRIYW5kbGVyOiBudWxsLFxyXG4gICAgICAgIHJvb21JZDogbnVsbCxcclxuICAgICAgICBtYXhOdW1PZkdhbWVzOiAwLFxyXG4gICAgICAgIG51bU9mR2FtZXM6IDAsXHJcbiAgICAgICAgbnVtT2ZNSjogMCxcclxuICAgICAgICBzZWF0SW5kZXg6IC0xLFxyXG4gICAgICAgIHNlYXRzOiBudWxsLFxyXG4gICAgICAgIHR1cm46IC0xLFxyXG4gICAgICAgIGJ1dHRvbjogLTEsXHJcbiAgICAgICAgY2h1cGFpOiAtMSxcclxuICAgICAgICBnYW1lc3RhdGU6IFwiXCIsXHJcbiAgICAgICAgaXNPdmVyOiBmYWxzZSxcclxuICAgICAgICBkaXNzb3ZlRGF0YTogbnVsbCxcclxuICAgICAgICByb29tX3R5cGU6IC0xLFxyXG4gICAgICAgIGNxX2RhdGE6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMudHVybiA9IC0xO1xyXG4gICAgICAgIHRoaXMuY2h1cGFpID0gLTE7XHJcbiAgICAgICAgdGhpcy5idXR0b24gPSAtMTtcclxuICAgICAgICB0aGlzLmdhbWVzdGF0ZSA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5jdXJhY3Rpb24gPSBudWxsO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmhvbGRzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuc2VhdHNbaV0uZm9sZHMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS5wZW5ncyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmNhaVNoZW4gPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS5jaGlzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuc2VhdHNbaV0uYW5nYW5ncyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLmRpYW5nYW5ncyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXRzW2ldLndhbmdhbmdzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuc2VhdHNbaV0ucmVhZHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5zZWF0c1tpXS5odWVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuc2VhdHNbaV0udGluZ2VkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmRhdGFFdmVudEhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY3FFdmVudEhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmlzT3ZlciA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VhdHMgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMucm9vbV90eXBlID0gLTE7XHJcbiAgICAgICAgICAgIHRoaXMubWF4TnVtT2ZHYW1lcyA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubnVtT2ZHYW1lcyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICBpZiAoZXZlbnQgPT0gJ3Rlc3QnKSBjb25zb2xlLmxvZyh0aGlzLmRhdGFFdmVudEhhbmRsZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGFFdmVudEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhRXZlbnRIYW5kbGVyLmVtaXQoZXZlbnQsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjcURpc3BhdGNoRXZlbnQoZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICBpZiAodGhpcy5jcUV2ZW50SGFuZGxlcikge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnY3FEaXNwYXRjaEV2ZW50JyxkYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5jcUV2ZW50SGFuZGxlci5lbWl0KGV2ZW50LCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0U2VhdEluZGV4QnlJRDogZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VhdHMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNlYXRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHRoaXMuc2VhdHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAocy51c2VyaWQgPT0gdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH0sXHJcbiAgICBpc093bmVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWF0SW5kZXggPT0gMDtcclxuICAgIH0sXHJcbiAgICBnZXRTZWF0QnlJRDogZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHNlYXRJbmRleCA9IHRoaXMuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgIHZhciBzZWF0ID0gdGhpcy5zZWF0c1tzZWF0SW5kZXhdO1xyXG4gICAgICAgIHJldHVybiBzZWF0O1xyXG4gICAgfSxcclxuICAgIGdldFNlbGZEYXRhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWF0c1t0aGlzLnNlYXRJbmRleF07XHJcbiAgICB9LFxyXG4gICAgZ2V0TG9jYWxJbmRleDogZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICB2YXIgcmV0ID0gKGluZGV4IC0gdGhpcy5zZWF0SW5kZXggKyA0KSAlIDQ7XHJcbiAgICAgICAgcmV0dXJuIHJldDtcclxuICAgIH0sXHJcbiAgICBnZXRMb2NhbEluZGV4WkpIOiBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgICAgIHZhciByZXQgPSAoaW5kZXggLSB0aGlzLnNlYXRJbmRleCArIDUpICUgNTtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfSxcclxuICAgIGdldExvY2FsSW5kZXhCeVVzZXJJZFpKSDogZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgdmFyIHNlYXRJbmRleCA9IHRoaXMuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgIHZhciByZXQgPSB0aGlzLmdldExvY2FsSW5kZXhaSkgoc2VhdEluZGV4KTtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfSxcclxuICAgIHByZXBhcmVSZXBsYXk6IGZ1bmN0aW9uKHJvb21JbmZvLCBkZXRhaWxPZkdhbWUpIHtcclxuICAgICAgICB0aGlzLnJvb21JZCA9IHJvb21JbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuc2VhdHMgPSByb29tSW5mby5zZWF0cztcclxuICAgICAgICB0aGlzLnR1cm4gPSBkZXRhaWxPZkdhbWUuYmFzZV9pbmZvLmJ1dHRvbjtcclxuICAgICAgICB0aGlzLnJvb21fdHlwZSA9IDA7XHJcbiAgICAgICAgdmFyIGJhc2VJbmZvID0gZGV0YWlsT2ZHYW1lLmJhc2VfaW5mbztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VhdHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHMgPSB0aGlzLnNlYXRzW2ldO1xyXG4gICAgICAgICAgICBzLnNlYXRpbmRleCA9IGk7XHJcbiAgICAgICAgICAgIHMuc2NvcmUgPSBudWxsO1xyXG4gICAgICAgICAgICBzLmhvbGRzID0gYmFzZUluZm8uZ2FtZV9zZWF0c1tpXTtcclxuICAgICAgICAgICAgcy5wZW5ncyA9IFtdO1xyXG4gICAgICAgICAgICBzLmNhaVNoZW4gPSBbXTtcclxuICAgICAgICAgICAgcy5jaGlzID0gW107XHJcbiAgICAgICAgICAgIHMuZXh0cmFQYWlzID0gW107XHJcbiAgICAgICAgICAgIHMuYW5nYW5ncyA9IFtdO1xyXG4gICAgICAgICAgICBzLmRpYW5nYW5ncyA9IFtdO1xyXG4gICAgICAgICAgICBzLndhbmdhbmdzID0gW107XHJcbiAgICAgICAgICAgIHMuZm9sZHMgPSBbXTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocyk7XHJcbiAgICAgICAgICAgIGlmIChjYy52di51c2VyTWdyLnVzZXJJZCA9PSBzLnVzZXJpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWF0SW5kZXggPSBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29uZiA9IHtcclxuICAgICAgICAgICAgdHlwZTogYmFzZUluZm8udHlwZSxcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY29uZi50eXBlID09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25mLnR5cGUgPT0gXCJ5a3hcIjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0V2FuZmE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjb25mID0gdGhpcy5jb25mO1xyXG4gICAgICAgIGlmIChjb25mKSB7XHJcbiAgICAgICAgICAgIHZhciBzdHJBcnIgPSBbXTtcclxuICAgICAgICAgICAgaWYgKGNvbmYubWF4R2FtZXMpIHtcclxuICAgICAgICAgICAgICAgIHN0ckFyci5wdXNoKGNvbmYubWF4R2FtZXMgKyBcIuWxgFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29uZi5iYXNlU2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIHN0ckFyci5wdXNoKFwiIOW6leWIhjpcIiArIGNvbmYuYmFzZVNjb3JlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29uZi55aXBhb2R1b3hpYW5nID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHN0ckFyci5wdXNoKFwiIOS4gOeCruWkmuWTjVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gc3RyQXJyLmpvaW4oXCIgXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH0sXHJcbiAgICByZXF1aXJlQnlHYW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyB2YXIgZ2FtZUhhbmRsZXIgPSByZXF1aXJlKCcnKTtcclxuICAgICAgICAvLyBnYW1lSGFuZGxlci5pbml0RXZlbnRzKCk7XHJcbiAgICB9LFxyXG4gICAgaW5pdEhhbmRsZXJzOiBmdW5jdGlvbih0eXBlKSB7XHJcbiAgICAgICAgY2MudnYubmV0LmhhbmRsZXJzID0ge307XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0O1xyXG4gICAgICAgIGlmICh0eXBlID09IDIpIHtcclxuICAgICAgICAgICAgdCA9IHJlcXVpcmUoJ1pqaE5ldE1ncicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgIHQgPSByZXF1aXJlKCdDcU5ldE1ncicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAwKSB7XHJcbiAgICAgICAgICAgIHQgPSByZXF1aXJlKCdNak5ldE1ncicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAzKSB7XHJcbiAgICAgICAgICAgIHQgPSByZXF1aXJlKCdEbk5ldE1ncicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSA0KSB7XHJcbiAgICAgICAgICAgIHQgPSByZXF1aXJlKCdEenBrTmV0TWdyJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDEwMCkge1xyXG4gICAgICAgICAgICB0ID0gcmVxdWlyZSgnSmJzTmV0TWdyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2Lk5ldE1nciA9IG5ldyB0KCk7XHJcbiAgICAgICAgY2MudnYuTmV0TWdyLmluaXRIYW5kbGVycyhzZWxmKTtcclxuICAgIH0sXHJcbiAgICBkb0d1bzogZnVuY3Rpb24oc2VhdEluZGV4LCBwYWkpIHtcclxuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XHJcbiAgICAgICAgdmFyIGZvbGRzID0gc2VhdERhdGEuZm9sZHM7XHJcbiAgICAgICAgaWYgKGZvbGRzKSB7XHJcbiAgICAgICAgICAgIGZvbGRzLnB1c2gocGFpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdndW9fbm90aWZ5Jywgc2VhdERhdGEpO1xyXG4gICAgfSxcclxuICAgIGRvTW9wYWk6IGZ1bmN0aW9uKHNlYXRJbmRleCwgcGFpKSB7XHJcbiAgICAgICAgdmFyIHNlYXREYXRhID0gdGhpcy5zZWF0c1tzZWF0SW5kZXhdO1xyXG4gICAgICAgIGlmIChzZWF0RGF0YS5ob2xkcykge1xyXG4gICAgICAgICAgICBzZWF0RGF0YS5ob2xkcy5wdXNoKHBhaSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ2FtZV9tb3BhaScsIHtcclxuICAgICAgICAgICAgICAgIHNlYXRJbmRleDogc2VhdEluZGV4LFxyXG4gICAgICAgICAgICAgICAgcGFpOiBwYWlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGRvQ2h1cGFpOiBmdW5jdGlvbihzZWF0SW5kZXgsIHBhaSkge1xyXG4gICAgICAgIHRoaXMuY2h1cGFpID0gcGFpO1xyXG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHRoaXMuc2VhdHNbc2VhdEluZGV4XTtcclxuICAgICAgICBpZiAoc2VhdERhdGEuaG9sZHMpIHtcclxuICAgICAgICAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YocGFpKTtcclxuICAgICAgICAgICAgc2VhdERhdGEuaG9sZHMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ2FtZV9jaHVwYWlfbm90aWZ5Jywge1xyXG4gICAgICAgICAgICBzZWF0RGF0YTogc2VhdERhdGEsXHJcbiAgICAgICAgICAgIHBhaTogcGFpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgZG9QZW5nOiBmdW5jdGlvbihzZWF0SW5kZXgsIHBhaSwgZXh0cmFQZW5nUGFpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJkb1BlbmdcIiwgZXh0cmFQZW5nUGFpKTtcclxuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XHJcbiAgICAgICAgLy/np7vpmaTmiYvniYxcclxuICAgICAgICBpZiAoc2VhdERhdGEuaG9sZHMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZHggPSBzZWF0RGF0YS5ob2xkcy5pbmRleE9mKHBhaSk7XHJcbiAgICAgICAgICAgICAgICBzZWF0RGF0YS5ob2xkcy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvL+abtOaWsOeisOeJjOaVsOaNrlxyXG4gICAgICAgIHZhciBwZW5ncyA9IHNlYXREYXRhLnBlbmdzO1xyXG4gICAgICAgIHBlbmdzLnB1c2gocGFpKTtcclxuICAgICAgICBpZiAoZXh0cmFQZW5nUGFpICE9IG51bGwgJiYgZXh0cmFQZW5nUGFpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgc2VhdERhdGEuZXh0cmFQYWlzID0gZXh0cmFQZW5nUGFpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCLnjqnlrrbnmoTmiYvkuK3lpJrkvZnnmoTniYzmmK9cIiwgc2VhdERhdGEuZXh0cmFQYWlzKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdwZW5nX25vdGlmeScsIHNlYXREYXRhKTtcclxuICAgIH0sXHJcbiAgICBkb0NoaTogZnVuY3Rpb24oc2VhdEluZGV4LCBwYWksIGNoaUFycmF5LCBleHRyYVBhaSkge1xyXG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHRoaXMuc2VhdHNbc2VhdEluZGV4XTtcclxuICAgICAgICAvL+enu+mZpOaJi+eJjFxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwi5ZCD54mM5Zue5o6J5Ye95pWwXCIpO1xyXG4gICAgICAgIGlmIChzZWF0RGF0YS5ob2xkcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDI7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YoY2hpQXJyYXlbaV0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlkeCAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXREYXRhLmhvbGRzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjaGlzID0gc2VhdERhdGEuY2hpcztcclxuICAgICAgICAgICAgY2hpQXJyYXkucHVzaChwYWkpO1xyXG4gICAgICAgICAgICBjaGlBcnJheS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhIC0gYjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNoaXMucHVzaChjaGlBcnJheSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChleHRyYVBhaSAhPSBudWxsICYmIGV4dHJhUGFpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgc2VhdERhdGEuZXh0cmFQYWlzID0gZXh0cmFQYWk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnY2hpX25vdGlmeScsIHNlYXREYXRhKTtcclxuICAgIH0sXHJcbiAgICBnZXRHYW5nVHlwZTogZnVuY3Rpb24oc2VhdERhdGEsIHBhaSkge1xyXG4gICAgICAgIGlmIChzZWF0RGF0YS5wZW5ncy5pbmRleE9mKHBhaSkgIT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwid2FuZ2FuZ1wiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBjbnQgPSAwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXREYXRhLmhvbGRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VhdERhdGEuaG9sZHNbaV0gPT0gcGFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY250Kys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNudCA9PSAzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJkaWFuZ2FuZ1wiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYW5nYW5nXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZG9HYW5nOiBmdW5jdGlvbihzZWF0SW5kZXgsIHBhaSwgZ2FuZ3R5cGUpIHtcclxuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XHJcbiAgICAgICAgaWYgKCFnYW5ndHlwZSkge1xyXG4gICAgICAgICAgICBnYW5ndHlwZSA9IHRoaXMuZ2V0R2FuZ1R5cGUoc2VhdERhdGEsIHBhaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChnYW5ndHlwZSA9PSBcIndhbmdhbmdcIikge1xyXG4gICAgICAgICAgICBpZiAoc2VhdERhdGEucGVuZ3MuaW5kZXhPZihwYWkpICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gc2VhdERhdGEucGVuZ3MuaW5kZXhPZihwYWkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlkeCAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlYXREYXRhLnBlbmdzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlYXREYXRhLndhbmdhbmdzLnB1c2gocGFpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlYXREYXRhLmhvbGRzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IDQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9IHNlYXREYXRhLmhvbGRzLmluZGV4T2YocGFpKTtcclxuICAgICAgICAgICAgICAgIGlmIChpZHggPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+WmguaenOayoeacieaJvuWIsO+8jOihqOekuuenu+WujOS6hu+8jOebtOaOpei3s+WHuuW+queOr1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VhdERhdGEuaG9sZHMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGdhbmd0eXBlID09IFwiYW5nYW5nXCIpIHtcclxuICAgICAgICAgICAgaWYgKCFzZWF0RGF0YS5hbmdhbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBzZWF0RGF0YS5hbmdhbmdzID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VhdERhdGEuYW5nYW5ncy5wdXNoKHBhaSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChnYW5ndHlwZSA9PSBcImRpYW5nYW5nXCIpIHtcclxuICAgICAgICAgICAgaWYgKCFzZWF0RGF0YS5kaWFuZ2FuZ3MpIHtcclxuICAgICAgICAgICAgICAgIHNlYXREYXRhLmRpYW5nYW5ncyA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlYXREYXRhLmRpYW5nYW5ncy5wdXNoKHBhaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCgnZ2FuZ19ub3RpZnknLCB7XHJcbiAgICAgICAgICAgIHNlYXREYXRhOiBzZWF0RGF0YSxcclxuICAgICAgICAgICAgZ2FuZ3R5cGU6IGdhbmd0eXBlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgLy8g6LSi56WeXHJcbiAgICBkb0NhaVNoZW46IGZ1bmN0aW9uKHNlYXRJbmRleCwgcGFpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLotKLnpZ4hZG9jYWlzaGVuXCIsIHNlYXRJbmRleCwgcGFpKTtcclxuICAgICAgICB2YXIgc2VhdERhdGEgPSB0aGlzLnNlYXRzW3NlYXRJbmRleF07XHJcbiAgICAgICAgLy8g56e76Zmk5omL54mMXHJcbiAgICAgICAgaWYgKHNlYXREYXRhLmhvbGRzKSB7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBzZWF0RGF0YS5ob2xkcy5pbmRleE9mKHBhaSk7XHJcbiAgICAgICAgICAgIHNlYXREYXRhLmhvbGRzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY2FpU2hlbiA9IHNlYXREYXRhLmNhaVNoZW47XHJcbiAgICAgICAgY2FpU2hlbi5wdXNoKHBhaSk7XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KCdnYW1lX2NhaXNoZW5fbm90aWZ5Jywgc2VhdERhdGEpO1xyXG4gICAgfSxcclxuICAgIGRvSHU6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2h1cGFpJywgZGF0YSk7XHJcbiAgICB9LFxyXG4gICAgZG9UdXJuQ2hhbmdlOiBmdW5jdGlvbihzaSkge1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBsYXN0OiB0aGlzLnR1cm4sXHJcbiAgICAgICAgICAgIHR1cm46IHNpLFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnR1cm4gPSBzaTtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoJ2dhbWVfY2h1cGFpJywgZGF0YSk7XHJcbiAgICB9LFxyXG4gICAgY29ubmVjdEdhbWVTZXJ2ZXI6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB0aGlzLmluaXRIYW5kbGVycyhjYy52di51c2VyTWdyLnJvb21fdHlwZSk7XHJcbiAgICAgICAgdGhpcy5kaXNzb3ZlRGF0YSA9IG51bGw7XHJcbiAgICAgICAgY2MudnYubmV0LmlwID0gZGF0YS5pcCArIFwiOlwiICsgZGF0YS5wb3J0O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGNjLnZ2Lm5ldC5pcCk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkNvbm5lY3RPSyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm9uQ29ubmVjdE9LXCIpO1xyXG4gICAgICAgICAgICB2YXIgc2QgPSB7XHJcbiAgICAgICAgICAgICAgICB0b2tlbjogZGF0YS50b2tlbixcclxuICAgICAgICAgICAgICAgIHJvb21pZDogZGF0YS5yb29taWQsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiBkYXRhLnRpbWUsXHJcbiAgICAgICAgICAgICAgICBzaWduOiBkYXRhLnNpZ24sXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW49PT09PT09PT09PT1cIik7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwibG9naW5cIiwgc2QpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIG9uQ29ubmVjdEZhaWxlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImZhaWxlZC5cIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2LndjLnNob3coXCLmraPlnKjov5vlhaXmiL/pl7RcIik7XHJcbiAgICAgICAgY2MudnYubmV0LmNvbm5lY3Qob25Db25uZWN0T0ssIG9uQ29ubmVjdEZhaWxlZCk7XHJcbiAgICB9LFxyXG4gICAgY29ubmVjdE1hdGNoU2VydmVyOiBmdW5jdGlvbihjb25uZWN0X2RhdGEsIG1hdGNoX2RhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0SGFuZGxlcnMoMTAwKTsgLy/plKbmoIfotZvnmoR0eXBl6K6+5Li6MTAwXHJcbiAgICAgICAgICAgIGNjLnZ2Lm1hdGNoX25ldC5pcCA9IGNvbm5lY3RfZGF0YS5pcCArIFwiOlwiICsgY29ubmVjdF9kYXRhLnBvcnQ7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIG9uQ29ubmVjdE9LID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hfZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoX2RhdGEudXNlcmlkID0gY2MudnYudXNlck1nci51c2VySWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNjLnZ2Lm1hdGNoX25ldC5zZW5kKFwibG9naW5cIiwgbWF0Y2hfZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBjYy52di53Yy5oaWRlKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBvbkNvbm5lY3RGYWlsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLms6jmhI9cIiwgXCLov5vlhaXmr5TotZvpmJ/liJflpLHotKXvvIFcIik7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjYy52di53Yy5zaG93KFwi5q2j5Zyo6L+b5YWl5q+U6LWb6Zif5YiXXCIpO1xyXG4gICAgICAgICAgICBjYy52di5tYXRjaF9uZXQuY29ubmVjdChvbkNvbm5lY3RPSywgb25Db25uZWN0RmFpbGVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgICAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgICAgIC8vIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBfZ2FtZW92ZXI6IG51bGwsXHJcbiAgICAgICAgX2dhbWVyZXN1bHQ6IG51bGwsXHJcbiAgICAgICAgX3NlYXRzOiBbXSxcclxuICAgICAgICBfaXNHYW1lRW5kOiBmYWxzZSxcclxuICAgICAgICBfcGluZ2p1OiBudWxsLFxyXG4gICAgICAgIF93aW46IG51bGwsXHJcbiAgICAgICAgX2xvc2U6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZ2FtZW92ZXIgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lX292ZXJcIik7XHJcbiAgICAgICAgdGhpcy5fZ2FtZW92ZXIuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fcGluZ2p1ID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJwaW5nanVcIik7XHJcbiAgICAgICAgdGhpcy5fd2luID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJ3aW5cIik7XHJcbiAgICAgICAgdGhpcy5fbG9zZSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwibG9zZVwiKTtcclxuICAgICAgICB0aGlzLl9saXVqdSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwiaHVhbmd6aHVhbmdcIik7XHJcbiAgICAgICAgdGhpcy5fZ2FtZXJlc3VsdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVfcmVzdWx0XCIpO1xyXG4gICAgICAgIHZhciB3YW5mYSA9IHRoaXMuX2dhbWVvdmVyLmdldENoaWxkQnlOYW1lKFwid2FuZmFcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB3YW5mYS5zdHJpbmcgPSBjYy52di5nYW1lTmV0TWdyLmdldFdhbmZhKCk7XHJcbiAgICAgICAgdmFyIGxpc3RSb290ID0gdGhpcy5fZ2FtZW92ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJyZXN1bHRfbGlzdFwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSA0OyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHMgPSBcInNcIiArIGk7XHJcbiAgICAgICAgICAgIHZhciBzbiA9IGxpc3RSb290LmdldENoaWxkQnlOYW1lKHMpO1xyXG4gICAgICAgICAgICB2YXIgdmlld2RhdGEgPSB7fTtcclxuICAgICAgICAgICAgdmlld2RhdGEudXNlcm5hbWUgPSBzbi5nZXRDaGlsZEJ5TmFtZSgndXNlcm5hbWUnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgICAgICB2aWV3ZGF0YS5yZWFzb24gPSBzbi5nZXRDaGlsZEJ5TmFtZSgncmVhc29uJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICAgICAgdmFyIGYgPSBzbi5nZXRDaGlsZEJ5TmFtZSgnZmFuJyk7XHJcbiAgICAgICAgICAgIGlmIChmICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHZpZXdkYXRhLmZhbiA9IGYuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2aWV3ZGF0YS5zY29yZSA9IHNuLmdldENoaWxkQnlOYW1lKCdzY29yZScpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgICAgIHZpZXdkYXRhLmh1ID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ2h1Jyk7XHJcbiAgICAgICAgICAgIHZpZXdkYXRhLm1haGpvbmdzID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ3BhaScpO1xyXG4gICAgICAgICAgICB2aWV3ZGF0YS56aHVhbmcgPSBzbi5nZXRDaGlsZEJ5TmFtZSgnemh1YW5nJyk7XHJcbiAgICAgICAgICAgIHZpZXdkYXRhLmh1cGFpID0gc24uZ2V0Q2hpbGRCeU5hbWUoJ2h1cGFpJyk7XHJcbiAgICAgICAgICAgIHZpZXdkYXRhLmh1YSA9IHNuLmdldENoaWxkQnlOYW1lKCdodWEnKTtcclxuICAgICAgICAgICAgdmlld2RhdGEuX3BlbmdhbmRnYW5nID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzLnB1c2godmlld2RhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WIneWni+WMlue9kee7nOS6i+S7tuebkeWQrOWZqFxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfb3ZlcicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5vbkdhbWVPdmVyKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfZW5kJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLl9pc0dhbWVFbmQgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIG9uR2FtZU92ZXIoZGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dhbWVyZXN1bHQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9nYW1lb3Zlci5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3BpbmdqdS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl93aW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbG9zZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9saXVqdS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB2YXIgbXlzY29yZSA9IGRhdGFbY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXhdLnNjb3JlO1xyXG4gICAgICAgIHZhciBpc0xpdUp1ID0gZGF0YVtjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleF0uaXNMaXVKdTtcclxuICAgICAgICBpZihpc0xpdUp1KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpdWp1LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKG15c2NvcmUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl93aW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChteXNjb3JlIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbG9zZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGluZ2p1LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy/mmL7npLrnjqnlrrbkv6Hmga9cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgc2VhdFZpZXcgPSB0aGlzLl9zZWF0c1tpXTtcclxuICAgICAgICAgICAgdmFyIHVzZXJEYXRhID0gZGF0YVtpXTtcclxuICAgICAgICAgICAgdmFyIGh1ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgLy/og6HniYznmoTnjqnlrrbmiY3mmL7npLog5piv5ZCm5riF5LiA6ImyIOaguXhu55qE5a2X5qC3XHJcbiAgICAgICAgICAgIHZhciBudW1PZkdhbmdzID0gdXNlckRhdGEuYW5nYW5ncy5sZW5ndGggKyB1c2VyRGF0YS53YW5nYW5ncy5sZW5ndGggKyB1c2VyRGF0YS5kaWFuZ2FuZ3MubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgbnVtT2ZHZW4gPSB1c2VyRGF0YS5udW1vZmdlbjtcclxuICAgICAgICAgICAgdmFyIGFjdGlvbkFyciA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgaXM3cGFpcnMgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIGlzY2hhZGFqaWFvID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdXNlckRhdGEuYWN0aW9ucy5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjID0gdXNlckRhdGEuYWN0aW9uc1tqXTtcclxuICAgICAgICAgICAgICAgIGlmIChhYy50eXBlID09IFwiemltb1wiIHx8IGFjLnR5cGUgPT0gXCJnYW5naHVhXCIgfHwgYWMudHlwZSA9PSBcImRpYW5nYW5naHVhXCIgfHwgYWMudHlwZSA9PSBcImh1XCIgfHwgYWMudHlwZSA9PSBcImdhbmdwYW9odVwiIHx8IGFjLnR5cGUgPT0gXCJxaWFuZ2dhbmdodVwiIHx8IGFjLnR5cGUgPT0gXCJjaGFkYWppYW9cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhYy50eXBlID09IFwiemltb1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi6Ieq5pG4XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImdhbmdodWFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuadoOS4iuiKsVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaHVlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJmYW5ncGFvXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuaUvueCrlwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWMudHlwZSA9PSBcImFuZ2FuZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmmpfmnaBcIik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjLnR5cGUgPT0gXCJkaWFuZ2FuZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmmI7mnaBcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGh1ZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5pc0hhb1FpRHVpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLosarkuIPlr7lcIik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCJ0aGVyaXR5XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWNgeS4ieW5ulwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnBhdHRlcm4gPT0gXCI3cGFpcnNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuS4g+WvuVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnFpbmd5aXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5riF5LiA6ImyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEubWVucWluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIumXqOa4hVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmhhaWRpaHUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmtbflupXmjZ7mnIhcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5pc0ZvdXJPbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlm5vlvZLkuIBcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS56aHVvV3VLdWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLmjYnkupTprYFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5odW55aXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5re35LiA6ImyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEuYmFaaGFuZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWFq+W8oFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmxhb1NoYW8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLogIHlsJFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS55aVRpYW9Mb25nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5LiA5p2h6b6ZXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEueGlhb0xpYW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlsI/ov55cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5kYUxpYW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLlpKfov55cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyRGF0YS5odUNudCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5Y2V5ZCKXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEueGlhb0dhbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWwj+mrmFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmRhR2FvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi5aSn6auYXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEucXVlTWVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkFyci5wdXNoKFwi57y66ZeoXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlckRhdGEua2V6aSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIuWIu1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJEYXRhLnBlbmdwZW5naHUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQXJyLnB1c2goXCLnorDnorDog6FcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsaWFuWmh1YW5nTnVtID0gcGFyc2VJbnQodXNlckRhdGEubGlhblpodWFuZ051bSkgLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsaWFuWmh1YW5nTnVtID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25BcnIucHVzaChcIui/nuW6hFwiICsgbGlhblpodWFuZ051bSArIFwi5qyhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IDM7ICsrbykge1xyXG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuaHUuY2hpbGRyZW5bb10uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9GSVhNRSDpmpDol4/nrKzlh6DkuKrog6HniYznmoRcclxuICAgICAgICAgICAgaWYgKHVzZXJEYXRhLmh1b3JkZXIgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuaHUuY2hpbGRyZW5bdXNlckRhdGEuaHVvcmRlcl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWF0Vmlldy51c2VybmFtZS5zdHJpbmcgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzW2ldLm5hbWU7XHJcbiAgICAgICAgICAgIHNlYXRWaWV3LnpodWFuZy5hY3RpdmUgPSBjYy52di5nYW1lTmV0TWdyLmJ1dHRvbiA9PSBpO1xyXG4gICAgICAgICAgICBzZWF0Vmlldy5yZWFzb24uc3RyaW5nID0gYWN0aW9uQXJyLmpvaW4oXCLjgIFcIik7XHJcbiAgICAgICAgICAgIC8v6IOh54mM55qE546p5a625omN5pyJ55WqXHJcbiAgICAgICAgICAgIHZhciBmYW4gPSAwO1xyXG4gICAgICAgICAgICBpZiAoaHVlZCkge1xyXG4gICAgICAgICAgICAgICAgZmFuID0gdXNlckRhdGEuZmFuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlYXRWaWV3LmZhbi5zdHJpbmcgPSBmYW4gKyBcIueVqlwiO1xyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICBpZiAodXNlckRhdGEuc2NvcmUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWF0Vmlldy5zY29yZS5zdHJpbmcgPSBcIitcIiArIHVzZXJEYXRhLnNjb3JlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuc2NvcmUuc3RyaW5nID0gdXNlckRhdGEuc2NvcmU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGh1cGFpID0gLTE7XHJcbiAgICAgICAgICAgIGlmIChodWVkKSB7XHJcbiAgICAgICAgICAgICAgICBodXBhaSA9IHVzZXJEYXRhLmh1cGFpO1xyXG4gICAgICAgICAgICAgICAgLy/ku47miYvniYzkuK3liZTpmaTog6HnmoTpgqPlvKDniYwgXHJcbiAgICAgICAgICAgICAgICB2YXIgaHVfaW5kZXggPSB1c2VyRGF0YS5ob2xkcy5pbmRleE9mKGh1cGFpKTtcclxuICAgICAgICAgICAgICAgIHVzZXJEYXRhLmhvbGRzLnNwbGljZShodV9pbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYubWFoam9uZ21nci5zb3J0TUoodXNlckRhdGEuaG9sZHMpO1xyXG4gICAgICAgICAgICAvL+iDoeeJjOS4jeWPguS4juaOkuW6j1xyXG4gICAgICAgICAgICBpZiAoaHVlZCkge1xyXG4gICAgICAgICAgICAgICAgdXNlckRhdGEuaG9sZHMucHVzaChodXBhaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/pmpDol4/miYDmnInniYxcclxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBzZWF0Vmlldy5tYWhqb25ncy5jaGlsZHJlbkNvdW50OyArK2spIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gc2VhdFZpZXcubWFoam9uZ3MuY2hpbGRyZW5ba107XHJcbiAgICAgICAgICAgICAgICBuLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBsYWNraW5nTnVtID0gKHVzZXJEYXRhLnBlbmdzLmxlbmd0aCArIG51bU9mR2FuZ3MgKyB1c2VyRGF0YS5jaGlzLmxlbmd0aCkgKiAzO1xyXG4gICAgICAgICAgICAvL+aYvuekuuebuOWFs+eahOeJjFxyXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHVzZXJEYXRhLmhvbGRzLmxlbmd0aDsgKytrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFpID0gdXNlckRhdGEuaG9sZHNba107XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IHNlYXRWaWV3Lm1haGpvbmdzLmNoaWxkcmVuW2sgKyBsYWNraW5nTnVtXTtcclxuICAgICAgICAgICAgICAgIG4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSBuLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBzZWF0Vmlldy5fcGVuZ2FuZGdhbmcubGVuZ3RoOyArK2spIHtcclxuICAgICAgICAgICAgICAgIHNlYXRWaWV3Ll9wZW5nYW5kZ2FuZ1trXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WIneWni+WMluadoOeJjFxyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICB2YXIgZ2FuZ3MgPSB1c2VyRGF0YS5hbmdhbmdzO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGdhbmdzLmxlbmd0aDsgKytrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2tdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgXCJhbmdhbmdcIik7XHJcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnYW5ncyA9IHVzZXJEYXRhLmRpYW5nYW5ncztcclxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnYW5ncy5sZW5ndGg7ICsraykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBnYW5nc1trXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBlbmdBbmRHYW5ncyhzZWF0VmlldywgaW5kZXgsIG1qaWQsIFwiZGlhbmdhbmdcIik7XHJcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnYW5ncyA9IHVzZXJEYXRhLndhbmdhbmdzO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGdhbmdzLmxlbmd0aDsgKytrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2tdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHNlYXRWaWV3LCBpbmRleCwgbWppZCwgXCJ3YW5nYW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WIneWni+WMlueisOeJjFxyXG4gICAgICAgICAgICB2YXIgcGVuZ3MgPSB1c2VyRGF0YS5wZW5ncztcclxuICAgICAgICAgICAgaWYgKHBlbmdzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBlbmdzLmxlbmd0aDsgKytrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1qaWQgPSBwZW5nc1trXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3Moc2VhdFZpZXcsIGluZGV4LCBtamlkLCBcInBlbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WIneWni+WMluWQg+eJjFxyXG4gICAgICAgICAgICB2YXIgY2hpcyA9IHVzZXJEYXRhLmNoaXM7XHJcbiAgICAgICAgICAgIGlmIChjaGlzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNoaXMubGVuZ3RoOyArK2spIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWppZHMgPSBjaGlzW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtamlkcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3Moc2VhdFZpZXcsIGluZGV4LCBtamlkcywgXCJjaGlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5Yid5aeL5YyW6Iqx54mMXHJcbiAgICAgICAgICAgIHZhciBodWEgPSB1c2VyRGF0YS5jYWlTaGVuO1xyXG4gICAgICAgICAgICB0aGlzLmluaXRIdWEoc2VhdFZpZXcsIGh1YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRIdWE6IGZ1bmN0aW9uKHNlYXRWaWV3LCBtamlkcykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhdFZpZXcuaHVhLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHNlYXRWaWV3Lmh1YS5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG1qaWRzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWppZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHNlYXRWaWV3Lmh1YS5jaGlsZHJlbltpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc2VhdFZpZXcuaHVhLmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIkJfXCIsIG1qaWRzW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0UGVuZ0FuZEdhbmdzOiBmdW5jdGlvbihzZWF0VmlldywgaW5kZXgsIG1qaWQsIGZsYWcpIHtcclxuICAgICAgICB2YXIgcGdyb290ID0gbnVsbDtcclxuICAgICAgICBpZiAoc2VhdFZpZXcuX3BlbmdhbmRnYW5nLmxlbmd0aCA8PSBpbmRleCkge1xyXG4gICAgICAgICAgICBwZ3Jvb3QgPSBjYy5pbnN0YW50aWF0ZShjYy52di5tYWhqb25nbWdyLnBlbmdQcmVmYWJTZWxmKTtcclxuICAgICAgICAgICAgc2VhdFZpZXcuX3BlbmdhbmRnYW5nLnB1c2gocGdyb290KTtcclxuICAgICAgICAgICAgc2VhdFZpZXcubWFoam9uZ3MuYWRkQ2hpbGQocGdyb290KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwZ3Jvb3QgPSBzZWF0Vmlldy5fcGVuZ2FuZGdhbmdbaW5kZXhdO1xyXG4gICAgICAgICAgICBwZ3Jvb3QuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNwcml0ZXMgPSBwZ3Jvb3QuZ2V0Q29tcG9uZW50c0luQ2hpbGRyZW4oY2MuU3ByaXRlKTtcclxuICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IHNwcml0ZXMubGVuZ3RoOyArK3MpIHtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHNwcml0ZXNbc107XHJcbiAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5uYW1lID09IFwiZ2FuZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNHYW5nID0gKGZsYWcgIT0gXCJwZW5nXCIgJiYgZmxhZyAhPSBcImNoaVwiKTtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmFjdGl2ZSA9IGlzR2FuZztcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWCA9IDEuMDtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWSA9IDEuMDtcclxuICAgICAgICAgICAgICAgIGlmIChmbGFnID09IFwiYW5nYW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldEVtcHR5U3ByaXRlRnJhbWUoXCJteXNlbGZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuc2NhbGVYID0gMS40O1xyXG4gICAgICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWSA9IDEuNDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZsYWcgPT0gXCJjaGlcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiQl9cIiwgbWppZFtzXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIkJfXCIsIG1qaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChmbGFnID09IFwiY2hpXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiQl9cIiwgbWppZFtzXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJCX1wiLCBtamlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBwZ3Jvb3QueCA9IGluZGV4ICogNTUgKiAzICsgaW5kZXggKiAxMDtcclxuICAgIH0sXHJcbiAgICBvbkJ0blJlYWR5Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkJ0blJlYWR5Q2xpY2tlZFwiKTtcclxuICAgICAgICBpZiAodGhpcy5faXNHYW1lRW5kKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dhbWVyZXN1bHQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZCgncmVhZHknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZ2FtZW92ZXIuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgb25CdG5TaGFyZUNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwib25CdG5TaGFyZUNsaWNrZWRcIik7XHJcbiAgICB9XHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuICAgIC8vIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2dhbWVyZXN1bHQ6IG51bGwsXHJcbiAgICAgICAgX3NlYXRzOiBbXSxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9nYW1lcmVzdWx0ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZV9yZXN1bHRcIik7XHJcbiAgICAgICAgLy90aGlzLl9nYW1lcmVzdWx0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBzZWF0cyA9IHRoaXMuX2dhbWVyZXN1bHQuZ2V0Q2hpbGRCeU5hbWUoXCJzZWF0c1wiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXRzLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzLnB1c2goc2VhdHMuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KFwiU2VhdFwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBidG5DbG9zZSA9IGNjLmZpbmQoXCJDYW52YXMvZ2FtZV9yZXN1bHQvYnRuQ2xvc2VcIik7XHJcbiAgICAgICAgaWYgKGJ0bkNsb3NlKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuQ2xvc2UsIHRoaXMubm9kZSwgXCJHYW1lUmVzdWx0XCIsIFwib25CdG5DbG9zZUNsaWNrZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBidG5TaGFyZSA9IGNjLmZpbmQoXCJDYW52YXMvZ2FtZV9yZXN1bHQvYnRuU2hhcmVcIik7XHJcbiAgICAgICAgaWYgKGJ0blNoYXJlKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuU2hhcmUsIHRoaXMubm9kZSwgXCJHYW1lUmVzdWx0XCIsIFwib25CdG5TaGFyZUNsaWNrZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5Yid5aeL5YyW572R57uc5LqL5Lu255uR5ZCs5ZmoXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9lbmQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYub25HYW1lRW5kKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBzaG93UmVzdWx0OiBmdW5jdGlvbihzZWF0LCBpbmZvLCBpc1p1aUppYVBhb1Nob3UpIHtcclxuICAgICAgICBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6dWlqaWFwYW9zaG91XCIpLmFjdGl2ZSA9IGlzWnVpSmlhUGFvU2hvdTtcclxuICAgICAgICBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6aW1vY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bXppbW87XHJcbiAgICAgICAgc2VhdC5ub2RlLmdldENoaWxkQnlOYW1lKFwiamllcGFvY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bWppZXBhbztcclxuICAgICAgICBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJkaWFucGFvY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bWRpYW5wYW87XHJcbiAgICAgICAgc2VhdC5ub2RlLmdldENoaWxkQnlOYW1lKFwiYW5nYW5nY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bWFuZ2FuZztcclxuICAgICAgICBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJtaW5nZ2FuZ2Npc2h1XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gaW5mby5udW1taW5nZ2FuZztcclxuICAgICAgICAvLyBzZWF0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaGFqaWFvY2lzaHVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvLm51bWNoYWRhamlhbztcclxuICAgIH0sXHJcbiAgICBvbkdhbWVFbmQ6IGZ1bmN0aW9uKGVuZGluZm8pIHtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xyXG4gICAgICAgIHZhciBtYXhzY29yZSA9IC0xO1xyXG4gICAgICAgIHZhciBtYXhkaWFucGFvID0gMDtcclxuICAgICAgICB2YXIgZGlhbnBhb2dhb3Nob3UgPSAtMTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VhdHNbaV07XHJcbiAgICAgICAgICAgIGlmIChzZWF0LnNjb3JlID4gbWF4c2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIG1heHNjb3JlID0gc2VhdC5zY29yZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZW5kaW5mb1tpXS5udW1kaWFucGFvID4gbWF4ZGlhbnBhbykge1xyXG4gICAgICAgICAgICAgICAgbWF4ZGlhbnBhbyA9IGVuZGluZm9baV0ubnVtZGlhbnBhbztcclxuICAgICAgICAgICAgICAgIGRpYW5wYW9nYW9zaG91ID0gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VhdHNbaV07XHJcbiAgICAgICAgICAgIHZhciBpc0JpZ3dpbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoc2VhdC5zY29yZSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlzQmlnd2luID0gc2VhdC5zY29yZSA9PSBtYXhzY29yZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tpXS5zZXRJbmZvKHNlYXQubmFtZSwgc2VhdC5zY29yZSwgaXNCaWd3aW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tpXS5zZXRJRChzZWF0LnVzZXJpZCk7XHJcbiAgICAgICAgICAgIHZhciBpc1p1aUppYVBhb1Nob3UgPSBkaWFucGFvZ2Fvc2hvdSA9PSBpO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dSZXN1bHQodGhpcy5fc2VhdHNbaV0sIGVuZGluZm9baV0sIGlzWnVpSmlhUGFvU2hvdSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xvc2VDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL+WIt+aWsOWuouaIt+err+mHkeW4geWSjOmSu+efs1xyXG4gICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2V0R2Vtc0FuZENvaW5zKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zID0gZGF0YS5nZW1zO1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLmNvaW5zID0gZGF0YS5jb2lucztcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdoYWxsXCIpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuU2hhcmVDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5zaGFyZS5zaG93KCk7XHJcbiAgICAgICAgLy8gY2MudnYuYW55c2RrTWdyLnNoYXJlUmVzdWx0KCk7XHJcbiAgICB9XHJcbn0pOyIsInZhciBHbG9iYWwgPSBjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuICAgIHN0YXRpY3M6IHtcbiAgICAgICAgaXNzdGFydGVkOiBmYWxzZSxcbiAgICAgICAgbmV0aW5pdGVkOiBmYWxzZSxcbiAgICAgICAgdXNlcmd1aWQ6IDAsXG4gICAgICAgIG5pY2tuYW1lOiBcIlwiLFxuICAgICAgICBtb25leTogMCxcbiAgICAgICAgbHY6IDAsXG4gICAgICAgIHJvb21JZDogMCxcbiAgICB9LFxufSk7IiwiLy8g5YyF5aS06bq75bCG6LCD6K+V5Zyw5Z2AXHJcbi8vIHZhciBVUkwgPSBcImh0dHA6Ly8xMTYuNjIuMTkzLjQ3OjgwMDlcIjtcclxuLy8gdmFyIFVSTCA9IFwiaHR0cDovLzExNi42Mi4xOTMuNDc6OTAwOVwiO1xyXG4vLyB2YXIgVVJMID0gXCJodHRwOi8vMTIxLjE5Ni4yMTMuMTY1OjkwMDlcIjtcclxudmFyIFVSTCA9IFwiaHR0cDovLzEyNy4wLjAuMTo5MDA5XCI7XHJcbmNjLmdhbWUuY29uZmlnWydub0NhY2hlJ109dHJ1ZTtcclxuY2MuZ2FtZS5jb25maWcubXl2ZXJzaW9uID0gMjAxNzA4MDQyO1xyXG52YXIgSFRUUCA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHN0YXRpY3M6IHtcclxuICAgICAgICBzZXNzaW9uSWQ6IDAsXHJcbiAgICAgICAgdXNlcklkOiAwLFxyXG4gICAgICAgIG1hc3Rlcl91cmw6IFVSTCxcclxuICAgICAgICB1cmw6IFVSTCxcclxuICAgICAgICBzZW5kUmVxdWVzdDogZnVuY3Rpb24ocGF0aCwgZGF0YSwgaGFuZGxlciwgZXh0cmFVcmwpIHtcclxuICAgICAgICAgICAgdmFyIHhociA9IGNjLmxvYWRlci5nZXRYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgICAgICB4aHIudGltZW91dCA9IDUwMDA7XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIj9cIjtcclxuICAgICAgICAgICAgZm9yICh2YXIgayBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RyICE9IFwiP1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9IFwiJlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RyICs9IGsgKyBcIj1cIiArIGRhdGFba107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV4dHJhVXJsID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGV4dHJhVXJsID0gSFRUUC51cmw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHJlcXVlc3RVUkwgPSBleHRyYVVybCArIHBhdGggKyBlbmNvZGVVUkkoc3RyKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJSZXF1ZXN0VVJMOlwiICsgcmVxdWVzdFVSTCk7XHJcbiAgICAgICAgICAgIHhoci5vcGVuKFwiR0VUXCIsIHJlcXVlc3RVUkwsIHRydWUpO1xyXG4gICAgICAgICAgICBpZiAoY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdC1FbmNvZGluZ1wiLCBcImd6aXAsZGVmbGF0ZVwiLCBcInRleHQvaHRtbDtjaGFyc2V0PVVURi04XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCAmJiAoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImh0dHAgcmVzKFwiKyB4aHIucmVzcG9uc2VUZXh0Lmxlbmd0aCArIFwiKTpcIiArIHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXQgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxlciAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcihyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IC8qIGNvZGUgKi9cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiICsgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaGFuZGxlcihudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2MudnYgJiYgY2MudnYud2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKGNjLnZ2ICYmIGNjLnZ2LndjKSB7XHJcbiAgICAgICAgICAgICAgICAvL2NjLnZ2LndjLnNob3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB4aHIuc2VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4geGhyO1xyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG59KTsiLCJ2YXIgTmV0ID0gcmVxdWlyZShcIk5ldFwiKVxyXG52YXIgR2xvYmFsID0gcmVxdWlyZShcIkdsb2JhbFwiKVxyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGJsTmFtZTogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJsR2VtczogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJsSUQ6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxibE5vdGljZTogY2MuTGFiZWwsXHJcbiAgICAgICAgam9pbkdhbWVXaW46IGNjLk5vZGUsXHJcbiAgICAgICAgYXBwbHlBZ2VudFdpbjogY2MuTm9kZSxcclxuICAgICAgICBjcmVhdGVSb29tV2luOiBjYy5Ob2RlLFxyXG4gICAgICAgIHNldHRpbmdzV2luOiBjYy5Ob2RlLFxyXG4gICAgICAgIGhlbHBXaW46IGNjLk5vZGUsXHJcbiAgICAgICAgc2hhcmVXaW46IGNjLk5vZGUsXHJcbiAgICAgICAgYnRuSm9pbkdhbWU6IGNjLk5vZGUsXHJcbiAgICAgICAgYnRuUmV0dXJuR2FtZTogY2MuTm9kZSxcclxuICAgICAgICBzcHJIZWFkSW1nOiBjYy5TcHJpdGUsXHJcbiAgICAgICAgZWZmQW5pbWF0aW9uOiBjYy5Ob2RlLFxyXG4gICAgICAgIF9sYXN0Q2hlY2tUaW1lOiAwLFxyXG4gICAgfSxcclxuICAgIGluaXROZXRIYW5kbGVyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgfSxcclxuICAgIG9uU2hhcmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LmFueXNka01nci5zaGFyZShcIuS6muW3qOWMheWktOm6u+WwhlwiLCBcIuS6muW3qOWMheWktOm6u+WwhlwiKTtcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgIHZhciBjdnMgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkNhbnZhcyk7XHJcbiAgICAgICAgICAgIGN2cy5maXRIZWlnaHQgPSB0cnVlO1xyXG4gICAgICAgICAgICBjdnMuZml0V2lkdGggPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWNjLnZ2KSB7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImxvZ2luXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJlTG9hZCgpO1xyXG4gICAgICAgIHRoaXMuaW5pdExhYmVscygpO1xyXG4gICAgICAgIHRoaXMuZWZmTm9kZSA9IGNjLmZpbmQoXCJDYW52YXMvZWZmXCIpO1xyXG4gICAgICAgIC8vIOWmguaenOacquWIm+W7uuaIv+mXtO+8jOWIm+W7uuaMiemSruaYvuekuueJueaViFxyXG4gICAgICAgIC8vIOWmguaenOWtmOWcqOaIv+mXtO+8jOi/lOWbnuaIv+mXtOaYvuekuueJueaViCAgICAgICAgICAgIFxyXG4gICAgICAgIHZhciBwb3MgPSBjYy52MigzMTAsIDUzKTtcclxuICAgICAgICB0aGlzLnBsYXlCdG5FZmYodHJ1ZSwgcG9zKTtcclxuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5yb29tSWQpIHtcclxuICAgICAgICAgICAgdGhpcy5idG5Kb2luR2FtZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5idG5SZXR1cm5HYW1lLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHBvcyA9IGNjLnYyKDMxMCwgNTMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuSm9pbkdhbWUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5idG5SZXR1cm5HYW1lLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBwb3MgPSBjYy52Mig4NiwgLTEwOCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOaSreaUvuaMiemSrueJueaViFxyXG4gICAgICAgIHRoaXMucGxheUJ0bkVmZih0cnVlLCBwb3MpO1xyXG4gICAgICAgIHZhciByb29tSWQgPSBjYy52di51c2VyTWdyLm9sZFJvb21JZFxyXG4gICAgICAgIGlmIChyb29tSWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLm9sZFJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZW50ZXJSb29tKHJvb21JZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbWdMb2FkZXIgPSB0aGlzLnNwckhlYWRJbWcubm9kZS5nZXRDb21wb25lbnQoXCJJbWFnZUxvYWRlclwiKTtcclxuICAgICAgICBpbWdMb2FkZXIuc2V0VXNlcklEKGNjLnZ2LnVzZXJNZ3IudXNlcklkKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuc3BySGVhZEltZy5ub2RlLCB0aGlzLm5vZGUsIFwiSGFsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKFwiQ2FudmFzL3JpZ2h0X2JvdHRvbS9idG5fc2hlemhpXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvcmlnaHRfYm90dG9tL2J0bl9oZWxwXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvcmlnaHRfYm90dG9tL2J0bl9zaGFyZV93eFwiKTtcclxuICAgICAgICB0aGlzLmhlbHBXaW4uYWRkQ29tcG9uZW50KFwiT25CYWNrXCIpO1xyXG4gICAgICAgIGlmICghY2MudnYudXNlck1nci5ub3RpY2UpIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5ub3RpY2UgPSB7XHJcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgbXNnOiBcIuaVsOaNruivt+axguS4rS4uLlwiLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghY2MudnYudXNlck1nci5nZW1zdGlwKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2Vtc3RpcCA9IHtcclxuICAgICAgICAgICAgICAgIHZlcnNpb246IG51bGwsXHJcbiAgICAgICAgICAgICAgICBtc2c6IFwi5pWw5o2u6K+35rGC5LitLi4uXCIsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sYmxOb3RpY2Uuc3RyaW5nID0gY2MudnYudXNlck1nci5ub3RpY2UubXNnO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEluZm8oKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hOb3RpY2UoKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hHZW1zVGlwKCk7XHJcbiAgICAgICAgLy8gY2MudnYuYXVkaW9NZ3IucGxheUJHTShcImJnTWFpbi5tcDNcIik7XHJcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheUJHTShcImJnRmlnaHQubXAzXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEV2ZW50SGFuZGxlcnMoKTtcclxuICAgIH0sXHJcbiAgICByZWZyZXNoSW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkdldCA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5nZW1zICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxibEdlbXMuc3RyaW5nID0gY2MudnYudXRpbHMuc2hvd0ppbmJpKHJldC5nZW1zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfdXNlcl9zdGF0dXNcIiwgZGF0YSwgb25HZXQuYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG4gICAgcmVmcmVzaEdlbXNUaXA6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgb25HZXQgPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2Vtc3RpcC52ZXJzaW9uID0gcmV0LnZlcnNpb247XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmdlbXN0aXAubXNnID0gcmV0Lm1zZy5yZXBsYWNlKFwiPG5ld2xpbmU+XCIsIFwiXFxuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgICAgIHR5cGU6IFwiZmtnbVwiLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBjYy52di51c2VyTWdyLmdlbXN0aXAudmVyc2lvblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfbWVzc2FnZVwiLCBkYXRhLCBvbkdldC5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcbiAgICByZWZyZXNoTm90aWNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9uR2V0ID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLm5vdGljZS52ZXJzaW9uID0gcmV0LnZlcnNpb247XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLm5vdGljZS5tc2cgPSByZXQubXNnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYmxOb3RpY2Uuc3RyaW5nID0gcmV0Lm1zZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICB0eXBlOiBcIm5vdGljZVwiLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBjYy52di51c2VyTWdyLm5vdGljZS52ZXJzaW9uXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9tZXNzYWdlXCIsIGRhdGEsIG9uR2V0LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuICAgIGluaXRCdXR0b25IYW5kbGVyOiBmdW5jdGlvbihidG5QYXRoKSB7XHJcbiAgICAgICAgdmFyIGJ0biA9IGNjLmZpbmQoYnRuUGF0aCk7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChidG4sIHRoaXMubm9kZSwgXCJIYWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgfSxcclxuICAgIHByZUxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLmxvYWRlci5sb2FkUmVzRGlyKFwidGV4dHVyZXMvaW1hZ2VzXCIsIGZ1bmN0aW9uKGVyciwgYXNzZXRzKSB7XHJcbiAgICAgICAgICAgIGNjLmxvYWRlci5sb2FkUmVzRGlyKFwidGV4dHVyZXMvTUpSb29tXCIsIGZ1bmN0aW9uKGVyciwgYXNzZXRzKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5sb2FkZXIubG9hZFJlc0RpcihcInRleHR1cmVzL01KXCIsIGZ1bmN0aW9uKGVyciwgYXNzZXRzKSB7fSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGluaXRMYWJlbHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubGJsTmFtZS5zdHJpbmcgPSBjYy52di51c2VyTWdyLnVzZXJOYW1lO1xyXG4gICAgICAgIHRoaXMubGJsR2Vtcy5zdHJpbmcgPSBjYy52di51dGlscy5zaG93SmluYmkoY2MudnYudXNlck1nci5nZW1zKTtcclxuICAgICAgICB0aGlzLmxibElELnN0cmluZyA9IFwiSUQ6XCIgKyBjYy52di51c2VyTWdyLnVzZXJJZDtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3NoZXpoaVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NXaW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2hlbHBcIikge1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBXaW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3NoYXJlX3d4XCIpIHtcclxuICAgICAgICAgICAgY2MudnYuc2hhcmUuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkFwcGx5QWdlbnRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmFwcGx5QWdlbnRXaW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBvbkFwcGx5QWdlbnRCdG5CYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmFwcGx5QWdlbnRXaW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgb25Kb2luR2FtZUNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuam9pbkdhbWVXaW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBvblJldHVybkdhbWVDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJtamdhbWVcIik7XHJcbiAgICB9LFxyXG4gICAgb25CdG5BZGRHZW1zQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLngrnlh7vlhYXlgLzmjInpkq5cIik7XHJcbiAgICAgICAgY2MudnYuY2hhcmdlLnNob3coKTtcclxuICAgIH0sXHJcbiAgICBvbkNyZWF0ZVJvb21DbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5yb29tSWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5oi/6Ze05bey57uP5Yib5bu6IVxcbuW/hemhu+ino+aVo+W9k+WJjeaIv+mXtOaJjeiDveWIm+W7uuaWsOeahOaIv+mXtFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uQ3JlYXRlUm9vbUNsaWNrZWRcIik7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVSb29tV2luLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgaW5pdEV2ZW50SGFuZGxlcnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5vbigndXBkYXRlX2dlbXMnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuZGV0YWlsLmdlbXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IGV2ZW50LmRldGFpbC5nZW1zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYmxHZW1zLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShzdHIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcbiAgICAvLyDojrflvpfmm7TmlrDmtojmga9cclxuICAgIGdldFJlZnJlc2hJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5raI5oGv5piv56m655qEJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHJldC51c2VyaWQgPT0gY2MudnYudXNlck1nci51c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXQuZ2VtcyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYmxHZW1zLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShyZXQuZ2Vtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX2xhc3RDaGVja1RpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvbmVlZF9yZWZyZXNoXCIsIHtcclxuICAgICAgICAgICAgdXNlcmlkOiBjYy52di51c2VyTWdyLnVzZXJJZFxyXG4gICAgICAgIH0sIGZuLmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuICAgIC8vIOaSreaUvuaMiemSrueJueaViFxyXG4gICAgcGxheUJ0bkVmZjogZnVuY3Rpb24oZmxhZywgcG9zKSB7XHJcbiAgICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgICAgdGhpcy5idG5FZmYgPSB0aGlzLmVmZkFuaW1hdGlvbi5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5lZmZBbmltYXRpb24uZ2V0Q29tcG9uZW50KGNjLk5vZGUpLmdldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZWZmTm9kZS5zZXRQb3NpdGlvbihwb3MpO1xyXG4gICAgICAgICAgICB2YXIgYW5pbVN0YXRlID0gdGhpcy5idG5FZmYucGxheSgnYW5uaXUnKTtcclxuICAgICAgICAgICAgYW5pbVN0YXRlLnNwZWVkID0gMC4zO1xyXG4gICAgICAgICAgICBhbmltU3RhdGUud3JhcE1vZGUgPSBjYy5XcmFwTW9kZS5Mb29wO1xyXG4gICAgICAgICAgICBhbmltU3RhdGUucmVwZWF0Q291bnQgPSBJbmZpbml0eTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ290b05ld0hhbGw6ZnVuY3Rpb24oKXtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdoYWxsXCIpO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLl9sYXN0Q2hlY2tUaW1lID4gMzAwMDApIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRSZWZyZXNoSW5mbygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHggPSB0aGlzLmxibE5vdGljZS5ub2RlLng7XHJcbiAgICAgICAgeCAtPSBkdCAqIDEwMDtcclxuICAgICAgICBpZiAoeCArIHRoaXMubGJsTm90aWNlLm5vZGUud2lkdGggPCAtMTAwMCkge1xyXG4gICAgICAgICAgICB4ID0gNTAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxibE5vdGljZS5ub2RlLnggPSB4O1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeiHquW3seacieaIv+mXtO+8jOS4jeiDveebtOaOpei/m+WFpeWIhuS6q+i/h+adpeeahOaIv+mXtFxyXG4gICAgICAgIGlmIChjYy52diAmJiBjYy52di51c2VyTWdyLnJvb21EYXRhICE9IG51bGwpIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5lbnRlclJvb20oY2MudnYudXNlck1nci5yb29tRGF0YSk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iucm9vbURhdGEgPSBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjeayoeacieaIv+mXtO+8jOS4lOWIhuS6q+i/h+adpeeahOaIv+mXtOWPt+S4jeaYr+epuueahOivne+8jOWPr+S7pei/m+WFpeaIv+mXtFxyXG4gICAgICAgICAgICBpZiAoY2MudnYgJiYgY2MudnYudXNlck1nci5zaGFyZVJvb21JZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnJvb21EYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHZhciByb29taWQgPSBjYy52di51c2VyTWdyLnNoYXJlUm9vbUlkO1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5zaGFyZVJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmVudGVyUm9vbShyb29taWQsIGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gXCLmiL/pl7RbXCIgKyByb29taWQgKyBcIl3kuI3lrZjlnKjvvIzor7fph43mlrDovpPlhaUhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gXCLmiL/pl7RbXCIgKyByb29taWQgKyBcIl3lt7Lmu6EhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBjb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIEhpc3RvcnlJdGVtUHJlZmFiOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYixcclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBfaGlzdG9yeTogbnVsbCxcclxuICAgICAgICBfdmlld2xpc3Q6IG51bGwsXHJcbiAgICAgICAgX2NvbnRlbnQ6IG51bGwsXHJcbiAgICAgICAgX3ZpZXdpdGVtVGVtcDogbnVsbCxcclxuICAgICAgICBfaGlzdG9yeURhdGE6IG51bGwsXHJcbiAgICAgICAgX2N1clJvb21JbmZvOiBudWxsLFxyXG4gICAgICAgIF9lbXB0eVRpcDogbnVsbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5faGlzdG9yeSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImhpc3RvcnlcIik7XHJcbiAgICAgICAgdGhpcy5faGlzdG9yeS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9lbXB0eVRpcCA9IHRoaXMuX2hpc3RvcnkuZ2V0Q2hpbGRCeU5hbWUoXCJlbXB0eVRpcFwiKTtcclxuICAgICAgICB0aGlzLl9lbXB0eVRpcC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3ZpZXdsaXN0ID0gdGhpcy5faGlzdG9yeS5nZXRDaGlsZEJ5TmFtZShcInZpZXdsaXN0XCIpO1xyXG4gICAgICAgIHRoaXMuX2NvbnRlbnQgPSBjYy5maW5kKFwidmlldy9jb250ZW50XCIsIHRoaXMuX3ZpZXdsaXN0KTtcclxuICAgICAgICB0aGlzLl92aWV3aXRlbVRlbXAgPSB0aGlzLl9jb250ZW50LmNoaWxkcmVuWzBdO1xyXG4gICAgICAgIHRoaXMuX2NvbnRlbnQucmVtb3ZlQ2hpbGQodGhpcy5fdmlld2l0ZW1UZW1wKTtcclxuICAgICAgICB2YXIgbm9kZSA9IGNjLmZpbmQoXCJDYW52YXMvc2VsZWN0TUovYnRuX3poYW5qaVwiKTtcclxuICAgICAgICBub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBzZWFyY2hVUkwgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xyXG4gICAgICAgIGlmIChzZWFyY2hVUkwgJiYgc2VhcmNoVVJMLmluZGV4T2YoXCJhY2NvdW50XCIpICE9IC0xKSB7XHJcbiAgICAgICAgICAgIHNlYXJjaFVSTCA9IHNlYXJjaFVSTC5zdWJzdHJpbmcoMSwgc2VhcmNoVVJMLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRBY2NvdW50ID0gc2VhcmNoVVJMLnNwbGl0KFwiJlwiKVswXS5zcGxpdChcIj1cIilbMV07XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRBY2NvdW50LmluZGV4T2YoXCJxaWFvXCIpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFkZENsaWNrRXZlbnQobm9kZSwgdGhpcy5ub2RlLCBcIkhpc3RvcnlcIiwgXCJvbkJ0bkhpc3RvcnlDbGlja2VkXCIpO1xyXG4gICAgICAgIHZhciBub2RlID0gY2MuZmluZChcIkNhbnZhcy9oaXN0b3J5L2J0bl9iYWNrXCIpO1xyXG4gICAgICAgIHRoaXMuYWRkQ2xpY2tFdmVudChub2RlLCB0aGlzLm5vZGUsIFwiSGlzdG9yeVwiLCBcIm9uQnRuQmFja0NsaWNrZWRcIik7XHJcbiAgICB9LFxyXG4gICAgYWRkQ2xpY2tFdmVudDogZnVuY3Rpb24obm9kZSwgdGFyZ2V0LCBjb21wb25lbnQsIGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgZXZlbnRIYW5kbGVyID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcclxuICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBoYW5kbGVyO1xyXG4gICAgICAgIHZhciBjbGlja0V2ZW50cyA9IG5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHM7XHJcbiAgICAgICAgY2xpY2tFdmVudHMucHVzaChldmVudEhhbmRsZXIpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQmFja0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9jdXJSb29tSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpc3RvcnlEYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5faGlzdG9yeS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRSb29tSGlzdG9yeUxpc3QodGhpcy5faGlzdG9yeURhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkhpc3RvcnlDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygn54K55Ye75oiY57up5oyJ6ZKuJyk7XHJcbiAgICAgICAgdGhpcy5faGlzdG9yeS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjYy52di51c2VyTWdyLmdldEhpc3RvcnlMaXN0KGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgZGF0YS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhLnRpbWUgPCBiLnRpbWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBzZWxmLl9oaXN0b3J5RGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA0OyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IGRhdGFbaV0uc2VhdHNbal07XHJcbiAgICAgICAgICAgICAgICAgICAgcy5uYW1lID0gbmV3IEJ1ZmZlcihzLm5hbWUsICdiYXNlNjQnKS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdFJvb21IaXN0b3J5TGlzdChkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBkYXRlRm9ybWF0OiBmdW5jdGlvbih0aW1lKSB7XHJcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh0aW1lKTtcclxuICAgICAgICB2YXIgZGF0ZXRpbWUgPSBcInswfS17MX0tezJ9IHszfTp7NH06ezV9XCI7XHJcbiAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcclxuICAgICAgICBtb250aCA9IG1vbnRoID49IDEwID8gbW9udGggOiAoXCIwXCIgKyBtb250aCk7XHJcbiAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xyXG4gICAgICAgIGRheSA9IGRheSA+PSAxMCA/IGRheSA6IChcIjBcIiArIGRheSk7XHJcbiAgICAgICAgdmFyIGggPSBkYXRlLmdldEhvdXJzKCk7XHJcbiAgICAgICAgaCA9IGggPj0gMTAgPyBoIDogKFwiMFwiICsgaCk7XHJcbiAgICAgICAgdmFyIG0gPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICBtID0gbSA+PSAxMCA/IG0gOiAoXCIwXCIgKyBtKTtcclxuICAgICAgICB2YXIgcyA9IGRhdGUuZ2V0U2Vjb25kcygpO1xyXG4gICAgICAgIHMgPSBzID49IDEwID8gcyA6IChcIjBcIiArIHMpO1xyXG4gICAgICAgIGRhdGV0aW1lID0gZGF0ZXRpbWUuZm9ybWF0KHllYXIsIG1vbnRoLCBkYXksIGgsIG0sIHMpO1xyXG4gICAgICAgIHJldHVybiBkYXRldGltZTtcclxuICAgIH0sXHJcbiAgICBpbml0Um9vbUhpc3RvcnlMaXN0OiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5nZXRWaWV3SXRlbShpKTtcclxuICAgICAgICAgICAgbm9kZS5pZHggPSBpO1xyXG4gICAgICAgICAgICB2YXIgdGl0bGVJZCA9IFwiXCIgKyAoaSArIDEpO1xyXG4gICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwidGl0bGVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aXRsZUlkO1xyXG4gICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwicm9vbU5vXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLmiL/pl7RJRDpcIiArIGRhdGFbaV0uaWQ7XHJcbiAgICAgICAgICAgIHZhciBkYXRldGltZSA9IHRoaXMuZGF0ZUZvcm1hdChkYXRhW2ldLnRpbWUgKiAxMDAwKTtcclxuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRldGltZTtcclxuICAgICAgICAgICAgdmFyIGJ0bk9wID0gbm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bk9wXCIpO1xyXG4gICAgICAgICAgICBidG5PcC5pZHggPSBpO1xyXG4gICAgICAgICAgICBidG5PcC5nZXRDaGlsZEJ5TmFtZShcIkxhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLor6bmg4VcIjtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA0OyArK2opIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gZGF0YVtpXS5zZWF0c1tqXTtcclxuICAgICAgICAgICAgICAgIHZhciBpbmZvID0gcy5uYW1lICsgXCI6XCIgKyBzLnNjb3JlO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhpbmZvKTtcclxuICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJpbmZvXCIgKyBqKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGluZm87XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZW1wdHlUaXAuYWN0aXZlID0gZGF0YS5sZW5ndGggPT0gMDtcclxuICAgICAgICB0aGlzLnNocmlua0NvbnRlbnQoZGF0YS5sZW5ndGgpO1xyXG4gICAgICAgIHRoaXMuX2N1clJvb21JbmZvID0gbnVsbDtcclxuICAgIH0sXHJcbiAgICBpbml0R2FtZUhpc3RvcnlMaXN0OiBmdW5jdGlvbihyb29tSW5mbywgZGF0YSkge1xyXG4gICAgICAgIGRhdGEuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhLmNyZWF0ZV90aW1lIDwgYi5jcmVhdGVfdGltZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmdldFZpZXdJdGVtKGkpO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gZGF0YS5sZW5ndGggLSBpIC0gMTtcclxuICAgICAgICAgICAgbm9kZS5pZHggPSBpZHg7XHJcbiAgICAgICAgICAgIHZhciB0aXRsZUlkID0gXCJcIiArIChpZHggKyAxKTtcclxuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInRpdGxlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGl0bGVJZDtcclxuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInJvb21Ob1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5oi/6Ze0SUQ6XCIgKyByb29tSW5mby5pZDtcclxuICAgICAgICAgICAgdmFyIGRhdGV0aW1lID0gdGhpcy5kYXRlRm9ybWF0KGRhdGFbaV0uY3JlYXRlX3RpbWUgKiAxMDAwKTtcclxuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRldGltZTtcclxuICAgICAgICAgICAgdmFyIGJ0bk9wID0gbm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bk9wXCIpO1xyXG4gICAgICAgICAgICBidG5PcC5pZHggPSBpZHg7XHJcbiAgICAgICAgICAgIGJ0bk9wLmdldENoaWxkQnlOYW1lKFwiTGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuWbnuaUvlwiO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5wYXJzZShkYXRhW2ldLnJlc3VsdCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgNDsgKytqKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHJvb21JbmZvLnNlYXRzW2pdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSBzLm5hbWUgKyBcIjpcIiArIHJlc3VsdFtqXTtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coaW5mbyk7XHJcbiAgICAgICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwiaW5mb1wiICsgaikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBpbmZvO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hyaW5rQ29udGVudChkYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgdGhpcy5fY3VyUm9vbUluZm8gPSByb29tSW5mbztcclxuICAgIH0sXHJcbiAgICBnZXRWaWV3SXRlbTogZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICB2YXIgY29udGVudCA9IHRoaXMuX2NvbnRlbnQ7XHJcbiAgICAgICAgaWYgKGNvbnRlbnQuY2hpbGRyZW5Db3VudCA+IGluZGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50LmNoaWxkcmVuW2luZGV4XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLl92aWV3aXRlbVRlbXApO1xyXG4gICAgICAgIGNvbnRlbnQuYWRkQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICB9LFxyXG4gICAgc2hyaW5rQ29udGVudDogZnVuY3Rpb24obnVtKSB7XHJcbiAgICAgICAgd2hpbGUgKHRoaXMuX2NvbnRlbnQuY2hpbGRyZW5Db3VudCA+IG51bSkge1xyXG4gICAgICAgICAgICB2YXIgbGFzdE9uZSA9IHRoaXMuX2NvbnRlbnQuY2hpbGRyZW5bdGhpcy5fY29udGVudC5jaGlsZHJlbkNvdW50IC0gMV07XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQucmVtb3ZlQ2hpbGQobGFzdE9uZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGdldEdhbWVMaXN0T2ZSb29tOiBmdW5jdGlvbihpZHgpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJvb21JbmZvID0gdGhpcy5faGlzdG9yeURhdGFbaWR4XTtcclxuICAgICAgICBjYy52di51c2VyTWdyLmdldEdhbWVzT2ZSb29tKHJvb21JbmZvLnV1aWQsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCAmJiBkYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaW5pdEdhbWVIaXN0b3J5TGlzdChyb29tSW5mbywgZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBnZXREZXRhaWxPZkdhbWU6IGZ1bmN0aW9uKGlkeCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgcm9vbVVVSUQgPSB0aGlzLl9jdXJSb29tSW5mby51dWlkO1xyXG4gICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2V0RGV0YWlsT2ZHYW1lKHJvb21VVUlELCBpZHgsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgZGF0YS5iYXNlX2luZm8gPSBKU09OLnBhcnNlKGRhdGEuYmFzZV9pbmZvKTtcclxuICAgICAgICAgICAgZGF0YS5hY3Rpb25fcmVjb3JkcyA9IEpTT04ucGFyc2UoZGF0YS5hY3Rpb25fcmVjb3Jkcyk7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IucHJlcGFyZVJlcGxheShzZWxmLl9jdXJSb29tSW5mbywgZGF0YSk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnJlcGxheU1nci5pbml0KGRhdGEpO1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJtamdhbWVcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgb25WaWV3SXRlbUNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGlkeCA9IGV2ZW50LnRhcmdldC5pZHg7XHJcbiAgICAgICAgY29uc29sZS5sb2coaWR4KTtcclxuICAgICAgICBpZiAodGhpcy5fY3VyUm9vbUluZm8gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmdldEdhbWVMaXN0T2ZSb29tKGlkeCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5nZXREZXRhaWxPZkdhbWUoaWR4KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25CdG5PcENsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGlkeCA9IGV2ZW50LnRhcmdldC5wYXJlbnQuaWR4O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGlkeCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2N1clJvb21JbmZvID09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRHYW1lTGlzdE9mUm9vbShpZHgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGV0YWlsT2ZHYW1lKGlkeCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiZnVuY3Rpb24gbG9hZEltYWdlKHVybCwgY29kZSwgY2FsbGJhY2spIHtcclxuICAgIGNjLmxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24oZXJyLCB0ZXgpIHtcclxuICAgICAgICB2YXIgc3ByaXRlRnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4LCBjYy5SZWN0KDAsIDAsIHRleC53aWR0aCwgdGV4LmhlaWdodCkpO1xyXG4gICAgICAgIGNhbGxiYWNrKGNvZGUsIHNwcml0ZUZyYW1lKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gZ2V0QmFzZUluZm8odXNlcmlkLCBjYWxsYmFjaykge1xyXG4gICAgaWYgKGNjLnZ2LmJhc2VJbmZvTWFwID09IG51bGwpIHtcclxuICAgICAgICBjYy52di5iYXNlSW5mb01hcCA9IHt9O1xyXG4gICAgfVxyXG4gICAgaWYgKGNjLnZ2LmJhc2VJbmZvTWFwW3VzZXJpZF0gIT0gbnVsbCkge1xyXG4gICAgICAgIGNhbGxiYWNrKHVzZXJpZCwgY2MudnYuYmFzZUluZm9NYXBbdXNlcmlkXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoJy9iYXNlX2luZm8nLCB7XHJcbiAgICAgICAgICAgIHVzZXJpZDogdXNlcmlkXHJcbiAgICAgICAgfSwgZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIHZhciB1cmwgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAocmV0LmhlYWRpbWd1cmwpIHtcclxuICAgICAgICAgICAgICAgIHVybCA9IHJldC5oZWFkaW1ndXJsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBpbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogcmV0Lm5hbWUsXHJcbiAgICAgICAgICAgICAgICBzZXg6IHJldC5zZXgsXHJcbiAgICAgICAgICAgICAgICB1cmw6IHVybFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LmJhc2VJbmZvTWFwW3VzZXJpZF0gPSBpbmZvO1xyXG4gICAgICAgICAgICBjYWxsYmFjayh1c2VyaWQsIGluZm8pO1xyXG4gICAgICAgIH0sIGNjLnZ2Lmh0dHAubWFzdGVyX3VybCk7XHJcbiAgICB9XHJcbn07XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHt9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuc2V0dXBTcHJpdGVGcmFtZSgpO1xyXG4gICAgfSxcclxuICAgIHNldFVzZXJJRDogZnVuY3Rpb24odXNlcmlkLCB0dHlwZSkge1xyXG4gICAgICAgIGlmICghdXNlcmlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNjLnZ2LmltYWdlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmltYWdlcyA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy8g5aaC5p6c5oyH5a6a57G75Z6L5Li6MeihqOekuuaYvuekuuS6jOe7tOeggeS/oeaBr1xyXG4gICAgICAgIGlmICh0dHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgIHZhciB5YW9xaW5nID0gJ2J0bWonICsgY2MudnYudXNlck1nci55YW9xaW5nX2tleTtcclxuICAgICAgICAgICAgdmFyIHJvb21pZCA9IGNjLnZ2LnVzZXJNZ3Iuc2hhcmVSb29tSWQgfHwgY2MudnYuZ2FtZU5ldE1nci5yb29tSWQgfHwgXCIwMDAwMDBcIjtcclxuICAgICAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vbWoueWFqdWdhbWUuY29tL21hbmFnZTEvPy9tZW1iZXIvdXNlci9xcmNvZGVfYXBwLyc7XHJcbiAgICAgICAgICAgIGlmICgheWFvcWluZykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdXJsID0gdXJsICsgeWFvcWluZyArICcvJyArIHJvb21pZCArICcucG5nJztcclxuICAgICAgICAgICAgbG9hZEltYWdlKHVybCwgdXNlcmlkLCBmdW5jdGlvbihlcnIsIHNwcml0ZUZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXR1cFNwcml0ZUZyYW1lKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGdldEJhc2VJbmZvKHVzZXJpZCwgZnVuY3Rpb24oY29kZSwgaW5mbykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZm8gJiYgaW5mby51cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkSW1hZ2UoaW5mby51cmwsIHVzZXJpZCwgZnVuY3Rpb24oZXJyLCBzcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNldHVwU3ByaXRlRnJhbWUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldHVwU3ByaXRlRnJhbWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgc3ByID0gdGhpcy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgaWYgKHNwcikge1xyXG4gICAgICAgICAgICAgICAgc3ByLnNwcml0ZUZyYW1lID0gdGhpcy5fc3ByaXRlRnJhbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIGluaXRIYW5kbGVyczogZnVuY3Rpb24oR2FtZU5ldCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gR2FtZU5ldDtcclxuICAgICAgICBjYy52di5tYXRjaF9uZXQuYWRkSGFuZGxlcihcInNpZ251cFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLov5vlhaXmr5TotZvpmJ/liJfmiJDlip/vvIHmr5TotZvkurrmlbDkuIDmu6HmgqjlsIbnm7TmjqXov5vlhaXmuLjmiI/vvIFcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubWF0Y2hfbmV0LmFkZEhhbmRsZXIoXCJzaWdudXBfZmFpbFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLov5vlhaXmr5TotZvpmJ/liJflpLHotKXvvIFcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubWF0Y2hfbmV0LmFkZEhhbmRsZXIoXCJjcmVhdGVfbWF0Y2hfZmluaXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJjcmVhdGVfbWF0Y2hfZmluaXNoXCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAvL+i+vuWIsOW8gOWni+avlOi1m+adoeS7tlxyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLmVudGVyUm9vbShkYXRhLnJvb21pZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubWF0Y2hfbmV0LmFkZEhhbmRsZXIoXCJtYXRjaF9yZXN1bHRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1hdGNoX3Jlc3VsdFwiLCBkYXRhKTtcclxuICAgICAgICAgICAgLy/lpITnkIbkuIDova7mr5TotZvnu5PmnpxcclxuICAgICAgICAgICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1zZyA9ICfor6Xova7mr5TotZvnu5PmnZ/vvIwnO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5pc1dpbikge1xyXG4gICAgICAgICAgICAgICAgbXNnICs9ICfmga3llpzov5vlhaXkuIvkuIDova7vvIEnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbXNnICs9ICfmgqjlt7Looqvmt5jmsbDvvIEnO1xyXG4gICAgICAgICAgICAgICAgY2MudnYubWF0Y2hfbmV0LmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdygn5o+Q56S6JywgbXNnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5tYXRjaF9uZXQuYWRkSGFuZGxlcihcIm1hdGNoX292ZXJcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1hdGNoX292ZXJcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgIC8v5aSE55CG5pW05Liq5q+U6LWb57uT5p6cXHJcbiAgICAgICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtc2cgPSAn6ZSm5qCH6LWb57uT5p2f77yMJztcclxuICAgICAgICAgICAgdmFyIHJhbmtpbmcgPSBkYXRhLnJhbmtpbmc7IC8v5o6S5ZCNXHJcbiAgICAgICAgICAgIGlmIChyYW5raW5nID09IDEpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSAn5oGt5Zac6I635b6X5Yag5YabJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChyYW5raW5nID09IDIpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSAn5oGt5Zac6I635b6X56ys5LqM5ZCNJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChyYW5raW5nID09IDMpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSAn5oGt5Zac6I635b6X56ys5LiJ5ZCNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy52di5tYXRjaF9uZXQuY2xvc2UoKTtcclxuICAgICAgICAgICAgLy8gdmFyIHJld2FyZF9udW0gPSBkYXRhLnJld2FyZF9udW07XHJcbiAgICAgICAgICAgIC8vIHZhciByZXdhcmRfdHlwZSA9IGRhdGEucmV3YXJkX3R5cGU7XHJcbiAgICAgICAgICAgIC8vIGlmIChyZXdhcmRfdHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBtc2cgKz0gcmV3YXJkX251bSArICfph5HluIHvvIEnO1xyXG4gICAgICAgICAgICAvLyB9IGVsc2UgaWYgKHJld2FyZF90eXBlID09IDIpIHtcclxuICAgICAgICAgICAgLy8gICAgIG1zZyArPSByZXdhcmRfbnVtICsgJ+mSu+efs++8gSc7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdygn5o+Q56S6JywgbXNnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5tYXRjaF9uZXQuYWRkSGFuZGxlcihcImV4aXRfbWF0Y2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjYy52di5tYXRjaF9uZXQuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSkiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7fSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2J0bkNsb3NlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnRuQ2xvc2VcIik7IC8v6L+U5Zue5oyJ6ZKuXHJcbiAgICAgICAgdGhpcy5fempobWF0Y2ggPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6amhtYXRjaFwiKTsgLy/miY7ph5HoirHnlYzpnaJcclxuICAgICAgICB0aGlzLl9kbm1hdGNoID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZG5tYXRjaFwiKTsgLy/mlpfniZvnlYzpnaJcclxuICAgICAgICB0aGlzLl9tam1hdGNoID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwibWptYXRjaFwiKTsgLy/purvlsIbnlYzpnaJcclxuICAgICAgICB0aGlzLl9kZXRhaWwgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2RldGFpbCcpOyAvL+avlOi1m+ivpuaDheeVjOmdolxyXG4gICAgICAgIHRoaXMuX2RldGFpbF9ydWxlID0gdGhpcy5fZGV0YWlsLmdldENoaWxkQnlOYW1lKCdydWxlJyk7IC8v6KeE5YiZ6K+m5oOFXHJcbiAgICAgICAgdGhpcy5fZGV0YWlsX3Jld2FyZCA9IHRoaXMuX2RldGFpbC5nZXRDaGlsZEJ5TmFtZSgncmV3YXJkJyk7IC8v5aWW5Yqx6K+m5oOFXHJcbiAgICAgICAgdGhpcy5fZGV0YWlsX3JlY29yZCA9IHRoaXMuX2RldGFpbC5nZXRDaGlsZEJ5TmFtZSgncmVjb3JkJyk7IC8v5oiY57up6K+m5oOFXHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9idG5DbG9zZSwgdGhpcy5ub2RlLCBcIkpic1wiLCBcIm9uQnRuQ2xvc2VcIik7XHJcbiAgICAgICAgdGhpcy5pbml0RXZlbnRXYW5mYSh0aGlzLl96amhtYXRjaCk7XHJcbiAgICAgICAgdGhpcy5pbml0RXZlbnRXYW5mYSh0aGlzLl9kbm1hdGNoKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudFdhbmZhKHRoaXMuX21qbWF0Y2gpO1xyXG4gICAgICAgIHRoaXMuaW5pdEV2ZW50RGV0YWlsKHRoaXMuX2RldGFpbF9ydWxlKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudERldGFpbCh0aGlzLl9kZXRhaWxfcmV3YXJkKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudERldGFpbCh0aGlzLl9kZXRhaWxfcmVjb3JkKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNsb3NlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgb25CdG5XYW5mYTogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB2YXIgbmFtZSA9IGV2ZW50LnRhcmdldC5uYW1lO1xyXG4gICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoXCJqYnNfXCIsIFwiXCIpO1xyXG4gICAgICAgIGlmIChuYW1lLmluZGV4T2YoXCJfXCIpID4gLTEpIHtcclxuICAgICAgICAgICAgLy/lj6/ngrnlh7tcclxuICAgICAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShcIl9cIiwgXCJcIik7XHJcbiAgICAgICAgICAgIHN3aXRjaCAobmFtZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZG91JzpcclxuICAgICAgICAgICAgICAgICAgICAvL+aWl+eJm1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RubWF0Y2guYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21hJzpcclxuICAgICAgICAgICAgICAgICAgICAvL+m6u+WwhlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21qbWF0Y2guYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3poYSc6XHJcbiAgICAgICAgICAgICAgICAgICAgLy/miY7ph5HoirFcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl96amhtYXRjaC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v6ZqQ6JeP5b2T5YmNcGFuZWxcclxuICAgICAgICAgICAgZXZlbnQudGFyZ2V0LnBhcmVudC5wYXJlbnQuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkRldGFpbENoYW5nZTogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB2YXIgbmFtZSA9IGV2ZW50LnRhcmdldC5uYW1lO1xyXG4gICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoXCJfYnV0dG9uXCIsIFwiXCIpO1xyXG4gICAgICAgIHRoaXMuX2RldGFpbF9ydWxlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2RldGFpbF9yZXdhcmQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fZGV0YWlsX3JlY29yZC5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgc3dpdGNoIChuYW1lKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3J1bGUnOlxyXG4gICAgICAgICAgICAgICAgLy/op4TliJlcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RldGFpbF9ydWxlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmV3YXJkJzpcclxuICAgICAgICAgICAgICAgIC8v5aWW5YqxXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZXRhaWxfcmV3YXJkLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmVjb3JkJzpcclxuICAgICAgICAgICAgICAgIC8v5oiY57upXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZXRhaWxfcmVjb3JkLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuICAgIG9uQnRuQmFvTWluZzogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJ0biA9IGV2ZW50LnRhcmdldDtcclxuICAgICAgICB2YXIgbWF0Y2hfZGF0YSA9IGJ0bi5kYXRhO1xyXG4gICAgICAgIHZhciBzZW5kX2RhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICB1c2VyaWQ6IGNjLnZ2LnVzZXJNZ3IudXNlcklkLFxyXG4gICAgICAgICAgICBtYXRjaF9pZDogbWF0Y2hfZGF0YVsnaWQnXSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvamluYmlhb19yb29tXCIsIHNlbmRfZGF0YSwgZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmICghcmV0IHx8IHJldC5lcnJjb2RlICE9IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXQuZXJybXNnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdygn5rOo5oSPJywgcmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coJ+azqOaEjycsICfmiqXlkI3lpLHotKXvvIzkuI3mu6HotrPmiqXlkI3mnaHku7YnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy/liLfmlrDlrqLmiLfnq6/ph5HluIHlkozpkrvnn7NcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5nZXRHZW1zQW5kQ29pbnMoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zID0gZGF0YS5nZW1zO1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5jb2lucyA9IGRhdGEuY29pbnM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgY29ubmVjdF9kYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgaXA6IHJldC5pcCxcclxuICAgICAgICAgICAgICAgIHBvcnQ6IHJldC5wb3J0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jb25uZWN0TWF0Y2hTZXJ2ZXIoY29ubmVjdF9kYXRhLCBtYXRjaF9kYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5ub2RlLmFjdGl2ZSA9IGZhbHNlOyAvL+aKpeWQjeWQju+8jOiHquWKqOmakOiXj+aKpeWQjeeVjOmdou+8jOeUqOS6juWGjeasoeaJk+W8gOeahOaXtuWAmeWPr+S7peWIt+aWsOaVsOaNrlxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8v6YCA6LWb5oyJ6ZKuXHJcbiAgICBvbkJ0blR1aVNhaTogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG1hdGNoX2lkID0gZXZlbnQudGFyZ2V0LmRhdGFbJ21hdGNoX2lkJ107XHJcbiAgICAgICAgdmFyIHNlbmRfZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgICAgIHVzZXJpZDogY2MudnYudXNlck1nci51c2VySWQsXHJcbiAgICAgICAgICAgIG1hdGNoX2lkOiBtYXRjaF9pZCxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvdHVpc2FpXCIsIHNlbmRfZGF0YSwgZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmICghcmV0IHx8IHJldC5lcnJjb2RlICE9IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXQuZXJybXNnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdygn5rOo5oSPJywgcmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coJ+azqOaEjycsICfpgIDotZvlpLHotKUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8v5Yi35paw5a6i5oi356uv6YeR5biB5ZKM6ZK755+zXHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2V0R2Vtc0FuZENvaW5zKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2VtcyA9IGRhdGEuZ2VtcztcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuY29pbnMgPSBkYXRhLmNvaW5zO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdmFyIGNvbm5lY3RfZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGlwOiByZXQuaXAsXHJcbiAgICAgICAgICAgICAgICBwb3J0OiByZXQucG9ydFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX2RldGFpbC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5ub2RlLmFjdGl2ZSA9IGZhbHNlOyAvL+aKpeWQjeWQju+8jOiHquWKqOmakOiXj+aKpeWQjeeVjOmdou+8jOeUqOS6juWGjeasoeaJk+W8gOeahOaXtuWAmeWPr+S7peWIt+aWsOaVsOaNrlxyXG4gICAgICAgICAgICBjYy52di5hbGVydC5zaG93KCfmj5DnpLonLCAn6YCA6LWb5oiQ5Yqf77yMODAl5oql5ZCN6LS55bey6L+U6L+Y77yBJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgLy/pobbpg6jmjInpkq7liIfmjaLpobXpnaJcclxuICAgIGluaXRFdmVudFdhbmZhOiBmdW5jdGlvbih0YXJnZXQpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW4gPSB0YXJnZXQuZ2V0Q2hpbGRCeU5hbWUoJ2pic193YW5mYScpLmNoaWxkcmVuO1xyXG4gICAgICAgIHZhciBoYXNNYUppYW5nID0gdHJ1ZTtcclxuICAgICAgICBpZiAoY2MudnYudXNlck1nci5tb2R1bGVzICYmIGNjLnZ2LnVzZXJNZ3IubW9kdWxlcy5pbmRleE9mKDIpID09IC0xKSB7XHJcbiAgICAgICAgICAgIC8v5rKh5pyJ6bq75bCGXHJcbiAgICAgICAgICAgIGhhc01hSmlhbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgaWYgKCFoYXNNYUppYW5nICYmIGNoaWxkLm5hbWUuaW5kZXhPZignamJzX21hJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgLy/lpoLmnpzkuI3ljIXlkKvpurvlsIbvvIzlsLHpmpDol4/purvlsIbmjInpkq5cclxuICAgICAgICAgICAgICAgIGNoaWxkLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoY2hpbGQsIHRoaXMubm9kZSwgXCJKYnNcIiwgXCJvbkJ0bldhbmZhXCIsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+ivpuaDhemhtumDqOaMiemSruWIh+aNolxyXG4gICAgaW5pdEV2ZW50RGV0YWlsOiBmdW5jdGlvbih0YXJnZXQpIHtcclxuICAgICAgICB2YXIgcnVsZV9idXR0b24gPSB0YXJnZXQuZ2V0Q2hpbGRCeU5hbWUoJ3J1bGVfYnV0dG9uJyk7XHJcbiAgICAgICAgdmFyIHJld2FyZF9idXR0b24gPSB0YXJnZXQuZ2V0Q2hpbGRCeU5hbWUoJ3Jld2FyZF9idXR0b24nKTtcclxuICAgICAgICB2YXIgcmVjb3JkX2J1dHRvbiA9IHRhcmdldC5nZXRDaGlsZEJ5TmFtZSgncmVjb3JkX2J1dHRvbicpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQocnVsZV9idXR0b24sIHRoaXMubm9kZSwgXCJKYnNcIiwgXCJvbkJ0bkRldGFpbENoYW5nZVwiLCB0cnVlKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHJld2FyZF9idXR0b24sIHRoaXMubm9kZSwgXCJKYnNcIiwgXCJvbkJ0bkRldGFpbENoYW5nZVwiLCB0cnVlKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHJlY29yZF9idXR0b24sIHRoaXMubm9kZSwgXCJKYnNcIiwgXCJvbkJ0bkRldGFpbENoYW5nZVwiLCB0cnVlKTtcclxuICAgIH0sXHJcbiAgICAvL+WIt+aWsOaKpeWQjeeVjOmdouaVsOaNrlxyXG4gICAgZnJlc2hNYXRjaDogZnVuY3Rpb24obWF0Y2hEYXRhcykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIW1hdGNoRGF0YXMpIHJldHVybjtcclxuICAgICAgICBmb3IgKHZhciBpIGluIG1hdGNoRGF0YXMpIHtcclxuICAgICAgICAgICAgdmFyIG1hdGNoRGF0YSA9IG1hdGNoRGF0YXNbaV07XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBudWxsO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3poYSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gc2VsZi5fempobWF0Y2g7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkb3UnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHNlbGYuX2RubWF0Y2g7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtYSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gc2VsZi5fbWptYXRjaDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHRhcmdldC5nZXRDaGlsZEJ5TmFtZSgnc2Nyb2xsdmlldycpLmdldENoaWxkQnlOYW1lKCd2aWV3JykuZ2V0Q2hpbGRCeU5hbWUoJ2NvbnRlbnQnKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiBpbiBtYXRjaERhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbWF0Y2hEYXRhW2pdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBjb250ZW50LmNoaWxkcmVuW2pdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSBsaXN0LmdldENoaWxkQnlOYW1lKCdpbmZvJyk7XHJcbiAgICAgICAgICAgICAgICBpbmZvLmdldENoaWxkQnlOYW1lKCdsYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZGF0YS5uYW1lOyAvL+avlOi1m+WQjeensFxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBsYXlvdXQgPSBsaXN0LmdldENoaWxkQnlOYW1lKCdsYXlvdXQnKTtcclxuICAgICAgICAgICAgICAgIGxheW91dC5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQobGF5b3V0LCBzZWxmLm5vZGUsIFwiSmJzXCIsIFwic2hvd0Jhb01pbmdEZXRhaWxcIiwgdHJ1ZSk7IC8v57uZ5oql5ZCN5L+h5oGv5re75Yqg54K55Ye75LqL5Lu277yM5pi+56S66K+m57uG5L+h5oGvXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG51bV9pbl9tYXRjaCA9IDEzO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFbJ251bV9pbl9tYXRjaCddICE9IG51bGwgJiYgdHlwZW9mIGRhdGFbJ251bV9pbl9tYXRjaCddICE9ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtX2luX21hdGNoID0gZGF0YVsnbnVtX2luX21hdGNoJ107XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtX2luX21hdGNoID0gcGFyc2VJbnQobnVtX2luX21hdGNoKSAlIHBhcnNlSW50KGRhdGEuZW50ZXJOdW0pOyBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluZm8uZ2V0Q2hpbGRCeU5hbWUoJ2hhc0VudGVyJykuZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gbnVtX2luX21hdGNoICsgJ+S6uic7IC8v5bey57uP5Yqg5YWl55qE5Lq65pWwXHJcbiAgICAgICAgICAgICAgICBpbmZvLmdldENoaWxkQnlOYW1lKCdlbm91Z2gnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9ICfmu6EnICsgZGF0YS5lbnRlck51bSArICfkurrlvIDotZsnO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBiYW9taW5nX2J0biA9IGxpc3QuZ2V0Q2hpbGRCeU5hbWUoJ2J1dHRvbicpOyAvL+aKpeWQjeaMiemSrlxyXG4gICAgICAgICAgICAgICAgYmFvbWluZ19idG4uZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJhb21pbmdfYnRuLCBzZWxmLm5vZGUsIFwiSmJzXCIsIFwib25CdG5CYW9NaW5nXCIsIHRydWUpOyAvL+e7meaKpeWQjeaMiemSrua3u+WKoOeCueWHu+S6i+S7tlxyXG4gICAgICAgICAgICAgICAgYmFvbWluZ19idG4uZ2V0Q2hpbGRCeU5hbWUoJ2xhYmVsJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRhLmZlZTsgLy/mmL7npLrmiqXlkI3otLlcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgeWliYW9taW5nX2J0biA9IGxpc3QuZ2V0Q2hpbGRCeU5hbWUoJ3lpYmFvbWluZycpOyAvL+W3suaKpeWQjeaMiemSrlxyXG4gICAgICAgICAgICAgICAgeWliYW9taW5nX2J0bi5nZXRDaGlsZEJ5TmFtZSgnbGFiZWwnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGRhdGEuZmVlOyAvL+aYvuekuuaKpeWQjei0uVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpc19pbmcgPSBudW1faW5fbWF0Y2ggPT0gZGF0YS5lbnRlck51bTtcclxuICAgICAgICAgICAgICAgIHZhciBqYnNfaW5nID0gbGlzdC5nZXRDaGlsZEJ5TmFtZSgnamJzX2luZycpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGlzX2Jhb19taW5nID0gZGF0YVsnaXNfYmFvX21pbmcnXTtcclxuICAgICAgICAgICAgICAgIGlmIChpc19iYW9fbWluZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGJhb21pbmdfYnRuLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGpic19pbmcuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgeWliYW9taW5nX2J0bi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBiYW9taW5nX2J0bi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHlpYmFvbWluZ19idG4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgamJzX2luZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaG93TWF0Y2hMaXN0OiBmdW5jdGlvbihtYXRjaERhdGEpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBjb25zb2xlLmxvZygnbWF0Y2hEYXRhJywgbWF0Y2hEYXRhKTtcclxuXHJcbiAgICAgICAgdGhpcy5mcmVzaE1hdGNoKG1hdGNoRGF0YSk7XHJcbiAgICB9LFxyXG4gICAgc2hvd0Jhb01pbmdEZXRhaWw6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBldmVudC50YXJnZXQuZGF0YTtcclxuICAgICAgICBjb25zb2xlLmxvZygnc2hvd0RldGFpbHM9PT0+JywgZGF0YSk7XHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGV0YWlsLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy5fZGV0YWlsX3J1bGUuZ2V0Q2hpbGRCeU5hbWUoJ3Njcm9sbHZpZXcnKS5nZXRDaGlsZEJ5TmFtZSgndmlldycpO1xyXG4gICAgICAgICAgICB2YXIgcnVsZV9jb250ZW50ID0gdmlldy5nZXRDaGlsZEJ5TmFtZSgncnVsZV9jb250ZW50Jyk7XHJcbiAgICAgICAgICAgIHZhciBudW0gPSBydWxlX2NvbnRlbnQuZ2V0Q2hpbGRCeU5hbWUoJ251bScpO1xyXG4gICAgICAgICAgICB2YXIgZmVlID0gcnVsZV9jb250ZW50LmdldENoaWxkQnlOYW1lKCdmZWUnKTtcclxuICAgICAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gcnVsZV9jb250ZW50LmdldENoaWxkQnlOYW1lKCdkZXNjcmlwdGlvbicpO1xyXG4gICAgICAgICAgICBudW0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuW8gOi1m+S6uuaVsO+8mlwiICsgZGF0YS5lbnRlck51bSArIFwi5Lq6XCI7XHJcbiAgICAgICAgICAgIHZhciBmZWVfdHlwZTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuZmVlVHlwZSA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICBmZWVfdHlwZSA9IFwi6ZK755+zXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmZWVfdHlwZSA9IFwi6YeR5biBXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmVlLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLmiqXlkI3otLnnlKjvvJpcIiArIGRhdGEuZmVlICsgZmVlX3R5cGU7XHJcbiAgICAgICAgICAgIC8vIGRlc2NyaXB0aW9uLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXHJcbiAgICAgICAgICAgIHZhciByZXdhcmRfdmlldyA9IHRoaXMuX2RldGFpbF9yZXdhcmQuZ2V0Q2hpbGRCeU5hbWUoJ3Njcm9sbHZpZXcnKS5nZXRDaGlsZEJ5TmFtZSgndmlldycpO1xyXG4gICAgICAgICAgICB2YXIgaW5mbyA9IHJld2FyZF92aWV3LmdldENoaWxkQnlOYW1lKCdjb250ZW50JykuZ2V0Q2hpbGRCeU5hbWUoJ2luZm8nKTtcclxuICAgICAgICAgICAgdmFyIGZpcnN0ID0gaW5mby5nZXRDaGlsZEJ5TmFtZSgnZmlyc3QnKS5nZXRDaGlsZEJ5TmFtZSgncmV3YXJkJyk7XHJcbiAgICAgICAgICAgIGZpcnN0LmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZGF0YS5yZXdhcmRGaXJzdCArIGZlZV90eXBlO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNlY29uZCA9IGluZm8uZ2V0Q2hpbGRCeU5hbWUoJ3NlY29uZCcpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5yZXdhcmRTZWNvbmQpIHtcclxuICAgICAgICAgICAgICAgIHNlY29uZC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlY29uZF9yZXdhcmQgPSBzZWNvbmQuZ2V0Q2hpbGRCeU5hbWUoJ3Jld2FyZCcpO1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kX3Jld2FyZC5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGRhdGEucmV3YXJkU2Vjb25kICsgZmVlX3R5cGU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWNvbmQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciB0aGlyZCA9IGluZm8uZ2V0Q2hpbGRCeU5hbWUoJ3RoaXJkJyk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnJld2FyZFRoaXJkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlyZC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRoaXJkX2F3YXJkID0gdGhpcmQuZ2V0Q2hpbGRCeU5hbWUoJ3Jld2FyZCcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcmRfYXdhcmQuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRhLnJld2FyZFRoaXJkICsgZmVlX3R5cGU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlyZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHR1aXNhaV9idG4gPSB0aGlzLl9kZXRhaWxfcnVsZS5nZXRDaGlsZEJ5TmFtZSgnamJzX3R1aXNhaScpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5pc19iYW9fbWluZyAmJiBkYXRhLm51bV9pbl9tYXRjaCAhPSBkYXRhLmVudGVyTnVtKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHR1aXNhaV9idG4sIHRoaXMubm9kZSwgXCJKYnNcIiwgXCJvbkJ0blR1aVNhaVwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHR1aXNhaV9idG4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHR1aXNhaV9idG4uZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaF9pZDogZGF0YS5pZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHVpc2FpX2J0bi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoaWRlQmFvTWluZ0RldGFpbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZGV0YWlsLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvKnVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgIH0sKi9cclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG51bXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgICAgIHR5cGU6IFtjYy5MYWJlbF1cclxuICAgICAgICB9LFxyXG4gICAgICAgIF9pbnB1dEluZGV4OiAwLFxyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7fSxcclxuICAgIG9uRW5hYmxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm9uUmVzZXRDbGlja2VkKCk7XHJcbiAgICB9LFxyXG4gICAgb25JbnB1dEZpbmlzaGVkOiBmdW5jdGlvbihyb29tSWQpIHtcclxuICAgICAgICBjYy52di51c2VyTWdyLmVudGVyUm9vbShyb29tSWQsIGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBcIum6u+WwhuaIv+mXtFtcIiArIHJvb21JZCArIFwiXeS4jeWtmOWcqO+8jOivt+mHjeaWsOi+k+WFpSFcIjtcclxuICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IFwi6bq75bCG5oi/6Ze0W1wiICsgcm9vbUlkICsgXCJd5bey5ruhIVwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBjb250ZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMub25SZXNldENsaWNrZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG4gICAgb25JbnB1dDogZnVuY3Rpb24obnVtKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lucHV0SW5kZXggPj0gdGhpcy5udW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubnVtc1t0aGlzLl9pbnB1dEluZGV4XS5zdHJpbmcgPSBudW07XHJcbiAgICAgICAgdGhpcy5faW5wdXRJbmRleCArPSAxO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5faW5wdXRJbmRleCA9PSB0aGlzLm51bXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHZhciByb29tSWQgPSB0aGlzLnBhcnNlUm9vbUlEKCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib2s6XCIgKyByb29tSWQpO1xyXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICAgICAgcm9vbV90eXBlOiAwLFxyXG4gICAgICAgICAgICAgICAgcm9vbUlkOiByb29tSWRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIGZuID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25JbnB1dEZpbmlzaGVkKHJvb21JZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJldC5lcnJjb2RlID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gXCLpurvlsIbmiL/pl7RbXCIgKyByb29tSWQgKyBcIl3kuI3lrZjlnKjvvIzor7fph43mlrDovpPlhaUhXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vblJlc2V0Q2xpY2tlZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2p1ZGdlX3Jvb21cIiwgZGF0YSwgZm4pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbk4wQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5vbklucHV0KDApO1xyXG4gICAgfSxcclxuICAgIG9uTjFDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm9uSW5wdXQoMSk7XHJcbiAgICB9LFxyXG4gICAgb25OMkNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMub25JbnB1dCgyKTtcclxuICAgIH0sXHJcbiAgICBvbk4zQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5vbklucHV0KDMpO1xyXG4gICAgfSxcclxuICAgIG9uTjRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm9uSW5wdXQoNCk7XHJcbiAgICB9LFxyXG4gICAgb25ONUNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMub25JbnB1dCg1KTtcclxuICAgIH0sXHJcbiAgICBvbk42Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5vbklucHV0KDYpO1xyXG4gICAgfSxcclxuICAgIG9uTjdDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm9uSW5wdXQoNyk7XHJcbiAgICB9LFxyXG4gICAgb25OOENsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMub25JbnB1dCg4KTtcclxuICAgIH0sXHJcbiAgICBvbk45Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5vbklucHV0KDkpO1xyXG4gICAgfSxcclxuICAgIG9uUmVzZXRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubnVtcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLm51bXNbaV0uc3RyaW5nID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faW5wdXRJbmRleCA9IDA7XHJcbiAgICB9LFxyXG4gICAgb25EZWxDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5faW5wdXRJbmRleCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRJbmRleCAtPSAxO1xyXG4gICAgICAgICAgICB0aGlzLm51bXNbdGhpcy5faW5wdXRJbmRleF0uc3RyaW5nID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25DbG9zZUNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBwYXJzZVJvb21JRDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzdHIgPSBcIlwiO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubnVtcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgc3RyICs9IHRoaXMubnVtc1tpXS5zdHJpbmc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgICAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgICAgIC8vIH0sXHJcbn0pOyIsIlN0cmluZy5wcm90b3R5cGUuZm9ybWF0ID0gZnVuY3Rpb24oYXJncykge1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSAmJiB0eXBlb2YoYXJncykgPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXJncykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoe1wiICsga2V5ICsgXCJ9KVwiLCBcImdcIik7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShyZWcsIGFyZ3Nba2V5XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyZ3VtZW50c1tpXSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoe1tcIiArIGkgKyBcIl19KVwiLCBcImdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UocmVnLCBhcmd1bWVudHNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG59O1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX3N0YXRlU3RyOiAnJyxcclxuICAgICAgICBfcHJvZ3Jlc3M6IDAuMCxcclxuICAgICAgICBfaXNMb2FkaW5nOiB0cnVlLFxyXG4gICAgICAgIGJ0bldlY2hhdExvZ2luOiBjYy5Ob2RlLFxyXG4gICAgICAgIGxvYWRpbmdiYXI6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJvZ3Jlc3NCYXJcclxuICAgICAgICB9LFxyXG4gICAgICAgIF90aW1lOiAwLFxyXG4gICAgICAgIGk6IDAsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubG9hZGluZ2Jhci5wcm9ncmVzcyA9IDA7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgIHZhciBjdnMgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkNhbnZhcyk7XHJcbiAgICAgICAgICAgIGN2cy5maXRIZWlnaHQgPSB0cnVlO1xyXG4gICAgICAgICAgICBjdnMuZml0V2lkdGggPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluaXRNZ3IoKTtcclxuICAgICAgICBpZiAoIWNjLnZ2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdE1ncigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy52di5odHRwLnVybCA9IGNjLnZ2Lmh0dHAubWFzdGVyX3VybDtcclxuICAgICAgICB0aGlzLmJ0bldlY2hhdExvZ2luLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHN0YXJ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIFNIT1dfVElNRSA9IDMwMDA7XHJcbiAgICAgICAgdmFyIEZBREVfVElNRSA9IDUwMDtcclxuICAgICAgICBpZiAoY2Muc3lzLm9zICE9IGNjLnN5cy5PU19JT1MgfHwgIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICB2YXIgdCA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGR0ID0gRGF0ZS5ub3coKSAtIHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoZHQgPCBTSE9XX1RJTUUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuLCAzMyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcCA9ICgxIC0gKChkdCAtIFNIT1dfVElNRSkgLyBGQURFX1RJTUUpKSAqIDI1NTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3AgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2hlY2tWZXJzaW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmbiwgMzMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmbiwgMzMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tWZXJzaW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRNZ3I6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2ID0ge307XHJcbiAgICAgICAgdmFyIFVzZXJNZ3IgPSByZXF1aXJlKFwiVXNlck1nclwiKTtcclxuICAgICAgICBjYy52di51c2VyTWdyID0gbmV3IFVzZXJNZ3IoKTtcclxuICAgICAgICB2YXIgUmVwbGF5TWdyID0gcmVxdWlyZShcIlJlcGxheU1nclwiKTtcclxuICAgICAgICBjYy52di5yZXBsYXlNZ3IgPSBuZXcgUmVwbGF5TWdyKCk7XHJcbiAgICAgICAgY2MudnYuaHR0cCA9IHJlcXVpcmUoXCJIVFRQXCIpO1xyXG4gICAgICAgIGNjLnZ2Lmdsb2JhbCA9IHJlcXVpcmUoXCJHbG9iYWxcIik7XHJcbiAgICAgICAgY2MudnYubmV0ID0gcmVxdWlyZShcIk5ldFwiKTtcclxuICAgICAgICBjYy52di5tYXRjaF9uZXQgPSByZXF1aXJlKFwiTWF0Y2hOZXRcIik7XHJcbiAgICAgICAgdmFyIEdhbWVOZXRNZ3IgPSByZXF1aXJlKFwiR2FtZU5ldE1nclwiKTtcclxuICAgICAgICBjYy52di5nYW1lTmV0TWdyID0gbmV3IEdhbWVOZXRNZ3IoKTtcclxuICAgICAgICAvLyBjYy52di5nYW1lTmV0TWdyLmluaXRIYW5kbGVycygpO1xyXG4gICAgICAgIHZhciBBbnlzZGtNZ3IgPSByZXF1aXJlKFwiQW55c2RrTWdyXCIpO1xyXG4gICAgICAgIGNjLnZ2LmFueXNka01nciA9IG5ldyBBbnlzZGtNZ3IoKTtcclxuICAgICAgICBjYy52di5hbnlzZGtNZ3IuaW5pdCgpO1xyXG4gICAgICAgIHZhciBWb2ljZU1nciA9IHJlcXVpcmUoXCJWb2ljZU1nclwiKTtcclxuICAgICAgICBjYy52di52b2ljZU1nciA9IG5ldyBWb2ljZU1ncigpO1xyXG4gICAgICAgIGNjLnZ2LnZvaWNlTWdyLmluaXQoKTtcclxuICAgICAgICB2YXIgQXVkaW9NZ3IgPSByZXF1aXJlKFwiQXVkaW9NZ3JcIik7XHJcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IgPSBuZXcgQXVkaW9NZ3IoKTtcclxuICAgICAgICBjYy52di5hdWRpb01nci5pbml0KCk7XHJcbiAgICAgICAgdmFyIFV0aWxzID0gcmVxdWlyZShcIlV0aWxzXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzID0gbmV3IFV0aWxzKCk7XHJcbiAgICAgICAgY2MuYXJncyA9IHRoaXMudXJsUGFyc2UoKTtcclxuICAgICAgICB0aGlzLl9pc0xvYWRpbmcgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIHVybFBhcnNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcGFyYW1zID0ge307XHJcbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuYW1lLCB2YWx1ZTtcclxuICAgICAgICB2YXIgc3RyID0gd2luZG93LmxvY2F0aW9uLmhyZWY7IC8v5Y+W5b6X5pW05Liq5Zyw5Z2A5qCPXHJcbiAgICAgICAgdmFyIG51bSA9IHN0ci5pbmRleE9mKFwiP1wiKVxyXG4gICAgICAgIHN0ciA9IHN0ci5zdWJzdHIobnVtICsgMSk7IC8v5Y+W5b6X5omA5pyJ5Y+C5pWwICAgXHJcbiAgICAgICAgdmFyIGFyciA9IHN0ci5zcGxpdChcIiZcIik7IC8v5ZCE5Liq5Y+C5pWw5pS+5Yiw5pWw57uE6YeMXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbnVtID0gYXJyW2ldLmluZGV4T2YoXCI9XCIpO1xyXG4gICAgICAgICAgICBpZiAobnVtID4gMCkge1xyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGFycltpXS5zdWJzdHJpbmcoMCwgbnVtKTtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gYXJyW2ldLnN1YnN0cihudW0gKyAxKTtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1tuYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJhbXM7XHJcbiAgICB9LFxyXG4gICAgY2hlY2tWZXJzaW9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9uR2V0VmVyc2lvbiA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LnZlcnNpb24gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvci5cIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIui/lOWbnueahOe7k+aenOaYr1wiICsgSlNPTi5zdHJpbmdpZnkocmV0KSk7XHJcbiAgICAgICAgICAgICAgICBjYy52di5TSSA9IHJldDtcclxuICAgICAgICAgICAgICAgIHNlbGYuc3RhcnRQcmVsb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciB4aHIgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb21wbGV0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBmblJlcXVlc3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5fc3RhdGVTdHIgPSBcIuato+WcqOi/nuaOpeacjeWKoeWZqFwiO1xyXG4gICAgICAgICAgICB4aHIgPSBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9zZXJ2ZXJpbmZvXCIsIG51bGwsIGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICAgICAgeGhyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIG9uR2V0VmVyc2lvbihyZXQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmbiwgNTAwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIWNvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoeGhyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeGhyLmFib3J0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc3RhdGVTdHIgPSBcIui/nuaOpeWksei0pe+8jOWNs+WwhumHjeivlVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuUmVxdWVzdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmblJlcXVlc3QoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm4oKTtcclxuICAgIH0sXHJcbiAgICBzdGFydFByZWxvYWRpbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3N0YXRlU3RyID0gXCLmraPlnKjliqDovb3otYTmupDvvIzor7fnqI3lgJlcIjtcclxuICAgICAgICAvLyB0aGlzLl9pc0xvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjYy5sb2FkZXIub25Qcm9ncmVzcyA9IGZ1bmN0aW9uKGNvbXBsZXRlZENvdW50LCB0b3RhbENvdW50LCBpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLl9pc0xvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3Byb2dyZXNzID0gY29tcGxldGVkQ291bnQgLyB0b3RhbENvdW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy5sb2FkZXIubG9hZFJlc0RpcihcInRleHR1cmVzL2ltYWdlcy9sb2dpblwiLCBmdW5jdGlvbihlcnIsIGFzc2V0cykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIueZu+W9lei1hOa6kOWKoOi9veWujOaIkFwiKTtcclxuICAgICAgICAgICAgc2VsZi5vbkxvYWRDb21wbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8vIOWKoOi9veWujOaIkFxyXG4gICAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2lzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ2Jhci5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuV2VjaGF0TG9naW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBjYy5sb2FkZXIub25Db21wbGV0ZSA9IG51bGw7XHJcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXNEaXIoXCJ0ZXh0dXJlcy9ob21lXCIsIGZ1bmN0aW9uKGVyciwgYXNzZXRzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGFsbOWkp+WOhei1hOa6kOWKoOi9veWujOaIkFwiKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvLyDngrnlh7vlvq7kv6HnmbvlvZXmjInpkq5cclxuICAgIG9uQnRuV2VpY2hhdENsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5Yib5bu65LiA5Liq5b6u5L+h55m75b2V55qEXCIpO1xyXG4gICAgICAgIGlmIChjYy5hcmdzW1wiYWNjb3VudFwiXSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZFdYTG9naW5YSFIoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjYy52di53Yy5zaG93KFwi5q2j5Zyo55m75b2V5ri45oiPLOivt+eojeWQjlwiKTtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5ndWVzdEF1dGgoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g5Y+R6YCB6K+35rGC77yM6I635Y+W5Yiw5b6u5L+h55m75b2V55So55qEY29kZVxyXG4gICAgc2VuZFdYTG9naW5YSFI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LndjLnNob3coXCLmraPlnKjnmbvlvZXmuLjmiI8s6K+356iN5ZCOXCIpO1xyXG4gICAgICAgIHZhciB1cmwgPSBcImh0dHA6Ly9tai55YWp1Z2FtZS5jb20vc2Vzc2lvbmlkLnBocFwiO1xyXG4gICAgICAgIHZhciB4aHIgPSBjYy5sb2FkZXIuZ2V0WE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHIub3BlbihcIkdFVFwiLCB1cmwsIHRydWUpO1xyXG4gICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQgJiYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPD0gMjA3KSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGh0dHBTdGF0dXMgPSB4aHIuc3RhdHVzVGV4dDtcclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IHhoci5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZSlcclxuICAgICAgICAgICAgICAgIHRoaXMuc2Vzc2lvbl9pZCA9IHJlc1tcInNpZFwiXTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlc3Npb25faWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoZSBzaWQgaXMgXCIgKyB0aGlzLnNlc3Npb25faWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MudnYuYW55c2RrTWdyLm9uTG9naW5SZXNwKHJldC5jb2RlLCByZXQudWlkLCByZXQucm9vbWlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLnZ2LndjLnNob3coXCLor7flnKjlvq7kv6HkuK3miZPlvIDor6Xpk77mjqXlnLDlnYDmiJbliLfmlrDpobXpnaLvvIFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfd3hfY29kZVwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZDogdGhpcy5zZXNzaW9uX2lkXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZm4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLml6Dnu5Pmnpzov5Tlm55cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHhoci50aW1lb3V0ID0gNTAwMDsgLy8gNSBzZWNvbmRzIGZvciB0aW1lb3V0XHJcbiAgICAgICAgeGhyLnNlbmQoKTtcclxuICAgIH0sXHJcbiAgICB0aW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl90aW1lID0gRGF0ZS5ub3coKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgdmFyIHByb2dyZXNzID0gdGhpcy5sb2FkaW5nYmFyLnByb2dyZXNzO1xyXG4gICAgICAgIGlmICh0aGlzLl9pc0xvYWRpbmcpIHtcclxuICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLl90aW1lID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWUoKTtcclxuICAgICAgICAgICAgICAgIHByb2dyZXNzICs9IGR0O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaSA+PSAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2dyZXNzIDwgdGhpcy5fcHJvZ3Jlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSB0aGlzLl9wcm9ncmVzcztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvZ3Jlc3MgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MgPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5pKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nYmFyLnByb2dyZXNzID0gcHJvZ3Jlc3M7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgZ2FtZVJvb3Q6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJlcGFyZVJvb3Q6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgX215TUpBcnI6IFtdLFxyXG4gICAgICAgIF9vcHRpb25zOiBudWxsLFxyXG4gICAgICAgIF9zZWxlY3RlZE1KOiBudWxsLFxyXG4gICAgICAgIF9jaHVwYWlTcHJpdGU6IFtdLFxyXG4gICAgICAgIF9tamNvdW50OiBudWxsLFxyXG4gICAgICAgIF9nYW1lY291bnQ6IG51bGwsXHJcbiAgICAgICAgX2h1cGFpVGlwczogW10sXHJcbiAgICAgICAgX2h1cGFpTGlzdHM6IFtdLFxyXG4gICAgICAgIF9wbGF5RWZ4czogW10sXHJcbiAgICAgICAgX29wdHM6IFtdLFxyXG4gICAgICAgIC8vIOeUqOS6juWtmOaUvuacjeWKoeerr+WPkei/h+adpeeahOWPr+S7peWQg+eahOe7hOWQiFxyXG4gICAgICAgIF9jaGlBcnJheXM6IFtdLFxyXG4gICAgICAgIC8vIOeUqOadpeWtmOaUvueOqeWutumAieS4reeahOWQg+eahOe7hOWQiFxyXG4gICAgICAgIF9jaGlPcHRpb25BcnJheTogW10sXHJcbiAgICAgICAgX2NoaU9wdHM6IG51bGwsXHJcbiAgICAgICAgX29wdGlvbnNEYXRhOiBudWxsLFxyXG4gICAgICAgIF9jYW5DaHVwYWk6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSAmJiBjYy5zeXMuaXNNb2JpbGUpIHtcclxuICAgICAgICAgICAgdmFyIGN2cyA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuQ2FudmFzKTtcclxuICAgICAgICAgICAgY3ZzLmZpdEhlaWdodCA9IHRydWU7XHJcbiAgICAgICAgICAgIGN2cy5maXRXaWR0aCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghY2MudnYpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibG9naW5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJOb3RpY2VUaXBcIik7XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJHYW1lT3ZlclwiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlBlbmdHYW5nc1wiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIk1KUm9vbVwiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlRpbWVQb2ludGVyXCIpO1xyXG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiR2FtZVJlc3VsdFwiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIkNoYXRcIik7XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJGb2xkc1wiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlJlcGxheUN0cmxcIik7XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJQb3B1cE1nclwiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlJlQ29ubmVjdFwiKTtcclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlZvaWNlXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdFZpZXcoKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudEhhbmRsZXJzKCk7XHJcbiAgICAgICAgdGhpcy5nYW1lUm9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnByZXBhcmVSb290LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY2hpQXJyYXlzID0gW107XHJcbiAgICAgICAgdGhpcy5fY2hpT3B0aW9uQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmluaXRXYW5mYUxhYmVsKCk7XHJcbiAgICAgICAgdGhpcy5vbkdhbWVCZWlnbigpO1xyXG4gICAgfSxcclxuICAgIGluaXRWaWV3OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL+aQnOe0oumcgOimgeeahOWtkOiKgueCuVxyXG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xyXG4gICAgICAgIHRoaXMuX21qY291bnQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoJ21qY291bnQnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX21qY291bnQuc3RyaW5nID0gXCLliankvZlcIiArIGNjLnZ2LmdhbWVOZXRNZ3IubnVtT2ZNSiArIFwi5bygXCI7XHJcbiAgICAgICAgdGhpcy5fZ2FtZWNvdW50ID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKCdnYW1lY291bnQnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX2dhbWVjb3VudC5zdHJpbmcgPSBcIlwiICsgY2MudnYuZ2FtZU5ldE1nci5udW1PZkdhbWVzICsgXCIvXCIgKyBjYy52di5nYW1lTmV0TWdyLm1heE51bU9mR2FtZXMgKyBcIuWxgFwiO1xyXG4gICAgICAgIHZhciBteXNlbGZDaGlsZCA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm15c2VsZlwiKTtcclxuICAgICAgICB2YXIgbXlob2xkcyA9IG15c2VsZkNoaWxkLmdldENoaWxkQnlOYW1lKFwiaG9sZHNcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBteWhvbGRzLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBteWhvbGRzLmNoaWxkcmVuW2ldLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgICB0aGlzLl9teU1KQXJyLnB1c2goc3ByaXRlKTtcclxuICAgICAgICAgICAgdGhpcy5vbk1qVG9VcChzcHJpdGUubm9kZSk7XHJcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZWFsd2lkdGggPSBjYy5kaXJlY3Rvci5nZXRWaXNpYmxlU2l6ZSgpLndpZHRoO1xyXG4gICAgICAgIG15aG9sZHMuc2NhbGVYICo9IHJlYWx3aWR0aCAvIDEyODA7XHJcbiAgICAgICAgbXlob2xkcy5zY2FsZVkgKj0gcmVhbHdpZHRoIC8gMTI4MDtcclxuICAgICAgICB2YXIgc2lkZXMgPSBbXCJteXNlbGZcIiwgXCJyaWdodFwiLCBcInVwXCIsIFwibGVmdFwiXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpZGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzaWRlID0gc2lkZXNbaV07XHJcbiAgICAgICAgICAgIHZhciBzaWRlQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2h1cGFpVGlwcy5wdXNoKHNpZGVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIkh1UGFpXCIpKTtcclxuICAgICAgICAgICAgdGhpcy5faHVwYWlMaXN0cy5wdXNoKHNpZGVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcImh1cGFpbGlzdFwiKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXlFZnhzLnB1c2goc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwicGxheV9lZnhcIikuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbikpO1xyXG4gICAgICAgICAgICB0aGlzLl9jaHVwYWlTcHJpdGUucHVzaChzaWRlQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJDaHVQYWlcIikuY2hpbGRyZW5bMF0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkpO1xyXG4gICAgICAgICAgICB2YXIgb3B0ID0gc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwib3B0XCIpO1xyXG4gICAgICAgICAgICBvcHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBvcHQuZ2V0Q2hpbGRCeU5hbWUoXCJwYWlcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgbm9kZTogb3B0LFxyXG4gICAgICAgICAgICAgICAgc3ByaXRlOiBzcHJpdGVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5fb3B0cy5wdXNoKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgb3B0cyA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm9wc1wiKTtcclxuICAgICAgICB0aGlzLl9vcHRpb25zID0gb3B0cztcclxuICAgICAgICB2YXIgY2hpT3B0cyA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcImNoaW9wc1wiKTtcclxuICAgICAgICB0aGlzLl9jaGlPcHRzID0gY2hpT3B0cztcclxuICAgICAgICB0aGlzLmhpZGVPcHRpb25zKCk7XHJcbiAgICAgICAgdGhpcy5oaWRlQ2h1cGFpKCk7XHJcbiAgICAgICAgdGhpcy5oaWRlQ2hpT3B0aW9ucygpO1xyXG4gICAgICAgIGlmICh0aGlzLl9teU1KQXJyLmxlbmd0aCA9PSAxNCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jYW5DaHVwYWkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoaWRlQ2h1cGFpOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NodXBhaVNwcml0ZS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLl9jaHVwYWlTcHJpdGVbaV0ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2hlY2tIYXNDYWlTaGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygn5Yik5pat5piv5ZCm5pyJ6LSi56WeJyk7XHJcbiAgICAgICAgdmFyIGhhc0NhaVNoZW4gPSBmYWxzZTtcclxuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci50dXJuKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fbXlNSkFyci5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUubWpJZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBjYy52di5tYWhqb25nbWdyLmdldE1haGpvbmdUeXBlKHNwcml0ZS5ub2RlLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IDQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLmnInotKLnpZ5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0NhaVNoZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhc0NhaVNoZW47XHJcbiAgICB9LFxyXG4gICAgLy8g5q+P5pG45LiA5qyh54mMLOWIpOaWreS4gOS4i+aYr+WQpuaYr+i0ouelnlxyXG4gICAgY2hlY2tDYWlTaGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja0hhc0NhaVNoZW4oKSkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIC8v6Ieq5Yqo5Ye66Iqx54mMXHJcbiAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gY2MudnYubWFoam9uZ21nci5nZXRNYWhqb25nVHlwZShub2RlLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2hvb3RDYWlTaGVuKG5vZGUubWpJZCk7XHJcbiAgICAgICAgICAgICAgICBub2RlLnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZWNvcmRTaG9vdFBvcyhub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbm9kZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLl9teU1KQXJyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gc2VsZi5fbXlNSkFycltpXTtcclxuICAgICAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5taklkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0TWFoam9uZ1R5cGUoc3ByaXRlLm5vZGUubWpJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgIT0gNCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy52di5nbG9iYWwudG91Y2hfdGFyZ2V0ID0gc3ByaXRlLm5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNjLnZ2LmdhbWVOZXRNZ3IudHVybiA9IHNwcml0ZS5ub2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gc3ByaXRlLm5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZnVuID0gZm4obm9kZSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuLCAxMDApO1xyXG4gICAgICAgICAgICAvL+mBjeWOhuajgOafpeeci+aYr+WQpuacieacquaJk+e8uueahOeJjCDlpoLmnpzmnInvvIzliJnpnIDopoHlsIbkuI3mmK/lrprnvLrnmoTniYzorr7nva7kuLrkuI3lj6/nlKhcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCLmo4Dmn6XmmK/lkKbmnInotKLnpZ5cIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCLmsqHmnInotKLnpZ5cIik7XHJcbiAgICAgICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLnR1cm4pIHtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwi5rKh5pyJ6LSi56WeOlwiLCBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCwgY2MudnYuZ2FtZU5ldE1nci50dXJuKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5hY3RpdmUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOayoeaciei9ruWIsOWHuueJjOmhuuW6jyzkuI3og73ngrnlh7vpurvlsIZcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5hY3RpdmUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlh7rniYzpu5jorqTov5jmmK/lj6/ku6Xngrnlh7vnmoRcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/lpoLmnpznjqnlrrbmiYvkuIrov5jmnInnvLrnmoTniYzmsqHmnInmiZPvvIzliJnlj6rog73miZPnvLrniYxcclxuICAgIGluaXRUaW5nZWRIb2xkczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5pyJ6LSi56WeLOW9k+eEtuS4jeiDveaYvuekuuWQrOeJjOWTjlxyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrSGFzQ2FpU2hlbigpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY29uZiA9PSBudWxsIHx8ICFjYy52di5nYW1lTmV0TWdyLmdldFNlbGZEYXRhKCkudGluZ2VkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fbXlNSkFyci5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUubWpJZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLnR1cm4pIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5hY3RpdmUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSBpID09IDEzO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5hY3RpdmUgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0RXh0cmFQYWlIb2xkczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLov5DooYzliLDov5nph4zlk6ZleHRyYVBhaUhvbGRzXCIpO1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrSGFzQ2FpU2hlbigpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNlbGZEYXRhID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWxmRGF0YSgpO1xyXG4gICAgICAgIGlmIChzZWxmRGF0YS5leHRyYVBhaXMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLlvZPliY3lpJrkvZnnmoTniYzkuI3lrZjlnKgs5LiN6ZyA6KaB6aKd5aSW5aSE55CG5omL54mMXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmNvbmYgPT0gbnVsbCB8fCAhc2VsZkRhdGEudGluZ2VkKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fbXlNSkFyci5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUubWpJZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLnR1cm4pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5Yik5pat5piv5ZCm5piv6Ieq5bexXCIpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAxNDsgKytqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbal07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIg5b2T5YmN55qE6bq75bCG55qEaWTmmK9cIiwgc3ByaXRlLm5vZGUubWpJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzcHJpdGUubm9kZS5hY3RpdmUgPT0gdHJ1ZSkgJiYgKHNwcml0ZS5ub2RlLm1qSWQgIT0gbnVsbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGZEYXRhLmV4dHJhUGFpcy5pbmRleE9mKHNwcml0ZS5ub2RlLm1qSWQpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5YeG5aSH6YCJ5oup5ZOq5Lqb5Y+v55SoXCIsIHNwcml0ZS5ub2RlLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5YeG5aSH6YCJ5oup5ZOq5Lqb5Y+v5Lul56aB55So55qEXCIsIHNwcml0ZS5ub2RlLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL2x56Ym05a6a44CC6L+Z5qC35YaZ5piv6ZSZ6K+v55qE44CC5Zug5Li66L+Z5qC35aeL57uI5piv5pyA5ZCO5LiA5Liq5Y+v5pON5L2c77yM5LiO6ZyA5rGC5LiN56ymXHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGZEYXRhLmV4dHJhUGFpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwi5b2T5YmN54mM5pivXCIsIHNlbGZEYXRhLmV4dHJhUGFpc1tpXSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHBhaUlkID0gc2VsZkRhdGEuZXh0cmFQYWlzW2ldO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGZvciAodmFyIGogPSAwOyBqIDwgMTQ7ICsraikge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5fbXlNSkFycltqXTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coXCIg5b2T5YmN55qE6bq75bCG55qEaWTmmK9cIiwgc3ByaXRlLm5vZGUubWpJZCk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlmICgoc3ByaXRlLm5vZGUuYWN0aXZlID09IHRydWUpICYmIChzcHJpdGUubm9kZS5taklkICE9IG51bGwpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBpZiAoc3ByaXRlLm5vZGUubWpJZCA9PSBwYWlJZCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5YeG5aSH6YCJ5oup5ZOq5Lqb5Y+v55SoXCIsIHNwcml0ZS5ub2RlLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5YeG5aSH6YCJ5oup5ZOq5Lqb5Y+v5Lul56aB55So55qEXCIsIHNwcml0ZS5ub2RlLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNwcml0ZS5ub2RlLmFjdGl2ZSA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNob3dUaW5nZWRGbGFnOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInNob3dUaW5nZWRGbGFnXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2MudnYuZ2FtZU5ldE1nci5zZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgc2VhdERhdGEgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzW2ldO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChpKTtcclxuICAgICAgICAgICAgdmFyIGh1cGFpID0gdGhpcy5faHVwYWlUaXBzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICBodXBhaS5hY3RpdmUgPSBzZWF0RGF0YS50aW5nZWQ7XHJcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS50aW5nZWQpIHtcclxuICAgICAgICAgICAgICAgIGh1cGFpLmdldENoaWxkQnlOYW1lKFwic3BySHVcIikuYWN0aXZlID0gIXNlYXREYXRhLnRpbmdlZDtcclxuICAgICAgICAgICAgICAgIGh1cGFpLmdldENoaWxkQnlOYW1lKFwic3ByWmltb1wiKS5hY3RpdmUgPSAhc2VhdERhdGEudGluZ2VkO1xyXG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJUaW5nXCIpLmFjdGl2ZSA9IHNlYXREYXRhLnRpbmdlZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICByZXNldFBhaTogZnVuY3Rpb24oaXNTaG93KSB7XHJcbiAgICAgICAgLy/ov5jljp/ooqvmi5bliqjnmoTniYznmoTkvY3nva5cclxuICAgICAgICB2YXIgdG91Y2hfdGFyZ2V0ID0gY2MudnYuZ2xvYmFsLnRvdWNoX3RhcmdldDtcclxuICAgICAgICBpZiAodG91Y2hfdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHRvdWNoX3RhcmdldC54ID0gdG91Y2hfdGFyZ2V0Lm9sZF9ub2RlX3g7XHJcbiAgICAgICAgICAgIHRvdWNoX3RhcmdldC55ID0gMDtcclxuICAgICAgICAgICAgaWYgKGlzU2hvdykge1xyXG4gICAgICAgICAgICAgICAgdG91Y2hfdGFyZ2V0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaW5pdEV2ZW50SGFuZGxlcnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZGF0YUV2ZW50SGFuZGxlciA9IHRoaXMubm9kZTtcclxuICAgICAgICAvL+WIneWni+WMluS6i+S7tuebkeWQrOWZqFxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfaG9sZHMnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XHJcbiAgICAgICAgICAgIHNlbGYuY2hlY2tDYWlTaGVuKCk7XHJcbiAgICAgICAgICAgIHZhciBzZWxmRGF0YSA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VsZkRhdGEoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNlbGZEYXRhXCIsIHNlbGZEYXRhLmV4dHJhUGFpcyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcclxuICAgICAgICAgICAgaWYgKHNlbGZEYXRhICE9IG51bGwgJiYgc2VsZkRhdGEuZXh0cmFQYWlzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmRGF0YS5leHRyYVBhaXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5b2T5YmN5aSa5L2Z55qE54mM5a2Y5ZyoLOWImemcgOimgemineWkluWkhOeQhuaJi+eJjFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmluaXRFeHRyYVBhaUhvbGRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZkRhdGEuZXh0cmFQYWlzID0gW107XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdFRpbmdlZEhvbGRzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfYmVnaW4nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYub25HYW1lQmVpZ24oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfc3luYycsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5vbkdhbWVCZWlnbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9jaHVwYWknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5oaWRlQ2h1cGFpKCk7XHJcbiAgICAgICAgICAgIHNlbGYuY2hlY2tDYWlTaGVuKCk7XHJcbiAgICAgICAgICAgIHZhciBzZWxmRGF0YSA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VsZkRhdGEoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInNlbGZEYXRhXCIsIHNlbGZEYXRhLmV4dHJhUGFpcyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcclxuICAgICAgICAgICAgaWYgKHNlbGZEYXRhICE9IG51bGwgJiYgc2VsZkRhdGEuZXh0cmFQYWlzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmRGF0YS5leHRyYVBhaXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5b2T5YmN5aSa5L2Z55qE54mM5a2Y5ZyoLOWImemcgOimgemineWkluWkhOeQhuaJi+eJjFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmluaXRFeHRyYVBhaUhvbGRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZkRhdGEuZXh0cmFQYWlzID0gW107XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdFRpbmdlZEhvbGRzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRhdGEubGFzdCAhPSBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoZGF0YS5sYXN0LCBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWNjLnZ2LnJlcGxheU1nci5pc1JlcGxheSgpICYmIGRhdGEudHVybiAhPSBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoZGF0YS50dXJuLCAtMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/pu5jorqTkuI3lj6/ku6Xlh7rniYxcclxuICAgICAgICAgICAgc2VsZi5fY2FuQ2h1cGFpID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICghc2VsZi5jaGVja0hhc0NhaVNoZW4oKSAmJiBkYXRhLnR1cm4gPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIC8v5Yik5pat5piv5ZCm5Y+v5Lul5Ye654mMLOWPquacieW9k+eOqeWutuayoeaciei0ouelnizkuJTmjIHmnInor53or63mnYPmiY3og73lh7rniYwo5Zug5Li6J2dhbWVfY2h1cGFpJyDmmK/lj5Hnu5nmiYDmnInkurrnmoQp44CCXHJcbiAgICAgICAgICAgICAgICBzZWxmLl9jYW5DaHVwYWkgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX21vcGFpJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVDaHVwYWkoKTtcclxuICAgICAgICAgICAgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGRhdGEuc2VhdEluZGV4KTtcclxuICAgICAgICAgICAgaWYgKGxvY2FsSW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMTM7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gc2VsZi5fbXlNSkFycltpbmRleF07XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgc3ByaXRlLCBwYWksIGluZGV4KTtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5taklkID0gcGFpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fY2FuQ2h1cGFpID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjYy52di5yZXBsYXlNZ3IuaXNSZXBsYXkoKSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoZGF0YS5zZWF0SW5kZXgsIHBhaSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9jYW5DaHVwYWkgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy52di5nbG9iYWwudG91Y2hfdGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICAgICAgY2MudnYuZ2xvYmFsLnNob290UG9zID0gbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfYWN0aW9uJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLl9vcHRpb25zRGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLnNob3dBY3Rpb24oZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImdhbWVfYWN0aW9uLS0tLS3mmK/lkKblj6/ku6XlkIPniYxcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgIC8vIGlmIChkYXRhLmRldGFpbCAmJiBkYXRhLmRldGFpbC5jaGkpIHtcclxuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwi5Y+v5Lul5ZCD54mMXCIpO1xyXG4gICAgICAgICAgICAvLyAgICAgc2VsZi5zaG93Q2hpQWN0aW9uKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAvLyBpZiAoZGF0YS5kZXRhaWwpIHtcclxuICAgICAgICAgICAgLy8gICAgIGlmIChkYXRhLmRldGFpbC5wZW5nIHx8IGRhdGEuZGV0YWlsLmdhbmcgfHwgZGF0YS5kZXRhaWwuaHUpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhcIueisOadoOiDoVwiKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICBzZWxmLnNob3dBY3Rpb24oZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdodXBhaScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJseTrmnInkurrog6HniYzkuoZcIik7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZUNoaU9wdGlvbnMoKTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgLy/lpoLmnpzkuI3mmK/njqnlrrboh6rlt7HvvIzliJnlsIbnjqnlrrbnmoTniYzpg73mlL7lgJJcclxuICAgICAgICAgICAgdmFyIHNlYXRJbmRleCA9IGRhdGEuc2VhdGluZGV4O1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChzZWF0SW5kZXgpO1xyXG4gICAgICAgICAgICB2YXIgaHVwYWkgPSBzZWxmLl9odXBhaVRpcHNbbG9jYWxJbmRleF07XHJcbiAgICAgICAgICAgIGh1cGFpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChsb2NhbEluZGV4ID09IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaGlkZU9wdGlvbnMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc2VhdERhdGEgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzW3NlYXRJbmRleF07XHJcbiAgICAgICAgICAgIHNlYXREYXRhLmh1ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5jb25mLnR5cGUgPT0gXCJ5a3hcIikge1xyXG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJIdVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJaaW1vXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJUaW5nXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0SHVwYWkobG9jYWxJbmRleCwgZGF0YS5odXBhaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5pc3ppbW8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXREYXRhLmhvbGRzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmluaXRNYWhqb25ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdE90aGVyTWFoam9uZ3Moc2VhdERhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGh1cGFpLmdldENoaWxkQnlOYW1lKFwic3BySHVcIikuYWN0aXZlID0gIWRhdGEuaXN6aW1vO1xyXG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJaaW1vXCIpLmFjdGl2ZSA9IGRhdGEuaXN6aW1vO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEoZGF0YS5pc3ppbW8gJiYgbG9jYWxJbmRleCA9PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vaWYoY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgPT0gZmFsc2UgJiYgbG9jYWxJbmRleCAhPSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBzZWxmLmluaXRFbXB0eVNwcml0ZXMoc2VhdEluZGV4KTsgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbml0TW9wYWkoc2VhdEluZGV4LCBkYXRhLmh1cGFpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpZiAoY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgPT0gdHJ1ZSAmJiBjYy52di5nYW1lTmV0TWdyLmNvbmYudHlwZSAhPSBcInlreFwiKSB7XHJcbiAgICAgICAgICAgIC8vICAgICB2YXIgb3B0ID0gc2VsZi5fb3B0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICAgICAgLy8gICAgIG9wdC5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vICAgICBvcHQuc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIGRhdGEuaHVwYWkpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmlzemltbykge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5wbGF5RWZ4KGxvY2FsSW5kZXgsIFwicGxheV96aW1vXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5wbGF5RWZ4KGxvY2FsSW5kZXgsIFwicGxheV9odVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5wbGF5U0ZYKFwibnYvaHUubXAzXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignbWpfY291bnQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX21qY291bnQuc3RyaW5nID0gXCLliankvZlcIiArIGNjLnZ2LmdhbWVOZXRNZ3IubnVtT2ZNSiArIFwi5bygXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX251bScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5fZ2FtZWNvdW50LnN0cmluZyA9IFwiXCIgKyBjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMgKyBcIi9cIiArIGNjLnZ2LmdhbWVOZXRNZ3IubWF4TnVtT2ZHYW1lcyArIFwi5bGAXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX292ZXInLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZ2FtZVJvb3QuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYucHJlcGFyZVJvb3QuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfY2h1cGFpX25vdGlmeScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5oaWRlQ2h1cGFpKCk7XHJcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGRhdGEuZGV0YWlsLnNlYXREYXRhO1xyXG4gICAgICAgICAgICAvL+WmguaenOaYr+iHquW3se+8jOWImeWIt+aWsOaJi+eJjFxyXG4gICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9jYW5DaHVwYWkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8v6L+Y5Y6f6KKr5ouW5Yqo55qE54mM55qE5L2N572uXHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlc2V0UGFpKCk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3VjaF90YXJnZXQgPSBjYy52di5nbG9iYWwudG91Y2hfdGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3VjaF90YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG91Y2hfdGFyZ2V0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0T3RoZXJNYWhqb25ncyhzZWF0RGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5zaG93Q2h1cGFpKCk7XHJcbiAgICAgICAgICAgIC8vIOiKseeJjOayoeacieWvueW6lOeahOWjsOmfs1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5kZXRhaWwucGFpIDwgMzQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhdWRpb1VybCA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0QXVkaW9VUkxCeU1KSUQoZGF0YS5kZXRhaWwucGFpKTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiYXVkaW9VcmwhISFcIiArIGF1ZGlvVXJsKTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoYXVkaW9VcmwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/otKLnpZ7lpITnkIZcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfY2Fpc2hlbl9ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwi6LSi56We5LqL5Lu255uR5ZCsISEhISEhISEhISEhIVwiLCBkYXRhKTtcclxuICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCfotKLnpZ7kuovku7bnm5HlkKwnLCBzZWF0RGF0YSk7XHJcbiAgICAgICAgICAgIC8v5aaC5p6c5piv6Ieq5bex77yM5YiZ5Yi35paw5omL54mMXHJcbiAgICAgICAgICAgIC8vIGlmIChzZWF0RGF0YS5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgLy8gICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgdmFyIHRvdWNoX3RhcmdldCA9IGNjLnZ2Lmdsb2JhbC50b3VjaF90YXJnZXQ7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgaWYgKHRvdWNoX3RhcmdldCkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICB0b3VjaF90YXJnZXQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgc2VsZi5pbml0Q2FpU2hlbkxpc3QoKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICBzZWxmLmluaXRNYWhqb25ncygpO1xyXG4gICAgICAgICAgICAvLyAgICAgfSwgNTAwKTtcclxuICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gICAgICBzZWxmLmluaXRPdGhlck1haGpvbmdzKHNlYXREYXRhKTtcclxuICAgICAgICAgICAgLy8gICAgIHNlbGYuaW5pdE90aGVyQ2FpU2hlbkxpc3Qoc2VhdERhdGEpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIHNlbGYuc2hvd0NodXBhaSgpO1xyXG4gICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRDYWlTaGVuTGlzdCgpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0TWFoam9uZ3MoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaW5pdE90aGVyTWFoam9uZ3Moc2VhdERhdGEpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pbml0T3RoZXJDYWlTaGVuTGlzdChzZWF0RGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ21hdGNoX2V4aXRfZXJyb3InLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v6ZSm5qCH6LWb5LiN6IO96YCA5Ye65ri45oiPXHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLplKbmoIfotZvkuK3kuI3og73pgIDlh7rmuLjmiI9cIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdndW9fbm90aWZ5JywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVDaHVwYWkoKTtcclxuICAgICAgICAgICAgc2VsZi5oaWRlT3B0aW9ucygpO1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVDaGlPcHRpb25zKCk7XHJcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICAvL+WmguaenOaYr+iHquW3se+8jOWImeWIt+aWsOaJi+eJjFxyXG4gICAgICAgICAgICBpZiAoc2VhdERhdGEuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRNYWhqb25ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJnaXZlLm1wM1wiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2d1b19yZXN1bHQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZU9wdGlvbnMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDmuLjmiI9cclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfcGxheWluZycsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5pbml0TWFoam9uZ3MoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3Blbmdfbm90aWZ5JywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVDaGlPcHRpb25zKCk7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZUNodXBhaSgpO1xyXG4gICAgICAgICAgICB2YXIgc2VhdERhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLmraTml7bnjqnlrrbnmoRzZWF0ZGF0ZVwiLCBzZWF0RGF0YSk7XHJcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRPdGhlck1haGpvbmdzKHNlYXREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHNlbGYuZ2V0TG9jYWxJbmRleChzZWF0RGF0YS5zZWF0aW5kZXgpO1xyXG4gICAgICAgICAgICBzZWxmLnBsYXlFZngobG9jYWxJbmRleCwgXCJwbGF5X3BlbmdcIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJudi9wZW5nLm1wM1wiKTtcclxuICAgICAgICAgICAgc2VsZi5oaWRlT3B0aW9ucygpO1xyXG4gICAgICAgICAgICBzZWF0RGF0YS50aW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxmLnNob3dUaW5nZWRGbGFnKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g5ZCDXHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKFwiY2hpX25vdGlmeVwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHNlbGYuZ2V0TG9jYWxJbmRleChzZWF0RGF0YSk7XHJcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRPdGhlck1haGpvbmdzKHNlYXREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBUT0RPIOWQg+eJjOeJueaViOaciWJ1Z1xyXG4gICAgICAgICAgICAvLyBzZWxmLnBsYXlFZngobG9jYWxJbmRleCwgXCJwbGF5X3BlbmdcIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJudi9jaGkubXAzXCIpO1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVDaGlPcHRpb25zKCk7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZU9wdGlvbnMoKTtcclxuICAgICAgICAgICAgc2VhdERhdGEudGluZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZi5zaG93VGluZ2VkRmxhZygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FuZ19ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZUNoaU9wdGlvbnMoKTtcclxuICAgICAgICAgICAgc2VsZi5oaWRlQ2h1cGFpKCk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGRhdGEuc2VhdERhdGE7XHJcbiAgICAgICAgICAgIHZhciBnYW5ndHlwZSA9IGRhdGEuZ2FuZ3R5cGU7XHJcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaW5pdE1haGpvbmdzKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmluaXRPdGhlck1haGpvbmdzKHNlYXREYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHNlbGYuZ2V0TG9jYWxJbmRleChzZWF0RGF0YS5zZWF0aW5kZXgpO1xyXG4gICAgICAgICAgICBzZWxmLnBsYXlFZngobG9jYWxJbmRleCwgXCJwbGF5X2dhbmdcIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJudi9nYW5nLm1wM1wiKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS0tLS0tLS1zZWF0RGF0YS0tLS0tLS0tLS0tLS0+PlwiLCBzZWF0RGF0YS50aW5nZWQsIHNlYXREYXRhKTtcclxuICAgICAgICAgICAgaWYgKHNlYXREYXRhLmFuZ2FuZ3MubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIHNlYXREYXRhLnRpbmdlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5zaG93VGluZ2VkRmxhZygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihcImhhbmdhbmdfbm90aWZ5XCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBzZWxmLmdldExvY2FsSW5kZXgoZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYucGxheUVmeChsb2NhbEluZGV4LCBcInBsYXlfZ2FuZ1wiKTtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChcIm52L2dhbmcubXAzXCIpO1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVPcHRpb25zKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgc2hvd0NodXBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBhaSA9IGNjLnZ2LmdhbWVOZXRNZ3IuY2h1cGFpO1xyXG4gICAgICAgIGlmIChwYWkgPj0gMCkge1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHRoaXMuZ2V0TG9jYWxJbmRleChjYy52di5nYW1lTmV0TWdyLnR1cm4pO1xyXG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5fY2h1cGFpU3ByaXRlW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgcGFpKTtcclxuICAgICAgICAgICAgdmFyIHRhcmdldF9ub2RlID0gc3ByaXRlLm5vZGU7XHJcbiAgICAgICAgICAgIHZhciBvbGRfeCA9IHRhcmdldF9ub2RlLng7XHJcbiAgICAgICAgICAgIHZhciBvbGRfeSA9IHRhcmdldF9ub2RlLnk7XHJcbiAgICAgICAgICAgIHNwcml0ZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciBwb3MgPSBjYy52di5nbG9iYWwuc2hvb3RQb3M7XHJcbiAgICAgICAgICAgIHN3aXRjaCAobG9jYWxJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X25vZGUueCA9IHBvcy54ICogMS4xOyAvL+enu+WIsOWHuueJjOS9jee9rlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRfbm9kZS55ID0gcG9zLnkgKiAxLjEgLSAxNTg7IC8v56e75Yiw5Ye654mM5L2N572uXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldF9ub2RlLnggPSBjYy5maW5kKFwiQ2FudmFzL2dhbWUvcmlnaHRcIikueDtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRfbm9kZS55ID0gLTE1MDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRfbm9kZS54ID0gLTUwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldF9ub2RlLnkgPSAyNzY7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X25vZGUueCA9IGNjLmZpbmQoXCJDYW52YXMvZ2FtZS9sZWZ0XCIpLng7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0X25vZGUueSA9IDE1MDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gY2MubW92ZVRvKDAuMDUsIGNjLnAob2xkX3gsIG9sZF95KSk7XHJcbiAgICAgICAgICAgIC8v5Yqo55S76ZyA6KaB6ZqQ6JeP6Ieq5bex5Ye655qE54mMXHJcbiAgICAgICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLnR1cm4gJiYgY2MudnYuZ2xvYmFsLnRvdWNoX3RhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYuZ2xvYmFsLnRvdWNoX3RhcmdldC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0YXJnZXRfbm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdG9DaGlBY3Rpb25QYWdlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcInRvIOWQgyDmk43kvZznmoTpobXpnaJcIik7XHJcbiAgICAgICAgdGhpcy5zaG93Q2hpQWN0aW9uKHRoaXMuX29wdGlvbnNEYXRhKTtcclxuICAgIH0sXHJcbiAgICAvLyDnorDvvIzmnaDvvIzog6HvvIzov4fmk43kvZxcclxuICAgIGFkZE9wdGlvbjogZnVuY3Rpb24oYnRuTmFtZSwgcGFpKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9vcHRpb25zLmNoaWxkcmVuQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLl9vcHRpb25zLmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQubmFtZSA9PSBcIm9wXCIgJiYgY2hpbGQuYWN0aXZlID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IGNoaWxkLmdldENoaWxkQnlOYW1lKFwib3BUYXJnZXRcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKFwiTV9cIiwgcGFpKTtcclxuICAgICAgICAgICAgICAgIHZhciBidG4gPSBjaGlsZC5nZXRDaGlsZEJ5TmFtZShidG5OYW1lKTtcclxuICAgICAgICAgICAgICAgIGJ0bi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnRuLnBhaSA9IHBhaTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDlkIPniYzmk43kvZxcclxuICAgIGFkZENoaU9wdGlvbjogZnVuY3Rpb24oYnRuTmFtZSwgZGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5ZCD54mM5pON5L2cYWRkY2hpb3B0aW9uXCIsIGRhdGEpO1xyXG4gICAgICAgIC8vIOaYvuekuuWFqOmDqFxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2hpT3B0cy5jaGlsZHJlbkNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5fY2hpT3B0cy5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgY2hpbGQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLm5hbWUgPT0gXCJidG5DaGlcIikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGFpICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5wYWkgPSBkYXRhLnBhaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NoaU9wdHMuY2hpbGRyZW5Db3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuX2NoaU9wdHMuY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMzsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBcIm9wXCIgKyBqO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5hbWUgPT0gaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NoaU9wdHMuY2hpbGRyZW5Db3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnRuYW1lID0gdGhpcy5fY2hpT3B0cy5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgdmFyIGluZm8gPSBkYXRhLmNoaUFycmF5SW5mbztcclxuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDnm67moIfniYxcclxuICAgICAgICAgICAgaWYgKHBhcmVudG5hbWUubmFtZSA9PSBcIm9wVGFyZ2V0XCIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnBhaSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHBhcmVudG5hbWUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIGRhdGEucGFpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGluZm8ubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gXCJvcFwiICsgaztcclxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRuYW1lLm5hbWUgPT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudG5hbWUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGROYW1lID0gXCJwYWlcIiArIGs7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhaUluZm8gPSBpbmZvW2tdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoaUFycmF5cy5wdXNoKHBhaUluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0aGlzLl9jaGlBcnJheXN0aGlzLl9jaGlBcnJheXN0aGlzLl9jaGlBcnJheXN0aGlzLl9jaGlBcnJheXMnLCB0aGlzLl9jaGlBcnJheXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0NoaVBhaUFycmF5KHBhcmVudG5hbWUsIHBhaUluZm8pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g5pi+56S65ZCD54mM55qE57uE5ZCIXHJcbiAgICBzaG93Q2hpUGFpQXJyYXk6IGZ1bmN0aW9uKHBhcmVudG5hbWUsIGRhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIuaYvuekuuWQg+eJjOeahOe7hOWQiFwiLCBkYXRhLCB0aGlzLl9jaGlBcnJheXMpO1xyXG4gICAgICAgIGlmIChkYXRhICE9IG51bGwgJiYgZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCAyOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFpID0gZGF0YVtpbmRleF07XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFpbmFtZSA9IFwicGFpXCIgKyBpbmRleDtcclxuICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSBwYXJlbnRuYW1lLmdldENoaWxkQnlOYW1lKHBhaW5hbWUpLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHBhaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g6ZqQ6JeP56Kw5p2g6IOh54mM5pON5L2cXHJcbiAgICBoaWRlT3B0aW9uczogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX29wdGlvbnMuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oaWRlQ2hpT3B0aW9ucygpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fb3B0aW9ucy5jaGlsZHJlbkNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5fb3B0aW9ucy5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLm5hbWUgPT0gXCJvcFwiKSB7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwiYnRuUGVuZ1wiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwiYnRuR2FuZ1wiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNoaWxkLmdldENoaWxkQnlOYW1lKFwiYnRuSHVcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC5nZXRDaGlsZEJ5TmFtZShcImJ0bkNoaVwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDpmpDol4/lkIPniYznmoTmk43kvZxcclxuICAgIGhpZGVDaGlPcHRpb25zOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIumakOiXj2hpZGVDaGlPcHRpb25zXCIsIHRoaXMuX2NoaU9wdHMuY2hpbGRyZW5Db3VudCk7XHJcbiAgICAgICAgdGhpcy5fY2hpT3B0cy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NoaU9wdHMuY2hpbGRyZW5Db3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuX2NoaU9wdHMuY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgIGNoaWxkLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaG93QWN0aW9uOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbnMuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZU9wdGlvbnMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRhdGEgJiYgKGRhdGEuaHUgfHwgZGF0YS5nYW5nIHx8IGRhdGEucGVuZyB8fCBkYXRhLmNoaSkpIHtcclxuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5odSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRPcHRpb24oXCJidG5IdVwiLCBkYXRhLnBhaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRhdGEucGVuZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRPcHRpb24oXCJidG5QZW5nXCIsIGRhdGEucGFpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGF0YS5nYW5nKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuZ2FuZ3BhaS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBncCA9IGRhdGEuZ2FuZ3BhaVtpXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZE9wdGlvbihcImJ0bkdhbmdcIiwgZ3ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmNoaSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRPcHRpb24oXCJidG5DaGlcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgc2VsZkRhdGEgPSBjYy52di5nYW1lTmV0TWdyLmdldFNlbGZEYXRhKCk7XHJcbiAgICAgICAgICAgIGlmIChzZWxmRGF0YS50aW5nZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIC8v5rOoMSk6MjAxNyAwNyAyNiBseVxyXG4gICAgICAgICAgICAgICAgLy/kuIvpnaLoh6rliqjlh7rniYzkuI3lnKjpnIDopoHvvIznlLHmnI3liqHlmajnq6/ljrvlrozmiJBcclxuICAgICAgICAgICAgICAgIC8v5Y6f5Zug5piv77yaIOS4i+mdouivreWPpeaJp+ihjOWQjuS8muS6p+eUn+S4gOenjeeJjOS4jeaYvuekuueahGJ1Z+OAgiBcclxuICAgICAgICAgICAgICAgIC8vICAgICAgYnVn5piv5b+F546w44CC5Y6f5Zug5LiN5piO44CCXHJcbiAgICAgICAgICAgICAgICAvLyAvL+WmguaenOW3sue7j+WQrOeJjO+8jOW5tuS4lOayoeacieaTjeS9nO+8jOWImeiHquWKqOaJk+eJjFxyXG4gICAgICAgICAgICAgICAgLy8gdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbdGhpcy5fbXlNSkFyci5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgIC8vIHZhciBub2RlID0gc3ByaXRlLm5vZGU7XHJcbiAgICAgICAgICAgICAgICAvLyBjYy52di5nbG9iYWwudG91Y2hfdGFyZ2V0ID0gbm9kZTtcclxuICAgICAgICAgICAgICAgIC8vIG5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnNob290KG5vZGUubWpJZCk7XHJcbiAgICAgICAgICAgICAgICAvLyBub2RlLnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5yZWNvcmRTaG9vdFBvcyhub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDlkIPniYznmoTmk43kvZxcclxuICAgIHNob3dDaGlBY3Rpb246IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIuWQg+eJjOaTjeS9nFwiLCBkYXRhKTtcclxuICAgICAgICAvLyDlpoLmnpznorDniYznmoTmk43kvZznlYzpnaLmmL7npLrkuoYs5YWI6ZqQ6JePLOato+W4uOaDheWGteS4i+i/meaYr+S4jeWPr+iDveeahFxyXG4gICAgICAgIGlmICh0aGlzLl9vcHRpb25zLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVPcHRpb25zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9jaGlPcHRzLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVDaGlPcHRpb25zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhICYmIGRhdGEuY2hpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoaU9wdHMuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fY2hpQXJyYXlzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX2NoaU9wdGlvbkFycmF5ID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpT3B0aW9uKCdidG5DaGknLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaW5pdFdhbmZhTGFiZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB3YW5mYSA9IGNjLmZpbmQoXCJDYW52YXMvaW5mb2Jhci93YW5mYVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHdhbmZhLnN0cmluZyA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0V2FuZmEoKTtcclxuICAgIH0sXHJcbiAgICBpbml0SHVwYWk6IGZ1bmN0aW9uKGxvY2FsSW5kZXgsIHBhaSkge1xyXG4gICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLmNvbmYudHlwZSA9PSBcInlreFwiKSB7XHJcbiAgICAgICAgICAgIHZhciBodXBhaWxpc3QgPSB0aGlzLl9odXBhaUxpc3RzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGh1cGFpbGlzdC5jaGlsZHJlbi5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGh1cGFpbm9kZSA9IGh1cGFpbGlzdC5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgICAgIGlmIChodXBhaW5vZGUuYWN0aXZlID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBodXBhaW5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgcGFpKTtcclxuICAgICAgICAgICAgICAgICAgICBodXBhaW5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDlnKjog6HniYzloIbph4zpnaLlpITnkIbotKLnpZ7mmL7npLpcclxuICAgIGluaXRDYWlTaGVuOiBmdW5jdGlvbihsb2NhbEluZGV4LCBwYWkpIHtcclxuICAgICAgICB2YXIgaHVwYWlsaXN0ID0gdGhpcy5faHVwYWlMaXN0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGh1cGFpbGlzdC5jaGlsZHJlbi5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgaHVwYWlub2RlID0gaHVwYWlsaXN0LmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBpZiAoaHVwYWlub2RlLmFjdGl2ZSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcclxuICAgICAgICAgICAgICAgIGh1cGFpbm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBwYWkpO1xyXG4gICAgICAgICAgICAgICAgaHVwYWlub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBwbGF5RWZ4OiBmdW5jdGlvbihpbmRleCwgbmFtZSkge1xyXG4gICAgICAgIHRoaXMuX3BsYXlFZnhzW2luZGV4XS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fcGxheUVmeHNbaW5kZXhdLnBsYXkobmFtZSk7XHJcbiAgICB9LFxyXG4gICAgb25HYW1lQmVpZ246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fcGxheUVmeHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5fcGxheUVmeHNbaV0ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9odXBhaUxpc3RzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5faHVwYWlMaXN0c1tpXS5jaGlsZHJlbkNvdW50OyArK2opIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2h1cGFpTGlzdHNbaV0uY2hpbGRyZW5bal0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYy52di5nYW1lTmV0TWdyLnNlYXRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHNbaV07XHJcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGkpO1xyXG4gICAgICAgICAgICB2YXIgaHVwYWkgPSB0aGlzLl9odXBhaVRpcHNbbG9jYWxJbmRleF07XHJcbiAgICAgICAgICAgIGh1cGFpLmFjdGl2ZSA9IHNlYXREYXRhLmh1ZWQ7XHJcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YS5odWVkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzog6HniYzkuoYu6IKv5a6a5LiN5pi+56S65ZCs54mM5LqGXHJcbiAgICAgICAgICAgICAgICBodXBhaS5nZXRDaGlsZEJ5TmFtZShcInNwckh1XCIpLmFjdGl2ZSA9ICFzZWF0RGF0YS5pc3ppbW87XHJcbiAgICAgICAgICAgICAgICBodXBhaS5nZXRDaGlsZEJ5TmFtZShcInNwclppbW9cIikuYWN0aXZlID0gc2VhdERhdGEuaXN6aW1vO1xyXG4gICAgICAgICAgICAgICAgaHVwYWkuZ2V0Q2hpbGRCeU5hbWUoXCJzcHJUaW5nXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlkZUNodXBhaSgpO1xyXG4gICAgICAgIHRoaXMuaGlkZU9wdGlvbnMoKTtcclxuICAgICAgICB2YXIgc2lkZXMgPSBbXCJyaWdodFwiLCBcInVwXCIsIFwibGVmdFwiXTtcclxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpZGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzaWRlQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZXNbaV0pO1xyXG4gICAgICAgICAgICB2YXIgaG9sZHMgPSBzaWRlQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJob2xkc1wiKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBob2xkcy5jaGlsZHJlbkNvdW50OyArK2opIHtcclxuICAgICAgICAgICAgICAgIHZhciBuYyA9IGhvbGRzLmNoaWxkcmVuW2pdO1xyXG4gICAgICAgICAgICAgICAgbmMuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIG5jLnNjYWxlWCA9IDEuMDtcclxuICAgICAgICAgICAgICAgIG5jLnNjYWxlWSA9IDEuMDtcclxuICAgICAgICAgICAgICAgIHZhciBzcHJpdGUgPSBuYy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuaG9sZHNFbXB0eVtpICsgMV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuZ2FtZXN0YXRlID09IFwiXCIgJiYgY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmdhbWVSb290LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5wcmVwYXJlUm9vdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmluaXRNYWhqb25ncygpO1xyXG4gICAgICAgIHRoaXMuaW5pdENhaVNoZW5MaXN0KCk7XHJcbiAgICAgICAgdmFyIHNlYXRzID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlYXRzKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0RGF0YSA9IHNlYXRzW2ldO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleChpKTtcclxuICAgICAgICAgICAgaWYgKGxvY2FsSW5kZXggIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0T3RoZXJNYWhqb25ncyhzZWF0RGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRPdGhlckNhaVNoZW5MaXN0KHNlYXREYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmIChpID09IGNjLnZ2LmdhbWVOZXRNZ3IudHVybikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdE1vcGFpKGksIC0xKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0TW9wYWkoaSwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaG93Q2h1cGFpKCk7XHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuY3VyYWN0aW9uICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fb3B0aW9uc0RhdGEgPSBjYy52di5nYW1lTmV0TWdyLmN1cmFjdGlvbjtcclxuICAgICAgICAgICAgdGhpcy5zaG93QWN0aW9uKGNjLnZ2LmdhbWVOZXRNZ3IuY3VyYWN0aW9uKTtcclxuICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jdXJhY3Rpb24gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrQ2FpU2hlbigpO1xyXG4gICAgICAgIHZhciBzZWxmRGF0YSA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VsZkRhdGEoKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJzZWxmRGF0YVwiLCBzZWxmRGF0YSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgICAgIGlmICghc2VsZkRhdGEuZXh0cmFQYWlzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlbGZEYXRhLmV4dHJhUGFpcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5b2T5YmN5aSa5L2Z55qE54mM5a2Y5ZyoLOWImemcgOimgemineWkluWkhOeQhuaJi+eJjFwiKTtcclxuICAgICAgICAgICAgdGhpcy5pbml0RXh0cmFQYWlIb2xkcygpO1xyXG4gICAgICAgICAgICBzZWxmRGF0YS5leHRyYVBhaXMgPSBbXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRUaW5nZWRIb2xkcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dUaW5nZWRGbGFnKCk7XHJcbiAgICB9LFxyXG4gICAgcmVjb3JkU2hvb3RQb3M6IGZ1bmN0aW9uKG5vZGUpIHsgLy/orrDlvZXlh7rniYzkvY3nva5cclxuICAgICAgICBpZiAobm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgcG9zID0ge1xyXG4gICAgICAgICAgICAgICAgeDogbm9kZS54LFxyXG4gICAgICAgICAgICAgICAgeTogbm9kZS55XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYuZ2xvYmFsLnNob290UG9zID0gcG9zO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbk1qVG9VcDogZnVuY3Rpb24obmMpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgbmMub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIGZ1bmN0aW9uKHRvdWNoKSB7XHJcbiAgICAgICAgICAgIGlmICghc2VsZi5fY2FuQ2h1cGFpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFuYy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgfHwgY2MudnYuZ2FtZU5ldE1nci50dXJuICE9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vbGRfbm9kZV94ID0gbmMueDtcclxuICAgICAgICAgICAgdGhpcy5vbGRfbm9kZV95ID0gbmMueTtcclxuICAgICAgICAgICAgdGhpcy5vbGRfdG91Y2hfeCA9IHRvdWNoLmdldExvY2F0aW9uKCkueDtcclxuICAgICAgICAgICAgdGhpcy5vbGRfdG91Y2hfeSA9IHRvdWNoLmdldExvY2F0aW9uKCkueVxyXG4gICAgICAgICAgICBjYy52di5nbG9iYWwudG91Y2hfdGFyZ2V0ID0gbmM7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmMub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSwgZnVuY3Rpb24odG91Y2gpIHtcclxuICAgICAgICAgICAgaWYgKCFzZWxmLl9jYW5DaHVwYWkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIW5jLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSB8fCBjYy52di5nYW1lTmV0TWdyLnR1cm4gIT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdG91Y2hYX2RpZmYgPSB0b3VjaC5nZXRMb2NhdGlvbigpLnggLSB0aGlzLm9sZF90b3VjaF94O1xyXG4gICAgICAgICAgICB2YXIgdG91Y2hZX2RpZmYgPSB0b3VjaC5nZXRMb2NhdGlvbigpLnkgLSB0aGlzLm9sZF90b3VjaF95O1xyXG4gICAgICAgICAgICBpZiAodG91Y2hZX2RpZmYgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBuYy54ID0gdGhpcy5vbGRfbm9kZV94ICsgdG91Y2hYX2RpZmY7XHJcbiAgICAgICAgICAgICAgICBuYy55ID0gdGhpcy5vbGRfbm9kZV95ICsgdG91Y2hZX2RpZmY7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBuYy5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uKHRvdWNoKSB7XHJcbiAgICAgICAgICAgIGlmICghc2VsZi5fY2FuQ2h1cGFpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFuYy5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgfHwgY2MudnYuZ2FtZU5ldE1nci50dXJuICE9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHRvdWNoWV9kaWZmID0gdG91Y2guZ2V0TG9jYXRpb24oKS55IC0gdGhpcy5vbGRfdG91Y2hfeTtcclxuICAgICAgICAgICAgaWYgKHRvdWNoWV9kaWZmID4gbmMuaGVpZ2h0IC8gMikge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZWNvcmRTaG9vdFBvcyhuYyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0TWFoam9uZ1R5cGUobmMubWpJZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG9vdENhaVNoZW4obmMubWpJZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvb3QobmMubWpJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBuYy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+i/mOWOn+WIsOWOn+Wni+S9jee9rlxyXG4gICAgICAgICAgICBuYy54ID0gdGhpcy5vbGRfbm9kZV94O1xyXG4gICAgICAgICAgICBuYy55ID0gdGhpcy5vbGRfbm9kZV95O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG5jLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCwgZnVuY3Rpb24odG91Y2gpIHtcclxuICAgICAgICAgICAgaWYgKCFzZWxmLl9jYW5DaHVwYWkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIW5jLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSB8fCBjYy52di5nYW1lTmV0TWdyLnR1cm4gIT0gY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdG91Y2hDYW5jZWwgPSB0b3VjaC5nZXRMb2NhdGlvbigpO1xyXG4gICAgICAgICAgICB2YXIgZGVsdGEgPSB0b3VjaENhbmNlbC55IC0gdGhpcy5vbGRfdG91Y2hfeTtcclxuICAgICAgICAgICAgaWYgKGRlbHRhID4gbmMuaGVpZ2h0IC8gMikge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZWNvcmRTaG9vdFBvcyhuYyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0TWFoam9uZ1R5cGUobmMubWpJZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG9vdENhaVNoZW4obmMubWpJZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvb3QobmMubWpJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuYy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+i/mOWOn+WIsOWOn+Wni+S9jee9rlxyXG4gICAgICAgICAgICBuYy54ID0gdGhpcy5vbGRfbm9kZV94O1xyXG4gICAgICAgICAgICBuYy55ID0gdGhpcy5vbGRfbm9kZV95O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIG9uTUpDbGlja2VkOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX2NhbkNodXBhaSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5aaC5p6c5LiN5piv6Ieq5bex55qE6L2u5a2Q77yM5YiZ5b+955WlXHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IudHVybiAhPSBjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vdCB5b3VyIHR1cm4uXCIgKyBjYy52di5nYW1lTmV0TWdyLnR1cm4pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX215TUpBcnIubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PSB0aGlzLl9teU1KQXJyW2ldLm5vZGUpIHtcclxuICAgICAgICAgICAgICAgIC8v5aaC5p6c5piv5YaN5qyh54K55Ye777yM5YiZ5Ye654mMXHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09IHRoaXMuX3NlbGVjdGVkTUopIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBldmVudC50YXJnZXQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBjYy52di5tYWhqb25nbWdyLmdldE1haGpvbmdUeXBlKHRoaXMuX3NlbGVjdGVkTUoubWpJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gNCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob290Q2FpU2hlbih0aGlzLl9zZWxlY3RlZE1KLm1qSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvb3QodGhpcy5fc2VsZWN0ZWRNSi5taklkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRNSi55ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3RlZE1KID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJlY29yZFNob290UG9zKGV2ZW50LnRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NlbGVjdGVkTUogIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkTUoueSA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBldmVudC50YXJnZXQueSA9IDE1O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0ZWRNSiA9IGV2ZW50LnRhcmdldDtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+WHuueJjFxyXG4gICAgc2hvb3Q6IGZ1bmN0aW9uKG1qSWQpIHtcclxuICAgICAgICBpZiAobWpJZCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoJ2NodXBhaScsIG1qSWQpO1xyXG4gICAgfSxcclxuICAgIC8v5Ye654mMXHJcbiAgICBzaG9vdENhaVNoZW46IGZ1bmN0aW9uKG1qSWQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIui0ouelnizmjaLniYxcIik7XHJcbiAgICAgICAgaWYgKG1qSWQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOS4gOWumuimgeaYr+i0ouelnuaJjeiDvei/m+ihjOatpOaTjeS9nFxyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdjYWlzaGVuJywgbWpJZCk7XHJcbiAgICB9LFxyXG4gICAgZ2V0TUpJbmRleDogZnVuY3Rpb24oc2lkZSwgaW5kZXgpIHtcclxuICAgICAgICBpZiAoc2lkZSA9PSBcInJpZ2h0XCIgfHwgc2lkZSA9PSBcInVwXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDEzIC0gaW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbmRleDtcclxuICAgIH0sXHJcbiAgICBpbml0TW9wYWk6IGZ1bmN0aW9uKHNlYXRJbmRleCwgcGFpKSB7XHJcbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoc2VhdEluZGV4KTtcclxuICAgICAgICB2YXIgc2lkZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U2lkZShsb2NhbEluZGV4KTtcclxuICAgICAgICB2YXIgcHJlID0gY2MudnYubWFoam9uZ21nci5nZXRGb2xkUHJlKGxvY2FsSW5kZXgpO1xyXG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xyXG4gICAgICAgIHZhciBzaWRlQ2hpbGQgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoc2lkZSk7XHJcbiAgICAgICAgdmFyIGhvbGRzID0gc2lkZUNoaWxkLmdldENoaWxkQnlOYW1lKFwiaG9sZHNcIik7XHJcbiAgICAgICAgdmFyIGxhc3RJbmRleCA9IHRoaXMuZ2V0TUpJbmRleChzaWRlLCAxMyk7XHJcbiAgICAgICAgdmFyIG5jID0gaG9sZHMuY2hpbGRyZW5bbGFzdEluZGV4XTtcclxuICAgICAgICBuYy5zY2FsZVggPSAxLjA7XHJcbiAgICAgICAgbmMuc2NhbGVZID0gMS4wO1xyXG4gICAgICAgIGlmIChwYWkgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBuYy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhaSA+PSAwKSB7XHJcbiAgICAgICAgICAgIG5jLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwidXBcIikge1xyXG4gICAgICAgICAgICAgICAgbmMuc2NhbGVYID0gMC43MztcclxuICAgICAgICAgICAgICAgIG5jLnNjYWxlWSA9IDAuNzM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IG5jLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgcGFpKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhaSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIG5jLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwidXBcIikge1xyXG4gICAgICAgICAgICAgICAgbmMuc2NhbGVYID0gMS4wO1xyXG4gICAgICAgICAgICAgICAgbmMuc2NhbGVZID0gMS4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBuYy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRIb2xkc0VtcHR5U3ByaXRlRnJhbWUoc2lkZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRFbXB0eVNwcml0ZXM6IGZ1bmN0aW9uKHNlYXRJbmRleCkge1xyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXRJbmRleCk7XHJcbiAgICAgICAgdmFyIHNpZGUgPSBjYy52di5tYWhqb25nbWdyLmdldFNpZGUobG9jYWxJbmRleCk7XHJcbiAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcclxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcclxuICAgICAgICB2YXIgc2lkZUNoaWxkID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKHNpZGUpO1xyXG4gICAgICAgIHZhciBob2xkcyA9IHNpZGVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcImhvbGRzXCIpO1xyXG4gICAgICAgIHZhciBzcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0RW1wdHlTcHJpdGVGcmFtZShzaWRlKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhvbGRzLmNoaWxkcmVuQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgbmMgPSBob2xkcy5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgbmMuc2NhbGVYID0gMS4wO1xyXG4gICAgICAgICAgICBuYy5zY2FsZVkgPSAxLjA7XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSBuYy5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRPdGhlck1haGpvbmdzOiBmdW5jdGlvbihzZWF0RGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwic2VhdDpcIiArIHNlYXREYXRhLnNlYXRpbmRleCwgc2VhdERhdGEpO1xyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gdGhpcy5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XHJcbiAgICAgICAgaWYgKGxvY2FsSW5kZXggPT0gMCB8fCBzZWF0RGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzaWRlID0gY2MudnYubWFoam9uZ21nci5nZXRTaWRlKGxvY2FsSW5kZXgpO1xyXG4gICAgICAgIHZhciBnYW1lID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcclxuICAgICAgICB2YXIgc2lkZVJvb3QgPSBnYW1lLmdldENoaWxkQnlOYW1lKHNpZGUpO1xyXG4gICAgICAgIHZhciBzaWRlSG9sZHMgPSBzaWRlUm9vdC5nZXRDaGlsZEJ5TmFtZShcImhvbGRzXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzaWRlaG9sZHMnLCBzaWRlSG9sZHMpO1xyXG4gICAgICAgIHZhciBudW0gPSBzZWF0RGF0YS5wZW5ncy5sZW5ndGggKyBzZWF0RGF0YS5hbmdhbmdzLmxlbmd0aCArIHNlYXREYXRhLmRpYW5nYW5ncy5sZW5ndGggKyBzZWF0RGF0YS53YW5nYW5ncy5sZW5ndGggKyBzZWF0RGF0YS5jaGlzLmxlbmd0aDtcclxuICAgICAgICBudW0gKj0gMztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bTsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgaSk7XHJcbiAgICAgICAgICAgIHNpZGVIb2xkcy5jaGlsZHJlbltpZHhdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcHJlID0gY2MudnYubWFoam9uZ21nci5nZXRGb2xkUHJlKGxvY2FsSW5kZXgpO1xyXG4gICAgICAgIHZhciBob2xkcyA9IHRoaXMuc29ydEhvbGRzKHNlYXREYXRhKTtcclxuICAgICAgICBpZiAoaG9sZHMgIT0gbnVsbCAmJiBob2xkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaG9sZHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZHggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgaSArIG51bSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3ByaXRlID0gc2lkZUhvbGRzLmNoaWxkcmVuW2lkeF0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2lkZSA9PSBcInVwXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVggPSAwLjczO1xyXG4gICAgICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWSA9IDAuNzM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gY2MudnYubWFoam9uZ21nci5nZXRTcHJpdGVGcmFtZUJ5TUpJRChwcmUsIGhvbGRzW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaG9sZHMubGVuZ3RoICsgbnVtID09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGFzZXRJZHggPSB0aGlzLmdldE1KSW5kZXgoc2lkZSwgMTMpO1xyXG4gICAgICAgICAgICAgICAgc2lkZUhvbGRzLmNoaWxkcmVuW2xhc2V0SWR4XS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzb3J0SG9sZHM6IGZ1bmN0aW9uKHNlYXREYXRhKSB7XHJcbiAgICAgICAgdmFyIGhvbGRzID0gc2VhdERhdGEuaG9sZHM7XHJcbiAgICAgICAgaWYgKGhvbGRzID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5aaC5p6c5omL5LiK55qE54mM55qE5pWw55uu5pivMiw1LDgsMTEsMTTvvIzooajnpLrmnIDlkI7kuIDlvKDniYzmmK/liJrmkbjliLDnmoTniYxcclxuICAgICAgICB2YXIgbW9wYWkgPSBudWxsO1xyXG4gICAgICAgIHZhciBsID0gaG9sZHMubGVuZ3RoXHJcbiAgICAgICAgaWYgKGwgPT0gMiB8fCBsID09IDUgfHwgbCA9PSA4IHx8IGwgPT0gMTEgfHwgbCA9PSAxNCkge1xyXG4gICAgICAgICAgICBtb3BhaSA9IGhvbGRzLnBvcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy52di5tYWhqb25nbWdyLnNvcnRNSihob2xkcyk7XHJcbiAgICAgICAgLy/lsIbmkbjniYzmt7vliqDliLDmnIDlkI5cclxuICAgICAgICBpZiAobW9wYWkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBob2xkcy5wdXNoKG1vcGFpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhvbGRzO1xyXG4gICAgfSxcclxuICAgIGluaXRNYWhqb25nczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlYXRzID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcclxuICAgICAgICB2YXIgc2VhdERhdGEgPSBzZWF0c1tjYy52di5nYW1lTmV0TWdyLnNlYXRJbmRleF07XHJcbiAgICAgICAgdmFyIGhvbGRzID0gdGhpcy5zb3J0SG9sZHMoc2VhdERhdGEpO1xyXG4gICAgICAgIGlmIChob2xkcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJzZWF0RGF0YS5jaGlzLmxlbmd0aFwiLCBzZWF0RGF0YS5jaGlzLmxlbmd0aCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJ0aGlzLl9teU1KQXJydGhpcy5fbXlNSkFycnRoaXMuX215TUpBcnJ0aGlzLl9teU1KQXJyXCIsIHRoaXMuX215TUpBcnIpO1xyXG4gICAgICAgIC8v5Yid5aeL5YyW5omL54mMXHJcbiAgICAgICAgdmFyIGxhY2tpbmdOdW0gPSAoc2VhdERhdGEucGVuZ3MubGVuZ3RoICsgc2VhdERhdGEuYW5nYW5ncy5sZW5ndGggKyBzZWF0RGF0YS5kaWFuZ2FuZ3MubGVuZ3RoICsgc2VhdERhdGEud2FuZ2FuZ3MubGVuZ3RoICsgc2VhdERhdGEuY2hpcy5sZW5ndGgpICogMztcclxuICAgICAgICBjb25zb2xlLmxvZyhcImxhY2tpbmdOdW1cIiwgbGFja2luZ051bSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob2xkcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgbWppZCA9IGhvbGRzW2ldO1xyXG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gdGhpcy5fbXlNSkFycltpICsgbGFja2luZ051bV07XHJcbiAgICAgICAgICAgIGlmIChzcHJpdGUgJiYgc3ByaXRlLm5vZGUpIHtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLm1qSWQgPSBtamlkO1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlLm5vZGUueSA9IDA7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTcHJpdGVGcmFtZUJ5TUpJRChcIk1fXCIsIHNwcml0ZSwgbWppZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYWNraW5nTnVtOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuX215TUpBcnJbaV07XHJcbiAgICAgICAgICAgIHNwcml0ZS5ub2RlLm1qSWQgPSBudWxsO1xyXG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBudWxsO1xyXG4gICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IGxhY2tpbmdOdW0gKyBob2xkcy5sZW5ndGg7IGkgPCB0aGlzLl9teU1KQXJyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLl9teU1KQXJyW2ldO1xyXG4gICAgICAgICAgICBzcHJpdGUubm9kZS5taklkID0gbnVsbDtcclxuICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgc3ByaXRlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldFNwcml0ZUZyYW1lQnlNSklEOiBmdW5jdGlvbihwcmUsIHNwcml0ZSwgbWppZCkge1xyXG4gICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBtamlkKTtcclxuICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGdldExvY2FsSW5kZXg6IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgICAgICAgdmFyIHJldCA9IChpbmRleCAtIGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4ICsgNCkgJSA0O1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwib2xkOlwiICsgaW5kZXggKyBcIixiYXNlOlwiICsgY2MudnYuZ2FtZU5ldE1nci5zZWF0SW5kZXggKyBcIixuZXc6XCIgKyByZXQpO1xyXG4gICAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9LFxyXG4gICAgb25PcHRpb25DbGlja2VkOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5ZCD56Kw5p2g54mM5pON5L2cXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5wYWkpO1xyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0blBlbmdcIikge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcInBlbmdcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bkdhbmdcIikge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImdhbmdcIiwgZXZlbnQudGFyZ2V0LnBhaSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bkh1XCIpIHtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJodVwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuR3VvXCIpIHtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJndW9cIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bkNoaVwiKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5ZCD54mM5pON5L2c5oyJ6ZKu54K55Ye7XCIpO1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImNoaVwiLCBldmVudC50YXJnZXQucGFpKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLlkJHmnI3liqHlmajlj5HpgIHlkIPniYzmk43kvZwtLVwiLCB7XHJcbiAgICAgICAgICAgICAgICBwYWk6IGV2ZW50LnRhcmdldC5wYWksXHJcbiAgICAgICAgICAgICAgICBjaGlBcnJheTogdGhpcy5fY2hpT3B0aW9uQXJyYXlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIOWQg+eJjOaTjeS9nFxyXG4gICAgb25DaGlPcHRpb25DbGlja2VkOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5ZCD54mM5pON5L2c5LqL5Lu257uR5a6aXCIpO1xyXG4gICAgICAgIC8vIOeUqOadpeWtmOaUvueOqeWutumAieS4reeahOWQg+eahOe7hOWQiFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5wYWkpO1xyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIm9wMFwiKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jaGlBcnJheXMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaU9wdGlvbkFycmF5ID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGlPcHRpb25BcnJheSA9IHRoaXMuX2NoaUFycmF5c1swXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIueOqeWutumAieS4reS6huesrOS4gOe7hOe7hOWQiFwiLCB0aGlzLl9jaGlPcHRpb25BcnJheSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIm9wMVwiKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jaGlBcnJheXMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaU9wdGlvbkFycmF5ID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGlPcHRpb25BcnJheSA9IHRoaXMuX2NoaUFycmF5c1sxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIumAieaLqeS6huesrOS6jOe7hOe7hOWQiFwiLCB0aGlzLl9jaGlPcHRpb25BcnJheSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIm9wMlwiKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jaGlBcnJheXMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaU9wdGlvbkFycmF5ID0gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGlPcHRpb25BcnJheSA9IHRoaXMuX2NoaUFycmF5c1syXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIumAieaLqeS6huesrOS4iee7hOe7hOWQiFwiLCB0aGlzLl9jaGlPcHRpb25BcnJheSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ0bkd1b1wiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZ3VvXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5DaGlcIikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWQg+eJjOaTjeS9nOaMiemSrueCueWHu1wiKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NoaU9wdGlvbkFycmF5Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5Y+v5Lul5ZCD55qE57uE5ZCI6YCJ5Lit5LqGLOWPkemAgeaVsOaNruWIsOacjeWKoeWZqFwiLCB0aGlzLl9jaGlPcHRpb25BcnJheSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBwYWk6IGV2ZW50LnRhcmdldC5wYWksXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpT3B0aW9uZWQ6IHRoaXMuX2NoaU9wdGlvbkFycmF5XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWQg+eJjOeahOe7hOWQiOaYr1wiLCBkYXRhKVxyXG4gICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJjaGlcIiwgZGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5rOo5oSPXCIsIFwi6K+36YCJ5oup5LiA57uE5ZCD54mM55qE57uE5ZCIXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5ZCR5pyN5Yqh5Zmo5Y+R6YCB5ZCD54mM5pON5L2cLS1cIiwgZXZlbnQudGFyZ2V0LnBhaSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRDYWlTaGVuTGlzdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ+W8gOWni+a4uOaIjyzosIPnlKjotKLnpZ7liJ3lp4vljJbkv6Hmga8nKTtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xyXG4gICAgICAgIHZhciBzZWF0RGF0YSA9IHNlYXRzW2NjLnZ2LmdhbWVOZXRNZ3Iuc2VhdEluZGV4XTtcclxuICAgICAgICB2YXIgY2Fpc2hlbiA9IHNlYXREYXRhLmNhaVNoZW47XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2NhaVNoZW4gaW5pdENhaVNoZW5MaXN0JywgY2Fpc2hlbik7XHJcbiAgICAgICAgaWYgKGNhaXNoZW4gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBnYW1lQ2hpbGQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xyXG4gICAgICAgIHZhciBteXNlbGZDaGlsZCA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm15c2VsZlwiKTtcclxuICAgICAgICB2YXIgY2Fpc2hlbl9saXN0ID0gbXlzZWxmQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJodXBhaWxpc3RcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWlzaGVuLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBtal9jYWlzaGVuX2lkID0gY2Fpc2hlbltpXTtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IGNhaXNoZW5fbGlzdC5jaGlsZHJlbltpXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgc3ByaXRlLm5vZGUubWpJZCA9IG1qX2NhaXNoZW5faWQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ByaXRlRnJhbWVCeU1KSUQoXCJNX1wiLCBzcHJpdGUsIG1qX2NhaXNoZW5faWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0T3RoZXJDYWlTaGVuTGlzdDogZnVuY3Rpb24oc2VhdERhdGEpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygn5Yid5aeL5YyW5YW25LuW5Lq655qE6LSi56WeJyk7XHJcbiAgICAgICAgdmFyIGNhaXNoZW4gPSBzZWF0RGF0YS5jYWlTaGVuO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdjYWlTaGVuIGluaXRPdGhlckNhaVNoZW5MaXN0JywgY2Fpc2hlbik7XHJcbiAgICAgICAgaWYgKGNhaXNoZW4gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gdGhpcy5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XHJcbiAgICAgICAgdmFyIHNpZGUgPSBjYy52di5tYWhqb25nbWdyLmdldFNpZGUobG9jYWxJbmRleCk7XHJcbiAgICAgICAgdmFyIGdhbWUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpO1xyXG4gICAgICAgIHZhciBzaWRlUm9vdCA9IGdhbWUuZ2V0Q2hpbGRCeU5hbWUoc2lkZSk7XHJcbiAgICAgICAgdmFyIHNpZGVfY2Fpc2hlbl9saXN0ID0gc2lkZVJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJodXBhaWxpc3RcIik7XHJcbiAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhaXNoZW4ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIG1qX2NhaXNoZW5faWQgPSBjYWlzaGVuW2ldO1xyXG4gICAgICAgICAgICB2YXIgc3ByaXRlID0gc2lkZV9jYWlzaGVuX2xpc3QuY2hpbGRyZW5baV0uZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgIHNwcml0ZS5ub2RlLm1qSWQgPSBtal9jYWlzaGVuX2lkO1xyXG4gICAgICAgICAgICB0aGlzLnNldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgc3ByaXRlLCBtal9jYWlzaGVuX2lkKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHt9LFxyXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uRGVzdHJveVwiKTtcclxuICAgICAgICBpZiAoY2MudnYpIHtcclxuICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jbGVhcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxibFJvb21Obzoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgX3NlYXRzOiBbXSxcclxuICAgICAgICBfc2VhdHMyOiBbXSxcclxuICAgICAgICBfdGltZUxhYmVsOiBudWxsLFxyXG4gICAgICAgIF92b2ljZU1zZ1F1ZXVlOiBbXSxcclxuICAgICAgICBfbGFzdFBsYXlpbmdTZWF0OiBudWxsLFxyXG4gICAgICAgIF9wbGF5aW5nU2VhdDogbnVsbCxcclxuICAgICAgICBfbGFzdFBsYXlUaW1lOiBudWxsLFxyXG4gICAgICAgIF9zaGFyZUNvbnRlbnQ6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0VmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdFNlYXRzKCk7XHJcbiAgICAgICAgdGhpcy5pbml0RXZlbnRIYW5kbGVycygpO1xyXG4gICAgfSxcclxuICAgIGluaXRWaWV3OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcHJlcGFyZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInByZXBhcmVcIik7XHJcbiAgICAgICAgdmFyIHNlYXRzID0gcHJlcGFyZS5nZXRDaGlsZEJ5TmFtZShcInNlYXRzXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhdHMuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2VhdHMucHVzaChzZWF0cy5jaGlsZHJlbltpXS5nZXRDb21wb25lbnQoXCJTZWF0XCIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoQnRucygpO1xyXG4gICAgICAgIHRoaXMubGJsUm9vbU5vID0gY2MuZmluZChcIkNhbnZhcy9pbmZvYmFyL1pfcm9vbV90eHQvTmV3IExhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fdGltZUxhYmVsID0gY2MuZmluZChcIkNhbnZhcy9pbmZvYmFyL3RpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLmxibFJvb21Oby5zdHJpbmcgPSBjYy52di5nYW1lTmV0TWdyLnJvb21JZDtcclxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcclxuICAgICAgICB2YXIgc2lkZXMgPSBbXCJteXNlbGZcIiwgXCJyaWdodFwiLCBcInVwXCIsIFwibGVmdFwiXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpZGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBzaWRlTm9kZSA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShzaWRlc1tpXSk7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2lkZU5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJzZWF0XCIpO1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0czIucHVzaChzZWF0LmdldENvbXBvbmVudChcIlNlYXRcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYnRuV2VjaGF0ID0gY2MuZmluZChcIkNhbnZhcy9wcmVwYXJlL2J0bldlaWNoYXRcIik7XHJcbiAgICAgICAgaWYgKGJ0bldlY2hhdCkge1xyXG4gICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0bldlY2hhdCwgdGhpcy5ub2RlLCBcIk1KUm9vbVwiLCBcIm9uQnRuV2VpY2hhdENsaWNrZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJlZnJlc2hCdG5zOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcHJlcGFyZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInByZXBhcmVcIik7XHJcbiAgICAgICAgdmFyIGJ0bkV4aXQgPSBwcmVwYXJlLmdldENoaWxkQnlOYW1lKFwiYnRuRXhpdFwiKTtcclxuICAgICAgICB2YXIgYnRuRGlzcHJlc3MgPSBwcmVwYXJlLmdldENoaWxkQnlOYW1lKFwiYnRuRGlzc29sdmVcIik7XHJcbiAgICAgICAgdmFyIGJ0bldlaWNoYXQgPSBwcmVwYXJlLmdldENoaWxkQnlOYW1lKFwiYnRuV2VpY2hhdFwiKTtcclxuICAgICAgICB2YXIgYnRuQmFjayA9IHByZXBhcmUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5CYWNrXCIpO1xyXG4gICAgICAgIHZhciBpc0lkbGUgPSBjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMgPT0gMDtcclxuICAgICAgICBidG5FeGl0LmFjdGl2ZSA9ICFjYy52di5nYW1lTmV0TWdyLmlzT3duZXIoKSAmJiBpc0lkbGU7XHJcbiAgICAgICAgYnRuRGlzcHJlc3MuYWN0aXZlID0gY2MudnYuZ2FtZU5ldE1nci5pc093bmVyKCkgJiYgaXNJZGxlO1xyXG4gICAgICAgIGJ0bldlaWNoYXQuYWN0aXZlID0gaXNJZGxlO1xyXG4gICAgICAgIGJ0bkJhY2suYWN0aXZlID0gaXNJZGxlO1xyXG4gICAgfSxcclxuICAgIGluaXRFdmVudEhhbmRsZXJzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCduZXdfdXNlcicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5pbml0U2luZ2xlU2VhdChkYXRhLmRldGFpbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCd1c2VyX3N0YXRlX2NoYW5nZWQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdFNpbmdsZVNlYXQoZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9iZWdpbicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5yZWZyZXNoQnRucygpO1xyXG4gICAgICAgICAgICBzZWxmLmluaXRTZWF0cygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9udW0nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYucmVmcmVzaEJ0bnMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3ZvaWNlX21zZycsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5fdm9pY2VNc2dRdWV1ZS5wdXNoKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLnBsYXlWb2ljZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignY2hhdF9wdXNoJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGlkeCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2xvY2FsSWR4XS5jaGF0KGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzMltsb2NhbElkeF0uY2hhdChkYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbigncXVpY2tfY2hhdF9wdXNoJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KGlkeCk7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGRhdGEuY29udGVudDtcclxuICAgICAgICAgICAgdmFyIGluZm8gPSBjYy52di5jaGF0LmdldFF1aWNrQ2hhdEluZm8oaW5kZXgpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uY2hhdChpbmZvLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0czJbbG9jYWxJZHhdLmNoYXQoaW5mby5jb250ZW50KTtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheVNGWChpbmZvLnNvdW5kKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2Vtb2ppX3B1c2gnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQoZGF0YS5zZW5kZXIpO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJZHggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoaWR4KTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2xvY2FsSWR4XS5lbW9qaShkYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0czJbbG9jYWxJZHhdLmVtb2ppKGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgaW5pdFNlYXRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhdHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0U2luZ2xlU2VhdChzZWF0c1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRTaW5nbGVTZWF0OiBmdW5jdGlvbihzZWF0KSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXQuc2VhdGluZGV4KTtcclxuICAgICAgICB2YXIgaXNPZmZsaW5lID0gIXNlYXQub25saW5lO1xyXG4gICAgICAgIHZhciBpc1podWFuZyA9IHNlYXQuc2VhdGluZGV4ID09IGNjLnZ2LmdhbWVOZXRNZ3IuYnV0dG9uO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiaXNPZmZsaW5lOlwiICsgaXNPZmZsaW5lKTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0SW5mbyhzZWF0Lm5hbWUsIHNlYXQuc2NvcmUpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRSZWFkeShzZWF0LnJlYWR5KTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0T2ZmbGluZShpc09mZmxpbmUpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRJRChzZWF0LnVzZXJpZCk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnZvaWNlTXNnKGZhbHNlKTtcclxuICAgICAgICB0aGlzLl9zZWF0czJbaW5kZXhdLnNldEluZm8oc2VhdC5uYW1lLCBzZWF0LnNjb3JlKTtcclxuICAgICAgICB0aGlzLl9zZWF0czJbaW5kZXhdLnNldFpodWFuZyhpc1podWFuZyk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHMyW2luZGV4XS5zZXRPZmZsaW5lKGlzT2ZmbGluZSk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHMyW2luZGV4XS5zZXRJRChzZWF0LnVzZXJpZCk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHMyW2luZGV4XS52b2ljZU1zZyhmYWxzZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5TZXR0aW5nc0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LnBvcHVwTWdyLnNob3dTZXR0aW5ncygpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQmFja0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLov5Tlm57lpKfljoVcIiwgXCLov5Tlm57lpKfljoXmiL/pl7Tku43kvJrkv53nlZnvvIzlv6vljrvpgoDor7flpKfkvJnmnaXnjqnlkKfvvIFcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld2hhbGxcIik7XHJcbiAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5DaGF0Q2xpY2tlZDogZnVuY3Rpb24oKSB7fSxcclxuICAgIC8vIOeCueWHu+WIhuS6q+aMiemSru+8jOS9v+eUqOW+ruS/oeWIhuS6q1xyXG4gICAgb25CdG5XZWljaGF0Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuc2hhcmUuc2hvdygpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuRGlzc29sdmVDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5hbGVydC5zaG93KFwi6Kej5pWj5oi/6Ze0XCIsIFwi6Kej5pWj5oi/6Ze05LiN5omj6YeR5biB77yM5piv5ZCm56Gu5a6a6Kej5pWj77yfXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImRpc3ByZXNzXCIpO1xyXG4gICAgICAgIH0sIHRydWUpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuRXhpdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJleGl0XCIpO1xyXG4gICAgfSxcclxuICAgIHBsYXlWb2ljZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BsYXlpbmdTZWF0ID09IG51bGwgJiYgdGhpcy5fdm9pY2VNc2dRdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJwbGF5Vm9pY2VcIik7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fdm9pY2VNc2dRdWV1ZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXgoaWR4KTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWluZ1NlYXQgPSBsb2NhbEluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyh0cnVlKTtcclxuICAgICAgICAgICAgdGhpcy5fc2VhdHMyW2xvY2FsSW5kZXhdLnZvaWNlTXNnKHRydWUpO1xyXG4gICAgICAgICAgICB2YXIgbXNnSW5mbyA9IEpTT04ucGFyc2UoZGF0YS5jb250ZW50KTtcclxuICAgICAgICAgICAgdmFyIG1zZ2ZpbGUgPSBcInZvaWNlbXNnLmFtclwiO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtc2dJbmZvLm1zZy5sZW5ndGgpO1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0UGxheVRpbWUgPSBEYXRlLm5vdygpICsgbXNnSW5mby50aW1lO1xyXG4gICAgICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlcnZlcmlkID0gbXNnSW5mb1snbXNnJ107XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuZG93bmxvYWRWb2ljZShzZXJ2ZXJpZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYudm9pY2VNZ3Iud3JpdGVWb2ljZShtc2dmaWxlLCBtc2dJbmZvLm1zZyk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLnBsYXkobXNnZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgaWYgKHdpbmRvdy52b2ljZSAmJiB3aW5kb3cudm9pY2UubG9jYWxJZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbElkID0gd2luZG93LnZvaWNlLmxvY2FsSWQ7XHJcbiAgICAgICAgICAgIHdpbmRvdy52b2ljZS5sb2NhbElkID0gbnVsbDtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3IucGF1c2VBbGwoKTtcclxuICAgICAgICAgICAgd2luZG93LnBsYXlWb2ljZShsb2NhbElkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwIC8gNjApO1xyXG4gICAgICAgIGlmICh0aGlzLl9sYXN0TWludXRlICE9IG1pbnV0ZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdE1pbnV0ZSA9IG1pbnV0ZXM7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgdmFyIGggPSBkYXRlLmdldEhvdXJzKCk7XHJcbiAgICAgICAgICAgIGggPSBoIDwgMTAgPyBcIjBcIiArIGggOiBoO1xyXG4gICAgICAgICAgICB2YXIgbSA9IGRhdGUuZ2V0TWludXRlcygpO1xyXG4gICAgICAgICAgICBtID0gbSA8IDEwID8gXCIwXCIgKyBtIDogbTtcclxuICAgICAgICAgICAgdGhpcy5fdGltZUxhYmVsLnN0cmluZyA9IFwiXCIgKyBoICsgXCI6XCIgKyBtO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fbGFzdFBsYXlUaW1lICE9IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKERhdGUubm93KCkgPiB0aGlzLl9sYXN0UGxheVRpbWUgKyAyMDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub25QbGF5ZXJPdmVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0UGxheVRpbWUgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5Vm9pY2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25QbGF5ZXJPdmVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICB3aW5kb3cuc3RvcFBsYXlWb2ljZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IucmVzdW1lQWxsKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvblBsYXlDYWxsYmFjazpcIiArIHRoaXMuX3BsYXlpbmdTZWF0KTtcclxuICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHRoaXMuX3BsYXlpbmdTZWF0O1xyXG4gICAgICAgIHRoaXMuX3BsYXlpbmdTZWF0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyhmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHMyW2xvY2FsSW5kZXhdLnZvaWNlTXNnKGZhbHNlKTtcclxuICAgIH0sXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LnZvaWNlTWdyLnN0b3AoKTtcclxuICAgICAgICAvLyAgICAgICAgY2MudnYudm9pY2VNZ3Iub25QbGF5Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgfVxyXG59KTsiLCJ2YXIgbWFoam9uZ1Nwcml0ZXMgPSBbXTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxlZnRBdGxhczoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVBdGxhc1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmlnaHRBdGxhczoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVBdGxhc1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm90dG9tQXRsYXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvdHRvbUZvbGRBdGxhczoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5TcHJpdGVBdGxhc1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGVuZ1ByZWZhYlNlbGY6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwZW5nUHJlZmFiTGVmdDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVtcHR5QXRsYXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhvbGRzRW1wdHk6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgICAgIHR5cGU6IFtjYy5TcHJpdGVGcmFtZV1cclxuICAgICAgICB9LFxyXG4gICAgICAgIF9zaWRlczogbnVsbCxcclxuICAgICAgICBfcHJlczogbnVsbCxcclxuICAgICAgICBfZm9sZFByZXM6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NpZGVzID0gW1wibXlzZWxmXCIsIFwicmlnaHRcIiwgXCJ1cFwiLCBcImxlZnRcIl07XHJcbiAgICAgICAgdGhpcy5fcHJlcyA9IFtcIk1fXCIsIFwiUl9cIiwgXCJCX1wiLCBcIkxfXCJdO1xyXG4gICAgICAgIHRoaXMuX2ZvbGRQcmVzID0gW1wiQl9cIiwgXCJSX1wiLCBcIkJfXCIsIFwiTF9cIl07XHJcbiAgICAgICAgY2MudnYubWFoam9uZ21nciA9IHRoaXM7XHJcbiAgICAgICAgLy/nrZJcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDEwOyArK2kpIHtcclxuICAgICAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcImRvdF9cIiArIGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+adoVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMTA7ICsraSkge1xyXG4gICAgICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwiYmFtYm9vX1wiICsgaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5LiHXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCAxMDsgKytpKSB7XHJcbiAgICAgICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJjaGFyYWN0ZXJfXCIgKyBpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/kuJzopb/ljZfljJfpo45cclxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwid2luZF9lYXN0XCIpO1xyXG4gICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJ3aW5kX3dlc3RcIik7XHJcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcIndpbmRfc291dGhcIik7XHJcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcIndpbmRfbm9ydGhcIik7XHJcbiAgICAgICAgLy/kuK3jgIHlj5HjgIHnmb1cclxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwicmVkXCIpO1xyXG4gICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJncmVlblwiKTtcclxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwid2hpdGVcIik7XHJcbiAgICAgICAgLy/mmKXlpI/np4vlhqwgXHJcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcInNwcmluZ1wiKTtcclxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwic3VtbWVyXCIpO1xyXG4gICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJhdXR1bW5cIik7XHJcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcIndpbnRlclwiKTtcclxuICAgICAgICAvL+WFsOerueiPiuaihVxyXG4gICAgICAgIG1haGpvbmdTcHJpdGVzLnB1c2goXCJvcmNoaWRcIik7IC8v5YWwXHJcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcImJhbWJvb1wiKTsgLy/nq7lcclxuICAgICAgICBtYWhqb25nU3ByaXRlcy5wdXNoKFwiY2hyeXNhbnRoZW11bVwiKTsgLy/oj4ogICAgICAgXHJcbiAgICAgICAgbWFoam9uZ1Nwcml0ZXMucHVzaChcInBsdW1cIik7IC8v5qKFICAgICAgICAgICAgXHJcbiAgICB9LFxyXG4gICAgZ2V0TWFoam9uZ1Nwcml0ZUJ5SUQ6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIG1haGpvbmdTcHJpdGVzW2lkXTtcclxuICAgIH0sXHJcbiAgICBnZXRNYWhqb25nVHlwZTogZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICBpZiAoaWQgPj0gMCAmJiBpZCA8IDkpIHsgLy/nrZJcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpZCA+PSA5ICYmIGlkIDwgMTgpIHsgLy/mnaFcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfSBlbHNlIGlmIChpZCA+PSAxOCAmJiBpZCA8IDI3KSB7IC8v5LiHXHJcbiAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaWQgPj0gMjcgJiYgaWQgPCAzNCkgeyAvL+Wtl+S4gO+8iOS4nOilv+WNl+WMl+S4reWPkeeZve+8iVxyXG4gICAgICAgICAgICByZXR1cm4gMztcclxuICAgICAgICB9IGVsc2UgaWYgKGlkID49IDM0ICYmIGlkIDwgNDIpIHsgLy/oirHkuIDvvIjmmKXlpI/np4vlhqzlhbDnq7noj4rmooXvvIlcclxuICAgICAgICAgICAgcmV0dXJuIDQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGdldFNwcml0ZUZyYW1lQnlNSklEOiBmdW5jdGlvbihwcmUsIG1qaWQpIHtcclxuICAgICAgICB2YXIgc3ByaXRlRnJhbWVOYW1lID0gdGhpcy5nZXRNYWhqb25nU3ByaXRlQnlJRChtamlkKTtcclxuICAgICAgICBzcHJpdGVGcmFtZU5hbWUgPSBwcmUgKyBzcHJpdGVGcmFtZU5hbWU7XHJcbiAgICAgICAgaWYgKHByZSA9PSBcIk1fXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tQXRsYXMuZ2V0U3ByaXRlRnJhbWUoc3ByaXRlRnJhbWVOYW1lKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHByZSA9PSBcIkJfXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tRm9sZEF0bGFzLmdldFNwcml0ZUZyYW1lKHNwcml0ZUZyYW1lTmFtZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwcmUgPT0gXCJMX1wiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxlZnRBdGxhcy5nZXRTcHJpdGVGcmFtZShzcHJpdGVGcmFtZU5hbWUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocHJlID09IFwiUl9cIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yaWdodEF0bGFzLmdldFNwcml0ZUZyYW1lKHNwcml0ZUZyYW1lTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIOWHuueJjOWjsOmfs+WvueW6lGlk5Y+q5pyJ562S5p2h5LiH5ZKM5Lic6KW/5Y2X5YyX5Lit5Y+R55m95omN5pyJ5aOw6Z+zXHJcbiAgICBnZXRBdWRpb1VSTEJ5TUpJRDogZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICB2YXIgcGFpdHlwZSA9IHRoaXMuZ2V0TWFoam9uZ1R5cGUoaWQpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi54mM55qE57G75Z6L5pivOlwiICsgcGFpdHlwZSk7XHJcbiAgICAgICAgaWYgKHBhaXR5cGUgPj0gMCAmJiBwYWl0eXBlIDwgNCkge1xyXG4gICAgICAgICAgICByZXR1cm4gXCJudi9cIiArIGlkICsgXCIubXAzXCI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGdldEVtcHR5U3ByaXRlRnJhbWU6IGZ1bmN0aW9uKHNpZGUpIHtcclxuICAgICAgICBpZiAoc2lkZSA9PSBcInVwXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfYl91cFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJteXNlbGZcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eUF0bGFzLmdldFNwcml0ZUZyYW1lKFwiZV9tal9iX2JvdHRvbVwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJsZWZ0XCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfYl9sZWZ0XCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PSBcInJpZ2h0XCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfYl9yaWdodFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0SG9sZHNFbXB0eVNwcml0ZUZyYW1lOiBmdW5jdGlvbihzaWRlKSB7XHJcbiAgICAgICAgaWYgKHNpZGUgPT0gXCJ1cFwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVtcHR5QXRsYXMuZ2V0U3ByaXRlRnJhbWUoXCJlX21qX3VwXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PSBcIm15c2VsZlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PSBcImxlZnRcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbXB0eUF0bGFzLmdldFNwcml0ZUZyYW1lKFwiZV9tal9sZWZ0XCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2lkZSA9PSBcInJpZ2h0XCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1wdHlBdGxhcy5nZXRTcHJpdGVGcmFtZShcImVfbWpfcmlnaHRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNvcnRNSjogZnVuY3Rpb24obWFoam9uZ3MpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgbWFoam9uZ3Muc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhIC0gYjtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBnZXRTaWRlOiBmdW5jdGlvbihsb2NhbEluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NpZGVzW2xvY2FsSW5kZXhdO1xyXG4gICAgfSxcclxuICAgIGdldFByZTogZnVuY3Rpb24obG9jYWxJbmRleCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wcmVzW2xvY2FsSW5kZXhdO1xyXG4gICAgfSxcclxuICAgIGdldEZvbGRQcmU6IGZ1bmN0aW9uKGxvY2FsSW5kZXgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZm9sZFByZXNbbG9jYWxJbmRleF07XHJcbiAgICB9XHJcbn0pOyIsImlmICh3aW5kb3cuaW8gPT0gbnVsbCkge1xuICAgIHdpbmRvdy5pbyA9IHJlcXVpcmUoXCJzb2NrZXQtaW9cIik7XG59XG52YXIgR2xvYmFsID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGlwOiBcIlwiLFxuICAgICAgICBzaW86IG51bGwsXG4gICAgICAgIGlzUGluZ2luZzogZmFsc2UsXG4gICAgICAgIGZuRGlzY29ubmVjdDogbnVsbCxcbiAgICAgICAgaGFuZGxlcnM6IHt9LFxuICAgICAgICBhZGRIYW5kbGVyOiBmdW5jdGlvbihldmVudCwgZm4pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZXJzW2V2ZW50XSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXZlbnQ6XCIgKyBldmVudCArIFwiJyBoYW5kbGVyIGhhcyBiZWVuIHJlZ2lzdGVyZWQuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZXZlbnQgKyBcIihcIiArIHR5cGVvZihkYXRhKSArIFwiKTpcIiArIChkYXRhPyBkYXRhLnRvU3RyaW5nKCk6XCJudWxsXCIpKTtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgIT0gXCJkaXNjb25uZWN0XCIgJiYgdHlwZW9mKGRhdGEpID09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZuKGRhdGEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNbZXZlbnRdID0gaGFuZGxlcjtcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXI6ZnVuY3Rpb24gXCIgKyBldmVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaW8ub24oZXZlbnQsIGhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjb25uZWN0OiBmdW5jdGlvbihmbkNvbm5lY3QsIGZuRXJyb3IpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBvcHRzID0ge1xuICAgICAgICAgICAgICAgICdyZWNvbm5lY3Rpb24nOiB0cnVlLFxuICAgICAgICAgICAgICAgICdmb3JjZSBuZXcgY29ubmVjdGlvbic6IHRydWUsXG4gICAgICAgICAgICAgICAgJ3RyYW5zcG9ydHMnOiBbJ3dlYnNvY2tldCcsICdwb2xsaW5nJ11cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2lvID0gd2luZG93LmlvLmNvbm5lY3QodGhpcy5pcCwgb3B0cyk7XG4gICAgICAgICAgICB0aGlzLnNpby5vbigncmVjb25uZWN0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlY29ubmVjdGlvbicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNpby5vbignY29ubmVjdCcsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNpby5jb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZuQ29ubmVjdChkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zaW8ub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkaXNjb25uZWN0XCIpO1xuICAgICAgICAgICAgICAgIHNlbGYuc2lvLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zaW8ub24oJ2Nvbm5lY3RfZmFpbGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nvbm5lY3RfZmFpbGVkJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmhhbmRsZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5oYW5kbGVyc1trZXldO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YodmFsdWUpID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09ICdkaXNjb25uZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mbkRpc2Nvbm5lY3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXI6ZnVuY3Rpb24gXCIgKyBrZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaW8ub24oa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0YXJ0SGVhcmJlYXQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3RhcnRIZWFyYmVhdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNpby5vbignZ2FtZV9wb25nJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sYXN0UmVjaWV2ZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmxhc3RSZWNpZXZlVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXNQaW5naW5nKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pc1BpbmdpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zaW8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vRklYTUU6IOi2heaXtuiuvuS4ujNzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHNlbGYubGFzdFJlY2lldmVUaW1lID4gMTAwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNlbmQ6IGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zaW8uY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCAmJiAodHlwZW9mKGRhdGEpID09IFwib2JqZWN0XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTsgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNpby5lbWl0KGV2ZW50LCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoJ2dhbWVfcGluZycpO1xuICAgICAgICB9LFxuICAgICAgICBjbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2UnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbyAmJiB0aGlzLnNpby5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaW8gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZm5EaXNjb25uZWN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mbkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZuRGlzY29ubmVjdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRlc3Q6IGZ1bmN0aW9uKGZuUmVzdWx0KSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xuICAgICAgICAgICAgICAgIGZuUmVzdWx0KHJldC5pc29ubGluZSk7XG4gICAgICAgICAgICAgICAgeGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcnIgPSB0aGlzLmlwLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXG4gICAgICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxuICAgICAgICAgICAgICAgIGlwOiBhcnJbMF0sXG4gICAgICAgICAgICAgICAgcG9ydDogYXJyWzFdLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeGhyID0gY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9pc19zZXJ2ZXJfb25saW5lXCIsIGRhdGEsIGZuKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhocikge1xuICAgICAgICAgICAgICAgICAgICB4aHIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm5SZXN1bHQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDE1MDApO1xuICAgICAgICB9XG4gICAgfSxcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIGluaXRIYW5kbGVyczogZnVuY3Rpb24oR2FtZU5ldCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gR2FtZU5ldDtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImxvZ2luX3Jlc3VsdFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5fcmVzdWx0PT09PlwiLCBkYXRhKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuZXJyY29kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21JZCA9IGRhdGEucm9vbWlkO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSBkYXRhLmNvbmYucm9vbV90eXBlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jb25mID0gZGF0YS5jb25mO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5tYXhOdW1PZkdhbWVzID0gZGF0YS5jb25mLm1heEdhbWVzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5udW1PZkdhbWVzID0gZGF0YS5udW1vZmdhbWVzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0cyA9IGRhdGEuc2VhdHM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRJbmRleCA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRChjYy52di51c2VyTWdyLnVzZXJJZCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzT3ZlciA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5lcnJtc2cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJsb2dpbl9maW5pc2hlZFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5fZmluaXNoZWRcIik7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm1qZ2FtZVwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImV4aXRfcmVzdWx0XCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBudWxsO1xyXG4gICAgICAgICAgICBzZWxmLnR1cm4gPSAtMTtcclxuICAgICAgICAgICAgc2VsZi5zZWF0cyA9IG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJleGl0X25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGE7XHJcbiAgICAgICAgICAgIHZhciBzID0gc2VsZi5nZXRTZWF0QnlJRCh1c2VySWQpO1xyXG4gICAgICAgICAgICBpZiAocyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBzLnVzZXJpZCA9IDA7XHJcbiAgICAgICAgICAgICAgICBzLm5hbWUgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwidXNlcl9zdGF0ZV9jaGFuZ2VkXCIsIHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJkaXNwcmVzc19wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBudWxsO1xyXG4gICAgICAgICAgICBzZWxmLnR1cm4gPSAtMTtcclxuICAgICAgICAgICAgc2VsZi5zZWF0cyA9IG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJkaXNjb25uZWN0XCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYucm9vbUlkID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnJvb21fdHlwZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibmV3aGFsbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb21fdHlwZSA9IC0xO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdoYWxsXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaXNPdmVyID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5vbGRSb29tSWQgPSBzZWxmLnJvb21JZDtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJkaXNjb25uZWN0XCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibWF0Y2hfZXhpdF9lcnJvclwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnbWF0Y2hfZXhpdF9lcnJvcicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibmV3X3VzZXJfY29tZXNfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBkYXRhLnNlYXRpbmRleDtcclxuICAgICAgICAgICAgaWYgKHNlbGYuc2VhdHNbc2VhdEluZGV4XS51c2VyaWQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzW3NlYXRJbmRleF0ub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbc2VhdEluZGV4XSA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCduZXdfdXNlcicsIHNlbGYuc2VhdHNbc2VhdEluZGV4XSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJ1c2VyX3N0YXRlX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VyaWQ7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLnJvb21fdHlwZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuZ2V0U2VhdEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgICAgIGlmICghc2VhdCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgc2VhdC5vbmxpbmUgPSBkYXRhLm9ubGluZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgndXNlcl9zdGF0ZV9jaGFuZ2VkJywgc2VhdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcInVzZXJfcmVhZHlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLnVzZXJpZDtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLmdldFNlYXRCeUlEKHVzZXJJZCk7XHJcbiAgICAgICAgICAgIHNlYXQucmVhZHkgPSBkYXRhLnJlYWR5O1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ3VzZXJfc3RhdGVfY2hhbmdlZCcsIHNlYXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9ob2xkc19wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLnNlYXRzW3NlbGYuc2VhdEluZGV4XTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHNlYXQuaG9sZHMgPSBkYXRhO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuc2VhdHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gc2VsZi5zZWF0c1tpXTtcclxuICAgICAgICAgICAgICAgIGlmICghcy5mb2xkcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHMuZm9sZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghcy5wZW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHMucGVuZ3MgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghcy5leHRyYVBhaXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLmV4dHJhUGFpcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFzLmNhaVNoZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBzLmNhaVNoZW4gPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghcy5jaGlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5jaGlzID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXMuYW5nYW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHMuYW5nYW5ncyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFzLmRpYW5nYW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIHMuZGlhbmdhbmdzID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXMud2FuZ2FuZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLndhbmdhbmdzID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzLnJlYWR5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2hvbGRzJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2JlZ2luX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FtZV9iZWdpbl9wdXNoJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLmJ1dHRvbiA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IHNlbGYuYnV0dG9uO1xyXG4gICAgICAgICAgICBzZWxmLmdhbWVzdGF0ZSA9IFwiYmVnaW5cIjtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2JlZ2luJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3BsYXlpbmdfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX3BsYXlpbmdfcHVzaCcpO1xyXG4gICAgICAgICAgICBzZWxmLmdhbWVzdGF0ZSA9IFwicGxheWluZ1wiO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfcGxheWluZycpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9zeW5jX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImdhbWVfc3luY19wdXNoXCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5udW1PZk1KID0gZGF0YS5udW1vZm1qO1xyXG4gICAgICAgICAgICBzZWxmLmdhbWVzdGF0ZSA9IGRhdGEuc3RhdGU7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IGRhdGEudHVybjtcclxuICAgICAgICAgICAgc2VsZi5idXR0b24gPSBkYXRhLmJ1dHRvbjtcclxuICAgICAgICAgICAgc2VsZi5jaHVwYWkgPSBkYXRhLmNodVBhaTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA0OyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5zZWF0c1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBzZCA9IGRhdGEuc2VhdHNbaV07XHJcbiAgICAgICAgICAgICAgICBzZWF0LmhvbGRzID0gc2QuaG9sZHM7XHJcbiAgICAgICAgICAgICAgICBzZWF0LmZvbGRzID0gc2QuZm9sZHM7XHJcbiAgICAgICAgICAgICAgICBzZWF0LmFuZ2FuZ3MgPSBzZC5hbmdhbmdzO1xyXG4gICAgICAgICAgICAgICAgc2VhdC5kaWFuZ2FuZ3MgPSBzZC5kaWFuZ2FuZ3M7XHJcbiAgICAgICAgICAgICAgICBzZWF0LndhbmdhbmdzID0gc2Qud2FuZ2FuZ3M7XHJcbiAgICAgICAgICAgICAgICBzZWF0LnBlbmdzID0gc2QucGVuZ3M7XHJcbiAgICAgICAgICAgICAgICBzZWF0LmV4dHJhUGFpcyA9IHNkLmV4dHJhUGFpcztcclxuICAgICAgICAgICAgICAgIHNlYXQuY2FpU2hlbiA9IHNkLmNhaVNoZW47XHJcbiAgICAgICAgICAgICAgICBzZWF0LmNoaXMgPSBzZC5jaGlzO1xyXG4gICAgICAgICAgICAgICAgc2VhdC5odWVkID0gc2QuaHVlZDtcclxuICAgICAgICAgICAgICAgIHNlYXQudGluZ2VkID0gc2QudGluZ2VkO1xyXG4gICAgICAgICAgICAgICAgc2VhdC5pc3ppbW8gPSBzZC5pc3ppbW87XHJcbiAgICAgICAgICAgICAgICBzZWF0Lmh1aW5mbyA9IHNkLmh1aW5mbztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9hY3Rpb25fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuY3VyYWN0aW9uID0gZGF0YTtcclxuICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jdXJhY3Rpb24gPSBkYXRhO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImdhbWVfYWN0aW9uX3B1c2gtLS3ojrflvpfmiYDku6Xmk43kvZznmoTmlbDmja5cIiwgZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9hY3Rpb24nLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3RpbWVyQmVnaW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV90aW1lckJlZ2luJywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9jaHVwYWlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX2NodXBhaV9wdXNoJyk7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHZhciB0dXJuVXNlcklEID0gZGF0YTtcclxuICAgICAgICAgICAgdmFyIHNpID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKHR1cm5Vc2VySUQpO1xyXG4gICAgICAgICAgICBzZWxmLmRvVHVybkNoYW5nZShzaSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX251bV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5udW1PZkdhbWVzID0gZGF0YTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX251bScsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9vdmVyX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FtZV9vdmVyX3B1c2gnKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBkYXRhLnJlc3VsdHM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5zZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0c1tpXS5zY29yZSA9IHJlc3VsdHMubGVuZ3RoID09IDAgPyAwIDogcmVzdWx0c1tpXS50b3RhbHNjb3JlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9vdmVyJywgcmVzdWx0cyk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmVuZGluZm8pIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXNPdmVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9lbmQnLCBkYXRhLmVuZGluZm8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYucmVzZXQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLnNlYXRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ3VzZXJfc3RhdGVfY2hhbmdlZCcsIHNlbGYuc2VhdHNbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJtal9jb3VudF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ21qX2NvdW50X3B1c2gnKTtcclxuICAgICAgICAgICAgc2VsZi5udW1PZk1KID0gZGF0YTtcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdtal9jb3VudCcsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiaHVfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdodV9wdXNoJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRvSHUoZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJoYW5nYW5nX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdoYW5nYW5nX25vdGlmeScsIGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2NodXBhaV9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLnVzZXJJZDtcclxuICAgICAgICAgICAgdmFyIHBhaSA9IGRhdGEucGFpO1xyXG4gICAgICAgICAgICB2YXIgc2kgPSBzZWxmLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgc2VsZi5kb0NodXBhaShzaSwgcGFpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbW9wYWlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX21vcGFpX3B1c2gnKTtcclxuICAgICAgICAgICAgc2VsZi5kb01vcGFpKHNlbGYuc2VhdEluZGV4LCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImd1b19ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdndW9fbm90aWZ5X3B1c2gnKTtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcklkO1xyXG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XHJcbiAgICAgICAgICAgIHZhciBzaSA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgICAgICBzZWxmLmRvR3VvKHNpLCBwYWkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ3VvX3Jlc3VsdFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdndW9fcmVzdWx0Jyk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ3VvX3Jlc3VsdCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ3VvaHVfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdndW9odV9wdXNoJyk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInB1c2hfbm90aWNlXCIsIHtcclxuICAgICAgICAgICAgICAgIGluZm86IFwi6L+H6IOhXCIsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiAxLjVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJwZW5nX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Blbmdfbm90aWZ5X3B1c2gtLS0tLS0t56Kw54mM5pON5L2cJywgZGF0YSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS51c2VyaWQ7XHJcbiAgICAgICAgICAgIHZhciBwYWkgPSBkYXRhLnBhaTtcclxuICAgICAgICAgICAgdmFyIHNpID0gc2VsZi5nZXRTZWF0SW5kZXhCeUlEKHVzZXJJZCk7XHJcbiAgICAgICAgICAgIHZhciBleHRyYVBlbmdQYWkgPSBkYXRhLmV4dHJhUGVuZ1BhaTtcclxuICAgICAgICAgICAgc2VsZi5kb1Blbmcoc2ksIGRhdGEucGFpLCBleHRyYVBlbmdQYWkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vICDlkIPniYzmk43kvZxcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImNoaV9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGlfbm90aWZ5X3B1c2gnLCBkYXRhKTtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xyXG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XHJcbiAgICAgICAgICAgIHZhciBzaSA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgICAgICB2YXIgZXh0cmFDaGlQYWkgPSBkYXRhLmV4dHJhQ2hpUGFpO1xyXG4gICAgICAgICAgICB2YXIgY2hpQXJyYXkgPSBkYXRhLmNoaUFycmF5O1xyXG4gICAgICAgICAgICBzZWxmLmRvQ2hpKHNpLCBkYXRhLnBhaSwgY2hpQXJyYXksIGV4dHJhQ2hpUGFpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbmdfbm90aWZ5X3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FuZ19ub3RpZnlfcHVzaCcpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xyXG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XHJcbiAgICAgICAgICAgIHZhciBzaSA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgICAgICBzZWxmLmRvR2FuZyhzaSwgcGFpLCBkYXRhLmdhbmd0eXBlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyAg6LSi56We5byD54mM5pON5L2cXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2NhaXNoZW5fbm90aWZ5X3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIui0ouelnuW8g+eJjOaTjeS9nFwiKTtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcklkO1xyXG4gICAgICAgICAgICB2YXIgcGFpID0gZGF0YS5wYWk7XHJcbiAgICAgICAgICAgIHZhciBzaSA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn6LSi56We5byD54mM5pON5L2cISEhISEhISEhIScsIGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRvQ2FpU2hlbihzaSwgcGFpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImNoYXRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImNoYXRfcHVzaFwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcInF1aWNrX2NoYXRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInF1aWNrX2NoYXRfcHVzaFwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImVtb2ppX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJlbW9qaV9wdXNoXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZGlzc29sdmVfbm90aWNlX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRpc3NvbHZlX25vdGljZV9wdXNoXCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNzb3ZlRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImRpc3NvbHZlX25vdGljZVwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImRpc3NvbHZlX2NhbmNlbF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNzb3ZlRGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImRpc3NvbHZlX2NhbmNlbFwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcInZvaWNlX21zZ19wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2b2ljZV9tc2dfcHVzaFwiKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwidm9pY2VfbXNnXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxufSkiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gX2hhbGxHZW1zVjogbnVsbCxcclxuICAgICAgICAvLyBfaGFsbENvaW5zVjogbnVsbCxcclxuICAgICAgICBfYWxlcnRWOiBudWxsLCAvL+aPkOekuuahhlxyXG4gICAgICAgIF9hbGVydENvbnRlbnRWOiBudWxsLFxyXG4gICAgICAgIF9tb3JyYUhhbGxWOiBudWxsLCAvL+Wkp+WOhXZpZXdcclxuICAgICAgICBfcm9vbUlkVjogbnVsbCxcclxuICAgICAgICBfc2VhdHNWOiBbXSwgLy/luqfkvY12aWV3XHJcbiAgICAgICAgX2NhaXF1YW5WOiBbXSxcclxuICAgICAgICAvL+WKqOeUu+ebuOWFs1xyXG4gICAgICAgIF9sZWZ0QW5pbWF0aW9uOiBudWxsLFxyXG4gICAgICAgIF9yaWdodEFuaW1hdGlvbjogbnVsbCxcclxuICAgICAgICBfbGVmdE9wZW5BbmltOiBudWxsLFxyXG4gICAgICAgIF9yaWdodE9wZW5BbmltOiBudWxsLFxyXG4gICAgICAgIF9hbmltVGltZTogMzAwMCxcclxuICAgICAgICBfcmVzdWx0c1Y6IG51bGwsIC8v57uT5p6c5pi+56S6dmlld1xyXG4gICAgICAgIF9jdXJyZW50UXVhblY6IG51bGwsIC8v5b2T5YmN6YCJ5oup5omL5Yq/55qEdmlld1xyXG4gICAgICAgIF93aW5sYWJlbFY6IG51bGwsXHJcbiAgICAgICAgX3dpbkJnVjogbnVsbCxcclxuICAgICAgICBjdXJyZW50UXVhbjogLTEsIC8v5b2T5YmN6YCJ5oup55qE5omL5Yq/XHJcbiAgICAgICAgaXNSYW5kb206IGZhbHNlLCAvL+aYr+WQpumaj+acuuaJi+WKv1xyXG4gICAgICAgIGdhbWVFbmREYXRhOiBudWxsLCAvL+WvueWxgOe7k+adn+aVsOaNrlxyXG4gICAgICAgIGppYW56aTogMCxcclxuICAgICAgICBzaGl0b3U6IDEsXHJcbiAgICAgICAgYnU6IDIsXHJcbiAgICAgICAgc2VhdGluZGV4OiAwLCAvL+W9k+WJjeS9jee9riAw5bemMeWPs1xyXG4gICAgICAgIHNlYXRzOiBudWxsLFxyXG4gICAgICAgIGNhbkFnYWluOiBmYWxzZSwgLy/og73lkKbnu6fnu63muLjmiI/vvIjlvZPmnInkurrmjonnur/miJbpgIDlh7rvvIlcclxuICAgICAgICBndWl6ZTogbnVsbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gdGhpcy5faGFsbEdlbXNWID0gY2MuZmluZChcIkNhbnZhcy9oZWFkZXIvamluYmkvZ2Vtc1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIC8vIHRoaXMuX2hhbGxDb2luc1YgPSBjYy5maW5kKFwiQ2FudmFzL2hlYWRlci96dWFuc2hpL2NvaW5zXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5ndWl6ZSA9IGNjLmZpbmQoXCJDYW52YXMvZ3Vlc3Nib3gvZ3VpemVcIik7XHJcbiAgICAgICAgdGhpcy5fYWxlcnRWID0gY2MuZmluZChcIkNhbnZhcy9ndWVzc2JveEFsZXJ0XCIpO1xyXG4gICAgICAgIHRoaXMuX2FsZXJ0Q29udGVudFYgPSB0aGlzLl9hbGVydFYuZ2V0Q2hpbGRCeU5hbWUoXCJjb250ZW50XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fbW9ycmFIYWxsViA9IGNjLmZpbmQoXCJDYW52YXMvZ3Vlc3Nib3hcIik7XHJcbiAgICAgICAgdGhpcy5fcm9vbUlkViA9IHRoaXMuX21vcnJhSGFsbFYuZ2V0Q2hpbGRCeU5hbWUoXCJyb29tSWRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLmluaXRTZWF0c1ZpZXcoKTtcclxuICAgICAgICB0aGlzLnNob3dXaW5Db3VudChmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5pbml0Q2FpcXVhblZpZXcoKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudEhhbmRsZXJzKCk7XHJcbiAgICAgICAgdGhpcy5zZXRHZW1zQW5kQ29pbnMoY2MudnYudXNlck1nci5nZW1zLCBjYy52di51c2VyTWdyLmNvaW5zKTtcclxuICAgICAgICBpZiAoY2MudnYuZ2FtZU5ldE1nci5jcV9kYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tY3FfZGF0YS0tLS1cIiwgY2MudnYuZ2FtZU5ldE1nci5jcV9kYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5zZWF0cyA9IGNjLnZ2LmdhbWVOZXRNZ3IuY3FfZGF0YS5zZWF0cztcclxuICAgICAgICAgICAgdGhpcy5pbml0U2VhdHNEYXRhKGNjLnZ2LmdhbWVOZXRNZ3IuY3FfZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdyZWFkeScpO1xyXG4gICAgfSxcclxuICAgIGluaXRTZWF0c1ZpZXc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWF0ID0gW107XHJcbiAgICAgICAgc2VhdFswXSA9IHRoaXMuX21vcnJhSGFsbFYuZ2V0Q2hpbGRCeU5hbWUoXCJzZWF0XCIpLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgc2VhdFsxXSA9IHRoaXMuX21vcnJhSGFsbFYuZ2V0Q2hpbGRCeU5hbWUoXCJzZWF0XCIpLmNoaWxkcmVuWzFdLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHNWLnNlYXQgPSBzZWF0O1xyXG4gICAgICAgIHRoaXMuX3NlYXRzVi5kaWZlbiA9IHRoaXMuX21vcnJhSGFsbFYuZ2V0Q2hpbGRCeU5hbWUoXCJkaWZlblwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzVi5nZW1zID0gdGhpcy5fbW9ycmFIYWxsVi5nZXRDaGlsZEJ5TmFtZShcImdlbXNCZ1wiKS5nZXRDaGlsZEJ5TmFtZShcImdlbXNcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl9zZWF0c1YuY29pbnMgPSB0aGlzLl9tb3JyYUhhbGxWLmdldENoaWxkQnlOYW1lKFwiY29pbnNCZ1wiKS5nZXRDaGlsZEJ5TmFtZShcImNvaW5zXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHNWLndpbmNvbnQgPSB0aGlzLl9tb3JyYUhhbGxWLmdldENoaWxkQnlOYW1lKFwid2luQmdcIikuZ2V0Q2hpbGRCeU5hbWUoXCJ3aW5jb250XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fd2lubGFiZWxWID0gdGhpcy5fbW9ycmFIYWxsVi5nZXRDaGlsZEJ5TmFtZShcIndpbmxhYmVsXCIpO1xyXG4gICAgICAgIHRoaXMuX3dpbkJnViA9IHRoaXMuX21vcnJhSGFsbFYuZ2V0Q2hpbGRCeU5hbWUoXCJ3aW5CZ1wiKTtcclxuICAgICAgICB0aGlzLl9zZWF0c1YubGFzdFRpbWUgPSB0aGlzLl9tb3JyYUhhbGxWLmdldENoaWxkQnlOYW1lKFwibGFzdFRpbWVCZ1wiKS5nZXRDaGlsZEJ5TmFtZShcImxhc3RUaW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICB9LFxyXG4gICAgaW5pdENhaXF1YW5WaWV3OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbGF5b3V0ID0gdGhpcy5fbW9ycmFIYWxsVi5nZXRDaGlsZEJ5TmFtZShcImNvbnRlbnRcIikuZ2V0Q2hpbGRCeU5hbWUoXCJsYXlvdXRcIik7XHJcbiAgICAgICAgdGhpcy5fY2FpcXVhblYubGVmdCA9IGxheW91dC5nZXRDaGlsZEJ5TmFtZShcImxlZnRcIik7XHJcbiAgICAgICAgdGhpcy5fY2FpcXVhblYubGVmdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9jYWlxdWFuVi5yaWdodCA9IGxheW91dC5nZXRDaGlsZEJ5TmFtZShcInJpZ2h0XCIpO1xyXG4gICAgICAgIHRoaXMuX2NhaXF1YW5WLnJpZ2h0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2xlZnRBbmltYXRpb24gPSBsYXlvdXQuZ2V0Q2hpbGRCeU5hbWUoXCJsX2FuaW1cIik7XHJcbiAgICAgICAgdGhpcy5fcmlnaHRBbmltYXRpb24gPSBsYXlvdXQuZ2V0Q2hpbGRCeU5hbWUoXCJyX2FuaW1cIik7XHJcbiAgICAgICAgdGhpcy5fbGVmdE9wZW5BbmltID0gdGhpcy5fbGVmdEFuaW1hdGlvbi5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICB0aGlzLl9yaWdodE9wZW5BbmltID0gdGhpcy5fcmlnaHRBbmltYXRpb24uZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgdGhpcy5fbGVmdFh1YW5kaW5nID0gdGhpcy5fY2FpcXVhblYubGVmdC5nZXRDaGlsZEJ5TmFtZSgneHVhbmRpbmcnKTtcclxuICAgICAgICB0aGlzLl9yaWdodFh1YW5kaW5nID0gdGhpcy5fY2FpcXVhblYucmlnaHQuZ2V0Q2hpbGRCeU5hbWUoJ3h1YW5kaW5nJyk7XHJcbiAgICAgICAgdGhpcy5fcmVzdWx0c1YgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB0aGlzLl9yZXN1bHRzVi5wdXNoKGxheW91dC5nZXRDaGlsZEJ5TmFtZShcInJlc3VsdDFcIikpO1xyXG4gICAgICAgIHRoaXMuX3Jlc3VsdHNWLnB1c2gobGF5b3V0LmdldENoaWxkQnlOYW1lKFwicmVzdWx0MlwiKSk7XHJcbiAgICAgICAgdGhpcy5fcmVzdWx0c1YucHVzaChsYXlvdXQuZ2V0Q2hpbGRCeU5hbWUoXCJyZXN1bHQzXCIpKTtcclxuICAgIH0sXHJcbiAgICBpbml0RXZlbnRIYW5kbGVyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jcUV2ZW50SGFuZGxlciA9IHRoaXMubm9kZTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy/muLjmiI/lvIDlp4tcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2NxX2JlZ2luJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY3FfYmVnaW49PT09PT09PT09PT09PT09PT09PT4nLCBkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5wbGF5T3BlbkFuaW0oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+aWsOWinueUqOaIt1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignY3FfbmV3X3VzZXInLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSByZXMuZGV0YWlsLmRhdGE7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY3FfZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBkYXRhLnNlYXRzO1xyXG4gICAgICAgICAgICBzZWxmLmluaXRTZWF0c0RhdGEoZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/muLjmiI/nu5PmnZ9cclxuICAgICAgICB0aGlzLm5vZGUub24oJ2NxX2dhbWVfb3ZlcicsIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHJlcy5kZXRhaWwuZGF0YTtcclxuICAgICAgICAgICAgc2VsZi5nYW1lRW5kRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIC8vIHNlbGYucGxheU9wZW5BbmltKCk7XHJcbiAgICAgICAgICAgIHNlbGYuZ2FtZUVuZCgpO1xyXG4gICAgICAgICAgICB2YXIgcyA9IHNlbGY7XHJcbiAgICAgICAgICAgIHZhciBhZ2FpbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHMuc2VhdGluZGV4ID09IDAgJiYgcy5jYW5BZ2FpbikgeyAvL+WmguaenOaYr+aIv+S4u1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdjcV9hZ2FpbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcy5jbGVhckNxKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0VGltZW91dChhZ2FpbiwgMjAwMCk7XHJcbiAgICAgICAgICAgIC8vIHZhciBkYXRhID0gZGF0YS5kZXRhaWwuZGF0YTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+aUu+aTgumAgOWHuuaIv+mXtFxyXG4gICAgICAgIHRoaXMubm9kZS5vbignY3FfZXhpdF9ub3RpZnknLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJpZCA9IHJlcy5kZXRhaWw7XHJcbiAgICAgICAgICAgIHNlbGYuY2FuQWdhaW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHVzZXJpZCA9PSBjYy52di51c2VyTWdyLnVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jbGVhckNxKCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdGluZGV4ID0gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNlYXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWF0cy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS1zZWxmLnNlYXRzLS0tLS0tLS0tPj5cIiwgc2VsZi5zZWF0cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2VhdHNWLnNlYXRbMV0uc3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dXaW5Db3VudChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5nZXRHZW1zQW5kQ29pbnMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+aIv+S4u+ino+aVo+aIv+mXtFxyXG4gICAgICAgIHRoaXMubm9kZS5vbignY3FfZGlzcHJlc3MnLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBzZWxmO1xyXG4gICAgICAgICAgICB2YXIgdXNlcmlkID0gcmVzLmRldGFpbDtcclxuICAgICAgICAgICAgaWYgKHVzZXJpZCA9PSBjYy52di51c2VyTWdyLnVzZXJJZCkge30gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5pOC5Li76YCD6LeR5LqG77yBLOW5tui1oOmAgeS6huS9oOWFqOmDqOWllumHke+8gVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxvYWRIb21lSGFsbCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5jYW5BZ2FpbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLmNsZWFyQ3EoKTtcclxuICAgICAgICAgICAgc2VsZi5zZWF0cyA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdGluZGV4ID0gMDtcclxuICAgICAgICAgICAgc2VsZi5nZXRHZW1zQW5kQ29pbnMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+WAkuiuoeaXtlxyXG4gICAgICAgIHRoaXMubm9kZS5vbignY3FfZ2FtZV90aW1lJywgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gcmVzLmRldGFpbC5kYXRhO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1YubGFzdFRpbWUuc3RyaW5nID0gZGF0YTtcclxuICAgICAgICAgICAgaWYgKGRhdGEgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY3VycmVudFF1YW4gPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+WAkuiuoeaXtue7k+adn+maj+acuumAieaLqeaJi+WKv1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXNSYW5kb20gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBudW0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCkgJSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChudW0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNodUppYW56aSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobnVtID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jaHVTaGl0b3UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNodUJ1KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mlLvmk4LlpLHotKVcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2NxX2xvc2VyX25vdGlmeScsIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHNlbGY7XHJcbiAgICAgICAgICAgIHZhciB1c2VyaWQgPSByZXMuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLmNhbkFnYWluID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICh1c2VyaWQgPT0gY2MudnYudXNlck1nci51c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuY2xlYXJDcSgpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0cyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5oKo5oyR5oiY5aSx6LSl77yB6Ieq5Yqo6YCA5Ye65oi/6Ze0XCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQubG9hZEhvbWVIYWxsKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNlYXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWF0cy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS1jcV9sb3Nlcl9ub3RpZnktLS0tLS0tLS0+PlwiLCBzZWxmLnNlYXRzKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWF0c1Yuc2VhdFsxXS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5zaG93V2luQ291bnQoZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuZ2V0R2Vtc0FuZENvaW5zKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mlLvmk4LmiJDlip9cclxuICAgICAgICB0aGlzLm5vZGUub24oJ2NxX3dpbm5lcl9ub3RpZnknLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBzZWxmO1xyXG4gICAgICAgICAgICB2YXIgdXNlcmlkID0gcmVzLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIHN0ciA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmICh1c2VyaWQgPT0gY2MudnYudXNlck1nci51c2VySWQpIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLmlLvmk4LmiJDlip/vvIHlubbojrflvpfkuoblhajpg6jlpZbph5HvvIFcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5sb2FkSG9tZUhhbGwoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuaCqOiiq+aJk+i0peS6hu+8geW5tuWwhuWllumHkei1oOmAgee7meS6huWvueaJi++8gVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmxvYWRIb21lSGFsbCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5jYW5BZ2FpbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLmNsZWFyQ3EoKTtcclxuICAgICAgICAgICAgc2VsZi5zZWF0cyA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdGluZGV4ID0gMDtcclxuICAgICAgICAgICAgc2VsZi5nZXRHZW1zQW5kQ29pbnMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+WHuuaLs+mAmuefpVxyXG4gICAgICAgIHRoaXMubm9kZS5vbignY3FfY2h1cXVhbl9ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5YGc5q2i5Yqo55S777yM5pi+56S65bey5Ye65ouzXHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgaWYgKHNlbGYuc2VhdHNbMF0udXNlcmlkID09IHVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5pOC5Li75Ye65ouzXHJcbiAgICAgICAgICAgICAgICBzZWxmLl9sZWZ0T3BlbkFuaW0uc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fbGVmdEFuaW1hdGlvbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX2NhaXF1YW5WLmxlZnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChjYy52di51c2VyTWdyLnVzZXJJZCAhPSB1c2VySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+S4jeaYr+acrOS6uueahOaXtuWAme+8jOaYvuekuuW3sumAieWumlxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2xlZnRYdWFuZGluZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy91c2VyaWRcclxuICAgICAgICAgICAgICAgIHNlbGYuX3JpZ2h0T3BlbkFuaW0uc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fcmlnaHRBbmltYXRpb24uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9jYWlxdWFuVi5yaWdodC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNjLnZ2LnVzZXJNZ3IudXNlcklkICE9IHVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8v5LiN5piv5pys5Lq655qE5pe25YCZ77yM5pi+56S65bey6YCJ5a6aXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcmlnaHRYdWFuZGluZy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBzZWxmO1xyXG4gICAgICAgICAgICBzZWxmLmNhbkFnYWluID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuc2VhdHMgPSBudWxsO1xyXG4gICAgICAgICAgICBzZWxmLnNlYXRpbmRleCA9IDA7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgaW5pdFNlYXRzRGF0YTogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgY29uc3UgPSBkYXRhLmNvbmYuY29uc3U7XHJcbiAgICAgICAgaWYgKGNvbnN1ID09IDApIHtcclxuICAgICAgICAgICAgLy/ph5HluIFcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNWLmRpZmVuLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShkYXRhLmNvbmYuYmFzZVNjb3JlKSArIFwi6YeR5biBXCI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy/pkrvnn7NcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNWLmRpZmVuLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShkYXRhLmNvbmYuYmFzZVNjb3JlKSArIFwi6ZK755+zXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzZWxmLnNlYXRzKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX3Jvb21JZFYuc3RyaW5nID0gXCLmiL/pl7Tlj7fvvJpcIiArIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuc2VhdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzVi5zZWF0W2ldLnN0cmluZyA9IHNlbGYuc2VhdHNbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNlYXRzW2ldLnVzZXJpZCA9PSBjYy52di51c2VyTWdyLnVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzVi53aW5jb250LnN0cmluZyA9IHNlbGYuc2VhdHNbaV0uc2NvcmU7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWF0aW5kZXggPSBzZWxmLnNlYXRzW2ldLnNlYXRpbmRleDtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmdldEdlbXNBbmRDb2lucygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzZWxmLnNlYXRzLmxlbmd0aCA9PSAyICYmIHNlbGYuc2VhdHNbMV0udXNlcmlkICE9IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNlYXRzWzBdLnVzZXJpZCA9PSBjYy52di51c2VyTWdyLnVzZXJJZCkgeyAvL+aIv+S4u+aPkOekuuacieS6uui/m+WFpeaIv+mXtFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2FsZXJ0Q29udGVudFYuc3RyaW5nID0gc2VsZi5zZWF0c1sxXS5uYW1lICsgXCLov5vlhaXkuobmiL/pl7RcIjtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9hbGVydFYuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHNlbGY7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5fYWxlcnRWLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93V2luQ291bnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dXaW5Db3VudChmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5jYW5BZ2FpbiA9IChzZWxmLnNlYXRzLmxlbmd0aCA9PSAyICYmIHNlbGYuc2VhdHNbMV0udXNlcmlkICE9IDApO1xyXG4gICAgICAgIHNlbGYuY2xlYXJDcSgpO1xyXG4gICAgfSxcclxuICAgIGdhbWVFbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5nYW1lRW5kRGF0YSB8fCB0aGlzLmdhbWVFbmREYXRhID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9yaWdodFh1YW5kaW5nLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2xlZnRYdWFuZGluZy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZ2FtZUVuZERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZUVuZERhdGFbaV0uc2VhdEluZGV4ID09IHRoaXMuc2VhdGluZGV4KSB7IC8v5aaC5p6c5piv6Ieq5bexXHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzLl9yZXN1bHRzVlt0aGlzLmdhbWVFbmREYXRhW2ldLndpbmVkXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzdWx0c1ZbdGhpcy5nYW1lRW5kRGF0YVsxXS53aW5lZF0uYWN0aXZlID0gdHJ1ZTsvL+WPquaYvuekuuaUu+aTguiAheeahOi+k+i1olxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lT3ZlclNob3dHZXN0dXJlKHRoaXMuZ2FtZUVuZERhdGFbaV0uY2h1UXVhbiwgaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fc2VhdHNWLndpbmNvbnQuc3RyaW5nID0gKGkgPT0gMCA/IDAgOiB0aGlzLmdhbWVFbmREYXRhW2ldLndpbkNvdW50KTsgLy/mmL7npLrmlLvmk4LogIXlvpfliIZcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2xlYXJDcTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NhaXF1YW5WKSB7XHJcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gdGhpcy5fY2FpcXVhblYubGVmdC5jaGlsZHJlbjtcclxuICAgICAgICAgICAgdmFyIHJpZ2h0ID0gdGhpcy5fY2FpcXVhblYucmlnaHQuY2hpbGRyZW47XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVmdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsZWZ0W2ldLmNoaWxkcmVuLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdFtpXS5jaGlsZHJlbltqXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJpZ2h0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJpZ2h0W2ldLmNoaWxkcmVuLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRbaV0uY2hpbGRyZW5bal0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3Jlc3VsdHNWKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fcmVzdWx0c1YubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VsdHNWW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2N1cnJlbnRRdWFuViA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50UXVhbiA9IC0xO1xyXG4gICAgICAgIHRoaXMuaXNSYW5kb20gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmdhbWVFbmREYXRhID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5fY2FpcXVhblYpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2FpcXVhblYubGVmdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2NhaXF1YW5WKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhaXF1YW5WLnJpZ2h0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDnjJzmi7PliqjnlLvmkq3mlL5cclxuICAgIHBsYXlPcGVuQW5pbTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2NhaXF1YW5WLmxlZnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fY2FpcXVhblYucmlnaHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGxlZnRBbmltID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX2xlZnRBbmltYXRpb24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIGFuaW1TdGF0ZTEgPSBzZWxmLl9sZWZ0T3BlbkFuaW0ucGxheSgnY2FpcXVhbjInKTtcclxuICAgICAgICAgICAgYW5pbVN0YXRlMS53cmFwTW9kZSA9IGNjLldyYXBNb2RlLkxvb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByaWdodEFuaW0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5fcmlnaHRBbmltYXRpb24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIGFuaW1TdGF0ZTIgPSBzZWxmLl9yaWdodE9wZW5BbmltLnBsYXkoJ2NhaXF1YW4xJyk7XHJcbiAgICAgICAgICAgIGFuaW1TdGF0ZTIud3JhcE1vZGUgPSBjYy5XcmFwTW9kZS5Mb29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc2VsZi5pc1JhbmRvbSkge1xyXG4gICAgICAgICAgICBsZWZ0QW5pbSgpO1xyXG4gICAgICAgICAgICByaWdodEFuaW0oKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZWZ0QW5pbSgpO1xyXG4gICAgICAgIHJpZ2h0QW5pbSgpO1xyXG4gICAgfSxcclxuICAgIHNob3dHZXN0dXJlOiBmdW5jdGlvbih0eXBlKSB7IC8v5omL5Yq/5pi+56S6XHJcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRRdWFuViAmJiB0aGlzLl9jdXJyZW50UXVhblYgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UXVhblYuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsZWZ0ID0gdGhpcy5fY2FpcXVhblYubGVmdC5jaGlsZHJlbjtcclxuICAgICAgICB2YXIgcmlnaHQgPSB0aGlzLl9jYWlxdWFuVi5yaWdodC5jaGlsZHJlbjtcclxuICAgICAgICBmb3IgKHZhciBpIGluIGxlZnQpIHtcclxuICAgICAgICAgICAgbGVmdFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiByaWdodCkge1xyXG4gICAgICAgICAgICByaWdodFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2VhdGluZGV4ID09IDApIHsgLy/lt6bovrlcclxuICAgICAgICAgICAgbGVmdFswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UXVhblYgPSBsZWZ0WzBdLmNoaWxkcmVuW3R5cGVdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJpZ2h0WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRRdWFuViA9IHJpZ2h0WzFdLmNoaWxkcmVuW3R5cGVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jdXJyZW50UXVhblYuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRRdWFuID0gdHlwZTtcclxuICAgICAgICB0aGlzLl9jYWlxdWFuVi5sZWZ0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY2FpcXVhblYucmlnaHQuYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBnYW1lT3ZlclNob3dHZXN0dXJlOiBmdW5jdGlvbih0eXBlLCBpbmRleCkge1xyXG4gICAgICAgIHZhciBsZWZ0ID0gdGhpcy5fY2FpcXVhblYubGVmdC5jaGlsZHJlbjtcclxuICAgICAgICB2YXIgcmlnaHQgPSB0aGlzLl9jYWlxdWFuVi5yaWdodC5jaGlsZHJlbjtcclxuICAgICAgICBpZiAoaW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgICBsZWZ0WzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGxlZnRbMF0uY2hpbGRyZW5bdHlwZV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByaWdodFsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICByaWdodFsxXS5jaGlsZHJlblt0eXBlXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmL7npLrotaLlj6XmrKHmlbBcclxuICAgIHNob3dXaW5Db3VudDogZnVuY3Rpb24oZmxhZykge1xyXG4gICAgICAgIHRoaXMuX3dpbmxhYmVsVi5hY3RpdmUgPSBmbGFnO1xyXG4gICAgICAgIHRoaXMuX3dpbkJnVi5hY3RpdmUgPSBmbGFnO1xyXG4gICAgfSxcclxuICAgIC8v6K6+572u6YeR5biB6ZK755+z5pWw6YePXHJcbiAgICBnZXRHZW1zQW5kQ29pbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjYy52di51c2VyTWdyLmdldEdlbXNBbmRDb2lucyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tZ2V0R2Vtc0FuZENvaW5zLS0tLS0tLS0+XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLmdlbXMgPSBkYXRhLmdlbXM7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuY29pbnMgPSBkYXRhLmNvaW5zO1xyXG4gICAgICAgICAgICAvLyBzZWxmLl9oYWxsR2Vtc1Yuc3RyaW5nID0gZGF0YS5nZW1zO1xyXG4gICAgICAgICAgICAvLyBzZWxmLl9oYWxsQ29pbnNWLnN0cmluZyA9IGRhdGEuY29pbnM7XHJcbiAgICAgICAgICAgIHNlbGYuc2V0R2Vtc0FuZENvaW5zKGRhdGEuZ2VtcywgZGF0YS5jb2lucyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgc2V0R2Vtc0FuZENvaW5zOiBmdW5jdGlvbihnZW1zLCBjb2lucykge1xyXG4gICAgICAgIGlmICh0aGlzLl9zZWF0c1YgJiYgdGhpcy5fc2VhdHNWLmdlbXMgJiYgdGhpcy5fc2VhdHNWLmNvaW5zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzVi5nZW1zLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShnZW1zKTtcclxuICAgICAgICAgICAgdGhpcy5fc2VhdHNWLmNvaW5zLnN0cmluZyA9IGNvaW5zO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+WHuuWJquWtkFxyXG4gICAgY2h1SmlhbnppOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UXVhbiA9PSAtMSkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dHZXN0dXJlKHRoaXMuamlhbnppKTtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoJ2NxX3Nob3QnLCB0aGlzLmppYW56aSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5Ye655+z5aS0XHJcbiAgICBjaHVTaGl0b3U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRRdWFuID09IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0dlc3R1cmUodGhpcy5zaGl0b3UpO1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZCgnY3Ffc2hvdCcsIHRoaXMuc2hpdG91KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/lh7rluINcclxuICAgIGNodUJ1OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UXVhbiA9PSAtMSkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dHZXN0dXJlKHRoaXMuYnUpO1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZCgnY3Ffc2hvdCcsIHRoaXMuYnUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+WFs+mXreW8ueahhumAmuefpVxyXG4gICAgb25CdG5DbG9zZUFsZXJ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9hbGVydFYuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5sb2FkSG9tZUhhbGwoKTtcclxuICAgICAgICAvLyB0aGlzLl9tb3JyYUhhbGxWLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5YWz6Zet54yc5ouz5aSn5Y6FXHJcbiAgICBvbkJ0bkNsb3NlUm9vbTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzdHIgPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLnNlYXRpbmRleCA9PSAwKSB7IC8v5oi/5Li7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlYXRzLmxlbmd0aCA9PSAyICYmIHRoaXMuc2VhdHNbMV0udXNlcmlkICE9IDApIHtcclxuICAgICAgICAgICAgICAgIHN0ciA9IFwi5oKo56Gu5a6a6KaB5pS+5byD5a6I5pOC77yB5bm25bCG5aWW6YeR6LWg6YCB57uZ5LqG5a+55omL77yfXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdHIgPSBcIuaCqOehruWumuimgeemu+W8gOaTguWPsO+8n1wiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgc3RyLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdjcV9kaXNwcmVzcycpO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5sb2FkSG9tZUhhbGwoKTtcclxuICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RyID0gXCLmgqjmiYvnu63otLnlt7LmiaPpmaTvvIHmgqjnoa7lrprmlL7lvIPmlLvmk4LvvJ9cIjtcclxuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBzdHIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoJ2NxX2V4aXQnKTtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQubG9hZEhvbWVIYWxsKCk7XHJcbiAgICAgICAgICAgIH0sIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+WKoOi9vemmlumhteWkp+WOhVxyXG4gICAgbG9hZEhvbWVIYWxsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdoYWxsXCIpO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxuICAgIC8v5omT5byA54yc5ouz6KeE5YiZXHJcbiAgICBvbk9wZW5ndWl6ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5ndWl6ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v5omT5byA54yc5ouz6KeE5YiZXHJcbiAgICBvbkNsb3NlZ3VpemU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuZ3VpemUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX2d1ZXNzVjogbnVsbCxcclxuICAgICAgICBfY3JlYXRlYm94VjogbnVsbCxcclxuICAgICAgICBfY3JlYXRlX2dlbXNWOiBudWxsLFxyXG4gICAgICAgIF9jcmVhdGVfY29pbnNWOiBudWxsLFxyXG4gICAgICAgIF9jcmVhdGVfdGFnVjogbnVsbCxcclxuICAgICAgICBfc2Vla2JveFY6IG51bGwsXHJcbiAgICAgICAgX2FsZXJ0VjogbnVsbCxcclxuICAgICAgICBfYWxlcnRDb250ZW50VjogbnVsbCxcclxuICAgICAgICBjb25zdTogMCwgLy8w6YeR5biB5Zy6IDHpkrvnn7PlnLpcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fZ3Vlc3NWID0gY2MuZmluZChcIkNhbnZhcy9ndWVzc1wiKTtcclxuICAgICAgICB0aGlzLl9jcmVhdGVib3hWID0gdGhpcy5fZ3Vlc3NWLmdldENoaWxkQnlOYW1lKFwiY3JlYXRlYm94XCIpO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZV9nZW1zViA9IHRoaXMuX2NyZWF0ZWJveFYuZ2V0Q2hpbGRCeU5hbWUoXCJjcmVhdGVfZ2Vtc1wiKTtcclxuICAgICAgICB0aGlzLl9jcmVhdGVfY29pbnNWID0gdGhpcy5fY3JlYXRlYm94Vi5nZXRDaGlsZEJ5TmFtZShcImNyZWF0ZV9jb2luc1wiKTtcclxuICAgICAgICB0aGlzLl9jcmVhdGVfdGFnViA9IHRoaXMuX2NyZWF0ZWJveFYuZ2V0Q2hpbGRCeU5hbWUoXCJjcmVhdGVfdGFnXCIpO1xyXG4gICAgICAgIHRoaXMuX3NlZWtib3hWID0gdGhpcy5fZ3Vlc3NWLmdldENoaWxkQnlOYW1lKFwic2Vla2JveFwiKTtcclxuICAgICAgICB0aGlzLl9hbGVydFYgPSBjYy5maW5kKFwiQ2FudmFzL2d1ZXNzYm94QWxlcnRcIik7XHJcbiAgICAgICAgdGhpcy5fYWxlcnRDb250ZW50ViA9IHRoaXMuX2FsZXJ0Vi5nZXRDaGlsZEJ5TmFtZShcImNvbnRlbnRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgIH0sXHJcbiAgICAvL+aYvuekuuWIm+W7uueMnOaLs+mhtemdolxyXG4gICAgb25CdG5TaG93TW9ycmE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2d1ZXNzVi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v5YWz6Zet54yc5ouz6aG16Z2iXHJcbiAgICBvbkJ0bkNsb3NlTW9ycmE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2d1ZXNzVi5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBvbkJ0blNldENvbnN1OiBmdW5jdGlvbihldiwgZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhID09IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25zdSA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZV90YWdWLmdldENoaWxkQnlOYW1lKFwiZ2Vtc19uXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVfdGFnVi5nZXRDaGlsZEJ5TmFtZShcImNvaW5zX25cIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlX2dlbXNWLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVfY29pbnNWLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb25zdSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZV90YWdWLmdldENoaWxkQnlOYW1lKFwiZ2Vtc19uXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZV90YWdWLmdldENoaWxkQnlOYW1lKFwiY29pbnNfblwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlX2dlbXNWLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZV9jb2luc1YuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5pi+56S65Yib5bu65oi/6Ze06aG16Z2iXHJcbiAgICBvbkJ0blNob3dDcmVhdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlYm94Vi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZV90YWdWLmdldENoaWxkQnlOYW1lKFwiZ2Vtc19uXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlX3RhZ1YuZ2V0Q2hpbGRCeU5hbWUoXCJjb2luc19uXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZV9nZW1zVi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZV9jb2luc1YuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb25zdSA9IDA7XHJcbiAgICB9LFxyXG4gICAgLy/lhbPpl63liJvlu7rmiL/pl7TpobXpnaJcclxuICAgIG9uQnRuQ2xvc2VDcmVhdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlYm94Vi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9jcmVhdGVfZ2Vtc1YuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlX2NvaW5zVi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbnN1ID0gMDtcclxuICAgIH0sXHJcbiAgICAvL+aYvuekuuWKoOWFpeaIv+mXtOmhtemdolxyXG4gICAgb25CdG5TaG93Sm9pbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fc2Vla2JveFYuYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICAvL+WFs+mXreWKoOWFpeaIv+mXtOmhtemdolxyXG4gICAgb25CdG5DbG9zZUpvaW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3NlZWtib3hWLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5YWz6Zet5by55qGG6YCa55+lXHJcbiAgICBvbkJ0bkNsb3NlQWxlcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2FsZXJ0Vi5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBvbkJ0blNldEJvbnVzOiBmdW5jdGlvbihldiwgZGF0YSkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbnN1ID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fY3JlYXRlX2dlbXNWLmdldENoaWxkQnlOYW1lKFwiZWRpdGJveFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCkuc3RyaW5nID0gZGF0YTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVfY29pbnNWLmdldENoaWxkQnlOYW1lKFwiZWRpdGJveFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCkuc3RyaW5nID0gZGF0YTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/liJvlu7rmiL/pl7RcclxuICAgIGNyZWF0TW9ycmFSb29tOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGRpZmVuO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbnN1ID09IDApIHtcclxuICAgICAgICAgICAgZGlmZW4gPSBzZWxmLl9jcmVhdGVfZ2Vtc1YuZ2V0Q2hpbGRCeU5hbWUoXCJlZGl0Ym94XCIpLmdldENvbXBvbmVudChjYy5FZGl0Qm94KS5zdHJpbmc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGlmZW4gPSBzZWxmLl9jcmVhdGVfY29pbnNWLmdldENoaWxkQnlOYW1lKFwiZWRpdGJveFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCkuc3RyaW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0tLS0tZGlmZW4tLS0tLS0tPj5cIiwgZGlmZW4pO1xyXG4gICAgICAgIGlmICghY2MudnYudXRpbHMuY2hlY2tSYXRlKGRpZmVuKSB8fCBwYXJzZUludChkaWZlbikgPD0gMCkge1xyXG4gICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi6K+36K6+572u5aWW6YeR5pWw6YeP77yBKOWPqumZkOaVtOaVsClcIik7XHJcbiAgICAgICAgICAgIC8vIHNlbGYuX2FsZXJ0Q29udGVudFYuc3RyaW5nID0gXCLor7forr7nva7lpZbph5HmlbDph4/vvIEo5Y+q6ZmQ5pW05pWwKVwiO1xyXG4gICAgICAgICAgICAvLyBzZWxmLl9hbGVydFYuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2VpcmlOdW0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKGRpZmVuLmNoYXJBdCgwKSA9PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgIGRpZmVuID0gZGlmZW4uc3Vic3RyKDEpXHJcbiAgICAgICAgICAgICAgICBzZWlyaU51bSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlaXJpTnVtKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29uc3UgPT0gMCkge1xyXG4gICAgICAgICAgICBkaWZlbiArPSBcIjAwMDBcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG9uQ3JlYXRlID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSAyMjIyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IFwi6YeR5biB5LiN6Laz77yM5Yib5bu65oi/6Ze05aSx6LSlIVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi6YeR5biB5LiN6Laz77yM5Yib5bu65oi/6Ze05aSx6LSlIVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi6YeR5biB5LiN6Laz77yM5Yib5bu65oi/6Ze05aSx6LSlIVwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IFwi5Yib5bu65oi/6Ze05aSx6LSlLOmUmeivr+eggVwiICsgcmV0LmVycmNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLliJvlu7rmiL/pl7TlpLHotKUs6ZSZ6K+v56CBXCIgKyByZXQuZXJyY29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuWIm+W7uuaIv+mXtOWksei0pSzplJnor6/noIE6XCIgKyByZXQuZXJyY29kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIGNvbnRlbnQpO1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5fYWxlcnRDb250ZW50Vi5zdHJpbmcgPSBjb250ZW50O1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5fYWxlcnRWLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn5Yib5bu65oi/6Ze05oiQ5Yqf77yB77yB77yB77yB77yB77yBJyk7XHJcbiAgICAgICAgICAgICAgICAvL+aYvuekuueMnOaLs+Wkp+WOhVxyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5fbW9ycmFIYWxsVi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5sb2FkTW9ycmFIYWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnJvb21fdHlwZSA9IDE7XHJcbiAgICAgICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmNvbm5lY3RHYW1lU2VydmVyKHJldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBjb25mID0ge1xyXG4gICAgICAgICAgICByb29tX3R5cGU6IDEsIC8vMeS7o+ihqOeMnOaLs+aIv+mXtFxyXG4gICAgICAgICAgICBkaWZlbjogZGlmZW4sXHJcbiAgICAgICAgICAgIGNvbnN1OiBzZWxmLmNvbnN1LCAvLzDph5HluIEgMemSu+efs1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICBjb25mOiBKU09OLnN0cmluZ2lmeShjb25mKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuato+WcqOWIm+W7uuaIv+mXtFwiKTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2NyZWF0ZV9wcml2YXRlX3Jvb21cIiwgZGF0YSwgb25DcmVhdGUpO1xyXG4gICAgfSxcclxuICAgIC8v5Yqg5YWl5oi/6Ze0XHJcbiAgICBqb2luTW9ycmFSb29tOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJvb21JZCA9IHNlbGYuX3NlZWtib3hWLmdldENoaWxkQnlOYW1lKFwiZWRpdGJveFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCkuc3RyaW5nO1xyXG4gICAgICAgIGlmICghY2MudnYudXRpbHMuY2hlY2tSYXRlKHJvb21JZCkpIHtcclxuICAgICAgICAgICAgLy8gc2VsZi5fYWxlcnRDb250ZW50Vi5zdHJpbmcgPSBcIuivt+i+k+WFpeato+ehrueahOaIv+mXtOWPt1wiO1xyXG4gICAgICAgICAgICAvLyBzZWxmLl9hbGVydFYuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuivt+i+k+WFpeato+ehrueahOaIv+mXtOWPt1wiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29udGVudCA9IG51bGw7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICByb29tX3R5cGU6IDEsXHJcbiAgICAgICAgICAgIHJvb21JZDogcm9vbUlkXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuam9pbihyb29tSWQpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJldC5lcnJjb2RlID09IDEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBcIueMnOaLs+aIv+mXtFtcIiArIHJvb21JZCArIFwiXeS4jeWtmOWcqO+8jOivt+mHjeaWsOi+k+WFpSFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY29udGVudCkgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBjb250ZW50KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvanVkZ2Vfcm9vbVwiLCBkYXRhLCBmbik7XHJcbiAgICB9LFxyXG4gICAgam9pbjogZnVuY3Rpb24ocm9vbUlkKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLXJvb21JZC0tLS0+PlwiLCByb29tSWQpO1xyXG4gICAgICAgIGNjLnZ2LndjLnNob3coXCLmraPlnKjov5vlhaXmiL/pl7RcIik7XHJcbiAgICAgICAgY2MudnYudXNlck1nci5lbnRlclJvb20ocm9vbUlkLCBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS1yZXQuZXJyY29kZS0tLS0+PlwiLCByZXQpO1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy/mmL7npLrnjJzmi7PlpKfljoVcclxuICAgICAgICAgICAgICAgIC8vIHNlbGYuX21vcnJhSGFsbFYuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuaW5pdEhhbmRsZXJzKDEpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5sb2FkTW9ycmFIYWxsKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IFwi54yc5ouz5oi/6Ze0W1wiICsgcm9vbUlkICsgXCJd5LiN5a2Y5Zyo77yM6K+36YeN5paw6L6T5YWlIVwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlID09IDQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gXCLmiL/pl7RbXCIgKyByb29tSWQgKyBcIl3lt7Lmu6EhXCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJldC5lcnJjb2RlID09IDUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gXCLpkrvnn7PmiJbph5HluIHkuI3otrPvvIFcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHNlbGYuX2FsZXJ0Q29udGVudFYuc3RyaW5nID0gY29udGVudDtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGYuX2FsZXJ0Vi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBjb250ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8v5Yqg6L2954yc5ouz5aSn5Y6FXHJcbiAgICBsb2FkTW9ycmFIYWxsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJjYWlxdWFuXCIpO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiaWYgKHdpbmRvdy5pbyA9PSBudWxsKSB7XG4gICAgd2luZG93LmlvID0gcmVxdWlyZShcInNvY2tldC1pb1wiKTtcbn1cbnZhciBHbG9iYWwgPSBjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuICAgIHN0YXRpY3M6IHtcbiAgICAgICAgaXA6IFwiXCIsXG4gICAgICAgIHNpbzogbnVsbCxcbiAgICAgICAgaXNQaW5naW5nOiBmYWxzZSxcbiAgICAgICAgZm5EaXNjb25uZWN0OiBudWxsLFxuICAgICAgICBoYW5kbGVyczoge30sXG4gICAgICAgIGFkZEhhbmRsZXI6IGZ1bmN0aW9uKGV2ZW50LCBmbikge1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFuZGxlcnNbZXZlbnRdKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJldmVudDpcIiArIGV2ZW50ICsgXCInIGhhbmRsZXIgaGFzIGJlZW4gcmVnaXN0ZXJlZC5cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhldmVudCArIFwiKFwiICsgdHlwZW9mKGRhdGEpICsgXCIpOlwiICsgKGRhdGE/IGRhdGEudG9TdHJpbmcoKTpcIm51bGxcIikpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudCAhPSBcImRpc2Nvbm5lY3RcIiAmJiB0eXBlb2YoZGF0YSkgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm4oZGF0YSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVyc1tldmVudF0gPSBoYW5kbGVyO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2lvKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZWdpc3RlcjpmdW5jdGlvbiBcIiArIGV2ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5vbihldmVudCwgaGFuZGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNvbm5lY3Q6IGZ1bmN0aW9uKGZuQ29ubmVjdCwgZm5FcnJvcikge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIG9wdHMgPSB7XG4gICAgICAgICAgICAgICAgJ3JlY29ubmVjdGlvbic6IGZhbHNlLFxuICAgICAgICAgICAgICAgICdmb3JjZSBuZXcgY29ubmVjdGlvbic6IHRydWUsXG4gICAgICAgICAgICAgICAgJ3RyYW5zcG9ydHMnOiBbJ3dlYnNvY2tldCcsICdwb2xsaW5nJ11cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2lvID0gd2luZG93LmlvLmNvbm5lY3QodGhpcy5pcCwgb3B0cyk7XG4gICAgICAgICAgICB0aGlzLnNpby5vbigncmVjb25uZWN0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlY29ubmVjdGlvbicpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNpby5vbignY29ubmVjdCcsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNpby5jb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZuQ29ubmVjdChkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zaW8ub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJkaXNjb25uZWN0XCIpO1xuICAgICAgICAgICAgICAgIHNlbGYuc2lvLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5zaW8ub24oJ2Nvbm5lY3RfZmFpbGVkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nvbm5lY3RfZmFpbGVkJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmhhbmRsZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5oYW5kbGVyc1trZXldO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YodmFsdWUpID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09ICdkaXNjb25uZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mbkRpc2Nvbm5lY3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVnaXN0ZXI6ZnVuY3Rpb24gXCIgKyBrZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaW8ub24oa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0YXJ0SGVhcmJlYXQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3RhcnRIZWFyYmVhdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNpby5vbignZ2FtZV9wb25nJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sYXN0UmVjaWV2ZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmxhc3RSZWNpZXZlVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIXNlbGYuaXNQaW5naW5nKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5pc1BpbmdpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zaW8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vRklYTUU6IOi2heaXtuiuvuS4ujNzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHNlbGYubGFzdFJlY2lldmVUaW1lID4gMTAwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNlbmQ6IGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zaW8uY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCAmJiAodHlwZW9mKGRhdGEpID09IFwib2JqZWN0XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTsgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNpby5lbWl0KGV2ZW50LCBkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoJ2dhbWVfcGluZycpO1xuICAgICAgICB9LFxuICAgICAgICBjbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2UnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNpbyAmJiB0aGlzLnNpby5jb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNpby5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaW8gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZm5EaXNjb25uZWN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mbkRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZuRGlzY29ubmVjdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRlc3Q6IGZ1bmN0aW9uKGZuUmVzdWx0KSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xuICAgICAgICAgICAgICAgIGZuUmVzdWx0KHJldC5pc29ubGluZSk7XG4gICAgICAgICAgICAgICAgeGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBhcnIgPSB0aGlzLmlwLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXG4gICAgICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxuICAgICAgICAgICAgICAgIGlwOiBhcnJbMF0sXG4gICAgICAgICAgICAgICAgcG9ydDogYXJyWzFdLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeGhyID0gY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9pc19zZXJ2ZXJfb25saW5lXCIsIGRhdGEsIGZuKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhocikge1xuICAgICAgICAgICAgICAgICAgICB4aHIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm5SZXN1bHQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDE1MDApO1xuICAgICAgICB9XG4gICAgfSxcbn0pOyIsInZhciBOZXQgPSByZXF1aXJlKFwiTmV0XCIpXHJcbnZhciBHbG9iYWwgPSByZXF1aXJlKFwiR2xvYmFsXCIpXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBzZWxlY3RaSkg6IGNjLk5vZGUsXHJcbiAgICAgICAgc2VsZWN0TUo6IGNjLk5vZGUsXHJcbiAgICAgICAgc2VsZWN0RE46IGNjLk5vZGUsXHJcbiAgICAgICAgc2VsZWN0RFpQSzogY2MuTm9kZSxcclxuICAgICAgICBuaWNrbmFtZTogY2MuTGFiZWwsXHJcbiAgICAgICAgdXNlckdlbXM6IGNjLkxhYmVsLFxyXG4gICAgICAgIHVzZXJDb2luczogY2MuTGFiZWwsXHJcbiAgICAgICAgaGVhZEltZzogY2MuU3ByaXRlLFxyXG4gICAgICAgIF9sYXN0Q2hlY2tUaW1lOiAwLFxyXG4gICAgICAgIF9sYXN0UmVmcmVzaFRpbWU6IDAsXHJcbiAgICAgICAgbWpfb25saW5lOiBjYy5MYWJlbCxcclxuICAgICAgICB6amhfb25saW5lOiBjYy5MYWJlbCxcclxuICAgICAgICBkbl9vbmxpbmU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGR6cGtfb25saW5lOiBjYy5MYWJlbCxcclxuICAgICAgICBlZmZBbmltYXRpb246IGNjLk5vZGUsXHJcbiAgICAgICAgbGJsTm90aWNlOiBjYy5MYWJlbCxcclxuICAgICAgICBfYWN0aXZpdHk6IG51bGwsXHJcbiAgICAgICAgZ29uZ2dhbzogY2MuTm9kZSxcclxuICAgICAgICBzdGF0ZW1lbnQ6IG51bGwsXHJcbiAgICAgICAgc3RhdGVtZW50Q29udGVudDogY2MuUmljaFRleHQsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghY2MudnYpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwibG9naW5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdGF0ZW1lbnQgPSBjYy5maW5kKFwiQ2FudmFzL3N0YXRlbWVudFwiKTtcclxuICAgICAgICB0aGlzLl9hY3Rpdml0eSA9IGNjLmZpbmQoXCJDYW52YXMvYWN0aXZpdHlcIik7XHJcbiAgICAgICAgdGhpcy5fbWF0Y2ggPSBjYy5maW5kKFwiQ2FudmFzL21hdGNoXCIpO1xyXG4gICAgICAgIHRoaXMuamJzID0gdGhpcy5fbWF0Y2guZ2V0Q29tcG9uZW50KFwiSmJzXCIpO1xyXG4gICAgICAgIHZhciBpbWdMb2FkZXIgPSB0aGlzLmhlYWRJbWcubm9kZS5nZXRDb21wb25lbnQoXCJJbWFnZUxvYWRlclwiKTtcclxuICAgICAgICBpbWdMb2FkZXIuc2V0VXNlcklEKGNjLnZ2LnVzZXJNZ3IudXNlcklkKTtcclxuICAgICAgICB0aGlzLmppbmJpID0gY2MuZmluZChcIkNhbnZhcy9oZWFkZXIvamluYmkvZ2Vtc1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuZGlhbW9uZCA9IGNjLmZpbmQoXCJDYW52YXMvaGVhZGVyL3p1YW5zaGkvY29pbnNcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLmppbmJpQ2hhbmdlID0gY2MuZmluZChcIkNhbnZhcy9qaW5iaUNoYW5nZVwiKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKFwiQ2FudmFzL3Njcm9sbHZpZXcvdmlldy9jb250ZW50L3pqaGJ0blwiKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKFwiQ2FudmFzL3Njcm9sbHZpZXcvdmlldy9jb250ZW50L21qYnRuXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvc2Nyb2xsdmlldy92aWV3L2NvbnRlbnQvZG5idG5cIik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcihcIkNhbnZhcy9zY3JvbGx2aWV3L3ZpZXcvY29udGVudC9kenBrYnRuXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvZm9vdGVyL2V4Y2hhbmdlXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIoXCJDYW52YXMvaGVhZGVyL2ppbmJpL2ljb25BZGRcIik7XHJcbiAgICAgICAgdGhpcy5pbml0SmluYmlDaGFuZ2VIYW5kbGVyKCk7XHJcbiAgICAgICAgdGhpcy5pbml0TGFiZWxzKCk7XHJcbiAgICAgICAgdGhpcy5nZXRVc2VyT25saW5lKCk7XHJcbiAgICAgICAgdGhpcy5lZmZOb2RlID0gY2MuZmluZChcIkNhbnZhcy9lZmZcIik7XHJcbiAgICAgICAgLy8gdGhpcy5wbGF5QnRuRWZmKHRydWUpO1xyXG4gICAgICAgIGlmICghY2MudnYudXNlck1nci5ub3RpY2UpIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5ub3RpY2UgPSB7XHJcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgbXNnOiBcIuaVsOaNruivt+axguS4rS4uLlwiLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKCFjYy52di51c2VyTWdyLmdlbXN0aXApIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zdGlwID0ge1xyXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogbnVsbCxcclxuICAgICAgICAgICAgICAgIG1zZzogXCLmlbDmja7or7fmsYLkuK0uLi5cIixcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciByb29tSWQgPSBjYy52di51c2VyTWdyLm9sZFJvb21JZFxyXG4gICAgICAgIGlmIChyb29tSWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLm9sZFJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZW50ZXJSb29tKHJvb21JZCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmxibE5vdGljZS5zdHJpbmcgPSBjYy52di51c2VyTWdyLm5vdGljZS5tc2c7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoTm90aWNlKCk7XHJcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IucGxheUJHTShcImJnRmlnaHQubXAzXCIpO1xyXG4gICAgICAgIC8v5qih5Z2X55qE5Yqo5oCB5pi+56S6XHJcbiAgICAgICAgaWYgKGNjLnZ2LnVzZXJNZ3IubW9kdWxlcykge1xyXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IGNjLmZpbmQoXCJDYW52YXMvc2Nyb2xsdmlldy92aWV3L2NvbnRlbnRcIik7XHJcbiAgICAgICAgICAgIHZhciBkZWxfYXJyID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gY29udGVudC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gY29udGVudC5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgICAgIGlmIChjYy52di51c2VyTWdyLm1vZHVsZXMuaW5kZXhPZihwYXJzZUludChpKSkgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxfYXJyLnB1c2goY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZGVsX2Fycikge1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5yZW1vdmVDaGlsZChkZWxfYXJyW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgd2lkdGggPSBjb250ZW50LmNoaWxkcmVuWzBdLndpZHRoO1xyXG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gY29udGVudC5jaGlsZHJlbi5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBwZXIgPSAoMTI4MCAtIHdpZHRoICogbGVuZ3RoKSAvIChsZW5ndGggKyAxKTtcclxuICAgICAgICAgICAgcGVyID0gcGVyICsgMTIwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIGNvbnRlbnQuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IGNvbnRlbnQuY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICBjaGlsZC54ID0gcGVyICsgaSAqICh3aWR0aCAvIDIgKyBwZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvL+mUpuagh+i1m+aYr+WQpuW8gOaUvlxyXG4gICAgICAgIHRoaXMuaW5pdEpicygpO1xyXG4gICAgfSxcclxuICAgIGluaXRKYnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBidG4gPSBjYy5maW5kKFwiQ2FudmFzL3Njcm9sbHZpZXcvdmlldy9jb250ZW50L2pic2J0blwiKTtcclxuICAgICAgICBpZiAoY2MudnYudXNlck1nci5pc19vcGVuX2picykge1xyXG4gICAgICAgICAgICBidG4uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gYnRuLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gYnRuLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2hpbGRyZW5baV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyovLyDmkq3mlL7mjInpkq7nibnmlYhcclxuICAgIHBsYXlCdG5FZmY6IGZ1bmN0aW9uKGZsYWcpIHtcclxuICAgICAgICBpZiAoZmxhZykge1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkVmZiA9IHRoaXMuZWZmQW5pbWF0aW9uLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xyXG4gICAgICAgICAgICB2YXIgYW5pbVN0YXRlID0gdGhpcy5idG5FZmYucGxheSgnYW5uaXUnKTtcclxuICAgICAgICAgICAgYW5pbVN0YXRlLnNwZWVkID0gMC4yO1xyXG4gICAgICAgICAgICBhbmltU3RhdGUud3JhcE1vZGUgPSBjYy5XcmFwTW9kZS5Mb29wO1xyXG4gICAgICAgICAgICBhbmltU3RhdGUucmVwZWF0Q291bnQgPSBJbmZpbml0eTtcclxuICAgICAgICB9XHJcbiAgICB9LCovXHJcbiAgICByZWZyZXNoTm90aWNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9uR2V0ID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLm5vdGljZS52ZXJzaW9uID0gcmV0LnZlcnNpb247XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLm5vdGljZS5tc2cgPSByZXQubXNnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYmxOb3RpY2Uuc3RyaW5nID0gcmV0Lm1zZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICB0eXBlOiBcIm5vdGljZVwiLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBjYy52di51c2VyTWdyLm5vdGljZS52ZXJzaW9uXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9tZXNzYWdlXCIsIGRhdGEsIG9uR2V0LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuICAgIGluaXRMYWJlbHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubmlja25hbWUuc3RyaW5nID0gY2MudnYudXNlck1nci51c2VyTmFtZTtcclxuICAgICAgICB0aGlzLnVzZXJHZW1zLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShjYy52di51c2VyTWdyLmdlbXMpO1xyXG4gICAgICAgIHRoaXMudXNlckNvaW5zLnN0cmluZyA9IGNjLnZ2LnVzZXJNZ3IuY29pbnM7XHJcbiAgICB9LFxyXG4gICAgaW5pdEJ1dHRvbkhhbmRsZXI6IGZ1bmN0aW9uKGJ0blBhdGgpIHtcclxuICAgICAgICB2YXIgYnRuID0gY2MuZmluZChidG5QYXRoKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0biwgdGhpcy5ub2RlLCBcIk5ld0hhbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICB9LFxyXG4gICAgaW5pdEppbmJpQ2hhbmdlSGFuZGxlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLmppbmJpQ2hhbmdlLmdldENoaWxkQnlOYW1lKCd5ZXMnKSwgdGhpcy5ub2RlLCBcIk5ld0hhbGxcIiwgXCJvbkNoYW5nZUppbmJpXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5qaW5iaUNoYW5nZS5nZXRDaGlsZEJ5TmFtZSgnbm8nKSwgdGhpcy5ub2RlLCBcIk5ld0hhbGxcIiwgXCJvbkNoYW5nZUppbmJpXCIpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50LnRhcmdldC5uYW1lKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3pqaGJ0bic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFpKSC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RaSkguZ2V0Q29tcG9uZW50KFwiU2VsZWN0WmpoXCIpLmluaXRWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZXhjaGFuZ2UnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5qaW5iaUNoYW5nZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ21qYnRuJzpcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0TUouYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkbmJ0bic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEROLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEROLmdldENvbXBvbmVudChcIlNlbGVjdERuXCIpLmluaXRWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZHpwa2J0bic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERaUEsuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RFpQSy5nZXRDb21wb25lbnQoXCJTZWxlY3REenBrXCIpLmluaXRWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnYnRuX3NldHRpbmcnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwic2V0XCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJzZXRcIikuZ2V0Q29tcG9uZW50KFwiU2V0XCIpLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaG93QWN0aXZpdHk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2FjdGl2aXR5LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fYWN0aXZpdHkuZ2V0Q29tcG9uZW50KFwiQ29sbGFwc2VcIikucmVmcmVzaEJ0bnMoKTtcclxuICAgIH0sXHJcbiAgICBoaWRlQWN0aXZpdHk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2FjdGl2aXR5LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5YWR5o2i6YeR5biBXHJcbiAgICBvbkNoYW5nZUppbmJpOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQudGFyZ2V0Lm5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSAneWVzJzpcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcclxuICAgICAgICAgICAgICAgICAgICB1c2VyaWQ6IGNjLnZ2LnVzZXJNZ3IudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgICAgIG51bV9kaWFtb25kOiBjYy5maW5kKFwiQ2FudmFzL2ppbmJpQ2hhbmdlL2VkaXRib3hcIikuZ2V0Q29tcG9uZW50KGNjLkVkaXRCb3gpLnN0cmluZ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBvblllcyA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldC51c2VyaWQgPT0gY2MudnYudXNlck1nci51c2VySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQuamluYmkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuamluYmkuc3RyaW5nID0gY2MudnYudXRpbHMuc2hvd0ppbmJpKHJldC5qaW5iaSk7IC8v5Yi35paw6YeR5biB5pi+56S6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFtb25kLnN0cmluZyA9IHJldC5kaWFtb25kOyAvL+WIt+aWsOmSu+efs+aYvuekulxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCflhZHmjaLmiJDlip/vvIEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+aXoOmHkeW4geaVsOmHj+i/lOWbnu+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3VzZXJpZOS4jeWMuemFje+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+WFkeaNouWksei0pe+8gScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmppbmJpQ2hhbmdlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvY2hhbmdlSmluYmlcIiwgZGF0YSwgb25ZZXMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbm8nOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5qaW5iaUNoYW5nZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkFkZENvaW5zQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuY2hhcmdlVHlwZS5zaG93KCk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5BZGRHZW1zQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5qaW5iaUNoYW5nZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIHNob3dBbm5vdW5jZW1lbnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuZ29uZ2dhby5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZ29uZ2dhby5nZXRDb21wb25lbnQoXCJBbm5vdW5jZW1lbnRcIikuZ2V0QW5ub3VuY2VtZW50KCk7XHJcbiAgICB9LFxyXG4gICAgLy8g6I635b6X5pu05paw5raI5oGvXHJcbiAgICBnZXRSZWZyZXNoSW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmtojmga/mmK/nqbrnmoQnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocmV0LnVzZXJpZCA9PSBjYy52di51c2VyTWdyLnVzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5nZW1zICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLnVzZXJHZW1zLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaShyZXQuZ2Vtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zID0gcmV0LmdlbXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocmV0LmNvaW5zICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmNvaW5zID0gcmV0LmNvaW5zO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNlbGYudXNlckNvaW5zLnN0cmluZyA9IHJldC5jb2lucztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IucmVmcmVzaFRpbWUgPSAzMDAwMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fbGFzdFJlZnJlc2hUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL25lZWRfcmVmcmVzaFwiLCB7XHJcbiAgICAgICAgICAgIHVzZXJpZDogY2MudnYudXNlck1nci51c2VySWRcclxuICAgICAgICB9LCBmbik7XHJcbiAgICB9LFxyXG4gICAgZ2V0VXNlck9ubGluZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBzZWxmLm1qX29ubGluZS5zdHJpbmcgPSByZXRbJzAnXSArIFwi5Lq65Zyo57q/XCI7XHJcbiAgICAgICAgICAgIHNlbGYuempoX29ubGluZS5zdHJpbmcgPSByZXRbJzInXSArIFwi5Lq65Zyo57q/XCI7XHJcbiAgICAgICAgICAgIHNlbGYuZG5fb25saW5lLnN0cmluZyA9IHJldFsnMyddICsgXCLkurrlnKjnur9cIjtcclxuICAgICAgICAgICAgc2VsZi5kenBrX29ubGluZS5zdHJpbmcgPSByZXRbJzQnXSArIFwi5Lq65Zyo57q/XCI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9sYXN0Q2hlY2tUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF91c2VyX29ubGluZVwiLCBkYXRhLCBmbik7XHJcbiAgICB9LFxyXG4gICAgZXhjaGFuZ2VSb29tOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYudXNlck1nci5yb29tX3R5cGUgPT0gMikge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9ICd6amgnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2MudnYudXNlck1nci5yb29tX3R5cGUgPT0gMykge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9ICdkbic7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSAnZHpwaydcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvbmYgPSB7XHJcbiAgICAgICAgICAgIHJvb21fdHlwZTogY2MudnYudXNlck1nci5yb29tX3R5cGUsIC8vMuS7o+ihqOaJjumHkeiKseaIv+mXtFxyXG4gICAgICAgICAgICBzY2VuZTogY2MudnYudXNlck1nci5zY2VuZSxcclxuICAgICAgICAgICAgZ2VucmU6IDEsXHJcbiAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgICAgIGNvbmY6IEpTT04uc3RyaW5naWZ5KGNvbmYpLFxyXG4gICAgICAgICAgICBlX3Jvb21pZDogY2MudnYudXNlck1nci5lX3Jvb21pZCxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2LndjLnNob3coXCLlr7vmib7miL/pl7RcIik7XHJcbiAgICAgICAgdmFyIG9uU2VhcmNoID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKHJldC5lcnJjb2RlID09IDIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBpZiAocmV0LmVycm1zZyA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLpkrvnn7PkuI3lpJ/vvIzml6Dms5XljLnphY1cIik7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIumHkeW4geS4jeWkn++8jOaXoOazleWMuemFjVwiKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLliJvlu7rmiL/pl7TlpLHotKUs6ZSZ6K+v56CBOlwiICsgcmV0LmVycmNvZGUpO1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+mUmeivr+eggScsIHJldC5lcnJjb2RlKTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgcmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnJvb21fdHlwZSA9IGNvbmYucm9vbV90eXBlO1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5zY2VuZSA9IGNvbmYuc2NlbmU7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmVfcm9vbWlkID0gcmV0LnJvb21pZDtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY29ubmVjdEdhbWVTZXJ2ZXIocmV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9leGNoYW5nZV9yb29tXCIsIGRhdGEsIG9uU2VhcmNoKTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge1xyXG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5fbGFzdENoZWNrVGltZSA+IDEwMDAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VXNlck9ubGluZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLl9sYXN0UmVmcmVzaFRpbWUgPiBjYy52di51c2VyTWdyLnJlZnJlc2hUaW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0UmVmcmVzaEluZm8oKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciB4ID0gdGhpcy5sYmxOb3RpY2Uubm9kZS54O1xyXG4gICAgICAgIHggLT0gZHQgKiAxMDA7XHJcbiAgICAgICAgaWYgKHggKyB0aGlzLmxibE5vdGljZS5ub2RlLndpZHRoIDwgLTEwMDApIHtcclxuICAgICAgICAgICAgeCA9IDUwMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sYmxOb3RpY2Uubm9kZS54ID0geDtcclxuICAgICAgICBpZiAoY2MudnYgJiYgY2MudnYudXNlck1nci5yb29tRGF0YSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IucmVjb25uZWN0aW9uID0gMTtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5lbnRlclJvb20oY2MudnYudXNlck1nci5yb29tRGF0YSk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iucm9vbURhdGEgPSBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjeayoeacieaIv+mXtO+8jOS4lOWIhuS6q+i/h+adpeeahOaIv+mXtOWPt+S4jeaYr+epuueahOivne+8jOWPr+S7pei/m+WFpeaIv+mXtFxyXG4gICAgICAgICAgICBpZiAoY2MudnYgJiYgY2MudnYudXNlck1nci5zaGFyZVJvb21JZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnJvb21EYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHZhciByb29taWQgPSBjYy52di51c2VyTWdyLnNoYXJlUm9vbUlkO1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5zaGFyZVJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmVudGVyUm9vbShyb29taWQsIGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gXCLmiL/pl7RbXCIgKyByb29taWQgKyBcIl3kuI3lrZjlnKjvvIzor7fph43mlrDovpPlhaUhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSA9PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gXCLmiL/pl7RbXCIgKyByb29taWQgKyBcIl3lt7Lmu6EhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBjb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYy52diAmJiBjYy52di51c2VyTWdyLmV4Y2hhbmdlID09IDEpIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5leGNoYW5nZSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZXhjaGFuZ2VSb29tKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudXNlckdlbXMuc3RyaW5nID0gY2MudnYudXRpbHMuc2hvd0ppbmJpKGNjLnZ2LnVzZXJNZ3IuZ2Vtcyk7XHJcbiAgICAgICAgdGhpcy51c2VyQ29pbnMuc3RyaW5nID0gY2MudnYudXNlck1nci5jb2lucztcclxuICAgIH0sXHJcbiAgICBvbk9wZW5zdGF0ZW1lbnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvbkdldCA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZW1lbnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVtZW50Q29udGVudC5zdHJpbmcgPSByZXQubXNnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgICAgIHR5cGU6IFwic3RhdGVtZW50XCIsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9tZXNzYWdlXCIsIGRhdGEsIG9uR2V0LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuICAgIG9uQ2xvc2VzdGF0ZW1lbnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuc3RhdGVtZW50LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8vIG9uSkJTQnRuQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY29ubmVjdE1hdGNoU2VydmVyKCk7XHJcbiAgICAvLyB9LFxyXG4gICAgb25KQlNCdG5DbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzZW5kX2RhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICB1c2VyaWQ6IGNjLnZ2LnVzZXJNZ3IudXNlcklkLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfamJzX2RhdGFcIiwgc2VuZF9kYXRhLCBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgc2VsZi5qYnMuc2hvd01hdGNoTGlzdChyZXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2d1b2h1OiBudWxsLFxyXG4gICAgICAgIF9pbmZvOiBudWxsLFxyXG4gICAgICAgIF9ndW9odVRpbWU6IC0xLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9ndW9odSA9IGNjLmZpbmQoXCJDYW52YXMvdGlwX25vdGljZVwiKTtcclxuICAgICAgICB0aGlzLl9ndW9odS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9pbmZvID0gY2MuZmluZChcIkNhbnZhcy90aXBfbm90aWNlL2luZm9cIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdwdXNoX25vdGljZScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5fZ3VvaHUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZi5fZ3VvaHVUaW1lID0gZGF0YS50aW1lO1xyXG4gICAgICAgICAgICBzZWxmLl9pbmZvLnN0cmluZyA9IGRhdGEuaW5mbztcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9ndW9odVRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2d1b2h1VGltZSAtPSBkdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2d1b2h1VGltZSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2d1b2h1LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBidG4gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fYmFja1wiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0biwgdGhpcy5ub2RlLCBcIk9uQmFja1wiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2JhY2tcIikge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcbiAgICAvLyB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWNjLnZ2KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGdhbWVDaGlsZCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIik7XHJcbiAgICAgICAgdmFyIG15c2VsZiA9IGdhbWVDaGlsZC5nZXRDaGlsZEJ5TmFtZShcIm15c2VsZlwiKTtcclxuICAgICAgICB2YXIgcGVuZ2FuZ3Jvb3QgPSBteXNlbGYuZ2V0Q2hpbGRCeU5hbWUoXCJwZW5nZ2FuZ3NcIik7XHJcbiAgICAgICAgdmFyIHJlYWx3aWR0aCA9IGNjLmRpcmVjdG9yLmdldFZpc2libGVTaXplKCkud2lkdGg7XHJcbiAgICAgICAgdmFyIHNjYWxlID0gcmVhbHdpZHRoIC8gMTI4MDtcclxuICAgICAgICBwZW5nYW5ncm9vdC5zY2FsZVggKj0gc2NhbGU7XHJcbiAgICAgICAgcGVuZ2FuZ3Jvb3Quc2NhbGVZICo9IHNjYWxlO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3Blbmdfbm90aWZ5JywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+WIt+aWsOaJgOacieeahOeJjFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBlbmdfbm90aWZ5XCIsIGRhdGEuZGV0YWlsKTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5vblBlbmdHYW5nQ2hhbmdlZChkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2NoaV9ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5Yi35paw5omA5pyJ55qE54mMXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2hpX25vdGlmeS0tLS0tcGVuZ2dhbmdcIiwgZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLm9uUGVuZ0dhbmdDaGFuZ2VkKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FuZ19ub3RpZnknLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5Yi35paw5omA5pyJ55qE54mMXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLm9uUGVuZ0dhbmdDaGFuZ2VkKGRhdGEuc2VhdERhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9iZWdpbicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5vbkdhbWVCZWluKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHNlYXRzID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlYXRzKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25QZW5nR2FuZ0NoYW5nZWQoc2VhdHNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkdhbWVCZWluOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmhpZGVTaWRlKFwibXlzZWxmXCIpO1xyXG4gICAgICAgIHRoaXMuaGlkZVNpZGUoXCJyaWdodFwiKTtcclxuICAgICAgICB0aGlzLmhpZGVTaWRlKFwidXBcIik7XHJcbiAgICAgICAgdGhpcy5oaWRlU2lkZShcImxlZnRcIik7XHJcbiAgICB9LFxyXG4gICAgaGlkZVNpZGU6IGZ1bmN0aW9uKHNpZGUpIHtcclxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcclxuICAgICAgICB2YXIgbXlzZWxmID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKHNpZGUpO1xyXG4gICAgICAgIHZhciBwZW5nYW5ncm9vdCA9IG15c2VsZi5nZXRDaGlsZEJ5TmFtZShcInBlbmdnYW5nc1wiKTtcclxuICAgICAgICBpZiAocGVuZ2FuZ3Jvb3QpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwZW5nYW5ncm9vdC5jaGlsZHJlbkNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHBlbmdhbmdyb290LmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uUGVuZ0dhbmdDaGFuZ2VkOiBmdW5jdGlvbihzZWF0RGF0YSkge1xyXG4gICAgICAgIGlmIChzZWF0RGF0YS5hbmdhbmdzID09IG51bGwgJiYgc2VhdERhdGEuZGlhbmdhbmdzID09IG51bGwgJiYgc2VhdERhdGEud2FuZ2FuZ3MgPT0gbnVsbCAmJiBzZWF0RGF0YS5wZW5ncyA9PSBudWxsICYmIHNlYXREYXRhLmNoaXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4KHNlYXREYXRhLnNlYXRpbmRleCk7XHJcbiAgICAgICAgdmFyIHNpZGUgPSBjYy52di5tYWhqb25nbWdyLmdldFNpZGUobG9jYWxJbmRleCk7XHJcbiAgICAgICAgdmFyIHByZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0Rm9sZFByZShsb2NhbEluZGV4KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uUGVuZ0dhbmdDaGFuZ2VkXCIgKyBsb2NhbEluZGV4KTtcclxuICAgICAgICB2YXIgZ2FtZUNoaWxkID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2FtZVwiKTtcclxuICAgICAgICB2YXIgbXlzZWxmID0gZ2FtZUNoaWxkLmdldENoaWxkQnlOYW1lKHNpZGUpO1xyXG4gICAgICAgIHZhciBwZW5nYW5ncm9vdCA9IG15c2VsZi5nZXRDaGlsZEJ5TmFtZShcInBlbmdnYW5nc1wiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBlbmdhbmdyb290LmNoaWxkcmVuQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICBwZW5nYW5ncm9vdC5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/liJ3lp4vljJbmnaDniYxcclxuICAgICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICAgIHZhciBnYW5ncyA9IHNlYXREYXRhLmFuZ2FuZ3M7XHJcbiAgICAgICAgaWYgKGdhbmdzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2FuZ3MubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3NbaV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwiYW5nYW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZ2FuZ3MgPSBzZWF0RGF0YS5kaWFuZ2FuZ3M7XHJcbiAgICAgICAgaWYgKGdhbmdzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ2FuZ3MubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtamlkID0gZ2FuZ3NbaV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwiZGlhbmdhbmdcIik7XHJcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBnYW5ncyA9IHNlYXREYXRhLndhbmdhbmdzO1xyXG4gICAgICAgIGlmIChnYW5ncykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGdhbmdzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWppZCA9IGdhbmdzW2ldO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0UGVuZ0FuZEdhbmdzKHBlbmdhbmdyb290LCBzaWRlLCBwcmUsIGluZGV4LCBtamlkLCBcIndhbmdhbmdcIik7XHJcbiAgICAgICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5Yid5aeL5YyW56Kw54mMXHJcbiAgICAgICAgdmFyIHBlbmdzID0gc2VhdERhdGEucGVuZ3M7XHJcbiAgICAgICAgaWYgKHBlbmdzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGVuZ3MubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtamlkID0gcGVuZ3NbaV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRQZW5nQW5kR2FuZ3MocGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIFwicGVuZ1wiKTtcclxuICAgICAgICAgICAgICAgIGluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5ZCD55qE54mM5LiA5a6a6KaB5Lul5pWw57uE55qE5b2i5byP5a2Y5pS+LOexu+S8vFtbMSwyLDNdLFszLDQsNV1dO1xyXG4gICAgICAgIC8v5Yid5aeL5YyW5ZCD54mMXHJcbiAgICAgICAgdmFyIGNoaXMgPSBzZWF0RGF0YS5jaGlzXHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIuaYvuekuuWQg+eJjOaTjeS9nFwiLCBjaGlzKTtcclxuICAgICAgICBpZiAoY2hpcykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwi5ZCD55qEXCIsIGNoaXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWppZHMgPSBjaGlzW2ldO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0Q2hpcyhwZW5nYW5ncm9vdCwgc2lkZSwgcHJlLCBpbmRleCwgbWppZHMpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0UGVuZ0FuZEdhbmdzOiBmdW5jdGlvbihwZW5nYW5ncm9vdCwgc2lkZSwgcHJlLCBpbmRleCwgbWppZCwgZmxhZykge1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbyhcImluaXRQZW5nQW5kR2FuZ3NcIiwgcGVuZ2FuZ3Jvb3QsIHNpZGUsIHByZSwgaW5kZXgsIG1qaWQsIGZsYWcpO1xyXG4gICAgICAgIHZhciBwZ3Jvb3QgPSBudWxsO1xyXG4gICAgICAgIGlmIChwZW5nYW5ncm9vdC5jaGlsZHJlbkNvdW50IDw9IGluZGV4KSB7XHJcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwibGVmdFwiIHx8IHNpZGUgPT0gXCJyaWdodFwiKSB7XHJcbiAgICAgICAgICAgICAgICBwZ3Jvb3QgPSBjYy5pbnN0YW50aWF0ZShjYy52di5tYWhqb25nbWdyLnBlbmdQcmVmYWJMZWZ0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBncm9vdCA9IGNjLmluc3RhbnRpYXRlKGNjLnZ2Lm1haGpvbmdtZ3IucGVuZ1ByZWZhYlNlbGYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBlbmdhbmdyb290LmFkZENoaWxkKHBncm9vdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGdyb290ID0gcGVuZ2FuZ3Jvb3QuY2hpbGRyZW5baW5kZXhdO1xyXG4gICAgICAgICAgICBwZ3Jvb3QuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNpZGUgPT0gXCJsZWZ0XCIpIHtcclxuICAgICAgICAgICAgcGdyb290LnkgPSAtKGluZGV4ICogMjUgKiAzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJyaWdodFwiKSB7XHJcbiAgICAgICAgICAgIHBncm9vdC55ID0gKGluZGV4ICogMjUgKiAzKTtcclxuICAgICAgICAgICAgcGdyb290LnNldExvY2FsWk9yZGVyKC1pbmRleCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzaWRlID09IFwibXlzZWxmXCIpIHtcclxuICAgICAgICAgICAgcGdyb290LnggPSBpbmRleCAqIDU1ICogMyArIGluZGV4ICogMTA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGdyb290LnggPSAtKGluZGV4ICogNTUgKiAzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNwcml0ZXMgPSBwZ3Jvb3QuZ2V0Q29tcG9uZW50c0luQ2hpbGRyZW4oY2MuU3ByaXRlKTtcclxuICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IHNwcml0ZXMubGVuZ3RoOyArK3MpIHtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHNwcml0ZXNbc107XHJcbiAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5uYW1lID09IFwiZ2FuZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNHYW5nID0gZmxhZyAhPSBcInBlbmdcIjtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLmFjdGl2ZSA9IGlzR2FuZztcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWCA9IDEuMDtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWSA9IDEuMDtcclxuICAgICAgICAgICAgICAgIGlmIChmbGFnID09IFwiYW5nYW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldEVtcHR5U3ByaXRlRnJhbWUoc2lkZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpZGUgPT0gXCJteXNlbGZcIiB8fCBzaWRlID09IFwidXBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5zY2FsZVggPSAxLjQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwcml0ZS5ub2RlLnNjYWxlWSA9IDEuNDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBtamlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGNjLnZ2Lm1haGpvbmdtZ3IuZ2V0U3ByaXRlRnJhbWVCeU1KSUQocHJlLCBtamlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyDlkIPniYxcclxuICAgIGluaXRDaGlzOiBmdW5jdGlvbihwZW5nYW5ncm9vdCwgc2lkZSwgcHJlLCBpbmRleCwgbWppZHMpIHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKFwiaW5pdENoaXNcIiwgbWppZHMpO1xyXG4gICAgICAgIHZhciBwZ3Jvb3QgPSBudWxsO1xyXG4gICAgICAgIGlmIChwZW5nYW5ncm9vdC5jaGlsZHJlbkNvdW50IDw9IGluZGV4KSB7XHJcbiAgICAgICAgICAgIGlmIChzaWRlID09IFwibGVmdFwiIHx8IHNpZGUgPT0gXCJyaWdodFwiKSB7XHJcbiAgICAgICAgICAgICAgICBwZ3Jvb3QgPSBjYy5pbnN0YW50aWF0ZShjYy52di5tYWhqb25nbWdyLnBlbmdQcmVmYWJMZWZ0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBncm9vdCA9IGNjLmluc3RhbnRpYXRlKGNjLnZ2Lm1haGpvbmdtZ3IucGVuZ1ByZWZhYlNlbGYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBlbmdhbmdyb290LmFkZENoaWxkKHBncm9vdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGdyb290ID0gcGVuZ2FuZ3Jvb3QuY2hpbGRyZW5baW5kZXhdO1xyXG4gICAgICAgICAgICBwZ3Jvb3QuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNpZGUgPT0gXCJsZWZ0XCIpIHtcclxuICAgICAgICAgICAgcGdyb290LnkgPSAtKGluZGV4ICogMjUgKiAzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNpZGUgPT0gXCJyaWdodFwiKSB7XHJcbiAgICAgICAgICAgIHBncm9vdC55ID0gKGluZGV4ICogMjUgKiAzKTtcclxuICAgICAgICAgICAgcGdyb290LnNldExvY2FsWk9yZGVyKC1pbmRleCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzaWRlID09IFwibXlzZWxmXCIpIHtcclxuICAgICAgICAgICAgcGdyb290LnggPSBpbmRleCAqIDU1ICogMyArIGluZGV4ICogMTA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGdyb290LnggPSAtKGluZGV4ICogNTUgKiAzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNwcml0ZXMgPSBwZ3Jvb3QuZ2V0Q29tcG9uZW50c0luQ2hpbGRyZW4oY2MuU3ByaXRlKTtcclxuICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IHNwcml0ZXMubGVuZ3RoOyArK3MpIHtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZSA9IHNwcml0ZXNbc107XHJcbiAgICAgICAgICAgIGlmIChzcHJpdGUubm9kZS5uYW1lID09IFwiZ2FuZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBjYy52di5tYWhqb25nbWdyLmdldFNwcml0ZUZyYW1lQnlNSklEKHByZSwgbWppZHNbc10pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuICAgIC8vIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX3BvcHVwcm9vdDogbnVsbCxcclxuICAgICAgICBfc2V0dGluZ3M6IG51bGwsXHJcbiAgICAgICAgX2Rpc3NvbHZlTm90aWNlOiBudWxsLFxyXG4gICAgICAgIF9lbmRUaW1lOiAtMSxcclxuICAgICAgICBfZXh0cmFJbmZvOiBudWxsLFxyXG4gICAgICAgIF9ub3RpY2VMYWJlbDogbnVsbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy52di5wb3B1cE1nciA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fcG9wdXByb290ID0gY2MuZmluZChcIkNhbnZhcy9wb3B1cHNcIik7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSBjYy5maW5kKFwiQ2FudmFzL3BvcHVwcy9zZXR0aW5nc1wiKTtcclxuICAgICAgICB0aGlzLl9kaXNzb2x2ZU5vdGljZSA9IGNjLmZpbmQoXCJDYW52YXMvcG9wdXBzL2Rpc3NvbHZlX25vdGljZVwiKTtcclxuICAgICAgICB0aGlzLl9ub3RpY2VMYWJlbCA9IHRoaXMuX2Rpc3NvbHZlTm90aWNlLmdldENoaWxkQnlOYW1lKFwiaW5mb1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuY2xvc2VBbGwoKTtcclxuICAgICAgICB0aGlzLmFkZEJ0bkhhbmRsZXIoXCJzZXR0aW5ncy9idG5fY2xvc2VcIik7XHJcbiAgICAgICAgdGhpcy5hZGRCdG5IYW5kbGVyKFwic2V0dGluZ3MvYnRuX3NxanNmalwiKTtcclxuICAgICAgICB0aGlzLmFkZEJ0bkhhbmRsZXIoXCJkaXNzb2x2ZV9ub3RpY2UvYnRuX2FncmVlXCIpO1xyXG4gICAgICAgIHRoaXMuYWRkQnRuSGFuZGxlcihcImRpc3NvbHZlX25vdGljZS9idG5fcmVqZWN0XCIpO1xyXG4gICAgICAgIHRoaXMuYWRkQnRuSGFuZGxlcihcImRpc3NvbHZlX25vdGljZS9idG5fb2tcIik7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihcImRpc3NvbHZlX25vdGljZVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGV2ZW50LmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5zaG93RGlzc29sdmVOb3RpY2UoZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKFwiZGlzc29sdmVfY2FuY2VsXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNlbGYuY2xvc2VBbGwoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3IuZGlzc292ZURhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93RGlzc29sdmVOb3RpY2UoY2MudnYuZ2FtZU5ldE1nci5kaXNzb3ZlRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGFkZEJ0bkhhbmRsZXI6IGZ1bmN0aW9uKGJ0bk5hbWUpIHtcclxuICAgICAgICB2YXIgYnRuID0gY2MuZmluZChcIkNhbnZhcy9wb3B1cHMvXCIgKyBidG5OYW1lKTtcclxuICAgICAgICB0aGlzLmFkZENsaWNrRXZlbnQoYnRuLCB0aGlzLm5vZGUsIFwiUG9wdXBNZ3JcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICB9LFxyXG4gICAgYWRkQ2xpY2tFdmVudDogZnVuY3Rpb24obm9kZSwgdGFyZ2V0LCBjb21wb25lbnQsIGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgZXZlbnRIYW5kbGVyID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcclxuICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBoYW5kbGVyO1xyXG4gICAgICAgIHZhciBjbGlja0V2ZW50cyA9IG5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHM7XHJcbiAgICAgICAgY2xpY2tFdmVudHMucHVzaChldmVudEhhbmRsZXIpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlQWxsKCk7XHJcbiAgICAgICAgdmFyIGJ0bk5hbWUgPSBldmVudC50YXJnZXQubmFtZTtcclxuICAgICAgICBpZiAoYnRuTmFtZSA9PSBcImJ0bl9hZ3JlZVwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZGlzc29sdmVfYWdyZWVcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChidG5OYW1lID09IFwiYnRuX3JlamVjdFwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZGlzc29sdmVfcmVqZWN0XCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYnRuTmFtZSA9PSBcImJ0bl9zcWpzZmpcIikge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImRpc3NvbHZlX3JlcXVlc3RcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChidG5OYW1lID09IFwiYnRuX29rXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjbG9zZUFsbDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXByb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2Rpc3NvbHZlTm90aWNlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHNob3dTZXR0aW5nczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwcm9vdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgc2hvd0Rpc3NvbHZlUmVxdWVzdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwcm9vdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIHNob3dEaXNzb2x2ZU5vdGljZTogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX2VuZFRpbWUgPSBEYXRlLm5vdygpIC8gMTAwMCArIGRhdGEudGltZTtcclxuICAgICAgICB0aGlzLl9leHRyYUluZm8gPSBcIlwiO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5zdGF0ZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBkYXRhLnN0YXRlc1tpXTtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzW2ldLm5hbWU7XHJcbiAgICAgICAgICAgIGlmIChiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9leHRyYUluZm8gKz0gXCJcXG5b5bey5ZCM5oSPXSBcIiArIG5hbWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9leHRyYUluZm8gKz0gXCJcXG5b5b6F56Gu6K6kXSBcIiArIG5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jbG9zZUFsbCgpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwcm9vdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2Rpc3NvbHZlTm90aWNlLmFjdGl2ZSA9IHRydWU7O1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2VuZFRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBsYXN0VGltZSA9IHRoaXMuX2VuZFRpbWUgLSBEYXRlLm5vdygpIC8gMTAwMDtcclxuICAgICAgICAgICAgaWYgKGxhc3RUaW1lIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZW5kVGltZSA9IC0xO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtID0gTWF0aC5mbG9vcihsYXN0VGltZSAvIDYwKTtcclxuICAgICAgICAgICAgdmFyIHMgPSBNYXRoLmNlaWwobGFzdFRpbWUgLSBtICogNjApO1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gXCJcIjtcclxuICAgICAgICAgICAgaWYgKG0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzdHIgKz0gbSArIFwi5YiGXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbm90aWNlTGFiZWwuc3RyaW5nID0gc3RyICsgcyArIFwi56eS5ZCO5oi/6Ze05bCG6Ieq5Yqo6Kej5pWjXCIgKyB0aGlzLl9leHRyYUluZm87XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHRhcmdldDogY2MuTm9kZSxcclxuICAgICAgICBzcHJpdGU6IGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIGNoZWNrZWRTcHJpdGU6IGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIGNoZWNrZWQ6IGZhbHNlLFxyXG4gICAgICAgIGdyb3VwSWQ6IC0xLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYy52di5yYWRpb2dyb3VwbWdyID09IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIFJhZGlvR3JvdXBNZ3IgPSByZXF1aXJlKFwiUmFkaW9Hcm91cE1nclwiKTtcclxuICAgICAgICAgICAgY2MudnYucmFkaW9ncm91cG1nciA9IG5ldyBSYWRpb0dyb3VwTWdyKCk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnJhZGlvZ3JvdXBtZ3IuaW5pdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyh0eXBlb2YoY2MudnYucmFkaW9ncm91cG1nci5hZGQpKTtcclxuICAgICAgICBjYy52di5yYWRpb2dyb3VwbWdyLmFkZCh0aGlzKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgIH0sXHJcbiAgICByZWZyZXNoOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0U3ByaXRlID0gdGhpcy50YXJnZXQuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0YXJnZXRTcHJpdGUuc3ByaXRlRnJhbWUgPSB0aGlzLmNoZWNrZWRTcHJpdGU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0U3ByaXRlLnNwcml0ZUZyYW1lID0gdGhpcy5zcHJpdGU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNoZWNrOiBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tlZCA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfSxcclxuICAgIG9uQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYucmFkaW9ncm91cG1nci5jaGVjayh0aGlzKTtcclxuICAgIH0sXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diAmJiBjYy52di5yYWRpb2dyb3VwbWdyKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnJhZGlvZ3JvdXBtZ3IuZGVsKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIF9ncm91cHM6IG51bGxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2dyb3VwcyA9IHt9O1xyXG4gICAgfSxcclxuICAgIGFkZDogZnVuY3Rpb24ocmFkaW9CdXR0b24pIHtcclxuICAgICAgICB2YXIgZ3JvdXBJZCA9IHJhZGlvQnV0dG9uLmdyb3VwSWQ7XHJcbiAgICAgICAgdmFyIGJ1dHRvbnMgPSB0aGlzLl9ncm91cHNbZ3JvdXBJZF07XHJcbiAgICAgICAgaWYgKGJ1dHRvbnMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBidXR0b25zID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuX2dyb3Vwc1tncm91cElkXSA9IGJ1dHRvbnM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJ1dHRvbnMucHVzaChyYWRpb0J1dHRvbik7XHJcbiAgICB9LFxyXG4gICAgZGVsOiBmdW5jdGlvbihyYWRpb0J1dHRvbikge1xyXG4gICAgICAgIHZhciBncm91cElkID0gcmFkaW9CdXR0b24uZ3JvdXBJZDtcclxuICAgICAgICB2YXIgYnV0dG9ucyA9IHRoaXMuX2dyb3Vwc1tncm91cElkXTtcclxuICAgICAgICBpZiAoYnV0dG9ucyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkeCA9IGJ1dHRvbnMuaW5kZXhPZihyYWRpb0J1dHRvbik7XHJcbiAgICAgICAgaWYgKGlkeCAhPSAtMSkge1xyXG4gICAgICAgICAgICBidXR0b25zLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYnV0dG9ucy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fZ3JvdXBzW2dyb3VwSWRdXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNoZWNrOiBmdW5jdGlvbihyYWRpb0J1dHRvbikge1xyXG4gICAgICAgIHZhciBncm91cElkID0gcmFkaW9CdXR0b24uZ3JvdXBJZDtcclxuICAgICAgICB2YXIgYnV0dG9ucyA9IHRoaXMuX2dyb3Vwc1tncm91cElkXTtcclxuICAgICAgICBpZiAoYnV0dG9ucyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidXR0b25zLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhciBidG4gPSBidXR0b25zW2ldO1xyXG4gICAgICAgICAgICBpZiAoYnRuID09IHJhZGlvQnV0dG9uKSB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2hlY2sodHJ1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBidG4uY2hlY2soZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBfcmVjb25uZWN0OiBudWxsLFxyXG4gICAgICAgIF9sYmxUaXA6IG51bGwsXHJcbiAgICAgICAgX2xhc3RQaW5nOiAwLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9yZWNvbm5lY3QgPSBjYy5maW5kKFwiQ2FudmFzL3JlY29ubmVjdFwiKTtcclxuICAgICAgICB0aGlzLl9sYmxUaXAgPSBjYy5maW5kKFwiQ2FudmFzL3JlY29ubmVjdC90aXBcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGZuVGVzdFNlcnZlck9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC50ZXN0KGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbmV3aGFsbCcpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuVGVzdFNlcnZlck9uLCAzMDAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5ub2RlLm9mZignZGlzY29ubmVjdCcsIGZuKTtcclxuICAgICAgICAgICAgc2VsZi5fcmVjb25uZWN0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGZuVGVzdFNlcnZlck9uKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2Rpc2Nvbm5lY3QnLCBmbik7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdsb2FkSGFsbCcsIGZ1bmN0aW9uKHJldCl7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbmV3aGFsbCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdC5hY3RpdmUpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSAlIDQ7XHJcbiAgICAgICAgICAgIHRoaXMuX2xibFRpcC5zdHJpbmcgPSBcIuS4juacjeWKoeWZqOaWreW8gOi/nuaOpe+8jOato+WcqOWwneivlemHjei/nlwiO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGJsVGlwLnN0cmluZyArPSAnLic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIF9uZXh0UGxheVRpbWU6IDEsXHJcbiAgICAgICAgX3JlcGxheTogbnVsbCxcclxuICAgICAgICBfaXNQbGF5aW5nOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3JlcGxheSA9IGNjLmZpbmQoXCJDYW52YXMvcmVwbGF5XCIpO1xyXG4gICAgICAgIHRoaXMuX3JlcGxheS5hY3RpdmUgPSBjYy52di5yZXBsYXlNZ3IuaXNSZXBsYXkoKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0blBhdXNlQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgb25CdG5QbGF5Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkJhY2tDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5yZXBsYXlNZ3IuY2xlYXIoKTtcclxuICAgICAgICBjYy52di5nYW1lTmV0TWdyLnJlc2V0KCk7XHJcbiAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5yb29tSWQgPSBudWxsO1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld2hhbGxcIik7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgICAgICBpZiAoY2MudnYpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzUGxheWluZyAmJiBjYy52di5yZXBsYXlNZ3IuaXNSZXBsYXkoKSA9PSB0cnVlICYmIHRoaXMuX25leHRQbGF5VGltZSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25leHRQbGF5VGltZSAtPSBkdDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9uZXh0UGxheVRpbWUgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmV4dFBsYXlUaW1lID0gY2MudnYucmVwbGF5TWdyLnRha2VBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyIsInZhciBBQ1RJT05fQ0hVUEFJID0gMTtcclxudmFyIEFDVElPTl9NT1BBSSA9IDI7XHJcbnZhciBBQ1RJT05fUEVORyA9IDM7XHJcbnZhciBBQ1RJT05fR0FORyA9IDQ7XHJcbnZhciBBQ1RJT05fSFUgPSA1O1xyXG52YXIgQUNUSU9OX0NISSA9IDc7XHJcbnZhciBBQ1RJT05fQ0FJU0hFTiA9IDg7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2xhc3RBY3Rpb246IG51bGwsXHJcbiAgICAgICAgX2FjdGlvblJlY29yZHM6IG51bGwsXHJcbiAgICAgICAgX2N1cnJlbnRJbmRleDogMCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7fSxcclxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9sYXN0QWN0aW9uID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9hY3Rpb25SZWNvcmRzID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9jdXJyZW50SW5kZXggPSAwO1xyXG4gICAgfSxcclxuICAgIGluaXQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9hY3Rpb25SZWNvcmRzID0gZGF0YS5hY3Rpb25fcmVjb3JkcztcclxuICAgICAgICBpZiAodGhpcy5fYWN0aW9uUmVjb3JkcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvblJlY29yZHMgPSB7fTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fY3VycmVudEluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLl9sYXN0QWN0aW9uID0gbnVsbDtcclxuICAgIH0sXHJcbiAgICBpc1JlcGxheTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvblJlY29yZHMgIT0gbnVsbDtcclxuICAgIH0sXHJcbiAgICBnZXROZXh0QWN0aW9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fY3VycmVudEluZGV4ID49IHRoaXMuX2FjdGlvblJlY29yZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2kgPSB0aGlzLl9hY3Rpb25SZWNvcmRzW3RoaXMuX2N1cnJlbnRJbmRleCsrXTtcclxuICAgICAgICB2YXIgYWN0aW9uID0gdGhpcy5fYWN0aW9uUmVjb3Jkc1t0aGlzLl9jdXJyZW50SW5kZXgrK107XHJcbiAgICAgICAgdmFyIHBhaSA9IHRoaXMuX2FjdGlvblJlY29yZHNbdGhpcy5fY3VycmVudEluZGV4KytdO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNpOiBzaSxcclxuICAgICAgICAgICAgdHlwZTogYWN0aW9uLFxyXG4gICAgICAgICAgICBwYWk6IHBhaVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG4gICAgdGFrZUFjdGlvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGFjdGlvbiA9IHRoaXMuZ2V0TmV4dEFjdGlvbigpO1xyXG4gICAgICAgIGlmICh0aGlzLl9sYXN0QWN0aW9uICE9IG51bGwgJiYgdGhpcy5fbGFzdEFjdGlvbi50eXBlID09IEFDVElPTl9DSFVQQUkpIHtcclxuICAgICAgICAgICAgaWYgKGFjdGlvbiAhPSBudWxsICYmIGFjdGlvbi50eXBlICE9IEFDVElPTl9QRU5HICYmIGFjdGlvbi50eXBlICE9IEFDVElPTl9HQU5HICYmIGFjdGlvbi50eXBlICE9IEFDVElPTl9IVSkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5kb0d1byh0aGlzLl9sYXN0QWN0aW9uLnNpLCB0aGlzLl9sYXN0QWN0aW9uLnBhaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbGFzdEFjdGlvbiA9IGFjdGlvbjtcclxuICAgICAgICBpZiAoYWN0aW9uID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmV4dEFjdGlvbkRlbGF5ID0gMS4wO1xyXG4gICAgICAgIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fQ0hVUEFJKSB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJjaHVwYWlcIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9DaHVwYWkoYWN0aW9uLnNpLCBhY3Rpb24ucGFpKTtcclxuICAgICAgICAgICAgcmV0dXJuIDEuMDtcclxuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi50eXBlID09IEFDVElPTl9NT1BBSSkge1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibW9wYWlcIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9Nb3BhaShhY3Rpb24uc2ksIGFjdGlvbi5wYWkpO1xyXG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvVHVybkNoYW5nZShhY3Rpb24uc2kpO1xyXG4gICAgICAgICAgICByZXR1cm4gMC41O1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLnR5cGUgPT0gQUNUSU9OX1BFTkcpIHtcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInBlbmdcIik7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9QZW5nKGFjdGlvbi5zaSwgYWN0aW9uLnBhaSk7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9UdXJuQ2hhbmdlKGFjdGlvbi5zaSk7XHJcbiAgICAgICAgICAgIHJldHVybiAxLjA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fR0FORykge1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiZ2FuZ1wiKTtcclxuICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5kaXNwYXRjaEV2ZW50KCdoYW5nYW5nX25vdGlmeScsIGFjdGlvbi5zaSk7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9HYW5nKGFjdGlvbi5zaSwgYWN0aW9uLnBhaSk7XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9UdXJuQ2hhbmdlKGFjdGlvbi5zaSk7XHJcbiAgICAgICAgICAgIHJldHVybiAxLjA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fSFUpIHtcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImh1XCIpO1xyXG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvSHUoe1xyXG4gICAgICAgICAgICAgICAgc2VhdGluZGV4OiBhY3Rpb24uc2ksXHJcbiAgICAgICAgICAgICAgICBodXBhaTogYWN0aW9uLnBhaSxcclxuICAgICAgICAgICAgICAgIGlzemltbzogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiAxLjU7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fQ0hJKSB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJjaGlcIik7XHJcbiAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICAvLyB2YXIgcGQgPSB7XHJcbiAgICAgICAgICAgIC8vICAgICBcInBhaVwiOiBwYWksXHJcbiAgICAgICAgICAgIC8vICAgICBcImNoaUFycmF5XCI6IGNoaUFycmF5XHJcbiAgICAgICAgICAgIC8vIH07XHJcbiAgICAgICAgICAgIHZhciBwYWkgPSBhY3Rpb24ucGFpW1wicGFpXCJdO1xyXG4gICAgICAgICAgICB2YXIgY2hpQXJyID0gYWN0aW9uLnBhaVtcImNoaUFycmF5XCJdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaUFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaUFycltpXSA9PSBwYWkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlBcnIuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuZG9DaGkoYWN0aW9uLnNpLCBwYWksIGNoaUFycik7XHJcbiAgICAgICAgICAgIHJldHVybiAxLjU7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24udHlwZSA9PSBBQ1RJT05fQ0FJU0hFTikge1xyXG4gICAgICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRvQ2FpU2hlbihhY3Rpb24uc2ksIGFjdGlvbi5wYWkpO1xyXG4gICAgICAgICAgICByZXR1cm4gMS41O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIF9zcHJJY29uOiBudWxsLFxyXG4gICAgICAgIF96aHVhbmc6IG51bGwsXHJcbiAgICAgICAgX3JlYWR5OiBudWxsLFxyXG4gICAgICAgIF9vZmZsaW5lOiBudWxsLFxyXG4gICAgICAgIF9sYmxOYW1lOiBudWxsLFxyXG4gICAgICAgIF9sYmxTY29yZTogbnVsbCxcclxuICAgICAgICBfc2NvcmVCZzogbnVsbCxcclxuICAgICAgICBfbmRkYXlpbmdqaWE6IG51bGwsXHJcbiAgICAgICAgX3ZvaWNlbXNnOiBudWxsLFxyXG4gICAgICAgIF9jaGF0QnViYmxlOiBudWxsLFxyXG4gICAgICAgIF9lbW9qaTogbnVsbCxcclxuICAgICAgICBfbGFzdENoYXRUaW1lOiAtMSxcclxuICAgICAgICBfdXNlck5hbWU6IFwiXCIsXHJcbiAgICAgICAgX3Njb3JlOiAwLFxyXG4gICAgICAgIF9kYXlpbmdqaWE6IGZhbHNlLFxyXG4gICAgICAgIF9pc09mZmxpbmU6IGZhbHNlLFxyXG4gICAgICAgIF9pc1JlYWR5OiBmYWxzZSxcclxuICAgICAgICBfaXNaaHVhbmc6IGZhbHNlLFxyXG4gICAgICAgIF91c2VySWQ6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc3BySWNvbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImljb25cIikuZ2V0Q29tcG9uZW50KFwiSW1hZ2VMb2FkZXJcIik7XHJcbiAgICAgICAgdGhpcy5fbGJsTmFtZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIm5hbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl9sYmxTY29yZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInNjb3JlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fdm9pY2Vtc2cgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ2b2ljZW1zZ1wiKTtcclxuICAgICAgICBpZiAodGhpcy5fdm9pY2Vtc2cpIHtcclxuICAgICAgICAgICAgdGhpcy5fdm9pY2Vtc2cuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9zcHJJY29uICYmIHRoaXMuX3Nwckljb24uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikpIHtcclxuICAgICAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9zcHJJY29uLCB0aGlzLm5vZGUsIFwiU2VhdFwiLCBcIm9uSWNvbkNsaWNrZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX29mZmxpbmUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJvZmZsaW5lXCIpO1xyXG4gICAgICAgIHRoaXMuX3JlYWR5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicmVhZHlcIik7XHJcbiAgICAgICAgdGhpcy5femh1YW5nID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiemh1YW5nXCIpO1xyXG4gICAgICAgIHRoaXMuX3Njb3JlQmcgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJaX21vbmV5X2ZyYW1lXCIpO1xyXG4gICAgICAgIHRoaXMuX25kZGF5aW5namlhID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZGF5aW5namlhXCIpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJDaGF0QnViYmxlXCIpO1xyXG4gICAgICAgIGlmICh0aGlzLl9jaGF0QnViYmxlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZW1vamkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJlbW9qaVwiKTtcclxuICAgICAgICBpZiAodGhpcy5fZW1vamkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24gJiYgdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nwckljb24uc2V0VXNlcklEKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uSWNvbkNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBpY29uU3ByaXRlID0gdGhpcy5fc3BySWNvbi5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGlmICh0aGlzLl91c2VySWQgIT0gbnVsbCAmJiB0aGlzLl91c2VySWQgPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0QnlJRCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB2YXIgc2V4ID0gMDtcclxuICAgICAgICAgICAgaWYgKGNjLnZ2LmJhc2VJbmZvTWFwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IGNjLnZ2LmJhc2VJbmZvTWFwW3RoaXMuX3VzZXJJZF07XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNleCA9IGluZm8uc2V4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9sYmxOYW1lICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsTmFtZS5zdHJpbmcgPSB0aGlzLl91c2VyTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUuc3RyaW5nID0gdGhpcy5fc2NvcmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9uZGRheWluZ2ppYSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25kZGF5aW5namlhLmFjdGl2ZSA9IHRoaXMuX2RheWluZ2ppYSA9PSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fb2ZmbGluZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9vZmZsaW5lLmFjdGl2ZSA9IHRoaXMuX2lzT2ZmbGluZSAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiAoY2MudnYuZ2FtZU5ldE1nci5udW1PZkdhbWVzID4gMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl96aHVhbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5femh1YW5nLmFjdGl2ZSA9IHRoaXMuX2lzWmh1YW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdGhpcy5fdXNlck5hbWUgIT0gbnVsbCAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xyXG4gICAgfSxcclxuICAgIHNldEluZm8obmFtZSwgc2NvcmUsIGRheWluZ2ppYSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9zY29yZSA9IHNjb3JlO1xyXG4gICAgICAgIGlmICh0aGlzLl9zY29yZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Njb3JlID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZGF5aW5namlhID0gZGF5aW5namlhO1xyXG4gICAgICAgIGlmICh0aGlzLl9zY29yZUJnICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2NvcmVCZy5hY3RpdmUgPSB0aGlzLl9zY29yZSAhPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fbGJsU2NvcmUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9sYmxTY29yZS5ub2RlLmFjdGl2ZSA9IHRoaXMuX3Njb3JlICE9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfSxcclxuICAgIHNldFpodWFuZzogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9pc1podWFuZyA9IHZhbHVlO1xyXG4gICAgICAgIGlmICh0aGlzLl96aHVhbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5femh1YW5nLmFjdGl2ZSA9IHZhbHVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLl96aHVhbmcgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6aHVhbmdcIik7XHJcbiAgICAgICAgICAgIHRoaXMuX3podWFuZy5hY3RpdmUgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0UmVhZHk6IGZ1bmN0aW9uKGlzUmVhZHkpIHtcclxuICAgICAgICB0aGlzLl9pc1JlYWR5ID0gaXNSZWFkeTtcclxuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiAoY2MudnYuZ2FtZU5ldE1nci5udW1PZkdhbWVzID4gMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldElEOiBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgIHZhciBpZE5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJpZFwiKTtcclxuICAgICAgICBpZiAoaWROb2RlKSB7XHJcbiAgICAgICAgICAgIHZhciBsYmwgPSBpZE5vZGUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICAgICAgbGJsLnN0cmluZyA9IFwiSUQ6XCIgKyBpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gaWQ7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fc3BySWNvbi5zZXRVc2VySUQoaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRPZmZsaW5lOiBmdW5jdGlvbihpc09mZmxpbmUpIHtcclxuICAgICAgICB0aGlzLl9pc09mZmxpbmUgPSBpc09mZmxpbmU7XHJcbiAgICAgICAgaWYgKHRoaXMuX29mZmxpbmUpIHtcclxuICAgICAgICAgICAgdGhpcy5fb2ZmbGluZS5hY3RpdmUgPSB0aGlzLl9pc09mZmxpbmUgJiYgdGhpcy5fdXNlck5hbWUgIT0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2hhdDogZnVuY3Rpb24oY29udGVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9jaGF0QnViYmxlID09IG51bGwgfHwgdGhpcy5fZW1vamkgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2Vtb2ppLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY29udGVudDtcclxuICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmdldENoaWxkQnlOYW1lKFwiTmV3IExhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY29udGVudDtcclxuICAgICAgICB0aGlzLl9sYXN0Q2hhdFRpbWUgPSAzO1xyXG4gICAgfSxcclxuICAgIGVtb2ppOiBmdW5jdGlvbihlbW9qaSkge1xyXG4gICAgICAgIC8vZW1vamkgPSBKU09OLnBhcnNlKGVtb2ppKTtcclxuICAgICAgICBpZiAodGhpcy5fZW1vamkgPT0gbnVsbCB8fCB0aGlzLl9lbW9qaSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coZW1vamkpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9lbW9qaS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKS5wbGF5KGVtb2ppKTtcclxuICAgICAgICB0aGlzLl9sYXN0Q2hhdFRpbWUgPSAzO1xyXG4gICAgfSxcclxuICAgIHZvaWNlTXNnOiBmdW5jdGlvbihzaG93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3ZvaWNlbXNnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZvaWNlbXNnLmFjdGl2ZSA9IHNob3c7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RDaGF0VGltZSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdENoYXRUaW1lIC09IGR0O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbGFzdENoYXRUaW1lIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Vtb2ppLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZW1vamkuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbikuc3RvcCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHBtOiBjYy5Ob2RlLFxyXG4gICAgICAgIHh6OiBjYy5Ob2RlLFxyXG4gICAgICAgIGxiOiBjYy5Ob2RlLFxyXG4gICAgICAgIHRoOiBjYy5Ob2RlLFxyXG4gICAgICAgIGd6OiBjYy5Ob2RlLFxyXG4gICAgICAgIGhqOiBjYy5Ob2RlLFxyXG4gICAgICAgIC8vIHBtbGFibGUxOiBjYy5MYWJlbCxcclxuICAgICAgICAvLyBwbWxhYmxlMjogY2MuTGFiZWwsXHJcbiAgICAgICAgcG1sYWJsZTM6IGNjLkxhYmVsLFxyXG4gICAgICAgIHBtbGFibGU0OiBjYy5MYWJlbCxcclxuICAgICAgICAvLyB4emxhYmxlMTogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8geHpsYWJsZTI6IGNjLkxhYmVsLFxyXG4gICAgICAgIHh6bGFibGUzOiBjYy5MYWJlbCxcclxuICAgICAgICB4emxhYmxlNDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gbGJsYWJsZTE6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGxibGFibGUyOiBjYy5MYWJlbCxcclxuICAgICAgICBsYmxhYmxlMzogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJsYWJsZTQ6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIHRobGFibGUxOiBjYy5MYWJlbCxcclxuICAgICAgICAvLyB0aGxhYmxlMjogY2MuTGFiZWwsXHJcbiAgICAgICAgdGhsYWJsZTM6IGNjLkxhYmVsLFxyXG4gICAgICAgIHRobGFibGU0OiBjYy5MYWJlbCxcclxuICAgICAgICAvLyBnemxhYmxlMTogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gZ3psYWJsZTI6IGNjLkxhYmVsLFxyXG4gICAgICAgIGd6bGFibGUzOiBjYy5MYWJlbCxcclxuICAgICAgICBnemxhYmxlNDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gaGpsYWJsZTE6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGhqbGFibGUyOiBjYy5MYWJlbCxcclxuICAgICAgICBoamxhYmxlMzogY2MuTGFiZWwsXHJcbiAgICAgICAgaGpsYWJsZTQ6IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMucG0pO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy54eik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLmxiKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMudGgpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5neik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLmhqKTtcclxuICAgIH0sXHJcbiAgICBpbml0VmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbS5zY2VuZSA9IHJldFtpXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5wbWxhYmxlMS5zdHJpbmcgPSByZXRbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5wbWxhYmxlMi5zdHJpbmcgPSByZXRbaV0uY29uc3VtZV90eXBlID8gKFwi6ZK755+zXCIgKyByZXRbaV0uY29uc3VtZV9udW0pIDogKFwi6YeR5biBXCIgKyByZXRbaV0uY29uc3VtZV9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBtbGFibGUzLnN0cmluZyA9IHJldFtpXS5vbmxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucG1sYWJsZTQuc3RyaW5nID0gXCLov5vmiL/kuIvpmZBcIiArIChyZXRbaV0ubGltaXRfdHlwZSA/IHJldFtpXS5saW1pdF9udW0gOiByZXRbaV0ubGltaXRfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnh6LnNjZW5lID0gcmV0W2ldLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLnh6bGFibGUxLnN0cmluZyA9IHJldFtpXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLnh6bGFibGUyLnN0cmluZyA9IHJldFtpXS5jb25zdW1lX3R5cGUgPyAoXCLpkrvnn7NcIiArIHJldFtpXS5jb25zdW1lX251bSkgOiAoXCLph5HluIFcIiArIHJldFtpXS5jb25zdW1lX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYueHpsYWJsZTMuc3RyaW5nID0gcmV0W2ldLm9ubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi54emxhYmxlNC5zdHJpbmcgPSBcIui/m+aIv+S4i+mZkFwiICsgKHJldFtpXS5saW1pdF90eXBlID8gcmV0W2ldLmxpbWl0X251bSA6IHJldFtpXS5saW1pdF9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGIuc2NlbmUgPSByZXRbaV0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYubGJsYWJsZTEuc3RyaW5nID0gcmV0W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYubGJsYWJsZTIuc3RyaW5nID0gcmV0W2ldLmNvbnN1bWVfdHlwZSA/IChcIumSu+efs1wiICsgcmV0W2ldLmNvbnN1bWVfbnVtKSA6IChcIumHkeW4gVwiICsgcmV0W2ldLmNvbnN1bWVfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sYmxhYmxlMy5zdHJpbmcgPSByZXRbaV0ub25saW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxibGFibGU0LnN0cmluZyA9IFwi6L+b5oi/5LiL6ZmQXCIgKyAocmV0W2ldLmxpbWl0X3R5cGUgPyByZXRbaV0ubGltaXRfbnVtIDogcmV0W2ldLmxpbWl0X251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50aC5zY2VuZSA9IHJldFtpXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi50aGxhYmxlMS5zdHJpbmcgPSByZXRbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi50aGxhYmxlMi5zdHJpbmcgPSByZXRbaV0uY29uc3VtZV90eXBlID8gKFwi6ZK755+zXCIgKyByZXRbaV0uY29uc3VtZV9udW0pIDogKFwi6YeR5biBXCIgKyByZXRbaV0uY29uc3VtZV9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRobGFibGUzLnN0cmluZyA9IHJldFtpXS5vbmxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudGhsYWJsZTQuc3RyaW5nID0gXCLov5vmiL/kuIvpmZBcIiArIChyZXRbaV0ubGltaXRfdHlwZSA/IHJldFtpXS5saW1pdF9udW0gOiByZXRbaV0ubGltaXRfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gNCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmd6LnNjZW5lID0gcmV0W2ldLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmd6bGFibGUxLnN0cmluZyA9IHJldFtpXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmd6bGFibGUyLnN0cmluZyA9IHJldFtpXS5jb25zdW1lX3R5cGUgPyAoXCLpkrvnn7NcIiArIHJldFtpXS5jb25zdW1lX251bSkgOiAoXCLph5HluIFcIiArIHJldFtpXS5jb25zdW1lX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ3psYWJsZTMuc3RyaW5nID0gcmV0W2ldLm9ubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5nemxhYmxlNC5zdHJpbmcgPSBcIui/m+aIv+S4i+mZkFwiICsgKHJldFtpXS5saW1pdF90eXBlID8gcmV0W2ldLmxpbWl0X251bSA6IHJldFtpXS5saW1pdF9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PSA1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGouc2NlbmUgPSByZXRbaV0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYuaGpsYWJsZTEuc3RyaW5nID0gcmV0W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYuaGpsYWJsZTIuc3RyaW5nID0gcmV0W2ldLmNvbnN1bWVfdHlwZSA/IChcIumSu+efs1wiICsgcmV0W2ldLmNvbnN1bWVfbnVtKSA6IChcIumHkeW4gVwiICsgcmV0W2ldLmNvbnN1bWVfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oamxhYmxlMy5zdHJpbmcgPSByZXRbaV0ub25saW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhqbGFibGU0LnN0cmluZyA9IFwi6L+b5oi/5LiL6ZmQXCIgKyAocmV0W2ldLmxpbWl0X3R5cGUgPyByZXRbaV0ubGltaXRfbnVtIDogcmV0W2ldLmxpbWl0X251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICByb29tX3R5cGU6IDMsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9zY2VuZVwiLCBkYXRhLCBmbik7XHJcbiAgICB9LFxyXG4gICAgb25CdG5CYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgaW5pdEJ1dHRvbkhhbmRsZXI6IGZ1bmN0aW9uKGJ0bikge1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuLCB0aGlzLm5vZGUsIFwiU2VsZWN0RG5cIiwgXCJtYXRjaFJvb21cIik7XHJcbiAgICB9LFxyXG4gICAgbWF0Y2hSb29tOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIHZhciBjb25mID0ge1xyXG4gICAgICAgICAgICByb29tX3R5cGU6IDMsIC8vM+S7o+ihqOaWl+eJm+aIv+mXtFxyXG4gICAgICAgICAgICBzY2VuZTogZXZlbnQudGFyZ2V0LnNjZW5lLFxyXG4gICAgICAgICAgICBnZW5yZTogMSxcclxuICAgICAgICAgICAgdHlwZTogJ2RuJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICBjb25mOiBKU09OLnN0cmluZ2lmeShjb25mKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuWvu+aJvuaIv+mXtFwiKTtcclxuICAgICAgICB2YXIgb25TZWFyY2ggPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di53Yy5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKHJldC5lcnJjb2RlID09IDIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBpZiAocmV0LmVycmNvZGUgPT0gLTMpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuaCqOW3suWKoOWFpeaIv+mXtO+8jOaXoOazleWMuemFjVwiKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5Yib5bu65oi/6Ze05aSx6LSlLOmUmeivr+eggTpcIiArIHJldC5lcnJjb2RlKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6ZSZ6K+v56CBJywgcmV0LmVycmNvZGUpO1xyXG4gICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCByZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iucm9vbV90eXBlID0gY29uZi5yb29tX3R5cGU7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnNjZW5lID0gY29uZi5zY2VuZTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZV9yb29taWQgPSByZXQucm9vbWlkO1xyXG4gICAgICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jb25uZWN0R2FtZVNlcnZlcihyZXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL21hdGNoX3Jvb21cIiwgZGF0YSwgb25TZWFyY2gpO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHBtOiBjYy5Ob2RlLFxyXG4gICAgICAgIHh6OiBjYy5Ob2RlLFxyXG4gICAgICAgIGxiOiBjYy5Ob2RlLFxyXG4gICAgICAgIHRoOiBjYy5Ob2RlLFxyXG4gICAgICAgIGd6OiBjYy5Ob2RlLFxyXG4gICAgICAgIGhqOiBjYy5Ob2RlLFxyXG4gICAgICAgIC8vIHBtbGFibGUxOiBjYy5MYWJlbCxcclxuICAgICAgICAvLyBwbWxhYmxlMjogY2MuTGFiZWwsXHJcbiAgICAgICAgcG1sYWJsZTM6IGNjLkxhYmVsLFxyXG4gICAgICAgIHBtbGFibGU0OiBjYy5MYWJlbCxcclxuICAgICAgICAvLyB4emxhYmxlMTogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8geHpsYWJsZTI6IGNjLkxhYmVsLFxyXG4gICAgICAgIHh6bGFibGUzOiBjYy5MYWJlbCxcclxuICAgICAgICB4emxhYmxlNDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gbGJsYWJsZTE6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGxibGFibGUyOiBjYy5MYWJlbCxcclxuICAgICAgICBsYmxhYmxlMzogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJsYWJsZTQ6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIHRobGFibGUxOiBjYy5MYWJlbCxcclxuICAgICAgICAvLyB0aGxhYmxlMjogY2MuTGFiZWwsXHJcbiAgICAgICAgdGhsYWJsZTM6IGNjLkxhYmVsLFxyXG4gICAgICAgIHRobGFibGU0OiBjYy5MYWJlbCxcclxuICAgICAgICAvLyBnemxhYmxlMTogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gZ3psYWJsZTI6IGNjLkxhYmVsLFxyXG4gICAgICAgIGd6bGFibGUzOiBjYy5MYWJlbCxcclxuICAgICAgICBnemxhYmxlNDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gaGpsYWJsZTE6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGhqbGFibGUyOiBjYy5MYWJlbCxcclxuICAgICAgICBoamxhYmxlMzogY2MuTGFiZWwsXHJcbiAgICAgICAgaGpsYWJsZTQ6IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMucG0pO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy54eik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLmxiKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMudGgpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5neik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLmhqKTtcclxuICAgIH0sXHJcbiAgICBpbml0VmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbS5zY2VuZSA9IHJldFtpXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5wbWxhYmxlMS5zdHJpbmcgPSByZXRbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5wbWxhYmxlMi5zdHJpbmcgPSByZXRbaV0uY29uc3VtZV90eXBlID8gKFwi6ZK755+zXCIgKyByZXRbaV0uY29uc3VtZV9udW0pIDogKFwi6YeR5biBXCIgKyByZXRbaV0uY29uc3VtZV9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBtbGFibGUzLnN0cmluZyA9IHJldFtpXS5vbmxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucG1sYWJsZTQuc3RyaW5nID0gXCLov5vmiL/kuIvpmZBcIiArIChyZXRbaV0ubGltaXRfdHlwZSA/IHJldFtpXS5saW1pdF9udW0gOiByZXRbaV0ubGltaXRfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnh6LnNjZW5lID0gcmV0W2ldLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLnh6bGFibGUxLnN0cmluZyA9IHJldFtpXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLnh6bGFibGUyLnN0cmluZyA9IHJldFtpXS5jb25zdW1lX3R5cGUgPyAoXCLpkrvnn7NcIiArIHJldFtpXS5jb25zdW1lX251bSkgOiAoXCLph5HluIFcIiArIHJldFtpXS5jb25zdW1lX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYueHpsYWJsZTMuc3RyaW5nID0gcmV0W2ldLm9ubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi54emxhYmxlNC5zdHJpbmcgPSBcIui/m+aIv+S4i+mZkFwiICsgKHJldFtpXS5saW1pdF90eXBlID8gcmV0W2ldLmxpbWl0X251bSA6IHJldFtpXS5saW1pdF9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGIuc2NlbmUgPSByZXRbaV0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYubGJsYWJsZTEuc3RyaW5nID0gcmV0W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYubGJsYWJsZTIuc3RyaW5nID0gcmV0W2ldLmNvbnN1bWVfdHlwZSA/IChcIumSu+efs1wiICsgcmV0W2ldLmNvbnN1bWVfbnVtKSA6IChcIumHkeW4gVwiICsgcmV0W2ldLmNvbnN1bWVfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sYmxhYmxlMy5zdHJpbmcgPSByZXRbaV0ub25saW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxibGFibGU0LnN0cmluZyA9IFwi6L+b5oi/5LiL6ZmQXCIgKyAocmV0W2ldLmxpbWl0X3R5cGUgPyByZXRbaV0ubGltaXRfbnVtIDogcmV0W2ldLmxpbWl0X251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50aC5zY2VuZSA9IHJldFtpXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi50aGxhYmxlMS5zdHJpbmcgPSByZXRbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi50aGxhYmxlMi5zdHJpbmcgPSByZXRbaV0uY29uc3VtZV90eXBlID8gKFwi6ZK755+zXCIgKyByZXRbaV0uY29uc3VtZV9udW0pIDogKFwi6YeR5biBXCIgKyByZXRbaV0uY29uc3VtZV9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRobGFibGUzLnN0cmluZyA9IHJldFtpXS5vbmxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudGhsYWJsZTQuc3RyaW5nID0gXCLov5vmiL/kuIvpmZBcIiArIChyZXRbaV0ubGltaXRfdHlwZSA/IHJldFtpXS5saW1pdF9udW0gOiByZXRbaV0ubGltaXRfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gNCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmd6LnNjZW5lID0gcmV0W2ldLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmd6bGFibGUxLnN0cmluZyA9IHJldFtpXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmd6bGFibGUyLnN0cmluZyA9IHJldFtpXS5jb25zdW1lX3R5cGUgPyAoXCLpkrvnn7NcIiArIHJldFtpXS5jb25zdW1lX251bSkgOiAoXCLph5HluIFcIiArIHJldFtpXS5jb25zdW1lX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ3psYWJsZTMuc3RyaW5nID0gcmV0W2ldLm9ubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5nemxhYmxlNC5zdHJpbmcgPSBcIui/m+aIv+S4i+mZkFwiICsgKHJldFtpXS5saW1pdF90eXBlID8gcmV0W2ldLmxpbWl0X251bSA6IHJldFtpXS5saW1pdF9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PSA1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGouc2NlbmUgPSByZXRbaV0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYuaGpsYWJsZTEuc3RyaW5nID0gcmV0W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYuaGpsYWJsZTIuc3RyaW5nID0gcmV0W2ldLmNvbnN1bWVfdHlwZSA/IChcIumSu+efs1wiICsgcmV0W2ldLmNvbnN1bWVfbnVtKSA6IChcIumHkeW4gVwiICsgcmV0W2ldLmNvbnN1bWVfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oamxhYmxlMy5zdHJpbmcgPSByZXRbaV0ub25saW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhqbGFibGU0LnN0cmluZyA9IFwi6L+b5oi/5LiL6ZmQXCIgKyAocmV0W2ldLmxpbWl0X3R5cGUgPyByZXRbaV0ubGltaXRfbnVtIDogcmV0W2ldLmxpbWl0X251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICByb29tX3R5cGU6IDQsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9zY2VuZVwiLCBkYXRhLCBmbik7XHJcbiAgICB9LFxyXG4gICAgb25CdG5CYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgaW5pdEJ1dHRvbkhhbmRsZXI6IGZ1bmN0aW9uKGJ0bikge1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoYnRuLCB0aGlzLm5vZGUsIFwiU2VsZWN0RHpwa1wiLCBcIm1hdGNoUm9vbVwiKTtcclxuICAgIH0sXHJcbiAgICBtYXRjaFJvb206IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGNvbmYgPSB7XHJcbiAgICAgICAgICAgIHJvb21fdHlwZTogNCwgLy805Luj6KGo5b635bee5omR5YWL5oi/6Ze0XHJcbiAgICAgICAgICAgIHNjZW5lOiBldmVudC50YXJnZXQuc2NlbmUsXHJcbiAgICAgICAgICAgIGdlbnJlOiAxLFxyXG4gICAgICAgICAgICB0eXBlOiAnZHpwaydcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcclxuICAgICAgICAgICAgY29uZjogSlNPTi5zdHJpbmdpZnkoY29uZilcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2LndjLnNob3coXCLlr7vmib7miL/pl7RcIik7XHJcbiAgICAgICAgdmFyIG9uU2VhcmNoID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYud2MuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgICAgIC8vIGlmIChyZXQuZXJyY29kZSA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHJldC5lcnJtc2cgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIumSu+efs+S4jeWkn++8jOaXoOazleWMuemFjVwiKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi6YeR5biB5LiN5aSf77yM5peg5rOV5Yy56YWNXCIpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgaWYgKHJldC5lcnJjb2RlID09IC0zKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLmgqjlt7LliqDlhaXmiL/pl7TvvIzml6Dms5XljLnphY1cIik7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuWIm+W7uuaIv+mXtOWksei0pSzplJnor6/noIE6XCIgKyByZXQuZXJyY29kZSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+mUmeivr+eggScsIHJldC5lcnJjb2RlKTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgcmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnJvb21fdHlwZSA9IGNvbmYucm9vbV90eXBlO1xyXG4gICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5zY2VuZSA9IGNvbmYuc2NlbmU7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmVfcm9vbWlkID0gcmV0LnJvb21pZDtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY29ubmVjdEdhbWVTZXJ2ZXIocmV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9tYXRjaF9yb29tXCIsIGRhdGEsIG9uU2VhcmNoKTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuICAgIC8vIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBidG1qOiBjYy5Ob2RlLFxyXG4gICAgICAgIHdobWo6IGNjLk5vZGUsXHJcbiAgICAgICAganJmajogY2MuTm9kZSxcclxuICAgICAgICBmaGZqOiBjYy5Ob2RlLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuYnRtaik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLndobWopO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5qcmZqKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuZmhmaik7XHJcbiAgICAgICAgaWYgKGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuanJmai5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5maGZqLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5qcmZqLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuZmhmai5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaW5pdFZpZXc6IGZ1bmN0aW9uKCkge30sXHJcbiAgICBvbkJ0bkJhY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBpbml0QnV0dG9uSGFuZGxlcjogZnVuY3Rpb24oYnRuKSB7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChidG4sIHRoaXMubm9kZSwgXCJTZWxlY3RNalwiLCBcIm9uQ2xpY2tCdG5cIik7XHJcbiAgICB9LFxyXG4gICAgb25DbGlja0J0bjogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50LnRhcmdldC5uYW1lKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ21qX2pvaW4nOlxyXG4gICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9Kb2luR2FtZVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ21qX2JhY2snOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5vblJldHVybkdhbWVDbGlja2VkKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnYmFvdG91JzpcclxuICAgICAgICAgICAgICAgIGlmIChjYy52di5nYW1lTmV0TWdyLnJvb21JZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25SZXR1cm5HYW1lQ2xpY2tlZCgpO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9DcmVhdGVSb29tXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnd3VoYW4nOlxyXG4gICAgICAgICAgICAgICAgLy8gY2MuZmluZChcIkNhbnZhcy9Kb2luR2FtZVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uUmV0dXJuR2FtZUNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm1qZ2FtZVwiKTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuICAgIC8vIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBwbTogY2MuTm9kZSxcclxuICAgICAgICB4ejogY2MuTm9kZSxcclxuICAgICAgICBsYjogY2MuTm9kZSxcclxuICAgICAgICB0aDogY2MuTm9kZSxcclxuICAgICAgICBnejogY2MuTm9kZSxcclxuICAgICAgICBoajogY2MuTm9kZSxcclxuICAgICAgICAvLyBwbWxhYmxlMTogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gcG1sYWJsZTI6IGNjLkxhYmVsLFxyXG4gICAgICAgIHBtbGFibGUzOiBjYy5MYWJlbCxcclxuICAgICAgICBwbWxhYmxlNDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8geHpsYWJsZTE6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIHh6bGFibGUyOiBjYy5MYWJlbCxcclxuICAgICAgICB4emxhYmxlMzogY2MuTGFiZWwsXHJcbiAgICAgICAgeHpsYWJsZTQ6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGxibGFibGUxOiBjYy5MYWJlbCxcclxuICAgICAgICAvLyBsYmxhYmxlMjogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJsYWJsZTM6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxibGFibGU0OiBjYy5MYWJlbCxcclxuICAgICAgICAvLyB0aGxhYmxlMTogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gdGhsYWJsZTI6IGNjLkxhYmVsLFxyXG4gICAgICAgIHRobGFibGUzOiBjYy5MYWJlbCxcclxuICAgICAgICB0aGxhYmxlNDogY2MuTGFiZWwsXHJcbiAgICAgICAgLy8gZ3psYWJsZTE6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGd6bGFibGUyOiBjYy5MYWJlbCxcclxuICAgICAgICBnemxhYmxlMzogY2MuTGFiZWwsXHJcbiAgICAgICAgZ3psYWJsZTQ6IGNjLkxhYmVsLFxyXG4gICAgICAgIC8vIGhqbGFibGUxOiBjYy5MYWJlbCxcclxuICAgICAgICAvLyBoamxhYmxlMjogY2MuTGFiZWwsXHJcbiAgICAgICAgaGpsYWJsZTM6IGNjLkxhYmVsLFxyXG4gICAgICAgIGhqbGFibGU0OiBjYy5MYWJlbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLnBtKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMueHopO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5sYik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLnRoKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuZ3opO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5oaik7XHJcbiAgICB9LFxyXG4gICAgaW5pdFZpZXc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucG0uc2NlbmUgPSByZXRbaV0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYucG1sYWJsZTEuc3RyaW5nID0gcmV0W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYucG1sYWJsZTIuc3RyaW5nID0gcmV0W2ldLmNvbnN1bWVfdHlwZSA/IChcIumSu+efs1wiICsgcmV0W2ldLmNvbnN1bWVfbnVtKSA6IChcIumHkeW4gVwiICsgcmV0W2ldLmNvbnN1bWVfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wbWxhYmxlMy5zdHJpbmcgPSByZXRbaV0ub25saW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBtbGFibGU0LnN0cmluZyA9IFwi6L+b5oi/5LiL6ZmQXCIgKyAocmV0W2ldLmxpbWl0X3R5cGUgPyByZXRbaV0ubGltaXRfbnVtIDogcmV0W2ldLmxpbWl0X251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi54ei5zY2VuZSA9IHJldFtpXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi54emxhYmxlMS5zdHJpbmcgPSByZXRbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi54emxhYmxlMi5zdHJpbmcgPSByZXRbaV0uY29uc3VtZV90eXBlID8gKFwi6ZK755+zXCIgKyByZXRbaV0uY29uc3VtZV9udW0pIDogKFwi6YeR5biBXCIgKyByZXRbaV0uY29uc3VtZV9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnh6bGFibGUzLnN0cmluZyA9IHJldFtpXS5vbmxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYueHpsYWJsZTQuc3RyaW5nID0gXCLov5vmiL/kuIvpmZBcIiArIChyZXRbaV0ubGltaXRfdHlwZSA/IHJldFtpXS5saW1pdF9udW0gOiByZXRbaV0ubGltaXRfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxiLnNjZW5lID0gcmV0W2ldLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmxibGFibGUxLnN0cmluZyA9IHJldFtpXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmxibGFibGUyLnN0cmluZyA9IHJldFtpXS5jb25zdW1lX3R5cGUgPyAoXCLpkrvnn7NcIiArIHJldFtpXS5jb25zdW1lX251bSkgOiAoXCLph5HluIFcIiArIHJldFtpXS5jb25zdW1lX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGJsYWJsZTMuc3RyaW5nID0gcmV0W2ldLm9ubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sYmxhYmxlNC5zdHJpbmcgPSBcIui/m+aIv+S4i+mZkFwiICsgKHJldFtpXS5saW1pdF90eXBlID8gcmV0W2ldLmxpbWl0X251bSA6IHJldFtpXS5saW1pdF9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PSAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudGguc2NlbmUgPSByZXRbaV0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYudGhsYWJsZTEuc3RyaW5nID0gcmV0W2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGYudGhsYWJsZTIuc3RyaW5nID0gcmV0W2ldLmNvbnN1bWVfdHlwZSA/IChcIumSu+efs1wiICsgcmV0W2ldLmNvbnN1bWVfbnVtKSA6IChcIumHkeW4gVwiICsgcmV0W2ldLmNvbnN1bWVfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50aGxhYmxlMy5zdHJpbmcgPSByZXRbaV0ub25saW5lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRobGFibGU0LnN0cmluZyA9IFwi6L+b5oi/5LiL6ZmQXCIgKyAocmV0W2ldLmxpbWl0X3R5cGUgPyByZXRbaV0ubGltaXRfbnVtIDogcmV0W2ldLmxpbWl0X251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09IDQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5nei5zY2VuZSA9IHJldFtpXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5nemxhYmxlMS5zdHJpbmcgPSByZXRbaV0ubmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5nemxhYmxlMi5zdHJpbmcgPSByZXRbaV0uY29uc3VtZV90eXBlID8gKFwi6ZK755+zXCIgKyByZXRbaV0uY29uc3VtZV9udW0pIDogKFwi6YeR5biBXCIgKyByZXRbaV0uY29uc3VtZV9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmd6bGFibGUzLnN0cmluZyA9IHJldFtpXS5vbmxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ3psYWJsZTQuc3RyaW5nID0gXCLov5vmiL/kuIvpmZBcIiArIChyZXRbaV0ubGltaXRfdHlwZSA/IHJldFtpXS5saW1pdF9udW0gOiByZXRbaV0ubGltaXRfbnVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gNSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhqLnNjZW5lID0gcmV0W2ldLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmhqbGFibGUxLnN0cmluZyA9IHJldFtpXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLmhqbGFibGUyLnN0cmluZyA9IHJldFtpXS5jb25zdW1lX3R5cGUgPyAoXCLpkrvnn7NcIiArIHJldFtpXS5jb25zdW1lX251bSkgOiAoXCLph5HluIFcIiArIHJldFtpXS5jb25zdW1lX251bSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGpsYWJsZTMuc3RyaW5nID0gcmV0W2ldLm9ubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oamxhYmxlNC5zdHJpbmcgPSBcIui/m+aIv+S4i+mZkFwiICsgKHJldFtpXS5saW1pdF90eXBlID8gcmV0W2ldLmxpbWl0X251bSA6IHJldFtpXS5saW1pdF9udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcclxuICAgICAgICAgICAgcm9vbV90eXBlOiAyLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfc2NlbmVcIiwgZGF0YSwgZm4pO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQmFjazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIGluaXRCdXR0b25IYW5kbGVyOiBmdW5jdGlvbihidG4pIHtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGJ0biwgdGhpcy5ub2RlLCBcIlNlbGVjdFpqaFwiLCBcIm1hdGNoUm9vbVwiKTtcclxuICAgIH0sXHJcbiAgICBtYXRjaFJvb206IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdmFyIGNvbmYgPSB7XHJcbiAgICAgICAgICAgIHJvb21fdHlwZTogMiwgLy8y5Luj6KGo5omO6YeR6Iqx5oi/6Ze0XHJcbiAgICAgICAgICAgIHNjZW5lOiBldmVudC50YXJnZXQuc2NlbmUsXHJcbiAgICAgICAgICAgIGdlbnJlOiAxLFxyXG4gICAgICAgICAgICB0eXBlOiAnempoJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICBjb25mOiBKU09OLnN0cmluZ2lmeShjb25mKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuWvu+aJvuaIv+mXtFwiKTtcclxuICAgICAgICB2YXIgb25TZWFyY2ggPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di53Yy5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKHJldC5lcnJjb2RlID09IDIpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBpZiAocmV0LmVycm1zZyA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi6ZK755+z5LiN5aSf77yM5peg5rOV5Yy56YWNXCIpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLph5HluIHkuI3lpJ/vvIzml6Dms5XljLnphY1cIik7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBpZiAocmV0LmVycmNvZGUgPT0gLTMpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIuaCqOW3suWKoOWFpeaIv+mXtO+8jOaXoOazleWMuemFjVwiKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5o+Q56S6XCIsIFwi5Yib5bu65oi/6Ze05aSx6LSlLOmUmeivr+eggTpcIiArIHJldC5lcnJjb2RlKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6ZSZ6K+v56CBJywgcmV0LmVycmNvZGUpO1xyXG4gICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCByZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iucm9vbV90eXBlID0gY29uZi5yb29tX3R5cGU7XHJcbiAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnNjZW5lID0gY29uZi5zY2VuZTtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZV9yb29taWQgPSByZXQucm9vbWlkO1xyXG4gICAgICAgICAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5jb25uZWN0R2FtZVNlcnZlcihyZXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL21hdGNoX3Jvb21cIiwgZGF0YSwgb25TZWFyY2gpO1xyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2J0bllYT3BlbjogbnVsbCxcclxuICAgICAgICBfYnRuWVhDbG9zZTogbnVsbCxcclxuICAgICAgICBfYnRuWVlPcGVuOiBudWxsLFxyXG4gICAgICAgIF9idG5ZWUNsb3NlOiBudWxsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2J0bllYT3BlbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInlpbnhpYW9cIikuZ2V0Q2hpbGRCeU5hbWUoXCJidG5feXhfb3BlblwiKTtcclxuICAgICAgICB0aGlzLl9idG5ZWENsb3NlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueGlhb1wiKS5nZXRDaGlsZEJ5TmFtZShcImJ0bl95eF9jbG9zZVwiKTtcclxuICAgICAgICB0aGlzLl9idG5ZWU9wZW4gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW55dWVcIikuZ2V0Q2hpbGRCeU5hbWUoXCJidG5feXlfb3BlblwiKTtcclxuICAgICAgICB0aGlzLl9idG5ZWUNsb3NlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueXVlXCIpLmdldENoaWxkQnlOYW1lKFwiYnRuX3l5X2Nsb3NlXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdEJ1dHRvbkhhbmRsZXIodGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnRuX2Nsb3NlXCIpKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bl9leGl0XCIpKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuX2J0bllYT3Blbik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLl9idG5ZWENsb3NlKTtcclxuICAgICAgICB0aGlzLmluaXRCdXR0b25IYW5kbGVyKHRoaXMuX2J0bllZT3Blbik7XHJcbiAgICAgICAgdGhpcy5pbml0QnV0dG9uSGFuZGxlcih0aGlzLl9idG5ZWUNsb3NlKTtcclxuICAgICAgICB2YXIgc2xpZGVyID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueGlhb1wiKS5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZFNsaWRlRXZlbnQoc2xpZGVyLCB0aGlzLm5vZGUsIFwiU2V0dGluZ3NcIiwgXCJvblNsaWRlZFwiKTtcclxuICAgICAgICB2YXIgc2xpZGVyID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWlueXVlXCIpLmdldENoaWxkQnlOYW1lKFwicHJvZ3Jlc3NcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkU2xpZGVFdmVudChzbGlkZXIsIHRoaXMubm9kZSwgXCJTZXR0aW5nc1wiLCBcIm9uU2xpZGVkXCIpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xyXG4gICAgfSxcclxuICAgIG9uU2xpZGVkOiBmdW5jdGlvbihzbGlkZXIpIHtcclxuICAgICAgICBpZiAoc2xpZGVyLm5vZGUucGFyZW50Lm5hbWUgPT0gXCJ5aW54aWFvXCIpIHtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3Iuc2V0U0ZYVm9sdW1lKHNsaWRlci5wcm9ncmVzcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChzbGlkZXIubm9kZS5wYXJlbnQubmFtZSA9PSBcInlpbnl1ZVwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnNldEJHTVZvbHVtZShzbGlkZXIucHJvZ3Jlc3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgIH0sXHJcbiAgICBpbml0QnV0dG9uSGFuZGxlcjogZnVuY3Rpb24oYnRuKSB7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChidG4sIHRoaXMubm9kZSwgXCJTZXR0aW5nc1wiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgIH0sXHJcbiAgICByZWZyZXNoVm9sdW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9idG5ZWENsb3NlLmFjdGl2ZSA9IGNjLnZ2LmF1ZGlvTWdyLnNmeFZvbHVtZSA+IDA7XHJcbiAgICAgICAgdGhpcy5fYnRuWVhPcGVuLmFjdGl2ZSA9ICF0aGlzLl9idG5ZWENsb3NlLmFjdGl2ZTtcclxuICAgICAgICB2YXIgeXggPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW54aWFvXCIpO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IDQzMCAqIGNjLnZ2LmF1ZGlvTWdyLnNmeFZvbHVtZTtcclxuICAgICAgICB2YXIgcHJvZ3Jlc3MgPSB5eC5nZXRDaGlsZEJ5TmFtZShcInByb2dyZXNzXCIpXHJcbiAgICAgICAgcHJvZ3Jlc3MuZ2V0Q29tcG9uZW50KGNjLlNsaWRlcikucHJvZ3Jlc3MgPSBjYy52di5hdWRpb01nci5zZnhWb2x1bWU7XHJcbiAgICAgICAgcHJvZ3Jlc3MuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9ncmVzc1wiKS53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIC8veXguZ2V0Q2hpbGRCeU5hbWUoXCJidG5fcHJvZ3Jlc3NcIikueCA9IHByb2dyZXNzLnggKyB3aWR0aDtcclxuICAgICAgICB0aGlzLl9idG5ZWUNsb3NlLmFjdGl2ZSA9IGNjLnZ2LmF1ZGlvTWdyLmJnbVZvbHVtZSA+IDA7XHJcbiAgICAgICAgdGhpcy5fYnRuWVlPcGVuLmFjdGl2ZSA9ICF0aGlzLl9idG5ZWUNsb3NlLmFjdGl2ZTtcclxuICAgICAgICB2YXIgeXkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ5aW55dWVcIik7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gNDMwICogY2MudnYuYXVkaW9NZ3IuYmdtVm9sdW1lO1xyXG4gICAgICAgIHZhciBwcm9ncmVzcyA9IHl5LmdldENoaWxkQnlOYW1lKFwicHJvZ3Jlc3NcIik7XHJcbiAgICAgICAgcHJvZ3Jlc3MuZ2V0Q29tcG9uZW50KGNjLlNsaWRlcikucHJvZ3Jlc3MgPSBjYy52di5hdWRpb01nci5iZ21Wb2x1bWU7XHJcbiAgICAgICAgcHJvZ3Jlc3MuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9ncmVzc1wiKS53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIC8veXkuZ2V0Q2hpbGRCeU5hbWUoXCJidG5fcHJvZ3Jlc3NcIikueCA9IHByb2dyZXNzLnggKyB3aWR0aDtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX2Nsb3NlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5fZXhpdFwiKSB7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInd4X2FjY291bnRcIik7XHJcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInd4X3NpZ25cIik7XHJcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImxvZ2luXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feXhfb3BlblwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnNldFNGWFZvbHVtZSgxLjApO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3l4X2Nsb3NlXCIpIHtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3Iuc2V0U0ZYVm9sdW1lKDApO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYnRuX3l5X29wZW5cIikge1xyXG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5zZXRCR01Wb2x1bWUoMSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJidG5feXlfY2xvc2VcIikge1xyXG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5zZXRCR01Wb2x1bWUoMCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZvbHVtZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHZvaWNlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGhlbHA6IGNjLk5vZGUsXHJcbiAgICAgICAgX2J0bllYT3BlbjogbnVsbCxcclxuICAgICAgICBfYnRuWVhDbG9zZTogbnVsbCxcclxuICAgICAgICBfYnRuWVlPcGVuOiBudWxsLFxyXG4gICAgICAgIF9idG5ZWUNsb3NlOiBudWxsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2J0bllYT3BlbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInZvaWNlXCIpLmdldENoaWxkQnlOYW1lKFwiamJzX2RldGFpbHNcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzb3VuZF9vblwiKTtcclxuICAgICAgICB0aGlzLl9idG5ZWENsb3NlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwidm9pY2VcIikuZ2V0Q2hpbGRCeU5hbWUoXCJqYnNfZGV0YWlsc1wiKS5nZXRDaGlsZEJ5TmFtZShcInNvdW5kX29mZlwiKTtcclxuICAgICAgICB0aGlzLl9idG5ZWU9wZW4gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ2b2ljZVwiKS5nZXRDaGlsZEJ5TmFtZShcImpic19kZXRhaWxzXCIpLmdldENoaWxkQnlOYW1lKFwibXVzaWNfb25cIik7XHJcbiAgICAgICAgdGhpcy5fYnRuWVlDbG9zZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInZvaWNlXCIpLmdldENoaWxkQnlOYW1lKFwiamJzX2RldGFpbHNcIikuZ2V0Q2hpbGRCeU5hbWUoXCJtdXNpY19vZmZcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9idG5ZWE9wZW4sIHRoaXMubm9kZSwgXCJTZXRcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9idG5ZWENsb3NlLCB0aGlzLm5vZGUsIFwiU2V0XCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fYnRuWVlPcGVuLCB0aGlzLm5vZGUsIFwiU2V0XCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fYnRuWVlDbG9zZSwgdGhpcy5ub2RlLCBcIlNldFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgIH0sXHJcbiAgICByZWZyZXNoVm9sdW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9idG5ZWENsb3NlLmFjdGl2ZSA9IGNjLnZ2LmF1ZGlvTWdyLnNmeFZvbHVtZSA+IDA7XHJcbiAgICAgICAgdGhpcy5fYnRuWVhPcGVuLmFjdGl2ZSA9ICF0aGlzLl9idG5ZWENsb3NlLmFjdGl2ZTtcclxuICAgICAgICB0aGlzLl9idG5ZWUNsb3NlLmFjdGl2ZSA9IGNjLnZ2LmF1ZGlvTWdyLmJnbVZvbHVtZSA+IDA7XHJcbiAgICAgICAgdGhpcy5fYnRuWVlPcGVuLmFjdGl2ZSA9ICF0aGlzLl9idG5ZWUNsb3NlLmFjdGl2ZTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNsaWNrZWQ6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiZ3VhbmJpXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJzb3VuZF9vblwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnNldFNGWFZvbHVtZSgxKTtcclxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoVm9sdW1lKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcInNvdW5kX29mZlwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnNldFNGWFZvbHVtZSgwKTtcclxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoVm9sdW1lKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIm11c2ljX29uXCIpIHtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3Iuc2V0QkdNVm9sdW1lKDEpO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwibXVzaWNfb2ZmXCIpIHtcclxuICAgICAgICAgICAgY2MudnYuYXVkaW9NZ3Iuc2V0QkdNVm9sdW1lKDApO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWb2x1bWUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwic2V0X211c2ljMVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMudm9pY2UuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJzZXRfZmFxMFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMudm9pY2UuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaGVscC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyIsIi8vIOW+ruS/oeWIhuS6q+ebuOWFs+mAu+i+keWkhOeQhlxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIF9zaGFyZTogbnVsbCxcbiAgICAgICAgX2xpbmtQYW5lbDogY2MuTm9kZSxcbiAgICAgICAgX1FSQ29kZVBhbmVsOiBjYy5Ob2RlLFxuICAgICAgICBfaGVhZEljb246IGNjLlNwcml0ZSxcbiAgICAgICAgX3NoYXJlSW5mbzogY2MuTGFiZWwsXG4gICAgICAgIF9zaGFyZVR5cGU6IDAsXG4gICAgICAgIF9idG5MaW5rOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuQnV0dG9uXG4gICAgICAgIH0sXG4gICAgICAgIF9idG5RUkNvZGU6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5CdXR0b25cbiAgICAgICAgfSxcbiAgICAgICAgX3Nwcml0ZUZyYW1lOiBudWxsLFxuICAgICAgICBfc2hhcmVSb29tSWQ6IG51bGwsXG4gICAgICAgIF9zcHJRUkNvZGU6IGNjLlNwcml0ZSxcbiAgICB9LFxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0VUkoKVxuICAgICAgICBjYy52di5zaGFyZSA9IHRoaXM7XG4gICAgfSxcbiAgICBpbml0VUk6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zaGFyZSA9IGNjLmZpbmQoXCJDYW52YXMvc2hhcmVcIik7XG4gICAgICAgIHRoaXMuX2xpbmtQYW5lbCA9IGNjLmZpbmQoXCJDYW52YXMvc2hhcmUvbGlua19wYW5lbFwiKTtcbiAgICAgICAgdGhpcy5fUVJDb2RlUGFuZWwgPSBjYy5maW5kKFwiQ2FudmFzL3NoYXJlL1FSX2NvZGVfcGFuZWxcIik7XG4gICAgICAgIHRoaXMuX2hlYWRJY29uID0gdGhpcy5fbGlua1BhbmVsLmdldENoaWxkQnlOYW1lKFwiaGVhZGljb25cIik7XG4gICAgICAgIHRoaXMuX3NoYXJlSW5mbyA9IHRoaXMuX2xpbmtQYW5lbC5nZXRDaGlsZEJ5TmFtZShcInNoYXJlaW5mb1wiKTtcbiAgICAgICAgdGhpcy5fYnRuTGluayA9IGNjLmZpbmQoXCJDYW52YXMvc2hhcmUvYnV0dG9uX2xpbmtcIikuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIHRoaXMuX2J0blFSQ29kZSA9IGNjLmZpbmQoXCJDYW52YXMvc2hhcmUvYnV0dG9uX3FyY29kZVwiKS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcbiAgICAgICAgdGhpcy5fc3ByUVJDb2RlID0gY2MuZmluZChcIkNhbnZhcy9zaGFyZS9RUl9jb2RlX3BhbmVsL1FSQ29kZUltZ1wiKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgdGhpcy5fc2hhcmVSb29tSWQgPSBjYy52di51c2VyTWdyLnNoYXJlUm9vbUlkIHx8IGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkO1xuICAgIH0sXG4gICAgb25DbG9zZUJ0bkNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygn5YWz6Zet5oyJ6ZKu54K55Ye7Jyk7XG4gICAgICAgIHRoaXMuX3NoYXJlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG4gICAgb25MaW5rQnRuQ2xpY2tlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfpk77mjqXpgoDor7fmjInpkq7ngrnlh7snKTtcbiAgICAgICAgdGhpcy5fc2hhcmVUeXBlID0gMTtcbiAgICAgICAgdGhpcy50b2dnbGVTdGF0dWUoKTtcbiAgICB9LFxuICAgIG9uUVJjb2RlQnRuQ2xpY2tlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfkuoznu7TnoIHliIbkuqvmjInpkq7ngrnlh7snKTtcbiAgICAgICAgdGhpcy5fc2hhcmVUeXBlID0gMjtcbiAgICAgICAgdGhpcy50b2dnbGVTdGF0dWUoKTtcbiAgICB9LFxuICAgIHRvZ2dsZVN0YXR1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9zaGFyZVR5cGUgPT0gMSkge1xuICAgICAgICAgICAgdGhpcy5fbGlua1BhbmVsLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9RUkNvZGVQYW5lbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2J0bkxpbmsuaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9idG5RUkNvZGUuaW50ZXJhY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZ2V0U2hhcmVMaW5rSW5mbygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fYnRuTGluay5pbnRlcmFjdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fYnRuUVJDb2RlLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fbGlua1BhbmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fUVJDb2RlUGFuZWwuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZ2V0U2hhcmVRUkNvZGVJbmZvKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9zaGFyZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLl9zaGFyZVR5cGUgPSAxO1xuICAgICAgICB0aGlzLnRvZ2dsZVN0YXR1ZSgpO1xuICAgIH0sXG4gICAgZ2V0U2hhcmVMaW5rSW5mbzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzaGFyZVRpdGxlID0gXCLkuprlt6jmo4vniYxcIjtcbiAgICAgICAgdmFyIHNoYXJlQ29udGVudCA9IFwi5oiR6YKA6K+35L2g5p2l546p5Lqa5beo5qOL54mM77yM5pyA54Gr54Ot55qE5qOL54mM5ri45oiP77yM5YyF5ZCr5ZCE56eN5Li75rWB5Y+K5Zyw5pa55qOL54mM5ri45oiP56eN57G777yM5b+r5LiK6L2m5ZCn77yBXCI7XG4gICAgICAgIGlmIChjYy52di51c2VyTWdyLnVzZXJOYW1lKSB7XG4gICAgICAgICAgICBzaGFyZUNvbnRlbnQgPSBjYy52di51c2VyTWdyLnVzZXJOYW1lICsgXCLpgoDor7fkvaDmnaXnjqnkuprlt6jmo4vniYzvvIzmnIDngavng63nmoTmo4vniYzmuLjmiI/vvIzljIXlkKvlkITnp43kuLvmtYHlj4rlnLDmlrnmo4vniYzmuLjmiI/np43nsbvvvIzlv6vkuIrovablkKfvvIFcIjtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuX3NoYXJlUm9vbUlkKSB7XG4gICAgICAgICAgICBzaGFyZUNvbnRlbnQgPSBzaGFyZUNvbnRlbnQgKyBcIuaIv+mXtOWPt+aYrzpcIiArIHRoaXMuX3NoYXJlUm9vbUlkO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9zaGFyZUluZm8uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBzaGFyZUNvbnRlbnQ7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy53eEZyaWVuZC50aXRsZSA9IHNoYXJlVGl0bGU7XG4gICAgICAgICAgICB3aW5kb3cud3hGcmllbmQuZGVzYyA9IHNoYXJlQ29udGVudDtcbiAgICAgICAgICAgIGlmKGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkICYmIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkICE9IG51bGwpe1xuICAgICAgICAgICAgICAgIHZhciBzaGFyZVVybCA9IGNjLnZ2LnVzZXJNZ3IueWFvcWluZ1VybCArIGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdmFyIHNoYXJlVXJsID0gY2MudnYudXNlck1nci55YW9xaW5nVXJsICsgXCIwMDAwMDBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdpbmRvdy53eEZyaWVuZC5saW5rID0gc2hhcmVVcmw7XG4gICAgICAgICAgICB3aW5kb3cuc2hhcmVNZXNzYWdlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIOWKoOi9veS6jOe7tOeggVxuICAgIGdldFNoYXJlUVJDb2RlSW5mbzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBJbWFnZUxvYWRlciA9IHRoaXMuX3NwclFSQ29kZS5ub2RlLmdldENvbXBvbmVudChcIkltYWdlTG9hZGVyXCIpO1xuICAgICAgICBJbWFnZUxvYWRlci5zZXRVc2VySUQoY2MudnYudXNlck1nci51c2VySWQsIDEpO1xuICAgIH0sXG4gICAgb25EZXN0b3J5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNjLnZ2KSB7XG4gICAgICAgICAgICBjYy52di5zaGFyZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX2Fycm93OiBudWxsLFxyXG4gICAgICAgIF9wb2ludGVyOiBudWxsLFxyXG4gICAgICAgIF90aW1lTGFiZWw6IG51bGwsXHJcbiAgICAgICAgX3RpbWU6IC0xLFxyXG4gICAgICAgIF9hbGVydFRpbWU6IC0xLFxyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGdhbWVDaGlsZCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImdhbWVcIik7XHJcbiAgICAgICAgdGhpcy5fYXJyb3cgPSBnYW1lQ2hpbGQuZ2V0Q2hpbGRCeU5hbWUoXCJhcnJvd1wiKTtcclxuICAgICAgICB0aGlzLl9wb2ludGVyID0gdGhpcy5fYXJyb3cuZ2V0Q2hpbGRCeU5hbWUoXCJwb2ludGVyXCIpO1xyXG4gICAgICAgIHRoaXMuaW5pdFBvaW50ZXIoKTtcclxuICAgICAgICB0aGlzLl90aW1lTGFiZWwgPSB0aGlzLl9hcnJvdy5nZXRDaGlsZEJ5TmFtZShcImxibFRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl90aW1lTGFiZWwuc3RyaW5nID0gXCIwMFwiO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfYmVnaW4nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdFBvaW50ZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfY2h1cGFpJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmluaXRQb2ludGVyKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3RpbWUgPSAxMDtcclxuICAgICAgICAgICAgc2VsZi5fYWxlcnRUaW1lID0gMztcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfdGltZXJCZWdpbicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5pbml0UG9pbnRlcigpO1xyXG4gICAgICAgICAgICBzZWxmLl90aW1lID0gMTA7XHJcbiAgICAgICAgICAgIHNlbGYuX2FsZXJ0VGltZSA9IDM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgaW5pdFBvaW50ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fYXJyb3cuYWN0aXZlID0gY2MudnYuZ2FtZU5ldE1nci5nYW1lc3RhdGUgPT0gXCJwbGF5aW5nXCI7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9hcnJvdy5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdHVybiA9IGNjLnZ2LmdhbWVOZXRNZ3IudHVybjtcclxuICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleCh0dXJuKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3BvaW50ZXIuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5fcG9pbnRlci5jaGlsZHJlbltpXS5hY3RpdmUgPSBpID09IGxvY2FsSW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKGR0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3RpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgLT0gZHQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hbGVydFRpbWUgPiAwICYmIHRoaXMuX3RpbWUgPCB0aGlzLl9hbGVydFRpbWUpIHtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoXCJ0aW1ldXBfYWxhcm0ubXAzXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWxlcnRUaW1lID0gLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHByZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHQgPSBNYXRoLmNlaWwodGhpcy5fdGltZSk7XHJcbiAgICAgICAgICAgIGlmICh0IDwgMTApIHtcclxuICAgICAgICAgICAgICAgIHByZSA9IFwiMFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBwcmUgKyB0O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBhY2NvdW50OiBudWxsLFxyXG4gICAgICAgIHVzZXJJZDogbnVsbCxcclxuICAgICAgICB1c2VyTmFtZTogbnVsbCxcclxuICAgICAgICBsdjogMCxcclxuICAgICAgICBleHA6IDAsXHJcbiAgICAgICAgY29pbnM6IDAsXHJcbiAgICAgICAgZ2VtczogMCxcclxuICAgICAgICBzaWduOiAwLFxyXG4gICAgICAgIGlwOiBcIlwiLFxyXG4gICAgICAgIHNleDogMCxcclxuICAgICAgICByb29tRGF0YTogbnVsbCxcclxuICAgICAgICBvbGRSb29tSWQ6IG51bGwsXHJcbiAgICAgICAgeWFvcWluZ1VybDogbnVsbCxcclxuICAgICAgICBoZWFkaW1nOiBudWxsLFxyXG4gICAgICAgIHNoYXJlUm9vbUlkOiBudWxsLFxyXG4gICAgICAgIHlhb3Fpbmdfa2V5OiBudWxsLFxyXG4gICAgICAgIGNoYXJnZXJhdGU6IG51bGwsXHJcbiAgICAgICAgaXNfc2lnbjogMCxcclxuICAgICAgICBzaWduX2RheXM6IDAsXHJcbiAgICAgICAgcm9vbV90eXBlOiAtMSxcclxuICAgICAgICBjb2xsYXBzZV9wcmlzZTogMCxcclxuICAgICAgICBpc19maXJzdF9jaGFyZ2U6IDAsXHJcbiAgICAgICAgc2NlbmU6IC0xLFxyXG4gICAgICAgIGVfcm9vbWlkOiAwLFxyXG4gICAgICAgIGV4Y2hhbmdlOiAwLFxyXG4gICAgICAgIHJlY29ubmVjdGlvbjogMCxcclxuICAgICAgICByZWZyZXNoVGltZTogMzAwMDAsXHJcbiAgICB9LFxyXG4gICAgZ3Vlc3RBdXRoOiBmdW5jdGlvbihwYXJhbSkge1xyXG4gICAgICAgIHRoaXMubG9hZFNjZW5lTmFtZSA9IHBhcmFtO1xyXG4gICAgICAgIHZhciBhY2NvdW50ID0gY2MuYXJnc1tcImFjY291bnRcIl07XHJcbiAgICAgICAgaWYgKGFjY291bnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBhY2NvdW50ID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWNjb3VudFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFjY291bnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBhY2NvdW50ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWNjb3VudFwiLCBhY2NvdW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9ndWVzdFwiLCB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGFjY291bnRcclxuICAgICAgICB9LCB0aGlzLm9uQXV0aCk7XHJcbiAgICB9LFxyXG4gICAgb25BdXRoOiBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IGNjLnZ2LnVzZXJNZ3I7XHJcbiAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuYWNjb3VudCA9IHJldC5hY2NvdW50O1xyXG4gICAgICAgICAgICBzZWxmLnNpZ24gPSByZXQuc2lnbjtcclxuICAgICAgICAgICAgc2VsZi5zaGFyZVJvb21JZCA9IHJldC5zaGFyZVJvb21JZDtcclxuICAgICAgICAgICAgY2MudnYuaHR0cC51cmwgPSBcImh0dHA6Ly9cIiArIGNjLnZ2LlNJLmhhbGw7XHJcbiAgICAgICAgICAgIHNlbGYubG9naW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8g55m75b2VXHJcbiAgICBsb2dpbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkxvZ2luID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmFjY291bnQgPSByZXQuYWNjb3VudDtcclxuICAgICAgICAgICAgICAgIHNlbGYudXNlcklkID0gcmV0LnVzZXJpZDtcclxuICAgICAgICAgICAgICAgIHNlbGYudXNlck5hbWUgPSByZXQubmFtZTtcclxuICAgICAgICAgICAgICAgIHNlbGYubHYgPSByZXQubHY7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmV4cCA9IHJldC5leHA7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNvaW5zID0gcmV0LmNvaW5zO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5nZW1zID0gcmV0LmdlbXM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21EYXRhID0gcmV0LnJvb21pZDtcclxuICAgICAgICAgICAgICAgIHNlbGYucm9vbV90eXBlID0gcmV0LnJvb21fdHlwZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V4ID0gcmV0LnNleDtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXAgPSByZXQuaXA7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmhlYWRpbWcgPSByZXQuaGVhZGltZztcclxuICAgICAgICAgICAgICAgIHNlbGYueWFvcWluZ1VybCA9IHJldC55YW9xaW5nVXJsO1xyXG4gICAgICAgICAgICAgICAgc2VsZi55YW9xaW5nX2tleSA9IHJldC55YW9xaW5nX2tleTtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXNfc2lnbiA9IHJldC5pc19zaWduO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zaWduX2RheXMgPSByZXQuc2lnbl9kYXlzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jb2xsYXBzZV9wcmlzZSA9IHJldC5jb2xsYXBzZV9wcmlzZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuaXNfZmlyc3RfY2hhcmdlID0gcmV0LmlzX2ZpcnN0X2NoYXJnZTtcclxuICAgICAgICAgICAgICAgIHNlbGYubW9kdWxlcyA9IHJldC5tb2R1bGVzOyAvL+aYvuekuuaooeWdl1xyXG4gICAgICAgICAgICAgICAgc2VsZi5pc19vcGVuX2picyA9IHJldC5pc19vcGVuX2piczsgLy/mmK/lkKblvIDmlL7plKbmoIfotZtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gIOWFheWAvOWFkeaNoueOh1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5jaGFyZ2VyYXRlID0gcmV0LmNoYXJnZXJhdGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVVcmwgPSBzZWxmLnlhb3FpbmdVcmw7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByb29tdmFsaWQgPSBzZWxmLnNoYXJlUm9vbUlkIHx8IGNjLnZ2LmdhbWVOZXRNZ3Iucm9vbUlkIHx8IHNlbGYucm9vbURhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvb212YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZVVybCA9IHNoYXJlVXJsICsgcm9vbXZhbGlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlVXJsID0gc2hhcmVVcmwgKyBcIjAwMDAwMFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93Lnd4RnJpZW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy53eEZyaWVuZC5saW5rID0gc2hhcmVVcmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy53eEZyaWVuZC5kZXNjID0gc2VsZi51c2VyTmFtZSArIHdpbmRvdy53eEZyaWVuZC5kZXNjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2hhcmVNZXNzYWdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYubG9hZFNjZW5lTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShzZWxmLmxvYWRTY2VuZU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdoYWxsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvaW5qaW5iaWFvXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBzZWxmLnVzZXJJZFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuaXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLnZ2Lm1hdGNoX25ldC5pcCA9IGRhdGEuaXAgKyBcIjpcIiArIGRhdGEucG9ydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiPz8/Pz9cIiwgY2MudnYubWF0Y2hfbmV0LmlwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLnZ2Lm1hdGNoX25ldC5jb25uZWN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuaW5pdEhhbmRsZXJzKDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MudnYubWF0Y2hfbmV0LnNlbmQoXCJsb2dpblwiLCB7dXNlcmlkIDogc2VsZi51c2VySWR9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBjYy52di53Yy5zaG93KFwi5q2j5Zyo55m75b2V5ri45oiPXCIpO1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvbG9naW5cIiwge1xyXG4gICAgICAgICAgICBhY2NvdW50OiB0aGlzLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ246IHRoaXMuc2lnblxyXG4gICAgICAgIH0sIG9uTG9naW4pO1xyXG4gICAgfSxcclxuICAgIC8vIOi/m+WFpeaIv+mXtFxyXG4gICAgZW50ZXJSb29tOiBmdW5jdGlvbihyb29tSWQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkVudGVyID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfov5vlhaXmiL/pl7RvbkVudGVyPT09PT4nLHJldCk7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5lbnRlclJvb20ocm9vbUlkLCBjYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LndjLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2socmV0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYucm9vbV90eXBlID0gcmV0LnJvb21fdHlwZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2NlbmUgPSByZXQuc2NlbmU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmVfcm9vbWlkID0gcmV0LnJvb21pZDtcclxuICAgICAgICAgICAgICAgIGNjLnZ2LmdhbWVOZXRNZ3IuY29ubmVjdEdhbWVTZXJ2ZXIocmV0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICByb29taWQ6IHJvb21JZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYud2Muc2hvdyhcIuato+WcqOi/m+WFpeaIv+mXtCBcIiArIHJvb21JZCk7XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9lbnRlcl9wcml2YXRlX3Jvb21cIiwgZGF0YSwgb25FbnRlcik7XHJcbiAgICB9LFxyXG4gICAgLy8g6I635Y+W5Y6G5Y+y5oiY5paX6K6w5b2VXHJcbiAgICBnZXRIaXN0b3J5TGlzdDogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9uR2V0ID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuaGlzdG9yeSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHJldC5oaXN0b3J5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuaHR0cC5zZW5kUmVxdWVzdChcIi9nZXRfaGlzdG9yeV9saXN0XCIsIGRhdGEsIG9uR2V0KTtcclxuICAgIH0sXHJcbiAgICAvLyDojrflj5bph5HluIHlkozpkrvnn7PmlbDph49cclxuICAgIGdldEdlbXNBbmRDb2luczogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG9uR2V0ID0gZnVuY3Rpb24ocmV0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXQuZXJyY29kZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmVycm1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF91c2VyX2dlbXNfYW5kX2NvaW5zXCIsIGRhdGEsIG9uR2V0KTtcclxuICAgIH0sXHJcbiAgICAvLyDnlKjmiLfnrb7liLBcclxuICAgIHNldFVzZXJTaWduOiBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgb25HZXQgPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2socmV0LmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL3NldF91c2VyX3NpZ25cIiwgZGF0YSwgb25HZXQpO1xyXG4gICAgfSxcclxuICAgIC8vIOiOt+WPluetvuWIsOekvOeJqeWIl+ihqFxyXG4gICAgZ2V0U2lnbkxpc3Q6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkdldCA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXQuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICBhY2NvdW50OiBjYy52di51c2VyTWdyLmFjY291bnQsXHJcbiAgICAgICAgICAgIHNpZ246IGNjLnZ2LnVzZXJNZ3Iuc2lnbixcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2Lmh0dHAuc2VuZFJlcXVlc3QoXCIvZ2V0X3NpZ25fbGlzdFwiLCBkYXRhLCBvbkdldCk7XHJcbiAgICB9LFxyXG4gICAgZ2V0R2FtZXNPZlJvb206IGZ1bmN0aW9uKHV1aWQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvbkdldCA9IGZ1bmN0aW9uKHJldCkge1xyXG4gICAgICAgICAgICBpZiAocmV0LmVycmNvZGUgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5lcnJtc2cpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmV0LmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2socmV0LmRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgYWNjb3VudDogY2MudnYudXNlck1nci5hY2NvdW50LFxyXG4gICAgICAgICAgICBzaWduOiBjYy52di51c2VyTWdyLnNpZ24sXHJcbiAgICAgICAgICAgIHV1aWQ6IHV1aWQsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9nYW1lc19vZl9yb29tXCIsIGRhdGEsIG9uR2V0KTtcclxuICAgIH0sXHJcbiAgICBnZXREZXRhaWxPZkdhbWU6IGZ1bmN0aW9uKHV1aWQsIGluZGV4LCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgb25HZXQgPSBmdW5jdGlvbihyZXQpIHtcclxuICAgICAgICAgICAgaWYgKHJldC5lcnJjb2RlICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXQuZXJybXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJldC5kYXRhKTtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHJldC5kYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjY291bnQ6IGNjLnZ2LnVzZXJNZ3IuYWNjb3VudCxcclxuICAgICAgICAgICAgc2lnbjogY2MudnYudXNlck1nci5zaWduLFxyXG4gICAgICAgICAgICB1dWlkOiB1dWlkLFxyXG4gICAgICAgICAgICBpbmRleDogaW5kZXgsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5odHRwLnNlbmRSZXF1ZXN0KFwiL2dldF9kZXRhaWxfb2ZfZ2FtZVwiLCBkYXRhLCBvbkdldCk7XHJcbiAgICB9XHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBfRGF5TGlzdFY6IG51bGwsXHJcbiAgICAgICAgX3NpZ246IG51bGwsXHJcbiAgICAgICAgX2J0bl9zaWduOiBudWxsLFxyXG4gICAgICAgIF9idG5fc2lnbmVkOiBudWxsLFxyXG4gICAgICAgIF9pc1Nob3dWaWV3OiBmYWxzZSxcclxuICAgICAgICBfdGltZTogbnVsbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fc2lnbiA9IGNjLmZpbmQoXCJDYW52YXMvc2lnblwiKTtcclxuICAgICAgICB0aGlzLl9idG5fc2lnbiA9IHRoaXMuX3NpZ24uZ2V0Q2hpbGRCeU5hbWUoXCJidG5fc2lnblwiKTtcclxuICAgICAgICB0aGlzLl9idG5fc2lnbmVkID0gdGhpcy5fc2lnbi5nZXRDaGlsZEJ5TmFtZShcImJ0bl9zaWduZWRcIik7XHJcbiAgICAgICAgdGhpcy5fdGltZSA9IHRoaXMuX3NpZ24uZ2V0Q2hpbGRCeU5hbWUoXCJ0aW1lXCIpO1xyXG4gICAgICAgIHRoaXMuX0RheUxpc3RWID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA3OyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBcImRheVwiICsgKGkgKyAxKTtcclxuICAgICAgICAgICAgdGhpcy5fRGF5TGlzdFYucHVzaCh0aGlzLl9zaWduLmdldENoaWxkQnlOYW1lKHBhdGgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faXNTaG93VmlldyA9IChjYy52di51c2VyTWdyLmlzX3NpZ24gPT0gMCk7XHJcbiAgICAgICAgdGhpcy5pbml0U2lnbkRhdGEoKTtcclxuICAgIH0sXHJcbiAgICBpbml0U2lnbkRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzU2hvd1ZpZXcpIHtcclxuICAgICAgICAgICAgLy/nrb7liLDmjInpkq7kuI3lj6/ngrnlh7tcclxuICAgICAgICAgICAgdGhpcy5fdGltZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi5bey55m75b2VXCIgKyBjYy52di51c2VyTWdyLnNpZ25fZGF5cyArIFwi5aSpXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0bl9zaWduLmFjdGl2ZSA9IChjYy52di51c2VyTWdyLnNpZ25fZGF5cyA8IDYgJiYgY2MudnYudXNlck1nci5pc19zaWduID09IDApO1xyXG4gICAgICAgICAgICB0aGlzLl9idG5fc2lnbmVkLmFjdGl2ZSA9IChjYy52di51c2VyTWdyLnNpZ25fZGF5cyA8IDYgJiYgY2MudnYudXNlck1nci5pc19zaWduID09IDEpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLl9idG5fc2lnbi5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSAoY2MudnYudXNlck1nci5pc19zaWduID09IDApO1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLmdldFNpZ25MaXN0KGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0taW5pdFNpZ25EYXRhLS0tLS0tLT4+XCIsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBkYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmlldyA9IHNlbGYuX0RheUxpc3RWW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSB2aWV3LmdldENoaWxkQnlOYW1lKFwibmFtZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZS5zdHJpbmcgPSBkLm5hbWUgKyBcIsOXXCIgKyBkLmFtb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaWduZWQgPSB2aWV3LmdldENoaWxkQnlOYW1lKFwic2lnbmVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNpZ25lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYy52di51c2VyTWdyLnNpZ25fZGF5cyA+IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVkLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkgPT0gZGF0YS5sZW5ndGggLSAxICYmIGNjLnZ2LnVzZXJNZ3Iuc2lnbl9kYXlzID4gNiAmJiBjYy52di51c2VyTWdyLmlzX3NpZ24gPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduZWQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnRuX3NpZ24gPSB2aWV3LmdldENoaWxkQnlOYW1lKFwiYnRuX3NpZ25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnRuX3NpZ24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG5fc2lnbi5hY3RpdmUgPSAoY2MudnYudXNlck1nci5zaWduX2RheXMgPj0gNiAmJiBjYy52di51c2VyTWdyLmlzX3NpZ24gPT0gMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnRuX3NpZ24uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gKGNjLnZ2LnVzZXJNZ3IuaXNfc2lnbiA9PSAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zaWduLmFjdGl2ZSA9IHNlbGYuX2lzU2hvd1ZpZXc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzZWxmLl9zaWduLmFjdGl2ZSA9IHNlbGYuX2lzU2hvd1ZpZXc7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v562+5YiwXHJcbiAgICBvblNpZ25CdG5DbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYudXNlck1nci5pc19zaWduID09IDApIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLnNldFVzZXJTaWduKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYudXNlck1nci5pc19zaWduID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLnNpZ25fZGF5cysrO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnR5cGUgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy52di51c2VyTWdyLmdlbXMgKz0gZGF0YS5hbW91bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5pdFNpZ25EYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLku4rml6Xlt7Lnrb7liLAhXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkNsb3NlQnRuQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fc2lnbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9pc1Nob3dWaWV3ID0gZmFsc2U7XHJcbiAgICB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgIH0sXHJcbiAgICBhZGRDbGlja0V2ZW50OiBmdW5jdGlvbihub2RlLCB0YXJnZXQsIGNvbXBvbmVudCwgaGFuZGxlciwgaXNSZXBsYWNlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coY29tcG9uZW50ICsgXCI6XCIgKyBoYW5kbGVyKTtcclxuICAgICAgICB2YXIgZXZlbnRIYW5kbGVyID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcclxuICAgICAgICBldmVudEhhbmRsZXIudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZXIgPSBoYW5kbGVyO1xyXG4gICAgICAgIHZhciBjbGlja0V2ZW50cyA9IG5vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHM7XHJcbiAgICAgICAgaWYgKGlzUmVwbGFjZSkge1xyXG4gICAgICAgICAgICAvL+aYr+WQpuimhuebluaOieS5i+WJjeeahOS6i+S7tlxyXG4gICAgICAgICAgICBjbGlja0V2ZW50c1swXSA9IGV2ZW50SGFuZGxlcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjbGlja0V2ZW50cy5wdXNoKGV2ZW50SGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGFkZFNsaWRlRXZlbnQ6IGZ1bmN0aW9uKG5vZGUsIHRhcmdldCwgY29tcG9uZW50LCBoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIGV2ZW50SGFuZGxlciA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLnRhcmdldCA9IHRhcmdldDtcclxuICAgICAgICBldmVudEhhbmRsZXIuY29tcG9uZW50ID0gY29tcG9uZW50O1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5oYW5kbGVyID0gaGFuZGxlcjtcclxuICAgICAgICB2YXIgc2xpZGVFdmVudHMgPSBub2RlLmdldENvbXBvbmVudChjYy5TbGlkZXIpLnNsaWRlRXZlbnRzO1xyXG4gICAgICAgIHNsaWRlRXZlbnRzLnB1c2goZXZlbnRIYW5kbGVyKTtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuICAgIC8vIH0sXHJcbiAgICBzaG93SmluYmk6IGZ1bmN0aW9uKGppbmJpLCBzdWZmaXgpIHtcclxuICAgICAgICBpZiAoIXN1ZmZpeCkge1xyXG4gICAgICAgICAgICBzdWZmaXggPSBcIuS4h1wiO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgamluYmkgPSBwYXJzZUZsb2F0KGppbmJpKTtcclxuICAgICAgICBpZiAoamluYmkgPj0gMTAwMDApIHtcclxuICAgICAgICAgICAgamluYmkgLz0gMTAwMDA7XHJcbiAgICAgICAgICAgIGppbmJpID0gamluYmkgKyBzdWZmaXg7XHJcbiAgICAgICAgICAgIHJldHVybiBqaW5iaTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGppbmJpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGVja1JhdGU6IGZ1bmN0aW9uKG51Ym1lcikge1xyXG4gICAgICAgIC8v5Yik5pat5a2X56ym5Liy5piv5ZCm5Li65pWw5a2XLy9cclxuICAgICAgICAvLyDjgIDjgIB2YXIgcmUgPSAvXlswLTldKy4/WzAtOV0qJC87ICBcclxuICAgICAgICAvL+WIpOaWreato+aVtOaVsCAvXlsxLTldK1swLTldKl0qJC8gXHJcbiAgICAgICAgdmFyIHJlID0gL15bMC05XStbMC05XSpdKiQvO+OAgOOAgFxyXG4gICAgICAgIGlmICghcmUudGVzdChudWJtZXIpKSB744CA44CA44CA44CAXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTvjgIDjgIBcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pOyIsInZhciByYWRpeCA9IDEyO1xyXG52YXIgYmFzZSA9IDEyOCAtIHJhZGl4O1xyXG5cclxuZnVuY3Rpb24gY3J5cHRvKHZhbHVlKSB7XHJcbiAgICB2YWx1ZSAtPSBiYXNlO1xyXG4gICAgdmFyIGggPSBNYXRoLmZsb29yKHZhbHVlIC8gcmFkaXgpICsgYmFzZTtcclxuICAgIHZhciBsID0gdmFsdWUgJSByYWRpeCArIGJhc2U7XHJcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShoKSArIFN0cmluZy5mcm9tQ2hhckNvZGUobCk7XHJcbn1cclxudmFyIGVuY29kZXJtYXAgPSB7fVxyXG52YXIgZGVjb2Rlcm1hcCA9IHt9XHJcbmZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcclxuICAgIHZhciBjb2RlID0gbnVsbDtcclxuICAgIHZhciB2ID0gaSArIDE7XHJcbiAgICBpZiAodiA+PSBiYXNlKSB7XHJcbiAgICAgICAgY29kZSA9IGNyeXB0byh2KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUodik7XHJcbiAgICB9XHJcbiAgICBlbmNvZGVybWFwW2ldID0gY29kZTtcclxuICAgIGRlY29kZXJtYXBbY29kZV0gPSBpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBlbmNvZGUoZGF0YSkge1xyXG4gICAgdmFyIGNvbnRlbnQgPSBcIlwiO1xyXG4gICAgdmFyIGxlbiA9IGRhdGEubGVuZ3RoO1xyXG4gICAgdmFyIGEgPSAobGVuID4+IDI0KSAmIDB4ZmY7XHJcbiAgICB2YXIgYiA9IChsZW4gPj4gMTYpICYgMHhmZjtcclxuICAgIHZhciBjID0gKGxlbiA+PiA4KSAmIDB4ZmY7XHJcbiAgICB2YXIgZCA9IGxlbiAmIDB4ZmY7XHJcbiAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbYV07XHJcbiAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbYl07XHJcbiAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbY107XHJcbiAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbZF07XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICBjb250ZW50ICs9IGVuY29kZXJtYXBbZGF0YVtpXV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29udGVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q29kZShjb250ZW50LCBpbmRleCkge1xyXG4gICAgdmFyIGMgPSBjb250ZW50LmNoYXJDb2RlQXQoaW5kZXgpO1xyXG4gICAgaWYgKGMgPj0gYmFzZSkge1xyXG4gICAgICAgIGMgPSBjb250ZW50LmNoYXJBdChpbmRleCkgKyBjb250ZW50LmNoYXJBdChpbmRleCArIDEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjID0gY29udGVudC5jaGFyQXQoaW5kZXgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlY29kZShjb250ZW50KSB7XHJcbiAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgdmFyIGxlbiA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7ICsraSkge1xyXG4gICAgICAgIHZhciBjID0gZ2V0Q29kZShjb250ZW50LCBpbmRleCk7XHJcbiAgICAgICAgaW5kZXggKz0gYy5sZW5ndGg7XHJcbiAgICAgICAgdmFyIHYgPSBkZWNvZGVybWFwW2NdO1xyXG4gICAgICAgIGxlbiB8PSB2IDw8ICgzIC0gaSkgKiA4O1xyXG4gICAgfVxyXG4gICAgdmFyIG5ld0RhdGEgPSBuZXcgVWludDhBcnJheShsZW4pO1xyXG4gICAgdmFyIGNudCA9IDA7XHJcbiAgICB3aGlsZSAoaW5kZXggPCBjb250ZW50Lmxlbmd0aCkge1xyXG4gICAgICAgIHZhciBjID0gZ2V0Q29kZShjb250ZW50LCBpbmRleCk7XHJcbiAgICAgICAgaW5kZXggKz0gYy5sZW5ndGg7XHJcbiAgICAgICAgbmV3RGF0YVtjbnRdID0gZGVjb2Rlcm1hcFtjXTtcclxuICAgICAgICBjbnQrKztcclxuICAgIH1cclxuICAgIHJldHVybiBuZXdEYXRhO1xyXG59XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIG9uUGxheUNhbGxiYWNrOiBudWxsLFxyXG4gICAgICAgIF92b2ljZU1lZGlhUGF0aDogbnVsbCxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5fdm9pY2VNZWRpYVBhdGggPSBqc2IuZmlsZVV0aWxzLmdldFdyaXRhYmxlUGF0aCgpICsgXCIvdm9pY2Vtc2dzL1wiO1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0b3JhZ2VEaXIodGhpcy5fdm9pY2VNZWRpYVBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBwcmVwYXJlOiBmdW5jdGlvbihmaWxlbmFtZSkge1xyXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBhdXNlQWxsKCk7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgd2luZG93LnN0YXJ0UmVjb3JkKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jbGVhckNhY2hlKGZpbGVuYW1lKTtcclxuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJjb20vdml2aWdhbWVzL3ZvaWNlc2RrL1ZvaWNlUmVjb3JkZXJcIiwgXCJwcmVwYXJlXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGZpbGVuYW1lKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJWb2ljZVNES1wiLCBcInByZXBhcmVSZWNvcmQ6XCIsIGZpbGVuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcmVsZWFzZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IucmVzdW1lQWxsKCk7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgd2luZG93LnN0b3BSZWNvcmQoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJjb20vdml2aWdhbWVzL3ZvaWNlc2RrL1ZvaWNlUmVjb3JkZXJcIiwgXCJyZWxlYXNlXCIsIFwiKClWXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIlZvaWNlU0RLXCIsIFwiZmluaXNoUmVjb3JkXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjYW5jZWw6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnJlc3VtZUFsbCgpO1xyXG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jYW5jZWxSZWNvcmQoKTtcclxuICAgICAgICAgICAgd2luZG93LnZvaWNlLmxvY2FsSWQgPSBudWxsO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcImNvbS92aXZpZ2FtZXMvdm9pY2VzZGsvVm9pY2VSZWNvcmRlclwiLCBcImNhbmNlbFwiLCBcIigpVlwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJWb2ljZVNES1wiLCBcImNhbmNlbFJlY29yZFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgd3JpdGVWb2ljZTogZnVuY3Rpb24oZmlsZW5hbWUsIHZvaWNlRGF0YSkge1xyXG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZvaWNlRGF0YSAmJiB2b2ljZURhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgZmlsZURhdGEgPSBkZWNvZGUodm9pY2VEYXRhKTtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHRoaXMuX3ZvaWNlTWVkaWFQYXRoICsgZmlsZW5hbWU7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDYWNoZShmaWxlbmFtZSk7XHJcbiAgICAgICAgICAgIGpzYi5maWxlVXRpbHMud3JpdGVEYXRhVG9GaWxlKGZpbGVEYXRhLCB1cmwpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjbGVhckNhY2hlOiBmdW5jdGlvbihmaWxlbmFtZSkge1xyXG4gICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHRoaXMuX3ZvaWNlTWVkaWFQYXRoICsgZmlsZW5hbWU7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJjaGVjayBmaWxlOlwiICsgdXJsKTtcclxuICAgICAgICAgICAgaWYgKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QodXJsKSkge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJlbW92ZTpcIiArIHVybCk7XHJcbiAgICAgICAgICAgICAgICBqc2IuZmlsZVV0aWxzLnJlbW92ZUZpbGUodXJsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdCh1cmwgKyBcIi53YXZcIikpIHtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJyZW1vdmU6XCIgKyB1cmwgKyBcIi53YXZcIik7XHJcbiAgICAgICAgICAgICAgICBqc2IuZmlsZVV0aWxzLnJlbW92ZUZpbGUodXJsICsgXCIud2F2XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHBsYXk6IGZ1bmN0aW9uKGZpbGVuYW1lKSB7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy52di5hdWRpb01nci5wYXVzZUFsbCgpO1xyXG4gICAgICAgIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcImNvbS92aXZpZ2FtZXMvdm9pY2VzZGsvVm9pY2VQbGF5ZXJcIiwgXCJwbGF5XCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGZpbGVuYW1lKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfSU9TKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJWb2ljZVNES1wiLCBcInBsYXk6XCIsIGZpbGVuYW1lKTtcclxuICAgICAgICB9IGVsc2Uge31cclxuICAgIH0sXHJcbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnJlc3VtZUFsbCgpO1xyXG4gICAgICAgIGlmIChjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcImNvbS92aXZpZ2FtZXMvdm9pY2VzZGsvVm9pY2VQbGF5ZXJcIiwgXCJzdG9wXCIsIFwiKClWXCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIlZvaWNlU0RLXCIsIFwic3RvcFBsYXlcIik7XHJcbiAgICAgICAgfSBlbHNlIHt9XHJcbiAgICB9LFxyXG4gICAgZ2V0Vm9pY2VMZXZlbDogZnVuY3Rpb24obWF4TGV2ZWwpIHtcclxuICAgICAgICBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVJlY29yZGVyXCIsIFwiZ2V0Vm9pY2VMZXZlbFwiLCBcIihJKUlcIiwgbWF4TGV2ZWwpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHt9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4TGV2ZWwgKyAxKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0Vm9pY2VEYXRhOiBmdW5jdGlvbihmaWxlbmFtZSkge1xyXG4gICAgICAgIGlmIChjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHRoaXMuX3ZvaWNlTWVkaWFQYXRoICsgZmlsZW5hbWU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0Vm9pY2VEYXRhOlwiICsgdXJsKTtcclxuICAgICAgICAgICAgdmFyIGZpbGVEYXRhID0ganNiLmZpbGVVdGlscy5nZXREYXRhRnJvbUZpbGUodXJsKTtcclxuICAgICAgICAgICAgaWYgKGZpbGVEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IGVuY29kZShmaWxlRGF0YSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29udGVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH0sXHJcbiAgICBkb3dubG9hZDogZnVuY3Rpb24oKSB7fSxcclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG4gICAgLy8gfSxcclxuICAgIHNldFN0b3JhZ2VEaXI6IGZ1bmN0aW9uKGRpcikge1xyXG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNjLnN5cy5vcyA9PSBjYy5zeXMuT1NfQU5EUk9JRCkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL3ZpdmlnYW1lcy92b2ljZXNkay9Wb2ljZVJlY29yZGVyXCIsIFwic2V0U3RvcmFnZURpclwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBkaXIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2Muc3lzLm9zID09IGNjLnN5cy5PU19JT1MpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIlZvaWNlU0RLXCIsIFwic2V0U3RvcmFnZURpcjpcIiwgZGlyKTtcclxuICAgICAgICAgICAgaWYgKCFqc2IuZmlsZVV0aWxzLmlzRGlyZWN0b3J5RXhpc3QoZGlyKSkge1xyXG4gICAgICAgICAgICAgICAganNiLmZpbGVVdGlscy5jcmVhdGVEaXJlY3RvcnkoZGlyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2xhc3RUb3VjaFRpbWU6IG51bGwsXHJcbiAgICAgICAgX3ZvaWNlOiBudWxsLFxyXG4gICAgICAgIF92b2x1bWU6IG51bGwsXHJcbiAgICAgICAgX3ZvaWNlX2ZhaWxlZDogbnVsbCxcclxuICAgICAgICBfbGFzdENoZWNrVGltZTogLTEsXHJcbiAgICAgICAgX3RpbWVCYXI6IG51bGwsXHJcbiAgICAgICAgTUFYX1RJTUU6IDE1MDAwLFxyXG4gICAgICAgIF92b2ljZVRpbWU6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3ZvaWNlID0gY2MuZmluZChcIkNhbnZhcy92b2ljZVwiKTtcclxuICAgICAgICB0aGlzLl92b2ljZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl92b2ljZV9mYWlsZWQgPSBjYy5maW5kKFwiQ2FudmFzL3ZvaWNlL3ZvaWNlX2ZhaWxlZFwiKTtcclxuICAgICAgICB0aGlzLl92b2ljZV9mYWlsZWQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fdGltZUJhciA9IGNjLmZpbmQoXCJDYW52YXMvdm9pY2UvdGltZVwiKTtcclxuICAgICAgICB0aGlzLl90aW1lQmFyLnNjYWxlWCA9IDAuMDtcclxuICAgICAgICB0aGlzLl92b2x1bWUgPSBjYy5maW5kKFwiQ2FudmFzL3ZvaWNlL3ZvbHVtZVwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMuX3ZvbHVtZS5jaGlsZHJlbi5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLl92b2x1bWUuY2hpbGRyZW5baV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBidG5Wb2ljZSA9IGNjLmZpbmQoXCJDYW52YXMvdm9pY2Uvdm9pY2VfZmFpbGVkL2J0bl9va1wiKTtcclxuICAgICAgICBpZiAoYnRuVm9pY2UpIHtcclxuICAgICAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChidG5Wb2ljZSwgdGhpcy5ub2RlLCBcIlZvaWNlXCIsIFwib25CdG5PS0NsaWNrZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgYnRuVm9pY2UgPSBjYy5maW5kKFwiQ2FudmFzL2J0bl92b2ljZVwiKTtcclxuICAgICAgICBpZiAoYnRuVm9pY2UpIHtcclxuICAgICAgICAgICAgYnRuVm9pY2Uub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVFwiKTtcclxuICAgICAgICAgICAgICAgIC8vIOWFs+aOieaJgOaciemfs+S5kFxyXG4gICAgICAgICAgICAgICAgY2MudnYudm9pY2VNZ3IucHJlcGFyZShcInJlY29yZC5hbXJcIik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9sYXN0VG91Y2hUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3ZvaWNlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl92b2ljZV9mYWlsZWQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBidG5Wb2ljZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRVwiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJ0blZvaWNlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2VsZi5fbGFzdFRvdWNoVGltZSA8IDEwMDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl92b2ljZV9mYWlsZWQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjYy52di52b2ljZU1nci5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5b2V6Z+z57uT5p2f5bm25LiK5LygXHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYudm9pY2VNZ3IucmVsZWFzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub25Wb2ljZU9LKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBidG5Wb2ljZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUxcIik7XHJcbiAgICAgICAgICAgICAgICBjYy52di52b2ljZU1nci5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZvaWNlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fbGFzdFRvdWNoVGltZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl92b2ljZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uVm9pY2VPSzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvblZvaWNlT0shISEhXCIgKyB0aGlzLl9sYXN0VG91Y2hUaW1lKTtcclxuICAgICAgICB0aGlzLl92b2ljZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5fbGFzdFRvdWNoVGltZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZvaWNlVGltZSA9IERhdGUubm93KCkgLSB0aGlzLl9sYXN0VG91Y2hUaW1lO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn5pe26ZW/5piv5aSa5bCRJyArIHRoaXMuX3ZvaWNlVGltZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuX2xhc3RUb3VjaFRpbWUgPSBudWxsO1xyXG4gICAgfSxcclxuICAgIC8vIOWPkemAgeivremfs+WIsOacjeWKoeWZqFxyXG4gICAgc2VuZFZvaWNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAod2luZG93LnZvaWNlLnNlcnZlcklkICYmIHRoaXMuX3ZvaWNlVGltZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWPkemAgeivremfs+a2iOaBr+WIsOacjeWKoeWZqFwiKTtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJ2b2ljZV9tc2dcIiwge1xyXG4gICAgICAgICAgICAgICAgbXNnOiB3aW5kb3cudm9pY2Uuc2VydmVySWQsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiB0aGlzLl92b2ljZVRpbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3ZvaWNlVGltZSA9IG51bGw7XHJcbiAgICAgICAgd2luZG93LnZvaWNlLnNlcnZlcklkID0gbnVsbDtcclxuICAgIH0sXHJcbiAgICBvbkJ0bk9LQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fdm9pY2UuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgICAgICBpZiAodGhpcy5fdm9pY2UuYWN0aXZlID09IHRydWUgJiYgdGhpcy5fdm9pY2VfZmFpbGVkLmFjdGl2ZSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRoaXMuX2xhc3RDaGVja1RpbWUgPiAzMDApIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fdm9sdW1lLmNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdm9sdW1lLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHYgPSBjYy52di52b2ljZU1nci5nZXRWb2ljZUxldmVsKDcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHYgPj0gMSAmJiB2IDw9IDcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92b2x1bWUuY2hpbGRyZW5bdiAtIDFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0Q2hlY2tUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fbGFzdFRvdWNoVGltZSkge1xyXG4gICAgICAgICAgICB2YXIgdGltZSA9IERhdGUubm93KCkgLSB0aGlzLl9sYXN0VG91Y2hUaW1lO1xyXG4gICAgICAgICAgICBpZiAodGltZSA+PSB0aGlzLk1BWF9USU1FKSB7XHJcbiAgICAgICAgICAgICAgICBjYy52di52b2ljZU1nci5yZWxlYXNlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uVm9pY2VPSygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdm9pY2UuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0VG91Y2hUaW1lID0gbnVsbDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gdGltZSAvIHRoaXMuTUFYX1RJTUU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lQmFyLnNjYWxlWCA9IDEgLSBwZXJjZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAod2luZG93LnZvaWNlICYmIHdpbmRvdy52b2ljZS5zZXJ2ZXJJZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaWTmmK/lpJrlsJFcIiArIHdpbmRvdy52b2ljZS5zZXJ2ZXJJZCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZFZvaWNlKCk7XHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICB0YXJnZXQ6IGNjLk5vZGUsXHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIF9pc1Nob3c6IGZhbHNlLFxyXG4gICAgICAgIGxibENvbnRlbnQ6IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYud2MgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0aGlzLl9pc1Nob3c7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgICAgICB0aGlzLnRhcmdldC5yb3RhdGlvbiA9IHRoaXMudGFyZ2V0LnJvdGF0aW9uIC0gZHQgKiA0NTtcclxuICAgIH0sXHJcbiAgICBzaG93OiBmdW5jdGlvbihjb250ZW50KSB7XHJcbiAgICAgICAgdGhpcy5faXNTaG93ID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5ub2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0aGlzLl9pc1Nob3c7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmxibENvbnRlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGNvbnRlbnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sYmxDb250ZW50LnN0cmluZyA9IGNvbnRlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhpZGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2lzU2hvdyA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLm5vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRoaXMuX2lzU2hvdztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgX2NoYXRSb290OiBudWxsLFxyXG4gICAgICAgIF90YWJRdWljazogbnVsbCxcclxuICAgICAgICBfdGFiRW1vamk6IG51bGwsXHJcbiAgICAgICAgX2lwdENoYXQ6IG51bGwsXHJcbiAgICAgICAgX3F1aWNrQ2hhdEluZm86IG51bGwsXHJcbiAgICAgICAgX2J0bkNoYXQ6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYuempoY2hhdCA9IHRoaXM7XHJcbiAgICAgICAgLy8gdGhpcy5fYnRuQ2hhdCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpbnhpXCIpO1xyXG4gICAgICAgIC8vIHRoaXMuX2J0bkNoYXQuYWN0aXZlID0gY2MudnYucmVwbGF5TWdyLmlzUmVwbGF5KCkgPT0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fY2hhdFJvb3QgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaGF0XCIpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3RhYlF1aWNrID0gdGhpcy5fY2hhdFJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJxdWlja2NoYXRsaXN0XCIpO1xyXG4gICAgICAgIHRoaXMuX3RhYkVtb2ppID0gdGhpcy5fY2hhdFJvb3QuZ2V0Q2hpbGRCeU5hbWUoXCJlbW9qaXNcIik7XHJcbiAgICAgICAgdGhpcy5faXB0Q2hhdCA9IHRoaXMuX2NoYXRSb290LmdldENoaWxkQnlOYW1lKFwiaXB0Q2hhdFwiKS5nZXRDb21wb25lbnQoY2MuRWRpdEJveCk7XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mbyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtMFwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDAsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5b+r54K55ZWK77yM6YO9562J5Yiw5oiR6Iqx5YS/6YO96LCi6LCi5LqG77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfMS5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW0xXCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogMSxcclxuICAgICAgICAgICAgY29udGVudDogXCLmgI7kuYjlj4jmlq3nur/kuobvvIznvZHnu5zmgI7kuYjov5nkuYjlt67llYrvvIFcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ18yLm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTJcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiAyLFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuS4jeimgei1sO+8jOWGs+aImOWIsOWkqeS6ru+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzMubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtM1wiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDMsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5L2g55qE54mM5omT5b6X5Lmf5aSq5aW95LqG77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfNC5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW00XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogNCxcclxuICAgICAgICAgICAgY29udGVudDogXCLkvaDmmK/lprnlprnov5jmmK/lk6Xlk6XllYrvvJ9cIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ181Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbTVcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiA1LFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuWSjOS9oOWQiOS9nOecn+aYr+WkquaEieW/q+S6hu+8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzYubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3F1aWNrQ2hhdEluZm9bXCJpdGVtNlwiXSA9IHtcclxuICAgICAgICAgICAgaW5kZXg6IDYsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwi5aSn5a625aW977yM5b6I6auY5YW06KeB5Yiw5ZCE5L2N77yBXCIsXHJcbiAgICAgICAgICAgIHNvdW5kOiBcImZpeF9tc2dfNy5tcDNcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcXVpY2tDaGF0SW5mb1tcIml0ZW03XCJdID0ge1xyXG4gICAgICAgICAgICBpbmRleDogNyxcclxuICAgICAgICAgICAgY29udGVudDogXCLlkITkvY3vvIznnJ/mmK/kuI3lpb3mhI/mgJ3vvIzmiJHlvpfnprvlvIDkuIDkvJrlhL/jgIJcIixcclxuICAgICAgICAgICAgc291bmQ6IFwiZml4X21zZ184Lm1wM1wiXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9xdWlja0NoYXRJbmZvW1wiaXRlbThcIl0gPSB7XHJcbiAgICAgICAgICAgIGluZGV4OiA4LFxyXG4gICAgICAgICAgICBjb250ZW50OiBcIuS4jeimgeWQteS6hu+8jOS4k+W/g+eOqea4uOaIj+WQp++8gVwiLFxyXG4gICAgICAgICAgICBzb3VuZDogXCJmaXhfbXNnXzkubXAzXCJcclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuICAgIGdldFF1aWNrQ2hhdEluZm8oaW5kZXgpIHtcclxuICAgICAgICB2YXIga2V5ID0gXCJpdGVtXCIgKyBpbmRleDtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcXVpY2tDaGF0SW5mb1trZXldO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2hhdENsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgb25CZ0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIG9uVGFiQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0YWJRdWlja1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYlF1aWNrLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYkVtb2ppLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJ0YWJFbW9qaVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhYlF1aWNrLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl90YWJFbW9qaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvblF1aWNrQ2hhdEl0ZW1DbGlja2VkOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5fcXVpY2tDaGF0SW5mb1tldmVudC50YXJnZXQubmFtZV07XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJxdWlja19jaGF0XCIsIGluZm8uaW5kZXgpO1xyXG4gICAgfSxcclxuICAgIG9uRW1vamlJdGVtQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQubmFtZSk7XHJcbiAgICAgICAgdGhpcy5fY2hhdFJvb3QuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJlbW9qaVwiLCBldmVudC50YXJnZXQubmFtZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5TZW5kQ2hhdENsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2NoYXRSb290LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9pcHRDaGF0LnN0cmluZyA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJjaGF0XCIsIHRoaXMuX2lwdENoYXQuc3RyaW5nKTtcclxuICAgICAgICB0aGlzLl9pcHRDaGF0LnN0cmluZyA9IFwiXCI7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcbiAgICAvLyB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBpbml0SGFuZGxlcnM6IGZ1bmN0aW9uKEdhbWVOZXQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IEdhbWVOZXQ7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJsb2dpbl9yZXN1bHRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuZXJyY29kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJvb21JZCA9IGRhdGEucm9vbWlkO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSBkYXRhLmNvbmYucm9vbV90eXBlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jb25mID0gZGF0YS5jb25mO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5tYXhOdW1PZkdhbWVzID0gZGF0YS5jb25mLm1heEdhbWVzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5udW1PZkdhbWVzID0gZGF0YS5udW1vZmdhbWVzO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZWF0cyA9IGRhdGEuc2VhdHM7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRJbmRleCA9IHNlbGYuZ2V0U2VhdEluZGV4QnlJRChjYy52di51c2VyTWdyLnVzZXJJZCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzT3ZlciA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuZXJyY29kZSA9PT0gNCkge1xyXG4gICAgICAgICAgICAgICAgLy/ph43mlrBsb2dpblxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjYy52di5uZXQuc2VuZCgnbG9naW4nLCBkYXRhKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEuZXJybXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibG9naW5fZmluaXNoZWRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJ6amhnYW1lXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZXhpdF9yZXN1bHRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IC0xO1xyXG4gICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8v54m55q6K5oOF5Ya15LiL77yI6ZSm5qCH6LWb562J77yJ5Y+v5Lul6K6+572u6L+Z6YeM55qEZGF0Ye+8jOWcqOmAgOWHuueahOaXtuWAmei/m+ihjOaTjeS9nFxyXG4gICAgICAgICAgICAgICAgc2VsZi5hY3Rpb25EYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZXhpdF9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhO1xyXG4gICAgICAgICAgICB2YXIgcyA9IHNlbGYuZ2V0U2VhdEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgaWYgKHMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcy51c2VyaWQgPSAwO1xyXG4gICAgICAgICAgICAgICAgcy5uYW1lID0gXCJcIjtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInVzZXJfc3RhdGVfY2hhbmdlZFwiLCBzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiY291bnRfZG93bl9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiY291bnRfZG93blwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImRpc3ByZXNzX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLnJvb21JZCA9IG51bGw7XHJcbiAgICAgICAgICAgIHNlbGYudHVybiA9IC0xO1xyXG4gICAgICAgICAgICBzZWxmLnNlYXRzID0gbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImRpc2Nvbm5lY3RcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uRGF0YSA9IHNlbGYuYWN0aW9uRGF0YTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZXhpdF9yb29tXCIpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5yb29tSWQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbkRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uRGF0YS5tc2cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBhY3Rpb25EYXRhLm1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWN0aW9uRGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIm5ld2hhbGxcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgYWN0aW9uRGF0YS5kZWxheSAqIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJuZXdoYWxsXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5yb29tX3R5cGUgPSAtMTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmlzT3ZlciA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3Iub2xkUm9vbUlkID0gc2VsZi5yb29tSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KFwiZGlzY29ubmVjdFwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yb29tSWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucm9vbV90eXBlID0gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImNoYXRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcImNoYXRfcHVzaFwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcInF1aWNrX2NoYXRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChcInF1aWNrX2NoYXRfcHVzaFwiLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImVtb2ppX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoXCJlbW9qaV9wdXNoXCIsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwibmV3X3VzZXJfY29tZXNfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBkYXRhLnNlYXRpbmRleDtcclxuICAgICAgICAgICAgaWYgKHNlbGYuc2VhdHNbc2VhdEluZGV4XS51c2VyaWQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNlYXRzW3NlYXRJbmRleF0ub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEub25saW5lID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2VhdHNbc2VhdEluZGV4XSA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCduZXdfdXNlcicsIHNlbGYuc2VhdHNbc2VhdEluZGV4XSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2NoZWNrUGFpX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdrYW5wYWknLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbG9zZWRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgncWlwYWknLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfd2FubmFUb0NvbXBhcmVfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV93YW5uYVRvQ29tcGFyZV9wdXNoJywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/lvIPniYzpgJrnn6UgZ2FtZV91c2VySW5sb3NlZF9wdXNoXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3VzZXJJbmxvc2VkX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ3FpUGFpX25vdGlmeScsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9teVR1cm5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9teVR1cm5fcHVzaCcsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV90dXJuQ2hhbmdlZF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX3R1cm5DaGFuZ2VkX3B1c2gnLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfdGltZXJJbml0Q291bnRlcl9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX3RpbWVySW5pdENvdW50ZXJfcHVzaCcsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ3VvX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdndW9fbm90aWZ5X3B1c2gnLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfbXlXaW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5oiR6LWi5LqGXHJcbiAgICAgICAgICAgIC8vIHNlbGYuZGlzcGF0Y2hFdmVudCgnd2luJywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lT3Zlcl9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5ri45oiP57uT5p2f5riF6Zmk5a6a5pe25ZmoXHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZU92ZXJfbm90aWZ5X3B1c2gnLCBkYXRhKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9vbmVJbldpbl9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/otaLkuoZcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCd3aW4nLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfYmVnaW5fcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuYnV0dG9uID0gZGF0YTtcclxuICAgICAgICAgICAgc2VsZi50dXJuID0gc2VsZi5idXR0b247XHJcbiAgICAgICAgICAgIHNlbGYuZ2FtZXN0YXRlID0gXCJiZWdpblwiO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfYmVnaW4nLCB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Wmh1OiBkYXRhLmN1cnJlbnRaaHUsXHJcbiAgICAgICAgICAgICAgICB0dXJuOiBkYXRhLnR1cm5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX215TW9uZXlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX215TW9uZXlfcHVzaCcpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX215TW9uZXknLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+ayoemSseS6humAmuefpeWJjeerr++8jOiuqeWFtumAgOWHulxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9ub01vbmV5X2V4aXRcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ25vTW9uZXlfZXhpdCcsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v5oC75rOo6YCa55+lXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX21vbmV5UG9vbF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2dhbWVfbW9uZXlQb29sX3B1c2gnKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9tb25leVBvb2wnLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+i3n+azqOmAmuefpVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2VuWmh1X25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2dlblpodV9ub3RpZnlfcHVzaCcpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnZW5aaHVfbm90aWZ5JywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/nnIvniYzpgJrnn6UgZ2FtZV9vbmVJbkNoZWNrUGFpX3B1c2hcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfb25lSW5DaGVja1BhaV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2dhbWVfb25lSW5DaGVja1BhaV9wdXNoJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2thblBhaV9ub3RpZnknLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+WKoOazqOmAmuefpSBqaWFaaHVfbm90aWZ5X3B1c2hcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImppYVpodV9ub3RpZnlfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdqaWFaaHVfbm90aWZ5X3B1c2gnKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnamlhWmh1X25vdGlmeScsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8v5o+Q56S65raI5oGv6YCa55+lXHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJtZXNzYWdlX25vdGlmeV9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ21lc3NhZ2Vfbm90aWZ5X3B1c2gnKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnbWVzc2FnZV9ub3RpZnknLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvL+i9ruaVsOmAmuefpVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV9jaXJjbGVDb3VudF9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2dhbWVfY2lyY2xlQ291bnRfcHVzaCcpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2NpcmNsZUNvdW50JywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy/mr5TniYznu5PmnpzpgJrnn6UgZ2FtZV91c2VySW5CaXBhaV9yZXN1bHRfcHVzaFxyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV91c2VySW5CaXBhaV9yZXN1bHRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnYW1lX3VzZXJJbkJpcGFpX3Jlc3VsdF9wdXNoJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfdXNlckluQmlwYWlfcmVzdWx0JywgZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX2FjdGlvbkNoYW5nZWRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9hY3Rpb25DaGFuZ2VkX3B1c2gnLCBkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfQW50aVJlc3VsdHNfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9BbnRpUmVzdWx0cycsIGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5hZGRIYW5kbGVyKFwiZ2FtZV91c2VySW5mb0J5SWRfcHVzaFwiLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ2dhbWVfdXNlckluZm9CeUlkJywgZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcIm1hdGNoX2V4aXRfZXJyb3JcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQoJ21hdGNoX2V4aXRfZXJyb3InKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYy52di5uZXQuYWRkSGFuZGxlcihcImdhbWVfZ2FtZUluZm9CeUlkX3B1c2hcIiwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KCdnYW1lX2dhbWVJbmZvQnlJZCcsIGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2MudnYubmV0LmFkZEhhbmRsZXIoXCJnYW1lX3NiSW5BbGxJbl9wdXNoXCIsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudCgnZ2FtZV9zYkluQWxsSW4nLCBkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59KSIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYmxSb29tTm86IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9zZWF0czogW10sXHJcbiAgICAgICAgX3RpbWVMYWJlbDogbnVsbCxcclxuICAgICAgICBfdm9pY2VNc2dRdWV1ZTogW10sXHJcbiAgICAgICAgX2xhc3RQbGF5aW5nU2VhdDogbnVsbCxcclxuICAgICAgICBfcGxheWluZ1NlYXQ6IG51bGwsXHJcbiAgICAgICAgX2xhc3RQbGF5VGltZTogbnVsbCxcclxuICAgICAgICBfc2hhcmVDb250ZW50OiBudWxsLFxyXG4gICAgICAgIHBhaWdyb3VwOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZUF0bGFzXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiYWNrOiBjYy5Ob2RlLFxyXG4gICAgICAgIGZhbmh1aTogY2MuTm9kZSxcclxuICAgICAgICBiZzogY2MuTm9kZSxcclxuICAgICAgICBoZWxwYnRuOiBjYy5Ob2RlLFxyXG4gICAgICAgIGhlbHBzaG93OiBjYy5Ob2RlLFxyXG4gICAgICAgIGFkZHpodWRldGFpbDogbnVsbCxcclxuICAgICAgICBvcHM6IG51bGwsXHJcbiAgICAgICAgemh1b2JqOiBudWxsLFxyXG4gICAgICAgIGZhbjogY2MuTm9kZSxcclxuICAgICAgICBiYWNrQWxlcnQ6IGNjLk5vZGUsXHJcbiAgICAgICAgYmFja0FsZXJ0X25vOiBjYy5Ob2RlLFxyXG4gICAgICAgIGNvdW50ZG93bjogY2MuTGFiZWwsXHJcbiAgICAgICAgX3RpbWU6IC0xLFxyXG4gICAgfSxcclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0cy5wdXNoKGNjLmZpbmQoXCJDYW52YXMvc2VhdFwiICsgaSkuZ2V0Q29tcG9uZW50KFwiempoU2VhdFwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3RpbWVMYWJlbCA9IGNjLmZpbmQoXCJDYW52YXMvdGltZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KFwiUmVDb25uZWN0XCIpO1xyXG4gICAgICAgIHRoaXMuX3podW9taWFuID0gY2MuZmluZChcIkNhbnZhcy96aHVvbWlhblwiKTtcclxuICAgICAgICB0aGlzLnpodW9iaiA9IFsnemh1MCcsICd6aHUxJywgJ3podTInLCAnemh1MycsICd6aHUwX2h1aScsICd6aHUxX2h1aScsICd6aHUyX2h1aScsICd6aHUzX2h1aSddO1xyXG4gICAgICAgIHRoaXMuX2VkaXQgPSBjYy5maW5kKFwiQ2FudmFzL2VkaXRcIik7XHJcbiAgICAgICAgdGhpcy5fZ3JheWthbnBhaSA9IHRoaXMuX2VkaXQuZ2V0Q2hpbGRCeU5hbWUoJ2dyYXlrYW5wYWknKTtcclxuICAgICAgICB0aGlzLl9rYW5wYWkgPSB0aGlzLl9lZGl0LmdldENoaWxkQnlOYW1lKCdrYW5wYWknKTtcclxuICAgICAgICB0aGlzLl9ncmF5Z2Vuemh1ID0gdGhpcy5fZWRpdC5nZXRDaGlsZEJ5TmFtZSgnZ3JheWdlbnpodScpO1xyXG4gICAgICAgIHRoaXMuX2dlbnpodSA9IHRoaXMuX2VkaXQuZ2V0Q2hpbGRCeU5hbWUoJ2dlbnpodScpO1xyXG4gICAgICAgIHRoaXMuX2dyYXlqaWF6aHUgPSB0aGlzLl9lZGl0LmdldENoaWxkQnlOYW1lKCdncmF5amlhemh1Jyk7XHJcbiAgICAgICAgdGhpcy5famlhemh1ID0gdGhpcy5fZWRpdC5nZXRDaGlsZEJ5TmFtZSgnamlhemh1Jyk7XHJcbiAgICAgICAgdGhpcy5fZ3JheXFpcGFpID0gdGhpcy5fZWRpdC5nZXRDaGlsZEJ5TmFtZSgnZ3JheXFpcGFpJyk7XHJcbiAgICAgICAgdGhpcy5fcWlwYWkgPSB0aGlzLl9lZGl0LmdldENoaWxkQnlOYW1lKCdxaXBhaScpO1xyXG4gICAgICAgIHRoaXMuX2dyYXliaXBhaSA9IHRoaXMuX2VkaXQuZ2V0Q2hpbGRCeU5hbWUoJ2dyYXliaXBhaScpO1xyXG4gICAgICAgIHRoaXMuX2JpcGFpID0gdGhpcy5fZWRpdC5nZXRDaGlsZEJ5TmFtZSgnYmlwYWknKTtcclxuICAgICAgICB0aGlzLl9hbGxpbiA9IHRoaXMuX2VkaXQuZ2V0Q2hpbGRCeU5hbWUoJ2FsbGluJyk7XHJcbiAgICAgICAgdGhpcy5fYWxsWmh1TGFiZWwgPSBjYy5maW5kKFwiQ2FudmFzL3pvbmd4aWF6aHUvbGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTsgLy/niYzmoYzkuIrmiYDmnInnmoTms6hcclxuICAgICAgICB0aGlzLl96aHUgPSBjYy5maW5kKFwiQ2FudmFzL3podVwiKTsgLy/liqDms6jnlYzpnaJcclxuICAgICAgICB0aGlzLl9kYW56aHUgPSBjYy5maW5kKFwiQ2FudmFzL2RhbnpodVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpOyAvL+WNleazqOaYvuekulxyXG4gICAgICAgIHRoaXMuX2x1bnNodSA9IGNjLmZpbmQoXCJDYW52YXMvbHVuc2h1XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7IC8v6L2u5pWw5pi+56S6XHJcbiAgICAgICAgdGhpcy5fcGtQYW5lbCA9IGNjLmZpbmQoXCJDYW52YXMvcGtcIik7IC8vcGvnlYzpnaJcclxuICAgICAgICB0aGlzLl9mbGFzaEFuaW0gPSBjYy5maW5kKFwiQ2FudmFzL3BrL3NoYW5kaWFuL3BrX3NoYW5kaWFuXCIpLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pOyAvL+mXqueUteWKqOeUu1xyXG4gICAgICAgIHRoaXMuX2JpcGFpQW5pbSA9IGNjLmZpbmQoXCJDYW52YXMvcGsvYmlwYWlcIikuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7IC8v5q+U54mM5Yqo55S7XHJcbiAgICAgICAgdGhpcy5fbGVmdExpZSA9IHRoaXMuX3BrUGFuZWwuZ2V0Q2hpbGRCeU5hbWUoJ2xlZnRMaWUnKTtcclxuICAgICAgICB0aGlzLl9yaWdodExpZSA9IHRoaXMuX3BrUGFuZWwuZ2V0Q2hpbGRCeU5hbWUoJ3JpZ2h0TGllJyk7XHJcbiAgICAgICAgdGhpcy5fdGlwcyA9IGNjLmZpbmQoXCJDYW52YXMvdGlwc1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpOyAvL3RpcHPmmL7npLpcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX2thbnBhaSwgdGhpcy5ub2RlLCBcImFsbFwiLCBcImthbnBhaVwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuYmFjaywgdGhpcy5ub2RlLCBcImFsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuZmFuaHVpLCB0aGlzLm5vZGUsIFwiYWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5mYW4sIHRoaXMubm9kZSwgXCJhbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLmJnLCB0aGlzLm5vZGUsIFwiYWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5oZWxwYnRuLCB0aGlzLm5vZGUsIFwiYWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5oZWxwc2hvdywgdGhpcy5ub2RlLCBcImFsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuYmFja0FsZXJ0X25vLCB0aGlzLm5vZGUsIFwiYWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fcWlwYWksIHRoaXMubm9kZSwgXCJhbGxcIiwgXCJxaXBhaVwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX2JpcGFpLCB0aGlzLm5vZGUsIFwiYWxsXCIsIFwiYmlwYWlcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9nZW56aHUsIHRoaXMubm9kZSwgXCJhbGxcIiwgXCJnZW56aHVcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9qaWF6aHUsIHRoaXMubm9kZSwgXCJhbGxcIiwgXCJqaWF6aHVcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChjYy5maW5kKCdDYW52YXMvemh1L3podTAnKSwgdGhpcy5ub2RlLCBcImFsbFwiLCBcImFkZHpodVwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KGNjLmZpbmQoJ0NhbnZhcy96aHUvemh1MScpLCB0aGlzLm5vZGUsIFwiYWxsXCIsIFwiYWRkemh1XCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQoY2MuZmluZCgnQ2FudmFzL3podS96aHUyJyksIHRoaXMubm9kZSwgXCJhbGxcIiwgXCJhZGR6aHVcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudChjYy5maW5kKCdDYW52YXMvemh1L3podTMnKSwgdGhpcy5ub2RlLCBcImFsbFwiLCBcImFkZHpodVwiKTtcclxuICAgICAgICB0aGlzLmluaXRWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0U2VhdHMoKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudEhhbmRsZXJzKCk7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJnZXRVc2VySW5mb0J5VXNlcmlkXCIpO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZ2V0R2FtZUluZm9CeVVzZXJpZFwiKTtcclxuICAgICAgICBjYy52di5uZXQuc2VuZChcInJlYWR5XCIpO1xyXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlCR00oXCJiYWNrLm1wM1wiKTtcclxuICAgIH0sXHJcbiAgICBpbml0VmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fa2FucGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3FpcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2dlbnpodS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9hbGxpbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9qaWF6aHUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYmlwYWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fcGtQYW5lbC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl96aHVvbWlhbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl90aXBzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBmcmVzaFVzZXJJbmZvOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+iOt+WPluaWree6v+mHjei/nuWQjueahOeUqOaIt+S/oeaBrycsIGRhdGEpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCAzOyB0KyspIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIGkgKyAnL2Z1cGFpJyArIHQpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9kYW56aHVcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBjYy5maW5kKFwiQ2FudmFzL2x1bnNodVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvem9uZ3hpYXpodVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYuX3RpcHMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBzZWxmLmNvdW50ZG93bi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYuX2thbnBhaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYuX3FpcGFpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgc2VsZi5fZ2Vuemh1LmFjdGl2ZSA9IGRhdGEuY2FuR2Vuemh1O1xyXG4gICAgICAgIHNlbGYuX2ppYXpodS5hY3RpdmUgPSBkYXRhLmNhbkFkZFpodTtcclxuICAgICAgICBzZWxmLl9iaXBhaS5hY3RpdmUgPSBkYXRhLmNhbkJpUGFpO1xyXG4gICAgICAgIHNlbGYub3BzID0gZGF0YS54aWFaaHVPcHRpb25zO1xyXG4gICAgICAgIHZhciBob2xkcyA9IGRhdGEuaG9sZHM7XHJcbiAgICAgICAgaWYgKGhvbGRzICYmIGhvbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1swXTtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZUZyYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlRnJhbWVzLnB1c2goc2VsZi5nZXRwYWlSZXMoaG9sZHNbaV0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWF0LmZhblBhaShzcHJpdGVGcmFtZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBmcmVzaEdhbWVJbmZvOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+iOt+WPluaWree6v+mHjei/nuWQjueahOa4uOaIj+S/oeaBrycsIGRhdGEpO1xyXG4gICAgICAgIGlmICh0aGlzLm9wcykge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZnJlc2hDdXJyZW50Wmh1KGRhdGEuY3VycmVudFpodSk7XHJcbiAgICAgICAgICAgIHRoaXMuZnJlc2hDaXJjbGVDb3VudChkYXRhLmNpcmNsZUNvdW50KTtcclxuICAgICAgICAgICAgdGhpcy5femh1b21pYW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIHRvdGFsID0gZGF0YS5tb25leVBvb2w7XHJcbiAgICAgICAgICAgIHNlbGYuX2FsbFpodUxhYmVsLnN0cmluZyA9IHRvdGFsOyAvL+aAu+aVsFxyXG4gICAgICAgICAgICAvL2ZyZXNo5YW25LuW5Lq655qE5pWw5o2uXHJcbiAgICAgICAgICAgIHZhciBjb21tb25JbmZvID0gZGF0YS5wbGF5ZXJzO1xyXG4gICAgICAgICAgICB2YXIgYWxsWmh1ID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gY29tbW9uSW5mbykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBjb21tb25JbmZvW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJpZCA9IHRlbXAudXNlcmlkO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvc3RNb25leSA9IHRlbXAuY29zdE1vbmV5OyAvL+S4i+eahOazqFxyXG4gICAgICAgICAgICAgICAgdmFyIG1vbmV5ID0gdGVtcC5tb25leTsgLy/miYDmnInnlKjnmoTpkrFcclxuICAgICAgICAgICAgICAgIC8v5Yi35paw6L+Z5Liq5Lq655qE5L+h5oGvXHJcbiAgICAgICAgICAgICAgICB2YXIgc2VhdEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKHVzZXJpZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChzZWF0SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICAgICAgICAgIHNlYXQuc2V0Q29zdE1vbmV5KGNvc3RNb25leSk7XHJcbiAgICAgICAgICAgICAgICBzZWF0LnNldE1vbmV5KG1vbmV5KTtcclxuICAgICAgICAgICAgICAgIHZhciBjb3N0QXJyID0gdGVtcC5jb3N0QXJyO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiBpbiBjb3N0QXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxsWmh1LnB1c2goY29zdEFycltqXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/mt7vliqDmoYzpnaLkuIrnmoTms6hcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBhbGxaaHUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB6aHUgPSBhbGxaaHVbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IHNlbGYuX3podW9taWFuLmNoaWxkcmVuWzBdO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld05vZGUgPSBjYy5pbnN0YW50aWF0ZShub2RlKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3podW9taWFuLmFkZENoaWxkKG5ld05vZGUpO1xyXG4gICAgICAgICAgICAgICAgbmV3Tm9kZS5nZXRDaGlsZEJ5TmFtZSgnbGFiZWwnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGNjLnZ2LnV0aWxzLnNob3dKaW5iaSh6aHUsICdXJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgemh1TGV2ZWwgPSBzZWxmLmdldFpodUxldmVsKHpodSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgemh1T2JqID0gY2MuZmluZCgnQ2FudmFzL3podS8nICsgc2VsZi56aHVvYmpbemh1TGV2ZWxdKTtcclxuICAgICAgICAgICAgICAgIHZhciB6aHVGcmFtZUNvcHkgPSB6aHVPYmouZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWU7XHJcbiAgICAgICAgICAgICAgICBuZXdOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gemh1RnJhbWVDb3B5O1xyXG4gICAgICAgICAgICAgICAgbmV3Tm9kZS54ID0gTWF0aC5yYW5kb20oKSAqIDIwMDtcclxuICAgICAgICAgICAgICAgIG5ld05vZGUueSA9IE1hdGgucmFuZG9tKCkgKiAyMDA7XHJcbiAgICAgICAgICAgICAgICBuZXdOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0Wmh1TGV2ZWw6IGZ1bmN0aW9uKHpodSkge1xyXG4gICAgICAgIHZhciBvcHMgPSB0aGlzLm9wcztcclxuICAgICAgICB2YXIgemh1TGV2ZWwgPSBudWxsO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gb3BzKSB7XHJcbiAgICAgICAgICAgIGlmIChwYXJzZUludChvcHNbaV0pID09IHBhcnNlSW50KHpodSkpIHtcclxuICAgICAgICAgICAgICAgIHpodUxldmVsID0gaTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh6aHVMZXZlbCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gb3BzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQob3BzW2ldKSA9PSBwYXJzZUludCh6aHUpICogMC41KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgemh1TGV2ZWwgPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh6aHVMZXZlbCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gb3BzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQob3BzW2ldKSA9PSBwYXJzZUludCh6aHUpICogMikge1xyXG4gICAgICAgICAgICAgICAgICAgIHpodUxldmVsID0gaTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gemh1TGV2ZWw7XHJcbiAgICB9LFxyXG4gICAgcmVmcmVzaEJ0bnM6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCAzOyB0KyspIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIGkgKyAnL2Z1cGFpJyArIHQpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9kYW56aHVcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBjYy5maW5kKFwiQ2FudmFzL2x1bnNodVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvem9uZ3hpYXpodVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3RpcHMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvdW50ZG93bi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZnJlc2hDdXJyZW50Wmh1KGRhdGEuY3VycmVudFpodSk7XHJcbiAgICAgICAgdGhpcy5mcmVzaENpcmNsZUNvdW50KGRhdGEudHVybik7XHJcbiAgICAgICAgdGhpcy5fa2FucGFpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fcWlwYWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9nZW56aHUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5famlhemh1LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2JpcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2hvd1hpYURpWmh1QW5pbShkYXRhLmN1cnJlbnRaaHUpOyAvL+S4i+W6leazqOWKqOeUu1xyXG4gICAgfSxcclxuICAgIHNob3dYaWFEaVpodUFuaW06IGZ1bmN0aW9uKGN1cnJlbnRaaHUpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW5fYmFvbGl1ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLl96aHVvbWlhbi5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDUpIHtcclxuICAgICAgICAgICAgICAgIC8v5Y+q55WZNeS4quW6leazqOeahOetueeggVxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW5fYmFvbGl1LnB1c2godGhpcy5femh1b21pYW4uY2hpbGRyZW5baV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3podW9taWFuLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl96aHVvbWlhbi5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIGZvciAodmFyIGogaW4gY2hpbGRyZW5fYmFvbGl1KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3podW9taWFuLmFkZENoaWxkKGNoaWxkcmVuX2Jhb2xpdVtqXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3podW9taWFuLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIGFkZE1vbmV5ID0gMTAwO1xyXG4gICAgICAgIGlmIChjdXJyZW50Wmh1KSB7XHJcbiAgICAgICAgICAgIGFkZE1vbmV5ID0gcGFyc2VJbnQoY3VycmVudFpodSkgKiAwLjU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGsgaW4gdGhpcy5fc2VhdHMpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9zZWF0c1trXS5fdXNlck5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIHg6IHRoaXMuX3NlYXRzW2tdLm5vZGUueCxcclxuICAgICAgICAgICAgICAgIHk6IHRoaXMuX3NlYXRzW2tdLm5vZGUueSxcclxuICAgICAgICAgICAgICAgIGFkZE1vbmV5OiBhZGRNb25leSxcclxuICAgICAgICAgICAgICAgIGFkZE1vbmV5TGV2ZWw6IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNob3daaHVBbmltKGRhdGEsIGspO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0RXZlbnRIYW5kbGVyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5kYXRhRXZlbnRIYW5kbGVyID0gdGhpcy5ub2RlO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm5vZGUub24oJ25ld191c2VyJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmluaXRTaW5nbGVTZWF0KGRhdGEuZGV0YWlsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3VzZXJfc3RhdGVfY2hhbmdlZCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5pbml0U2luZ2xlU2VhdChkYXRhLmRldGFpbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2JlZ2luJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLnJlZnJlc2hCdG5zKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICAgICAgLy8gc2VsZi5pbml0U2VhdHMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfbnVtJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvLyBzZWxmLnJlZnJlc2hCdG5zKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCd2b2ljZV9tc2cnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHNlbGYuX3ZvaWNlTXNnUXVldWUucHVzaChkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5wbGF5Vm9pY2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2NoYXRfcHVzaCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIGlkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLnNlbmRlcik7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbElkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChpZHgpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uY2hhdChkYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbigncXVpY2tfY2hhdF9wdXNoJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4WkpIKGlkeCk7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGRhdGEuY29udGVudDtcclxuICAgICAgICAgICAgdmFyIGluZm8gPSBjYy52di56amhjaGF0LmdldFF1aWNrQ2hhdEluZm8oaW5kZXgpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uY2hhdChpbmZvLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5wbGF5U0ZYKGluZm8uc291bmQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZW1vamlfcHVzaCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIGlkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLnNlbmRlcik7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbElkeCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChpZHgpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uZW1vamkoZGF0YS5jb250ZW50KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2thbnBhaScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZXZlbnQuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaG9sZHMgPSBkYXRhLmhvbGRzO1xyXG4gICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuX3NlYXRzWzBdO1xyXG4gICAgICAgICAgICB2YXIgc3ByaXRlRnJhbWVzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBzcHJpdGVGcmFtZXMucHVzaChzZWxmLmdldHBhaVJlcyhob2xkc1tpXSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlYXQuZmFuUGFpKHNwcml0ZUZyYW1lcyk7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50Wmh1ID0gZGF0YS5jdXJyZW50Wmh1O1xyXG4gICAgICAgICAgICBzZWxmLl9nZW56aHUuZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY2MudnYudXRpbHMuc2hvd0ppbmJpKGN1cnJlbnRaaHUsICdXJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdxaXBhaScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZXZlbnQuZGV0YWlsO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ3NodScpIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0MC9zaHVpY29uJykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0MC9xaWljb24nKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX2dyYXlxaXBhaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxmLl9xaXBhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIGhvbGRzID0gZGF0YS5ob2xkcztcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1swXTtcclxuICAgICAgICAgICAgdmFyIHNwcml0ZUZyYW1lcyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlRnJhbWVzLnB1c2goc2VsZi5nZXRwYWlSZXMoaG9sZHNbaV0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWF0LmZhblBhaShzcHJpdGVGcmFtZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9teVR1cm5fcHVzaCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZXZlbnQuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLmFkZHpodWRldGFpbCA9IGRhdGEueGlhWmh1T3B0aW9ucztcclxuICAgICAgICAgICAgc2VsZi5vcHMgPSBkYXRhLnhpYVpodUV4dHJhLm9wcztcclxuICAgICAgICAgICAgLy/lj6/mk43kvZzmjInpkq5cclxuICAgICAgICAgICAgaWYgKGRhdGEuY2FuQWRkWmh1KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9qaWF6aHUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGF0YS5jYW5HZW56aHUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX2dlbnpodS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRaaHUgPSBkYXRhLmN1cnJlbnRaaHU7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEuaGFzQ2hlY2tlZFBhaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8v5pqX5rOoXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFpodSA9IGN1cnJlbnRaaHUgKiAwLjU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9nZW56aHUuZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY2MudnYudXRpbHMuc2hvd0ppbmJpKGN1cnJlbnRaaHUsICdXJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRhdGEuY2FuQmlQYWkpIHtcclxuICAgICAgICAgICAgICAgIC8v5ruh6Laz5q+U54mM5p2h5Lu2XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9iaXBhaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmFsbEluRmxhZykge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fYWxsaW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGYuX2dyYXlnZW56aHUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9hbGxpbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZU92ZXJfbm90aWZ5X3B1c2gnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQoZXZlbnQuZGV0YWlsKSk7XHJcbiAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIGkgKyAnL3RvZ2dsZScpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV90dXJuQ2hhbmdlZF9wdXNoJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGV2ZW50LmRldGFpbCkpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IDU7IHQrKykge1xyXG4gICAgICAgICAgICAgICAgY2MuZmluZCgnQ2FudmFzL3NlYXQnICsgdCArICcvdG9nZ2xlJykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MuZmluZCgnQ2FudmFzL3NlYXQnICsgaSArICcvdG9nZ2xlJykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbaV0uc2V0VGltZSgpO1xyXG4gICAgICAgICAgICBpZiAoaSAhPSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvL+WmguaenOayoeaciei9ruWIsOiHquW3seaTjeS9nFxyXG4gICAgICAgICAgICAgICAgc2VsZi5fZ2Vuemh1LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5famlhemh1LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fYmlwYWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl96aHUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfdGltZXJJbml0Q291bnRlcl9wdXNoJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJseTp0aW1lciBjb3VudGVyIGJlZ2luXCIpO1xyXG4gICAgICAgICAgICB2YXIgaSA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQoZXZlbnQuZGV0YWlsKSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgNTsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5maW5kKCdDYW52YXMvc2VhdCcgKyB0ICsgJy90b2dnbGUnKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy5maW5kKCdDYW52YXMvc2VhdCcgKyBpICsgJy90b2dnbGUnKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpXS5zZXRUaW1lKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2FjdGlvbkNoYW5nZWRfcHVzaCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBicCA9IGNjLmZpbmQoJ0NhbnZhcy9lZGl0L2JpcGFpJyk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZXZlbnQuZGV0YWlsO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS54aWFaaHVPcHRpb25zKSBzZWxmLmFkZHpodWRldGFpbCA9IGRhdGEueGlhWmh1T3B0aW9ucztcclxuICAgICAgICAgICAgaWYgKGRhdGEueGlhWmh1RXh0cmEub3BzKSBzZWxmLm9wcyA9IGRhdGEueGlhWmh1RXh0cmEub3BzO1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuZGV0YWlsLmNhbkJpUGFpKSB7XHJcbiAgICAgICAgICAgICAgICBicC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYnAuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2d1b19ub3RpZnlfcHVzaCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0MC90b2dnbGUnKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dlblpodV9ub3RpZnknLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgdXNlcmlkID0gZXZlbnQuZGV0YWlsLnVzZXJpZDtcclxuICAgICAgICAgICAgdmFyIHNlYXRJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRCh1c2VyaWQpO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChzZWF0SW5kZXgpO1xyXG4gICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICBzZWF0LnNob3dHZW5aaHUoKTtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRaaHUgPSBldmVudC5kZXRhaWwuY3VycmVudFpodTtcclxuICAgICAgICAgICAgdmFyIGhhc0NoZWNrZWRQYWkgPSBldmVudC5kZXRhaWwuaGFzQ2hlY2tlZFBhaTtcclxuICAgICAgICAgICAgdmFyIGFkZE1vbmV5ID0gZXZlbnQuZGV0YWlsLmFkZE1vbmV5O1xyXG4gICAgICAgICAgICB2YXIgYWRkTW9uZXlMZXZlbCA9IGV2ZW50LmRldGFpbC5hZGRNb25leUxldmVsO1xyXG4gICAgICAgICAgICBzZWxmLmZyZXNoQ3VycmVudFpodShjdXJyZW50Wmh1KTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBzZWF0Lm5vZGUueCxcclxuICAgICAgICAgICAgICAgIHk6IHNlYXQubm9kZS55LFxyXG4gICAgICAgICAgICAgICAgYWRkTW9uZXk6IGFkZE1vbmV5LFxyXG4gICAgICAgICAgICAgICAgYWRkTW9uZXlMZXZlbDogYWRkTW9uZXlMZXZlbCxcclxuICAgICAgICAgICAgICAgIGhhc0NoZWNrZWRQYWk6IGhhc0NoZWNrZWRQYWlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLnNob3daaHVBbmltKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbigna2FuUGFpX25vdGlmeScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VyaWQgPSBldmVudC5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWRaSkgodXNlcmlkKTtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICAgICAgc2VhdC5zaG93S2FuUGFpKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdqaWFaaHVfbm90aWZ5JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIHVzZXJpZCA9IGV2ZW50LmRldGFpbC51c2VyaWQ7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWRaSkgodXNlcmlkKTtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICAgICAgc2VhdC5zaG93SmlhWmh1KCk7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50Wmh1ID0gZXZlbnQuZGV0YWlsLmN1cnJlbnRaaHU7XHJcbiAgICAgICAgICAgIHZhciBoYXNDaGVja2VkUGFpID0gZXZlbnQuZGV0YWlsLmhhc0NoZWNrZWRQYWk7XHJcbiAgICAgICAgICAgIHZhciBhZGRNb25leSA9IGV2ZW50LmRldGFpbC5hZGRNb25leTtcclxuICAgICAgICAgICAgdmFyIGFkZE1vbmV5TGV2ZWwgPSBldmVudC5kZXRhaWwuYWRkTW9uZXlMZXZlbDtcclxuICAgICAgICAgICAgc2VsZi5mcmVzaEN1cnJlbnRaaHUoY3VycmVudFpodSk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgeDogc2VhdC5ub2RlLngsXHJcbiAgICAgICAgICAgICAgICB5OiBzZWF0Lm5vZGUueSxcclxuICAgICAgICAgICAgICAgIGFkZE1vbmV5OiBhZGRNb25leSxcclxuICAgICAgICAgICAgICAgIGFkZE1vbmV5TGV2ZWw6IGFkZE1vbmV5TGV2ZWwsXHJcbiAgICAgICAgICAgICAgICBoYXNDaGVja2VkUGFpOiBoYXNDaGVja2VkUGFpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5zaG93Wmh1QW5pbShkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3FpUGFpX25vdGlmeScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZXZlbnQuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgdXNlcmlkID0gZGF0YS51c2VySWQ7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWRaSkgodXNlcmlkKTtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICAgICAgc2VhdC5zaG93UWlQYWkoZGF0YS5zdGF0dXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignd2luJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+i1ouS6huS4gOWxgFxyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn6LWi5LqG5LiA5bGAJywgZGF0YSk7XHJcbiAgICAgICAgICAgIC8v6LWi55qE5Lq65pi+56S65omL54mMXHJcbiAgICAgICAgICAgIHZhciB1c2VyaWQgPSBkYXRhLndpbmVyO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkWkpIKHVzZXJpZCk7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5fc2VhdHNbbG9jYWxJbmRleF07XHJcbiAgICAgICAgICAgIHZhciBob2xkcyA9IGRhdGEuaG9sZHM7XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGVGcmFtZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHNwcml0ZUZyYW1lcy5wdXNoKHNlbGYuZ2V0cGFpUmVzKGhvbGRzW2ldKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VhdC5mYW5QYWkoc3ByaXRlRnJhbWVzKTtcclxuICAgICAgICAgICAgLy/otaLkuobnmoTliqjnlLtcclxuICAgICAgICAgICAgc2VsZi5lbmREYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgc2VsZi5pc0VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICghc2VsZi5fcGtQYW5lbC5hY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2hvd0VuZEFuaW0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9tb25leVBvb2wnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5Yi35paw5oC75rOoXHJcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIHRvdGFsID0gZGF0YS5tb25leVBvb2w7XHJcbiAgICAgICAgICAgIHNlbGYuX2FsbFpodUxhYmVsLnN0cmluZyA9IHRvdGFsOyAvL+aAu+aVsFxyXG4gICAgICAgICAgICAvL2ZyZXNo5YW25LuW5Lq655qE5pWw5o2uXHJcbiAgICAgICAgICAgIHZhciBjb21tb25JbmZvID0gZGF0YS5jb21tb25JbmZvO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIGNvbW1vbkluZm8pIHtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VyaWQgPSBpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBjb21tb25JbmZvW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvc3RNb25leSA9IHRlbXAuY29zdE1vbmV5OyAvL+S4i+eahOazqFxyXG4gICAgICAgICAgICAgICAgdmFyIG1vbmV5ID0gdGVtcC5tb25leTsgLy/miYDmnInnlKjnmoTpkrFcclxuICAgICAgICAgICAgICAgIC8v5Yi35paw6L+Z5Liq5Lq655qE5L+h5oGvXHJcbiAgICAgICAgICAgICAgICB2YXIgc2VhdEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKHVzZXJpZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChzZWF0SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlYXRzID0gY2MudnYuZ2FtZU5ldE1nci5zZWF0cztcclxuICAgICAgICAgICAgICAgIHNlYXRzW3NlYXRJbmRleF0uc2NvcmUgPSBtb25leTtcclxuICAgICAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5fc2VhdHNbbG9jYWxJbmRleF07XHJcbiAgICAgICAgICAgICAgICBzZWF0LnNldENvc3RNb25leShjb3N0TW9uZXkpO1xyXG4gICAgICAgICAgICAgICAgc2VhdC5zZXRNb25leShtb25leSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ21lc3NhZ2Vfbm90aWZ5JywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+a2iOaBr+aYvuekulxyXG4gICAgICAgICAgICBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gZGF0YS5tZXNzYWdlO1xyXG4gICAgICAgICAgICBjYy52di5hbGVydC5zaG93KFwi5rOo5oSPXCIsIG1lc3NhZ2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9jaXJjbGVDb3VudCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/liLfmlrDova7mlbBcclxuICAgICAgICAgICAgdmFyIGNpcmNsZUNvdW50ID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHNlbGYuZnJlc2hDaXJjbGVDb3VudChjaXJjbGVDb3VudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdjbGlja1BrQnV0dG9uJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgdXNlcklkMiA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLmNsaWNrUGtCdXR0b24odXNlcklkMik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX3VzZXJJbkJpcGFpX3Jlc3VsdCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgd2luZXIgPSBkYXRhLndpbmVyO1xyXG4gICAgICAgICAgICB2YXIgbG9zZXIgPSBkYXRhLmxvc2VyO1xyXG4gICAgICAgICAgICBzZWxmLmJpcGFpQW5pbVF1ZXVlID0gW3tcclxuICAgICAgICAgICAgICAgIHdpbmVyOiB3aW5lcixcclxuICAgICAgICAgICAgICAgIGxvc2VyOiBsb3NlclxyXG4gICAgICAgICAgICB9XTsgLy/mr5TniYzpmJ/liJdcclxuICAgICAgICAgICAgc2VsZi5iaXBhaUFuaW1JbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHNlbGYuc2hvd0JpcGFpQW5pbSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV93YW5uYVRvQ29tcGFyZV9wdXNoJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIGlmICghZGF0YSB8fCBkYXRhLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RpcHMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLl90aXBzLnN0cmluZyA9IFwi6K+36YCJ5oup5q+U54mM546p5a62XCI7XHJcbiAgICAgICAgICAgIHNlbGYuX3RpcHMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VyaWQgPSBkYXRhW2ldLnVzZXJpZDtcclxuICAgICAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQodXNlcmlkKTtcclxuICAgICAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4WkpIKHNlYXRJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgc2VhdC5zaG93UGtCdXR0b24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignY291bnRfZG93bicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX3RpcHMubm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RpcHMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLmNvdW50ZG93bi5zdHJpbmcgPSBkYXRhLmNvdW50RG93bjtcclxuICAgICAgICAgICAgc2VsZi5jb3VudGRvd24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5jb3VudERvd24gPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jb3VudGRvd24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9BbnRpUmVzdWx0cycsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/mnIDlkI7kuIDova7nmoTmr5TniYxcclxuICAgICAgICAgICAgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLmJpcGFpQW5pbVF1ZXVlID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJpcGFpRGF0YSA9IGRhdGFbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgd2luZXIgPSBiaXBhaURhdGFbJ3dpblVzZXJpZCddO1xyXG4gICAgICAgICAgICAgICAgdmFyIGxvc2VyID0gYmlwYWlEYXRhWydsb3NlVXNlcmlkJ107XHJcbiAgICAgICAgICAgICAgICBzZWxmLmJpcGFpQW5pbVF1ZXVlLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmVyOiB3aW5lcixcclxuICAgICAgICAgICAgICAgICAgICBsb3NlcjogbG9zZXJcclxuICAgICAgICAgICAgICAgIH0pOyAvL+avlOeJjOmYn+WIl1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuYmlwYWlBbmltSW5kZXggPSAwO1xyXG4gICAgICAgICAgICBzZWxmLnNob3dCaXBhaUFuaW0oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfdXNlckluZm9CeUlkJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+iOt+WPluaWree6v+mHjei/nuWQjueahOeUqOaIt+S/oeaBr1xyXG4gICAgICAgICAgICBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHNlbGYuZnJlc2hVc2VySW5mbyhkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfZ2FtZUluZm9CeUlkJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+iOt+WPluaWree6v+mHjei/nuWQjueahOa4uOaIj+S/oeaBr1xyXG4gICAgICAgICAgICBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHNlbGYuZnJlc2hHYW1lSW5mbyhkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2V4aXRfcm9vbScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/liLfmlrDnlKjmiLfpkrHluIHmlbDph49cclxuICAgICAgICAgICAgc2VsZi5nZXRHZW1zQW5kQ29pbnMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ25vTW9uZXlfZXhpdCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/mj5DnpLrph5HpkrHkuI3otrNcclxuICAgICAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIuaPkOekulwiLCBcIumHkemSseS4jei2s++8jOaCqOWwhumAgOWHuuaIv+mXtO+8jOivt+WcqOa0u+WKqOmihuWPluavj+aXpemHkeW4geihpeWKqVwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ21hdGNoX2V4aXRfZXJyb3InLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v6ZSm5qCH6LWb5LiN6IO96YCA5Ye65ri45oiPXHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLplKbmoIfotZvkuK3kuI3og73pgIDlh7rmuLjmiI9cIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX3NiSW5BbGxJbicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/mnInkurphbGxpbuS6hlxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZ2FtZV9zYkluQWxsSW49PT09PT4nLCBkYXRhLmRldGFpbCk7XHJcbiAgICAgICAgICAgIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5kb0FsbGluKGRhdGEsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoJ2FsbEluQWN0aXZlRnJvbUNsaWVudCcpOyAvL+inpuWPkeS4i+S4gOatpVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfSxcclxuICAgIC8v6K6+572u6YeR5biB6ZK755+z5pWw6YePXHJcbiAgICBnZXRHZW1zQW5kQ29pbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjYy52di51c2VyTWdyLmdldEdlbXNBbmRDb2lucyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2VtcyA9IGRhdGEuZ2VtcztcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5jb2lucyA9IGRhdGEuY29pbnM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgaW5pdFNlYXRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5nYW1lTmV0TWdyLnNlYXRzO1xyXG4gICAgICAgIGlmICghc2VhdHMpIHJldHVybjtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdFNpbmdsZVNlYXQoc2VhdHNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBpbml0U2luZ2xlU2VhdDogZnVuY3Rpb24oc2VhdCkge1xyXG4gICAgICAgIHZhciBpbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChzZWF0LnNlYXRpbmRleCk7XHJcbiAgICAgICAgdmFyIGlzT2ZmbGluZSA9ICFzZWF0Lm9ubGluZTtcclxuICAgICAgICAvLyB2YXIgaXNaaHVhbmcgPSBzZWF0LnNlYXRpbmRleCA9PSBjYy52di5nYW1lTmV0TWdyLmJ1dHRvbjtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0SW5mbyhzZWF0Lm5hbWUsIHNlYXQuc2NvcmUpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRSZWFkeShzZWF0LnJlYWR5KTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0T2ZmbGluZShpc09mZmxpbmUpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRJRChzZWF0LnVzZXJpZCk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnZvaWNlTXNnKGZhbHNlKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0blNldHRpbmdzQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYucG9wdXBNZ3Iuc2hvd1NldHRpbmdzKCk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5CYWNrQ2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuYWxlcnQuc2hvdyhcIui/lOWbnuWkp+WOhVwiLCBcIui/lOWbnuWkp+WOheaIv+mXtOS7jeS8muS/neeVme+8jOW/q+WOu+mCgOivt+Wkp+S8meadpeeOqeWQp++8gVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiaGFsbFwiKTtcclxuICAgICAgICB9LCB0cnVlKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkNoYXRDbGlja2VkOiBmdW5jdGlvbigpIHt9LFxyXG4gICAgLy8g54K55Ye75YiG5Lqr5oyJ6ZKu77yM5L2/55So5b6u5L+h5YiG5LqrXHJcbiAgICBvbkJ0bldlaWNoYXRDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5zaGFyZS5zaG93KCk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5EaXNzb2x2ZUNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLop6PmlaPmiL/pl7RcIiwgXCLop6PmlaPmiL/pl7TkuI3miaPph5HluIHvvIzmmK/lkKbnoa7lrprop6PmlaPvvJ9cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZGlzcHJlc3NcIik7XHJcbiAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5FeGl0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmJhY2tBbGVydC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBjYy52di5uZXQuc2VuZChcImV4aXRcIik7XHJcbiAgICB9LFxyXG4gICAgb25CdG5FeGNoYW5nZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5iYWNrQWxlcnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgY2MudnYudXNlck1nci5leGNoYW5nZSA9IDE7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJleGl0XCIpO1xyXG4gICAgfSxcclxuICAgIHBsYXlWb2ljZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BsYXlpbmdTZWF0ID09IG51bGwgJiYgdGhpcy5fdm9pY2VNc2dRdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJwbGF5Vm9pY2VcIik7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fdm9pY2VNc2dRdWV1ZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoaWR4KTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWluZ1NlYXQgPSBsb2NhbEluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyh0cnVlKTtcclxuICAgICAgICAgICAgdmFyIG1zZ0luZm8gPSBKU09OLnBhcnNlKGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgICAgIHZhciBtc2dmaWxlID0gXCJ2b2ljZW1zZy5hbXJcIjtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdFBsYXlUaW1lID0gRGF0ZS5ub3coKSArIG1zZ0luZm8udGltZTtcclxuICAgICAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJpZCA9IG1zZ0luZm9bJ21zZyddO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmRvd25sb2FkVm9pY2Uoc2VydmVyaWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLndyaXRlVm9pY2UobXNnZmlsZSwgbXNnSW5mby5tc2cpO1xyXG4gICAgICAgICAgICBjYy52di52b2ljZU1nci5wbGF5KG1zZ2ZpbGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge1xyXG4gICAgICAgIGlmICh3aW5kb3cudm9pY2UgJiYgd2luZG93LnZvaWNlLmxvY2FsSWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJZCA9IHdpbmRvdy52b2ljZS5sb2NhbElkO1xyXG4gICAgICAgICAgICB3aW5kb3cudm9pY2UubG9jYWxJZCA9IG51bGw7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBhdXNlQWxsKCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5wbGF5Vm9pY2UobG9jYWxJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCAvIDYwKTtcclxuICAgICAgICBpZiAodGhpcy5fbGFzdE1pbnV0ZSAhPSBtaW51dGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xhc3RNaW51dGUgPSBtaW51dGVzO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgIHZhciBoID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICBoID0gaCA8IDEwID8gXCIwXCIgKyBoIDogaDtcclxuICAgICAgICAgICAgdmFyIG0gPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgbSA9IG0gPCAxMCA/IFwiMFwiICsgbSA6IG07XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBcIlwiICsgaCArIFwiOlwiICsgbTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RQbGF5VGltZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChEYXRlLm5vdygpID4gdGhpcy5fbGFzdFBsYXlUaW1lICsgMjAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uUGxheWVyT3ZlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFBsYXlUaW1lID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheVZvaWNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uUGxheWVyT3ZlcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgd2luZG93LnN0b3BQbGF5Vm9pY2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnJlc3VtZUFsbCgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwib25QbGF5Q2FsbGJhY2s6XCIgKyB0aGlzLl9wbGF5aW5nU2VhdCk7XHJcbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSB0aGlzLl9wbGF5aW5nU2VhdDtcclxuICAgICAgICB0aGlzLl9wbGF5aW5nU2VhdCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fc2VhdHNbbG9jYWxJbmRleF0udm9pY2VNc2coZmFsc2UpO1xyXG4gICAgfSxcclxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYudm9pY2VNZ3Iuc3RvcCgpO1xyXG4gICAgICAgIC8vICAgICAgICBjYy52di52b2ljZU1nci5vblBsYXlDYWxsYmFjayA9IG51bGw7XHJcbiAgICB9LFxyXG4gICAgLy/ngrnlh7vnnIvniYzmjInpkq5cclxuICAgIGthbnBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoJ2thbnBhaScpO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye75Yqg5rOo5oyJ6ZKu77yM5omT5byA5Yqg5rOo55WM6Z2iXHJcbiAgICBqaWF6aHU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBkIGluIHNlbGYuemh1b2JqKSB7XHJcbiAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy96aHUvJyArIHNlbGYuemh1b2JqW2RdKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5femh1LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLmFkZHpodWRldGFpbCkge1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5pbk9iamVjdChzZWxmLmFkZHpodWRldGFpbFtpXSwgc2VsZi5vcHMpKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl96aHUuZ2V0Q2hpbGRCeU5hbWUoJ3podScgKyBpKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5femh1LmdldENoaWxkQnlOYW1lKCd6aHUnICsgaSkuZ2V0Q2hpbGRCeU5hbWUoJ2xhYmVsJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjYy52di51dGlscy5zaG93SmluYmkoc2VsZi5hZGR6aHVkZXRhaWxbaV0sICdXJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl96aHUuZ2V0Q2hpbGRCeU5hbWUoJ3podScgKyBpICsgJ19odWknKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5femh1LmdldENoaWxkQnlOYW1lKCd6aHUnICsgaSArICdfaHVpJykuZ2V0Q2hpbGRCeU5hbWUoJ2xhYmVsJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjYy52di51dGlscy5zaG93SmluYmkoc2VsZi5hZGR6aHVkZXRhaWxbaV0sICdXJyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v54K55Ye75q+U54mM5oyJ6ZKuXHJcbiAgICBiaXBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoJ3dhbm5hVG9Db21wYXJlUGFpJyk7XHJcbiAgICAgICAgLy/mmL7npLrlhbbku5bkurrnmoRwa+aMiemSru+8jOmAieaLqeWSjOiwgeavlOeJjFxyXG4gICAgICAgIC8vIHRoaXMuc2hvd090aGVyc1BrQnV0dG9uKCk7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tQa0J1dHRvbjogZnVuY3Rpb24odXNlcklkMikge1xyXG4gICAgICAgIHRoaXMuaGlkZU9oZXJzUGtCdXR0b24oKTtcclxuICAgICAgICB2YXIgdXNlcklkMSA9IGNjLnZ2LnVzZXJNZ3IudXNlcklkOyAvL+iHquW3sVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdiaXBhaScsIHtcclxuICAgICAgICAgICAgdXNlcklkMTogdXNlcklkMSxcclxuICAgICAgICAgICAgdXNlcklkMjogdXNlcklkMlxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye75byD54mM5oyJ6ZKuXHJcbiAgICBxaXBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoJ3FpcGFpJyk7XHJcbiAgICB9LFxyXG4gICAgLy/ngrnlh7vot5/ms6jmjInpkq5cclxuICAgIGdlbnpodTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoJ2dlbnpodScpO1xyXG4gICAgfSxcclxuICAgIGFkZHpodTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgbnVtO1xyXG4gICAgICAgIHZhciBpbmRleCA9IGUudGFyZ2V0Lm5hbWUuc3BsaXQoJ3podScpWzFdO1xyXG4gICAgICAgIG51bSA9IHNlbGYuYWRkemh1ZGV0YWlsW2luZGV4XTtcclxuICAgICAgICBjb25zb2xlLmxvZyhudW0pO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdhZGR6aHUnLCBudW0pO1xyXG4gICAgICAgIHRoaXMuX3podS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBnZXRwYWlSZXM6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZGF0YSA9IGRhdGEgKyAxO1xyXG4gICAgICAgIHZhciB0eXBlLCBudW0sIGh1YXNlX2JpZywgaHVhc2Vfc21hbGw7XHJcbiAgICAgICAgbnVtID0gKGRhdGEgJSAxMDApLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgaWYgKGRhdGEgPiAwICYmIGRhdGEgPCAxNCkge1xyXG4gICAgICAgICAgICB0eXBlID0gJzA0JzsgLy/pu5HmoYNcclxuICAgICAgICAgICAgbnVtID0gbnVtICsgJy0xJzsgLy/pu5HniYxcclxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEgPiAxMDAgJiYgZGF0YSA8IDExNCkge1xyXG4gICAgICAgICAgICB0eXBlID0gJzAzJzsgLy/nuqLmoYNcclxuICAgICAgICAgICAgbnVtID0gbnVtICsgJy0yJzsgLy/nuqLniYxcclxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEgPiAyMDAgJiYgZGF0YSA8IDIxNCkge1xyXG4gICAgICAgICAgICB0eXBlID0gJzAyJzsgLy/mooXoirFcclxuICAgICAgICAgICAgbnVtID0gbnVtICsgJy0xJzsgLy/pu5HniYxcclxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEgPiAzMDAgJiYgZGF0YSA8IDMxNCkge1xyXG4gICAgICAgICAgICB0eXBlID0gJzAxJzsgLy/mlrnlnZdcclxuICAgICAgICAgICAgbnVtID0gbnVtICsgJy0yJzsgLy/nuqLniYxcclxuICAgICAgICB9XHJcbiAgICAgICAgaHVhc2VfYmlnID0gXCJodWFzZV9iaWdcIiArIHR5cGU7XHJcbiAgICAgICAgaHVhc2Vfc21hbGwgPSBcImh1YXNlX3NtYWxsXCIgKyB0eXBlO1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIG51bTogc2VsZi5wYWlncm91cC5nZXRTcHJpdGVGcmFtZShudW0pLFxyXG4gICAgICAgICAgICBodWFzZV9iaWc6IHNlbGYucGFpZ3JvdXAuZ2V0U3ByaXRlRnJhbWUoaHVhc2VfYmlnKSxcclxuICAgICAgICAgICAgaHVhc2Vfc21hbGw6IHNlbGYucGFpZ3JvdXAuZ2V0U3ByaXRlRnJhbWUoaHVhc2Vfc21hbGwpLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gaWYgKG51bSA9PSAnMScpIG51bSA9ICdBJztcclxuICAgICAgICAvLyBpZiAobnVtID09ICcxMScpIG51bSA9ICdKJztcclxuICAgICAgICAvLyBpZiAobnVtID09ICcxMicpIG51bSA9ICdRJztcclxuICAgICAgICAvLyBpZiAobnVtID09ICcxMycpIG51bSA9ICdLJztcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgIT0gXCJ6aHVcIikge1xyXG4gICAgICAgICAgICBjYy5maW5kKCdDYW52YXMvemh1JykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJhY2tcIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBzaG93LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBidG4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYmdcIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwc2hvdy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwYnRuLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImhlbHBidG5cIikge1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBzaG93LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuaGVscGJ0bi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5mYW5odWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImZhblwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFuaHVpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBzaG93LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBidG4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5iYWNrQWxlcnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwibm9cIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwc2hvdy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwYnRuLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja0FsZXJ0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBmcmVzaEN1cnJlbnRaaHU6IGZ1bmN0aW9uKGN1cnJlbnRfemh1KSB7XHJcbiAgICAgICAgdGhpcy5fZGFuemh1LnN0cmluZyA9IFwi5Y2V5rOo77yaXCIgKyBjdXJyZW50X3podTtcclxuICAgIH0sXHJcbiAgICBmcmVzaE51bU9mTHVuOiBmdW5jdGlvbihudW0pIHt9LFxyXG4gICAgcmVzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5jbGVhckVuZCgpO1xyXG4gICAgICAgIHRoaXMuaW5pdFZpZXcoKTtcclxuICAgICAgICB0aGlzLmluaXRTZWF0cygpO1xyXG4gICAgfSxcclxuICAgIGZyZXNoQ2lyY2xlQ291bnQ6IGZ1bmN0aW9uKGNpcmNsZUNvdW50KSB7XHJcbiAgICAgICAgdGhpcy5fbHVuc2h1LnN0cmluZyA9IFwi6L2u5pWw77yaXCIgKyAoY2lyY2xlQ291bnQgKyAxKSArIFwiLzE1XCI7XHJcbiAgICB9LFxyXG4gICAgc2hvd1BrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9sZWZ0TGllLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3JpZ2h0TGllLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3BrUGFuZWwuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvL+aSreaUvuavlOeJjOWKqOeUu1xyXG4gICAgICAgIHRoaXMuX2ZsYXNoQW5pbS5wbGF5KCdwa19zaGFuZGlhbicpO1xyXG4gICAgICAgIHRoaXMuX2JpcGFpQW5pbS5wbGF5KCdiaXBhaScpO1xyXG4gICAgfSxcclxuICAgIGhpZGVQazogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLnNob3dMaWUoZGF0YSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9wa1BhbmVsLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5iaXBhaUFuaW1JbmRleCsrOyAvL+S4i+S4gOS4quavlOeJjOWKqOeUu1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuYmlwYWlBbmltSW5kZXggPj0gc2VsZi5iaXBhaUFuaW1RdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+ayoeacieS4i+S4gOS4quWKqOeUu+S6hlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmlzRW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c5qCH6K+G5Li65ri45oiP57uT5p2fXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd0VuZEFuaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+WmguaenOayoeaciee7k+adnyzmiafooYzmr5TniYzns7vliJfliqjnlLvnu5PmnZ/lkI7nmoTlm57osIPlh73mlbBcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuYmlwYWlBbmltQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmlwYWlBbmltQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93QmlwYWlBbmltKCk7IC8v5omn6KGM5LiL5LiA5Liq5q+U54mM5Yqo55S7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgfSxcclxuICAgIHNob3dMaWU6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAvLzAt5pi+56S65bem6L656KOC54mMIDEt5pi+56S65Y+z6L656KOC54mMXHJcbiAgICAgICAgaWYgKGRhdGEgPT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yaWdodExpZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xlZnRMaWUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaGlkZUxpZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fbGVmdExpZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9yaWdodExpZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93T3RoZXJzUGtCdXR0b246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5fc2VhdHMpIHtcclxuICAgICAgICAgICAgaWYgKGkgPT0gMCkgY29udGludWU7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gdGhpcy5fc2VhdHNbaV07XHJcbiAgICAgICAgICAgIHNlYXQuc2hvd1BrQnV0dG9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNob3daaHVBbmltOiBmdW5jdGlvbihkYXRhLCBkaXpodUxldmVsKSB7XHJcbiAgICAgICAgLy/kuIvms6jliqjnlLtcclxuICAgICAgICBpZiAoIWRhdGEpIHJldHVybjtcclxuICAgICAgICB2YXIgeCA9IGRhdGEueDsgLy/otbflp4vngrlYXHJcbiAgICAgICAgdmFyIHkgPSBkYXRhLnk7IC8v6LW35aeL54K5WVxyXG4gICAgICAgIHZhciByYW5kb21fZGlmZiA9IE1hdGgucmFuZG9tKCkgKiA1MDtcclxuICAgICAgICB2YXIgZW5kWCA9IHggKiAwLjIgKyByYW5kb21fZGlmZjtcclxuICAgICAgICB2YXIgZW5kWSA9IHkgKiAwLjIgKyByYW5kb21fZGlmZjtcclxuICAgICAgICB2YXIgYWRkTW9uZXkgPSBkYXRhLmFkZE1vbmV5O1xyXG4gICAgICAgIHZhciBhZGRNb25leUxldmVsID0gZGF0YS5hZGRNb25leUxldmVsO1xyXG4gICAgICAgIHZhciBub2RlID0gdGhpcy5femh1b21pYW4uY2hpbGRyZW5bMF07XHJcbiAgICAgICAgdmFyIG5ld05vZGUgPSBjYy5pbnN0YW50aWF0ZShub2RlKTtcclxuICAgICAgICBpZiAodHlwZW9mIGRpemh1TGV2ZWwgIT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgLy/lpoLmnpzmmK/lupXms6jmnKzouqtcclxuICAgICAgICAgICAgbmV3Tm9kZSA9IHRoaXMuX3podW9taWFuLmNoaWxkcmVuW2Rpemh1TGV2ZWxdO1xyXG4gICAgICAgICAgICBlbmRYID0gbmV3Tm9kZS54O1xyXG4gICAgICAgICAgICBlbmRZID0gbmV3Tm9kZS55O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3podW9taWFuLmFkZENoaWxkKG5ld05vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXdOb2RlLmdldENoaWxkQnlOYW1lKCdsYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gY2MudnYudXRpbHMuc2hvd0ppbmJpKGFkZE1vbmV5LCAnVycpO1xyXG4gICAgICAgIHZhciB6aHVPYmogPSBjYy5maW5kKCdDYW52YXMvemh1LycgKyB0aGlzLnpodW9ialthZGRNb25leUxldmVsXSk7XHJcbiAgICAgICAgdmFyIHpodUZyYW1lQ29weSA9IHpodU9iai5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZTtcclxuICAgICAgICBuZXdOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gemh1RnJhbWVDb3B5O1xyXG4gICAgICAgIG5ld05vZGUueCA9IHg7XHJcbiAgICAgICAgbmV3Tm9kZS55ID0geTtcclxuICAgICAgICBuZXdOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIGFjdGlvbiA9IGNjLm1vdmVUbygwLjQsIGNjLnAoZW5kWCwgZW5kWSkpO1xyXG4gICAgICAgIG5ld05vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICB9LFxyXG4gICAgaGlkZU9oZXJzUGtCdXR0b246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLl90aXBzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLl9zZWF0cykge1xyXG4gICAgICAgICAgICBpZiAoaSA9PSAwKSBjb250aW51ZTtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSB0aGlzLl9zZWF0c1tpXTtcclxuICAgICAgICAgICAgc2VhdC5oaWRlUGtCdXR0b24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaW5PYmplY3Q6IGZ1bmN0aW9uKGRhdGEsIG9iaikge1xyXG4gICAgICAgIHZhciBmID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBvYmopIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEgPT0gb2JqW2ldKSB7XHJcbiAgICAgICAgICAgICAgICBmID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmO1xyXG4gICAgfSxcclxuICAgIC8v57uT5p2f5Yqo55S7XHJcbiAgICBzaG93RW5kQW5pbTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBkYXRhID0gc2VsZi5lbmREYXRhO1xyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciB3aW5fdXNlcmlkID0gZGF0YS53aW5lcjtcclxuICAgICAgICAgICAgdmFyIGhvbGRzID0gZGF0YS5ob2xkcztcclxuICAgICAgICAgICAgdmFyIHdpbl9zZWF0SW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKHdpbl91c2VyaWQpKTtcclxuICAgICAgICAgICAgLy/lj5blvpfluqfkvY1cclxuICAgICAgICAgICAgdmFyIHdpbl9zZWF0ID0gc2VsZi5fc2VhdHNbd2luX3NlYXRJbmRleF07XHJcbiAgICAgICAgICAgIHdpbl9zZWF0LnNob3dZYW5odWEoKTsgLy/mlL7ng5/oirFcclxuICAgICAgICAgICAgLy/nrbnnoIHnp7vliqjliqjnlLtcclxuICAgICAgICAgICAgLy8gc2VsZi5femh1b21pYW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl96aHVvbWlhbi5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBzZWxmLl96aHVvbWlhbi5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBjYy5tb3ZlVG8oMiwgY2MucCh3aW5fc2VhdC5ub2RlLngsIHdpbl9zZWF0Lm5vZGUueSkpO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5vbGRYID0gbm9kZS54O1xyXG4gICAgICAgICAgICAgICAgbm9kZS5vbGRZID0gbm9kZS55O1xyXG4gICAgICAgICAgICAgICAgbm9kZS5ydW5BY3Rpb24oYWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZi5femh1b21pYW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5femh1b21pYW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX3podW9taWFuLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gc2VsZi5femh1b21pYW4uY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm9sZFgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUueCA9IG5vZGUub2xkWDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5vbGRZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnkgPSBub2RlLm9sZFk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy/ph43mlrDlvIDlp4vkuIDlsYBcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc3RhcnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMTUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsZWFyRW5kOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi5pc0VuZCA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYuZW5kRGF0YSA9IG51bGw7XHJcbiAgICAgICAgc2VsZi5fdGlwcy5zdHJpbmcgPSBcIuato+WcqOetieW+heS4i+S4gOWxgOa4uOaIj1wiO1xyXG4gICAgICAgIHNlbGYuX3RpcHMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdyZWFkeScpO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgfSxcclxuICAgIC8v5q+U54mM5Yqo55S7XHJcbiAgICBzaG93QmlwYWlBbmltOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJpcGFpRGF0YSA9IHNlbGYuYmlwYWlBbmltUXVldWVbc2VsZi5iaXBhaUFuaW1JbmRleF07XHJcbiAgICAgICAgdmFyIHdpbmVyID0gYmlwYWlEYXRhWyd3aW5lciddO1xyXG4gICAgICAgIHZhciBsb3NlciA9IGJpcGFpRGF0YVsnbG9zZXInXTtcclxuICAgICAgICB2YXIgbHB4ID0gY2MuZmluZCgnQ2FudmFzL3BrL2xlZnRQYWknKS54LFxyXG4gICAgICAgICAgICBscHkgPSBjYy5maW5kKCdDYW52YXMvcGsvbGVmdFBhaScpLnksXHJcbiAgICAgICAgICAgIHJweCA9IGNjLmZpbmQoJ0NhbnZhcy9way9yaWdodFBhaScpLngsXHJcbiAgICAgICAgICAgIHJweSA9IGNjLmZpbmQoJ0NhbnZhcy9way9yaWdodFBhaScpLnk7XHJcbiAgICAgICAgdmFyIFdzZWF0SW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQod2luZXIpLFxyXG4gICAgICAgICAgICBMc2VhdEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGxvc2VyKTtcclxuICAgICAgICB2YXIgV2xvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoV3NlYXRJbmRleCksXHJcbiAgICAgICAgICAgIExsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4WkpIKExzZWF0SW5kZXgpO1xyXG4gICAgICAgIHZhciBiMSA9IGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIFdsb2NhbEluZGV4KSxcclxuICAgICAgICAgICAgYjIgPSBjYy5maW5kKCdDYW52YXMvc2VhdCcgKyBMbG9jYWxJbmRleCk7XHJcbiAgICAgICAgY2MuZmluZCgnQ2FudmFzL3BrL2xlZnRQYWknKS54ID0gYjEueDtcclxuICAgICAgICBjYy5maW5kKCdDYW52YXMvcGsvbGVmdFBhaScpLnkgPSBiMS55O1xyXG4gICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9waycpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgY2MuZmluZCgnQ2FudmFzL3BrL2xlZnRQYWknKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9way9yaWdodFBhaScpLnggPSBiMi54O1xyXG4gICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9way9yaWdodFBhaScpLnkgPSBiMi55O1xyXG4gICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9way9yaWdodFBhaScpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIGFjdGlvbjEgPSBjYy5tb3ZlVG8oMC40LCBjYy5wKGxweCwgbHB5KSksXHJcbiAgICAgICAgICAgIGFjdGlvbjIgPSBjYy5tb3ZlVG8oMC40LCBjYy5wKHJweCwgcnB5KSk7XHJcbiAgICAgICAgY2MuZmluZCgnQ2FudmFzL3BrL2xlZnRQYWknKS5ydW5BY3Rpb24oYWN0aW9uMSk7XHJcbiAgICAgICAgY2MuZmluZCgnQ2FudmFzL3BrL3JpZ2h0UGFpJykucnVuQWN0aW9uKGFjdGlvbjIpO1xyXG4gICAgICAgIHNlbGYuaGlkZUxpZSgpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2hvd1BrKCk7XHJcbiAgICAgICAgICAgIHNlbGYuaGlkZVBrKDEpO1xyXG4gICAgICAgIH0sIDQwMCk7XHJcbiAgICB9LFxyXG4gICAgLy/lraTms6jkuIDmjrdcclxuICAgIGFsbGluOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5uZXQuc2VuZCgnYWxsX2luJyk7XHJcbiAgICB9LFxyXG4gICAgLy/lraTms6jkuIDmjrfliqjnlLtcclxuICAgIGRvQWxsaW46IGZ1bmN0aW9uKGRhdGEsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHVzZXJpZCA9IGRhdGEudXNlcmlkOyAvL+WPkei1t+WtpOazqOS4gOaOt+eahOmCo+S4quS6ulxyXG4gICAgICAgIHZhciBzdGF0dXMgPSBkYXRhLnN0YXR1czsgLy8wLei+k+S6hiAxLei1ouS6hlxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmJpcGFpQW5pbVF1ZXVlID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl9zZWF0cykge1xyXG4gICAgICAgICAgICB2YXIgc2VhdERhdGEgPSBzZWxmLl9zZWF0c1tpXTtcclxuICAgICAgICAgICAgdmFyIHNlYXRVc2VySWQgPSBzZWF0RGF0YVsnX3VzZXJJZCddO1xyXG4gICAgICAgICAgICBpZiAoIXNlYXRVc2VySWQgfHwgc2VhdFVzZXJJZCA9PSB1c2VyaWQpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB2YXIgd2luZXIsIGxvc2VyO1xyXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09IDApIHtcclxuICAgICAgICAgICAgICAgIHdpbmVyID0gc2VhdFVzZXJJZDtcclxuICAgICAgICAgICAgICAgIGxvc2VyID0gdXNlcmlkO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgd2luZXIgPSB1c2VyaWQ7XHJcbiAgICAgICAgICAgICAgICBsb3NlciA9IHNlYXRVc2VySWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5iaXBhaUFuaW1RdWV1ZS5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHdpbmVyOiB3aW5lcixcclxuICAgICAgICAgICAgICAgIGxvc2VyOiBsb3NlclxyXG4gICAgICAgICAgICB9KTsgLy/mr5TniYzpmJ/liJdcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5iaXBhaUFuaW1JbmRleCA9IDA7XHJcbiAgICAgICAgc2VsZi5zaG93QmlwYWlBbmltKCk7XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHNlbGYuYmlwYWlBbmltQ2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYmxSb29tTm86IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9zZWF0czogW10sXHJcbiAgICAgICAgX3RpbWVMYWJlbDogbnVsbCxcclxuICAgICAgICBfdm9pY2VNc2dRdWV1ZTogW10sXHJcbiAgICAgICAgX2xhc3RQbGF5aW5nU2VhdDogbnVsbCxcclxuICAgICAgICBfcGxheWluZ1NlYXQ6IG51bGwsXHJcbiAgICAgICAgX2xhc3RQbGF5VGltZTogbnVsbCxcclxuICAgICAgICBfc2hhcmVDb250ZW50OiBudWxsLFxyXG4gICAgICAgIHBhaWdyb3VwOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZUF0bGFzXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiYWNrOiBjYy5Ob2RlLFxyXG4gICAgICAgIGZhbmh1aTogY2MuTm9kZSxcclxuICAgICAgICBiZzogY2MuTm9kZSxcclxuICAgICAgICBiYWNrQWxlcnQ6IGNjLk5vZGUsXHJcbiAgICAgICAgYmFja0FsZXJ0X25vOiBjYy5Ob2RlLFxyXG4gICAgICAgIGZhbjogY2MuTm9kZSxcclxuICAgICAgICBqaW5iaTogY2MuTm9kZSxcclxuICAgICAgICBjb3VudGRvd246IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0cy5wdXNoKGNjLmZpbmQoXCJDYW52YXMvc2VhdFwiICsgaSkuZ2V0Q29tcG9uZW50KFwiZG5TZWF0XCIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdGltZUxhYmVsID0gY2MuZmluZChcIkNhbnZhcy90aW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fdGlwcyA9IGNjLmZpbmQoXCJDYW52YXMvdGlwc1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX2RpZmVuID0gY2MuZmluZChcIkNhbnZhcy9kaWZlblwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX3FpYW5nWmh1VGlwcyA9IGNjLmZpbmQoXCJDYW52YXMvdGV4dDFcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl94aWFCZWlUaXBzID0gY2MuZmluZChcIkNhbnZhcy90ZXh0M1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX2xhc3RSZXN1bHQgPSBjYy5maW5kKFwiQ2FudmFzL2xhc3RSZXN1bHRcIik7XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoXCJSZUNvbm5lY3RcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLmJhY2ssIHRoaXMubm9kZSwgXCJkbkFsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuZmFuaHVpLCB0aGlzLm5vZGUsIFwiZG5BbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLmZhbiwgdGhpcy5ub2RlLCBcImRuQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5iZywgdGhpcy5ub2RlLCBcImRuQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5iYWNrQWxlcnRfbm8sIHRoaXMubm9kZSwgXCJkbkFsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICB0aGlzLmluaXRWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0U2VhdHMoKTtcclxuICAgICAgICB0aGlzLmluaXRFdmVudEhhbmRsZXJzKCk7XHJcbiAgICAgICAgY2MudnYubmV0LnNlbmQoXCJyZWFkeVwiKTtcclxuICAgICAgICBjYy52di5hdWRpb01nci5wbGF5QkdNKFwiYmFjay5tcDNcIik7XHJcbiAgICAgICAgdGhpcy5xaWFuZ1podUxldmVsID0gWzAsIDEsIDIsIDMsIDRdOyAvL+aKouazqOeahOaho+asoVxyXG4gICAgICAgIHRoaXMuamluYmlfbm9kZV9hcnIgPSBbXTtcclxuICAgIH0sXHJcbiAgICBpbml0VmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fdGlwcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fbGFzdFJlc3VsdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBpbml0U2VhdHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWF0cyA9IGNjLnZ2LmdhbWVOZXRNZ3Iuc2VhdHM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRTaW5nbGVTZWF0KHNlYXRzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaW5pdFNpbmdsZVNlYXQ6IGZ1bmN0aW9uKHNlYXQpIHtcclxuICAgICAgICB2YXIgaW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoc2VhdC5zZWF0aW5kZXgpO1xyXG4gICAgICAgIHZhciBpc09mZmxpbmUgPSAhc2VhdC5vbmxpbmU7XHJcbiAgICAgICAgLy8gdmFyIGlzWmh1YW5nID0gc2VhdC5zZWF0aW5kZXggPT0gY2MudnYuZ2FtZU5ldE1nci5idXR0b247XHJcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnNldEluZm8oc2VhdC5uYW1lLCBzZWF0LnNjb3JlKTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0UmVhZHkoc2VhdC5yZWFkeSk7XHJcbiAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnNldE9mZmxpbmUoaXNPZmZsaW5lKTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0SUQoc2VhdC51c2VyaWQpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS52b2ljZU1zZyhmYWxzZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5TZXR0aW5nc0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LnBvcHVwTWdyLnNob3dTZXR0aW5ncygpO1xyXG4gICAgfSxcclxuICAgIC8vIOeCueWHu+WIhuS6q+aMiemSru+8jOS9v+eUqOW+ruS/oeWIhuS6q1xyXG4gICAgb25CdG5XZWljaGF0Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuc2hhcmUuc2hvdygpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuRGlzc29sdmVDbGlja2VkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5hbGVydC5zaG93KFwi6Kej5pWj5oi/6Ze0XCIsIFwi6Kej5pWj5oi/6Ze05LiN5omj6YeR5biB77yM5piv5ZCm56Gu5a6a6Kej5pWj77yfXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImRpc3ByZXNzXCIpO1xyXG4gICAgICAgIH0sIHRydWUpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJiYWNrXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5mYW5odWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYmdcIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiZmFuXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5mYW5odWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja0FsZXJ0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcIm5vXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5mYW5odWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja0FsZXJ0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkV4aXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuYmFja0FsZXJ0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZXhpdFwiKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkV4Y2hhbmdlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmJhY2tBbGVydC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBjYy52di51c2VyTWdyLmV4Y2hhbmdlID0gMTtcclxuICAgICAgICBjYy52di5uZXQuc2VuZChcImV4aXRcIik7XHJcbiAgICB9LFxyXG4gICAgcGxheVZvaWNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fcGxheWluZ1NlYXQgPT0gbnVsbCAmJiB0aGlzLl92b2ljZU1zZ1F1ZXVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXlWb2ljZVwiKTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl92b2ljZU1zZ1F1ZXVlLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQoZGF0YS5zZW5kZXIpO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChpZHgpO1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5aW5nU2VhdCA9IGxvY2FsSW5kZXg7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzW2xvY2FsSW5kZXhdLnZvaWNlTXNnKHRydWUpO1xyXG4gICAgICAgICAgICB2YXIgbXNnSW5mbyA9IEpTT04ucGFyc2UoZGF0YS5jb250ZW50KTtcclxuICAgICAgICAgICAgdmFyIG1zZ2ZpbGUgPSBcInZvaWNlbXNnLmFtclwiO1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0UGxheVRpbWUgPSBEYXRlLm5vdygpICsgbXNnSW5mby50aW1lO1xyXG4gICAgICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlcnZlcmlkID0gbXNnSW5mb1snbXNnJ107XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuZG93bmxvYWRWb2ljZShzZXJ2ZXJpZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MudnYudm9pY2VNZ3Iud3JpdGVWb2ljZShtc2dmaWxlLCBtc2dJbmZvLm1zZyk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLnBsYXkobXNnZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRFdmVudEhhbmRsZXJzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di5nYW1lTmV0TWdyLmRhdGFFdmVudEhhbmRsZXIgPSB0aGlzLm5vZGU7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignbmV3X3VzZXInLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5paw5Lq65Yqg5YWl5oi/6Ze0XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdFNpbmdsZVNlYXQoZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbigndXNlcl9zdGF0ZV9jaGFuZ2VkJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgc2VhdCA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoc2VhdC5zZWF0aW5kZXgpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2VhdEhpZGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfaW5pdCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGdhbWVJbmZvID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIGlmICghZ2FtZUluZm8pIHJldHVybjtcclxuICAgICAgICAgICAgc2VsZi5zaG93RGlGZW4oZ2FtZUluZm8uYmFzZUZlbik7XHJcbiAgICAgICAgICAgIHNlbGYuX3RpcHMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHNlYXREYXRhcyA9IHt9O1xyXG4gICAgICAgICAgICBpZiAoZ2FtZUluZm9bJ3BsYXllcnMnXSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBnYW1lSW5mb1sncGxheWVycyddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gZ2FtZUluZm9bJ3BsYXllcnMnXVtpXTtcclxuICAgICAgICAgICAgICAgICAgICBzZWF0RGF0YXNbc2VhdERhdGFbJ3VzZXJpZCddXSA9IHNlYXREYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZWxmLnJlZnJlc2hTZWF0cyhzZWF0RGF0YXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignbm90X2V4aXQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZXhjaGFuZ2UgPSAwO1xyXG4gICAgICAgICAgICBjYy52di5hbGVydC5zaG93KCfmj5DnpLonLCAn5ri45oiP6L+b6KGM5Lit77yM5peg5rOV6YCA5Ye65oi/6Ze0Jyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2JlZ2luJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLmNvdW50ZG93bi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICAvL+a4uOaIj+W8gOWni1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn5ri45oiP5byA5aeLJywgZGF0YSk7XHJcbiAgICAgICAgICAgIHZhciBob2xkcyA9IGRhdGEuaG9sZHM7XHJcbiAgICAgICAgICAgIHZhciBtYXhRaWFuZ1podWFuZ0JlaVNodSA9IGRhdGEubWF4UWlhbmdaaHVhbmdCZWlTaHU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdob2xkcz09PT4nLCBob2xkcyk7XHJcbiAgICAgICAgICAgIHNlbGYuc2hvd1NlbGZQYWkoaG9sZHMpOyAvL+WxleekuuiHquW3seaJi+S4iueahOWbm+W8oOaJi+eJjFxyXG4gICAgICAgICAgICBzZWxmLnNob3dRaWFuZ1podShtYXhRaWFuZ1podWFuZ0JlaVNodSk7IC8v5bGV56S65oqi5bqE5YCN5pWwXHJcbiAgICAgICAgICAgIHNlbGYuc2hvd090aGVyU2VhdCgpO1xyXG4gICAgICAgICAgICBzZWxmLnNob3dRaWFuZ1podVRpcHMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3ZvaWNlX21zZycsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5fdm9pY2VNc2dRdWV1ZS5wdXNoKGRhdGEpO1xyXG4gICAgICAgICAgICBzZWxmLnBsYXlWb2ljZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignY2hhdF9wdXNoJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4WkpIKGlkeCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2xvY2FsSWR4XS5jaGF0KGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdxdWlja19jaGF0X3B1c2gnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQoZGF0YS5zZW5kZXIpO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJZHggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoaWR4KTtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gZGF0YS5jb250ZW50O1xyXG4gICAgICAgICAgICB2YXIgaW5mbyA9IGNjLnZ2LnpqaGNoYXQuZ2V0UXVpY2tDaGF0SW5mbyhpbmRleCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2xvY2FsSWR4XS5jaGF0KGluZm8uY29udGVudCk7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlTRlgoaW5mby5zb3VuZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdlbW9qaV9wdXNoJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4WkpIKGlkeCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2xvY2FsSWR4XS5lbW9qaShkYXRhLmNvbnRlbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignc2hvd19xaWFuZycsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/mnInkurrmiqLluoRcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xyXG4gICAgICAgICAgICB2YXIgYmVpc2h1ID0gZGF0YS5iZWlTaHU7XHJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoc2VhdEluZGV4KTtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1tsb2NhbEluZGV4XTtcclxuICAgICAgICAgICAgc2VhdC5zaG93UWlhbmdaaHVUZXh0KGJlaXNodSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdjb3VudF9kb3duJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5fdGlwcy5ub2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fdGlwcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHNlbGYuY291bnRkb3duLnN0cmluZyA9IGRhdGEuY291bnREb3duO1xyXG4gICAgICAgICAgICBzZWxmLmNvdW50ZG93bi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmNvdW50RG93biA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNvdW50ZG93bi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX3podWFuZ1NlbGVjdGVkJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+aKouW6hOe7k+adn1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVRaWFuZ1podVRpcHMoKTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbMF0uaGlkZVFpYW5nWmh1KCk7XHJcbiAgICAgICAgICAgIC8v5a6a5bqEXHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl9zZWF0cykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1tpXTtcclxuICAgICAgICAgICAgICAgIHNlYXQuaGlkZVFpYW5nWmh1VGV4dCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoc2VhdEluZGV4KTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsU2VhdCA9IHNlbGYuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICBsb2NhbFNlYXQuc2hvd1podWFuZygpO1xyXG4gICAgICAgICAgICAvL+WumuWujOW6hOWQju+8jOa/gOa0u+acjeWKoeWZqFxyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZCgnemh1YW5nRW5kRnJvbUNsaWVudCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9teVh6QmVnaW4nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5LiL5rOoXHJcbiAgICAgICAgICAgIHNlbGYuc2hvd1hpYVpodVRpcHMoKTsgLy/mmL7npLrkuIvms6jmj5DnpLpcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1swXTtcclxuICAgICAgICAgICAgc2VhdC5zaG93WGlhQmVpKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9teVh6RW5kJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+S4i+azqOe7k+adn1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVYaWFaaHVUaXBzKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzWzBdLmhpZGVYaWFCZWkoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3Nob3dfYmVpU2h1VGV4dCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/mmL7npLrkuIvnmoTlgI3mlbBcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGRhdGEudXNlcmlkO1xyXG4gICAgICAgICAgICB2YXIgYmVpU2h1ID0gZGF0YS5iZWlTaHU7XHJcbiAgICAgICAgICAgIHNlbGYuc2hvd0JlaVNodVRleHQodXNlcklkLCBiZWlTaHUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9teUhvbGRzVXBkYXRlJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+WPkeacgOWQjuS4gOW8oOaJi+eJjFxyXG4gICAgICAgICAgICB2YXIgaG9sZHMgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5zaG93U2VsZlBhaShob2xkcyk7IC8v5bGV56S65omL54mMXHJcbiAgICAgICAgICAgIHNlbGYuc2hvd1lvdVNoaSgpO1xyXG4gICAgICAgICAgICBzZWxmLnNob3dDb3VudCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9iX09uZVNuRW5kJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+eul+eJm+e7k+adn1xyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBzZWF0SW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldFNlYXRJbmRleEJ5SUQodXNlcklkKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoc2VhdEluZGV4KTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsU2VhdCA9IHNlbGYuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgICAgICBsb2NhbFNlYXQuc25FbmQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ21hdGNoX2V4aXRfZXJyb3InLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v6ZSm5qCH6LWb5LiN6IO96YCA5Ye65ri45oiPXHJcbiAgICAgICAgICAgIGNjLnZ2LmFsZXJ0LnNob3coXCLmj5DnpLpcIiwgXCLplKbmoIfotZvkuK3kuI3og73pgIDlh7rmuLjmiI9cIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX3Nob3dBbGxVc2VyJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAvL+a4uOaIj+e7k+adn1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgbW9uZXlGbG93cyA9IGRhdGEubW9uZXlGbG93cztcclxuICAgICAgICAgICAgdmFyIHBsYXllcnMgPSBkYXRhLnBsYXllcnM7XHJcbiAgICAgICAgICAgIHZhciB6aHVhbmdfdXNlcklkID0gbnVsbDtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSBudWxsO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIHBsYXllcnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSBwbGF5ZXJzW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsYXllci5pc1podWFuZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHpodWFuZ191c2VySWQgPSBwbGF5ZXIudXNlcmlkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGNjLnZ2LnVzZXJNZ3IudXNlcklkID09IHBsYXllci51c2VyaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+WIpOaWreiHquW3seeahOi+k+i1olxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIuc3RhdHVzID09ICd3aW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdXNlcl9hcnJfdG9aaHVhbmcgPSBbXTsgLy/mtYHlkJHluoRcclxuICAgICAgICAgICAgdmFyIHVzZXJfYXJyX2Zyb21aaHVhbmcgPSBbXTsgLy/ku47luoTmnaVcclxuICAgICAgICAgICAgZm9yICh2YXIgaiBpbiBtb25leUZsb3dzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9uZXlGbG93ID0gbW9uZXlGbG93c1tqXTtcclxuICAgICAgICAgICAgICAgIGlmIChtb25leUZsb3cudG8gPT0gemh1YW5nX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfYXJyX3RvWmh1YW5nLnB1c2gobW9uZXlGbG93KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChtb25leUZsb3cuZnJvbSA9PSB6aHVhbmdfdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9hcnJfZnJvbVpodWFuZy5wdXNoKG1vbmV5Rmxvdyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5zaG93TGFzdFBhaShwbGF5ZXJzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2hvd0xhc3RSZXN1bHQodHlwZSk7IC8v5pi+56S65pys5Lq66L6T6LWiXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUxhc3RSZXN1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGVMYXN0UGFpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX3RpcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGlwcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd01vbmV5Rmxvd3NBbmltKHVzZXJfYXJyX3RvWmh1YW5nLCB1c2VyX2Fycl9mcm9tWmh1YW5nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93TW9uZXlDaGFuZ2UocGxheWVycyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3Nob3dNb25leUNoYW5nZeaJp+ihjOaXtumXtOS4ujLnp5JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKCdyZWFkeScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0sIDE1MDApOyAvL+aYvuekuui+k+i1oueahOaXtumXtFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2V4aXRfcm9vbScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgLy/liLfmlrDnlKjmiLfpkrHluIHmlbDph49cclxuICAgICAgICAgICAgc2VsZi5nZXRHZW1zQW5kQ29pbnMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICByZWZyZXNoU2VhdHM6IGZ1bmN0aW9uKHNlYXREYXRhcykge1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5fc2VhdHMpIHtcclxuICAgICAgICAgICAgdmFyIHNlYXQgPSB0aGlzLl9zZWF0c1tpXTtcclxuICAgICAgICAgICAgdmFyIHNlYXREYXRhID0gc2VhdERhdGFzW3NlYXQuX3VzZXJJZF07XHJcbiAgICAgICAgICAgIGlmIChzZWF0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc2VhdC5fc2NvcmUgPSBzZWF0RGF0YVsnbW9uZXknXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWF0LnJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/orr7nva7ph5HluIHpkrvnn7PmlbDph49cclxuICAgIGdldEdlbXNBbmRDb2luczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2V0R2Vtc0FuZENvaW5zKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5nZW1zID0gZGF0YS5nZW1zO1xyXG4gICAgICAgICAgICBjYy52di51c2VyTWdyLmNvaW5zID0gZGF0YS5jb2lucztcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBzaG93TGFzdFBhaTogZnVuY3Rpb24ocGxheWVycywgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy/mmL7npLrmr4/kuKrkurrnmoTniYxcclxuICAgICAgICAvLyB2YXIgcGxheWVyc19udW0gPSBwbGF5ZXJzLmxlbmd0aDtcclxuICAgICAgICB2YXIgcGxheWVyX2luZGV4ID0gMDtcclxuICAgICAgICB2YXIgZnVuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChwbGF5ZXJfaW5kZXggPiBwbGF5ZXJzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcGxheWVyID0gcGxheWVyc1twbGF5ZXJfaW5kZXhdO1xyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gcGxheWVyLnVzZXJpZDtcclxuICAgICAgICAgICAgdmFyIGhvbGRzID0gcGxheWVyLmhvbGRzO1xyXG4gICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuZ2V0U2VhdEJ5VXNlcklkKHVzZXJJZCk7XHJcbiAgICAgICAgICAgIHZhciBzcHJpdGVGcmFtZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBob2xkcykge1xyXG4gICAgICAgICAgICAgICAgc3ByaXRlRnJhbWVzLnB1c2goc2VsZi5nZXRwYWlSZXMoaG9sZHNbaV0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWF0LnNob3dMYXN0UGFpKHNwcml0ZUZyYW1lcywgcGxheWVyLnNjb3JlKTtcclxuICAgICAgICAgICAgcGxheWVyX2luZGV4Kys7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW4sIDEwMDApOyAvLzHnp5LmmL7npLrkuIDkuKpcclxuICAgICAgICBmdW4oKTtcclxuICAgIH0sXHJcbiAgICBoaWRlTGFzdFBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLl9zZWF0cykge1xyXG4gICAgICAgICAgICB2YXIgc2VhdCA9IHRoaXMuX3NlYXRzW2ldO1xyXG4gICAgICAgICAgICBzZWF0LmhpZGVMYXN0UGFpKCk7XHJcbiAgICAgICAgICAgIHNlYXQuaGlkZUJlaVNodVRleHQoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2hvd01vbmV5Q2hhbmdlOiBmdW5jdGlvbihwbGF5ZXJzKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gcGxheWVycykge1xyXG4gICAgICAgICAgICB2YXIgcGxheWVyID0gcGxheWVyc1tpXTtcclxuICAgICAgICAgICAgdmFyIHVzZXJJZCA9IHBsYXllci51c2VyaWQ7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gc2VsZi5nZXRTZWF0QnlVc2VySWQodXNlcklkKTtcclxuICAgICAgICAgICAgdmFyIG1vbmV5ID0gcGxheWVyLm1vbmV5O1xyXG4gICAgICAgICAgICBpZiAoc2VhdCkge1xyXG4gICAgICAgICAgICAgICAgc2VhdC5jaGFuZ2VNb25leShtb25leSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0U2VhdEJ5VXNlcklkOiBmdW5jdGlvbih1c2VySWQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHNlYXRJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRCh1c2VySWQpO1xyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRMb2NhbEluZGV4WkpIKHNlYXRJbmRleCk7XHJcbiAgICAgICAgaWYgKCFzZWxmLl9zZWF0cykgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgdmFyIGxvY2FsU2VhdCA9IHNlbGYuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgIHJldHVybiBsb2NhbFNlYXQ7XHJcbiAgICB9LFxyXG4gICAgc2hvd01vbmV5Rmxvd3NBbmltOiBmdW5jdGlvbih1c2VyX2Fycl90b1podWFuZywgdXNlcl9hcnJfZnJvbVpodWFuZywgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy/otYTph5HmtYHliqjnlLtcclxuICAgICAgICAvL+a1geWQkeW6hOeahOmHkeW4geWKqOeUu1xyXG4gICAgICAgIHNlbGYuYnVpbGRNb25leUZsb3dzQW5pbURhdGEodXNlcl9hcnJfdG9aaHVhbmcpO1xyXG4gICAgICAgIHNlbGYuZXhlY01vbmV5Rmxvd3NBbmltKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvL+S7juW6hOa1geWHuueahOmHkeW4geWKqOeUu1xyXG4gICAgICAgICAgICBzZWxmLmJ1aWxkTW9uZXlGbG93c0FuaW1EYXRhKHVzZXJfYXJyX2Zyb21aaHVhbmcpO1xyXG4gICAgICAgICAgICBzZWxmLmV4ZWNNb25leUZsb3dzQW5pbShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGJ1aWxkTW9uZXlGbG93c0FuaW1EYXRhOiBmdW5jdGlvbih1c2VyX2Fycikge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAvL+aehOmAoOmHkeW4gea1geaVsOaNrlxyXG4gICAgICAgIGZvciAodmFyIGkgaW4gdXNlcl9hcnIpIHtcclxuICAgICAgICAgICAgLy/otbfngrlcclxuICAgICAgICAgICAgdmFyIGZyb21fdXNlcklkID0gdXNlcl9hcnJbaV0uZnJvbTtcclxuICAgICAgICAgICAgdmFyIGZyb21TZWF0ID0gc2VsZi5nZXRTZWF0QnlVc2VySWQoZnJvbV91c2VySWQpO1xyXG4gICAgICAgICAgICB2YXIgZnJvbV9ub2RlID0gZnJvbVNlYXQubm9kZTtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0X3ggPSBmcm9tX25vZGUueDtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0X3kgPSBmcm9tX25vZGUueTtcclxuICAgICAgICAgICAgLy/nu4jngrlcclxuICAgICAgICAgICAgdmFyIHRvX3VzZXJJZCA9IHVzZXJfYXJyW2ldLnRvO1xyXG4gICAgICAgICAgICB2YXIgdG9TZWF0ID0gc2VsZi5nZXRTZWF0QnlVc2VySWQodG9fdXNlcklkKTtcclxuICAgICAgICAgICAgdmFyIHRvX25vZGUgPSB0b1NlYXQubm9kZTtcclxuICAgICAgICAgICAgdmFyIGVuZF94ID0gdG9fbm9kZS54O1xyXG4gICAgICAgICAgICB2YXIgZW5kX3kgPSB0b19ub2RlLnk7XHJcbiAgICAgICAgICAgIHZhciBkaXNfeCA9IGVuZF94IC0gc3RhcnRfeDtcclxuICAgICAgICAgICAgdmFyIGRpc195ID0gZW5kX3kgLSBzdGFydF95O1xyXG4gICAgICAgICAgICB2YXIgamluX251bSA9IDE1O1xyXG4gICAgICAgICAgICB2YXIgcGVyX3ggPSBNYXRoLmZsb29yKGRpc194IC8gamluX251bSk7XHJcbiAgICAgICAgICAgIHZhciBwZXJfeSA9IE1hdGguZmxvb3IoZGlzX3kgLyBqaW5fbnVtKTtcclxuICAgICAgICAgICAgdmFyIG5ld19ub2RlX2FyciA9IFtdO1xyXG4gICAgICAgICAgICAvLyBpZiAodHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDw9IGppbl9udW07IGorKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld194ID0gc3RhcnRfeCArIGogKiBwZXJfeDtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdfeSA9IHN0YXJ0X3kgKyBqICogcGVyX3k7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGUgPSBjYy5pbnN0YW50aWF0ZShzZWxmLmppbmJpKTtcclxuICAgICAgICAgICAgICAgIG5ld19ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgbmV3X25vZGUueCA9IG5ld194O1xyXG4gICAgICAgICAgICAgICAgbmV3X25vZGUueSA9IG5ld195O1xyXG4gICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhc1wiKS5hZGRDaGlsZChuZXdfbm9kZSk7XHJcbiAgICAgICAgICAgICAgICBuZXdfbm9kZV9hcnIucHVzaChuZXdfbm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5qaW5iaV9ub2RlX2Fyci5wdXNoKG5ld19ub2RlX2Fycik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGV4ZWNNb25leUZsb3dzQW5pbTogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICAvL+aJp+ihjOmHkeW4gea1geWKqOeUu1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuamluYmlfbm9kZV9hcnIpIHJldHVybjtcclxuICAgICAgICBpZiAoc2VsZi5qaW5iaV9ub2RlX2Fyci5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBzZWxmLmNsZWFyRmxvd0FuaW0oKTtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGludGVyVmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghc2VsZi5zaG93SmluYmlJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zaG93SmluYmlJbmRleCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLmppbmJpX25vZGVfYXJyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3X25vZGVfYXJyID0gc2VsZi5qaW5iaV9ub2RlX2FycltpXTtcclxuICAgICAgICAgICAgICAgIG5ld19ub2RlX2FycltzZWxmLnNob3dKaW5iaUluZGV4XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzZWxmLnNob3dKaW5iaUluZGV4ID49IDEwKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dKaW5iaUluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgIHNlbGYuZmxvd0VuZEFuaW0oY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlclZhbCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dKaW5iaUluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfSxcclxuICAgIGZsb3dFbmRBbmltOiBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZHVyYXRpb24gPSAwLjQ7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLmppbmJpX25vZGVfYXJyKSB7XHJcbiAgICAgICAgICAgIHZhciBub2RlX2FyciA9IHNlbGYuamluYmlfbm9kZV9hcnJbaV07XHJcbiAgICAgICAgICAgIHZhciBlbmROb2RlID0gbm9kZV9hcnJbbm9kZV9hcnIubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogaW4gbm9kZV9hcnIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBub2RlID0gbm9kZV9hcnJbal07XHJcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gY2MubW92ZVRvKGR1cmF0aW9uLCBjYy5wKGVuZE5vZGUueCwgZW5kTm9kZS55KSk7XHJcbiAgICAgICAgICAgICAgICBub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8v5riF55CG6YeR5biBXHJcbiAgICAgICAgICAgIHNlbGYuY2xlYXJGbG93QW5pbSgpO1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBkdXJhdGlvbiAqIDEwMDApO1xyXG4gICAgfSxcclxuICAgIGNsZWFyRmxvd0FuaW06IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuamluYmlfbm9kZV9hcnIpIHtcclxuICAgICAgICAgICAgdmFyIG5vZGVfYXJyID0gc2VsZi5qaW5iaV9ub2RlX2FycltpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiBpbiBub2RlX2Fycikge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBub2RlX2FycltqXTtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoXCJDYW52YXNcIikucmVtb3ZlQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5qaW5iaV9ub2RlX2FyciA9IFtdO1xyXG4gICAgfSxcclxuICAgIHNob3dCZWlTaHVUZXh0OiBmdW5jdGlvbih1c2VySWQsIGJlaVNodSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgc2VhdEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKHVzZXJJZCk7XHJcbiAgICAgICAgdmFyIGxvY2FsSW5kZXggPSBjYy52di5nYW1lTmV0TWdyLmdldExvY2FsSW5kZXhaSkgoc2VhdEluZGV4KTtcclxuICAgICAgICB2YXIgc2VhdCA9IHNlbGYuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgIHNlYXQuc2hvd0JlaVNodVRleHQoYmVpU2h1KTtcclxuICAgIH0sXHJcbiAgICBzaG93Q291bnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3NlYXRzWzBdLnNob3dDb3VudCgpO1xyXG4gICAgfSxcclxuICAgIHNob3dZb3VTaGk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3NlYXRzWzBdLnNob3dZb3VTaGkoKTtcclxuICAgIH0sXHJcbiAgICBzaG93UWlhbmdaaHVUaXBzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL+aYvuekuuaKouS4u3RpcHNcclxuICAgICAgICB0aGlzLl9xaWFuZ1podVRpcHMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGhpZGVRaWFuZ1podVRpcHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3FpYW5nWmh1VGlwcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHNob3dYaWFaaHVUaXBzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl94aWFCZWlUaXBzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICBoaWRlWGlhWmh1VGlwczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5feGlhQmVpVGlwcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHNob3dPdGhlclNlYXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgc2VhdCA9IHNlbGYuX3NlYXRzW2ldO1xyXG4gICAgICAgICAgICBzZWF0LnNob3dCZWlQYWkoNCk7IC8v5pi+56S654mM55qE6IOM6Z2iXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNob3dRaWFuZ1podTogZnVuY3Rpb24obWF4UWlhbmdaaHVhbmdCZWlTaHUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGxldmVsID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYucWlhbmdaaHVMZXZlbCkge1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5xaWFuZ1podUxldmVsW2ldIDw9IG1heFFpYW5nWmh1YW5nQmVpU2h1KSB7XHJcbiAgICAgICAgICAgICAgICBsZXZlbCA9IGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNlYXQgPSBzZWxmLl9zZWF0c1swXTtcclxuICAgICAgICBzZWF0LnNob3dRaWFuZ1podShsZXZlbCk7XHJcbiAgICB9LFxyXG4gICAgc2hvd1NlbGZQYWk6IGZ1bmN0aW9uKGhvbGRzKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzZWF0ID0gc2VsZi5fc2VhdHNbMF07XHJcbiAgICAgICAgdmFyIHNwcml0ZUZyYW1lcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gaG9sZHMpIHtcclxuICAgICAgICAgICAgc3ByaXRlRnJhbWVzLnB1c2goc2VsZi5nZXRwYWlSZXMoaG9sZHNbaV0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VhdC5zaG93U2VsZlBhaShzcHJpdGVGcmFtZXMpO1xyXG4gICAgfSxcclxuICAgIGdldHBhaVJlczogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBkYXRhID0gZGF0YSArIDE7XHJcbiAgICAgICAgdmFyIHR5cGUsIG51bSwgaHVhc2VfYmlnLCBodWFzZV9zbWFsbDtcclxuICAgICAgICBudW0gPSAoZGF0YSAlIDEwMCkudG9TdHJpbmcoKTtcclxuICAgICAgICBpZiAoZGF0YSA+IDAgJiYgZGF0YSA8IDE0KSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnMDQnOyAvL+m7keahg1xyXG4gICAgICAgICAgICBudW0gPSBudW0gKyAnLTEnOyAvL+m7keeJjFxyXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YSA+IDEwMCAmJiBkYXRhIDwgMTE0KSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnMDMnOyAvL+e6ouahg1xyXG4gICAgICAgICAgICBudW0gPSBudW0gKyAnLTInOyAvL+e6oueJjFxyXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YSA+IDIwMCAmJiBkYXRhIDwgMjE0KSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnMDInOyAvL+aiheiKsVxyXG4gICAgICAgICAgICBudW0gPSBudW0gKyAnLTEnOyAvL+m7keeJjFxyXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YSA+IDMwMCAmJiBkYXRhIDwgMzE0KSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnMDEnOyAvL+aWueWdl1xyXG4gICAgICAgICAgICBudW0gPSBudW0gKyAnLTInOyAvL+e6oueJjFxyXG4gICAgICAgIH1cclxuICAgICAgICBodWFzZV9iaWcgPSBcImh1YXNlX2JpZ1wiICsgdHlwZTtcclxuICAgICAgICBodWFzZV9zbWFsbCA9IFwiaHVhc2Vfc21hbGxcIiArIHR5cGU7XHJcbiAgICAgICAgdmFyIGhvbGQgPSBkYXRhIC0gMTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICBudW06IHNlbGYucGFpZ3JvdXAuZ2V0U3ByaXRlRnJhbWUobnVtKSxcclxuICAgICAgICAgICAgaHVhc2VfYmlnOiBzZWxmLnBhaWdyb3VwLmdldFNwcml0ZUZyYW1lKGh1YXNlX2JpZyksXHJcbiAgICAgICAgICAgIGh1YXNlX3NtYWxsOiBzZWxmLnBhaWdyb3VwLmdldFNwcml0ZUZyYW1lKGh1YXNlX3NtYWxsKSxcclxuICAgICAgICAgICAgaG9sZDogaG9sZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgICBzaG93RGlGZW46IGZ1bmN0aW9uKGRpZmVuKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuX2RpZmVuLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBzZWxmLl9kaWZlbi5zdHJpbmcgPSBcIuW6leWIhu+8mlwiICsgZGlmZW47XHJcbiAgICB9LFxyXG4gICAgc2hvd0xhc3RSZXN1bHQ6IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICB2YXIgc2VhdEluZGV4ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGNjLnZ2LnVzZXJNZ3IudXNlcklkKTtcclxuICAgICAgICB2YXIgbG9jYWxJbmRleCA9IGNjLnZ2LmdhbWVOZXRNZ3IuZ2V0TG9jYWxJbmRleFpKSChzZWF0SW5kZXgpO1xyXG4gICAgICAgIGlmICghdGhpcy5fc2VhdHMpIHJldHVybjtcclxuICAgICAgICB2YXIgc2VhdCA9IHRoaXMuX3NlYXRzW2xvY2FsSW5kZXhdO1xyXG4gICAgICAgIGlmICh0aGlzLl9sYXN0UmVzdWx0ICYmIHNlYXQuX2xhc3RwYWkuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xhc3RSZXN1bHQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGUgPT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0UmVzdWx0LmdldENoaWxkQnlOYW1lKCd3aW4nKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0UmVzdWx0LmdldENoaWxkQnlOYW1lKCdsb3NlJykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDIpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdFJlc3VsdC5nZXRDaGlsZEJ5TmFtZSgnd2luJykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX2xhc3RSZXN1bHQuZ2V0Q2hpbGRCeU5hbWUoJ2xvc2UnKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoaWRlTGFzdFJlc3VsdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RSZXN1bHQpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdFJlc3VsdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgICAgICBpZiAod2luZG93LnZvaWNlICYmIHdpbmRvdy52b2ljZS5sb2NhbElkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWQgPSB3aW5kb3cudm9pY2UubG9jYWxJZDtcclxuICAgICAgICAgICAgd2luZG93LnZvaWNlLmxvY2FsSWQgPSBudWxsO1xyXG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5wYXVzZUFsbCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cucGxheVZvaWNlKGxvY2FsSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWludXRlcyA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDAgLyA2MCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RNaW51dGUgIT0gbWludXRlcykge1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0TWludXRlID0gbWludXRlcztcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICB2YXIgaCA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgaCA9IGggPCAxMCA/IFwiMFwiICsgaCA6IGg7XHJcbiAgICAgICAgICAgIHZhciBtID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgICAgIG0gPSBtIDwgMTAgPyBcIjBcIiArIG0gOiBtO1xyXG4gICAgICAgICAgICB0aGlzLl90aW1lTGFiZWwuc3RyaW5nID0gXCJcIiArIGggKyBcIjpcIiArIG07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9sYXN0UGxheVRpbWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSA+IHRoaXMuX2xhc3RQbGF5VGltZSArIDIwMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vblBsYXllck92ZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RQbGF5VGltZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXlWb2ljZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvblBsYXllck92ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5zdG9wUGxheVZvaWNlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYy52di5hdWRpb01nci5yZXN1bWVBbGwoKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uUGxheUNhbGxiYWNrOlwiICsgdGhpcy5fcGxheWluZ1NlYXQpO1xyXG4gICAgICAgIHZhciBsb2NhbEluZGV4ID0gdGhpcy5fcGxheWluZ1NlYXQ7XHJcbiAgICAgICAgdGhpcy5fcGxheWluZ1NlYXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2xvY2FsSW5kZXhdLnZvaWNlTXNnKGZhbHNlKTtcclxuICAgIH0sXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LnZvaWNlTWdyLnN0b3AoKTtcclxuICAgICAgICAvLyAgICAgICAgY2MudnYudm9pY2VNZ3Iub25QbGF5Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgfSxcclxuICAgIG9uUWlhbmdaaHVhbmdDbGljazogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgbm9kZSA9IGUudGFyZ2V0O1xyXG4gICAgICAgIHZhciBvcGFjaXR5ID0gbm9kZS5vcGFjaXR5O1xyXG4gICAgICAgIGlmIChvcGFjaXR5ID09IDI1NSkge1xyXG4gICAgICAgICAgICB2YXIgYmVpc2h1ID0gMDtcclxuICAgICAgICAgICAgdmFyIG5vZGVOYW1lID0gbm9kZS5uYW1lO1xyXG4gICAgICAgICAgICBiZWlzaHUgPSBub2RlTmFtZS5yZXBsYWNlKCdxaWFuZycsICcnKTtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJxaWFuZ196aHVhbmdcIiwgYmVpc2h1KTtcclxuICAgICAgICAgICAgc2VsZi5oaWRlUWlhbmdaaHVUaXBzKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzWzBdLmhpZGVRaWFuZ1podSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvblhpYVpodUNsaWNrOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciBub2RlID0gZS50YXJnZXQ7XHJcbiAgICAgICAgdmFyIG9wYWNpdHkgPSBub2RlLm9wYWNpdHk7XHJcbiAgICAgICAgaWYgKG9wYWNpdHkgPT0gMjU1KSB7XHJcbiAgICAgICAgICAgIHZhciBiZWlzaHUgPSAwO1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gbm9kZS5nZXRDaGlsZEJ5TmFtZSgnbnVtJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmc7XHJcbiAgICAgICAgICAgIGJlaXNodSA9IHN0ci5yZXBsYWNlKCflgI0nLCAnJyk7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwieGlhX3podVwiLCBiZWlzaHUpO1xyXG4gICAgICAgICAgICBzZWxmLmhpZGVYaWFaaHVUaXBzKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzWzBdLmhpZGVYaWFCZWkoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25Zb3VTaGlDbGljazogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfmnInljYEnLCBlLnRhcmdldCk7XHJcbiAgICAgICAgdmFyIG5pdV9hcnIgPSB0aGlzLl9zZWF0c1swXS5nZXROaXVBcnIoKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnbml1X2FycicsIG5pdV9hcnIpO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwieW91X3NoaVwiLCBuaXVfYXJyKTtcclxuICAgIH0sXHJcbiAgICBvblNhblBhaUNsaWNrOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+aVo+eJjCcsIGUudGFyZ2V0KTtcclxuICAgICAgICBjYy52di5uZXQuc2VuZChcInNhbl9wYWlcIik7XHJcbiAgICB9LFxyXG4gICAgb25QYWlDbGljazogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5fc2VhdHNbMF0uX2NvdW50LmFjdGl2ZSkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBub2RlID0gZS50YXJnZXQ7XHJcbiAgICAgICAgdmFyIG5vZGVOYW1lID0gbm9kZS5uYW1lO1xyXG4gICAgICAgIHZhciBob2xkID0gbm9kZS5ob2xkO1xyXG4gICAgICAgIHZhciBudW0gPSBob2xkICUgMTAwO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdob2xkJywgaG9sZCk7XHJcbiAgICAgICAgaWYgKG5vZGUuaXNDbGlja2VkKSB7XHJcbiAgICAgICAgICAgIG5vZGUuaXNDbGlja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIG5vZGUueSAtPSAyMDtcclxuICAgICAgICAgICAgdGhpcy5fc2VhdHNbMF0udW5zZXRDb3VudChub2RlTmFtZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbm9kZS5pc0NsaWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBub2RlLnkgKz0gMjA7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXRzWzBdLnNldENvdW50KG51bSwgbm9kZU5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBfc3BySWNvbjogbnVsbCxcclxuICAgICAgICBfemh1YW5nOiBudWxsLFxyXG4gICAgICAgIF9yZWFkeTogbnVsbCxcclxuICAgICAgICBfb2ZmbGluZTogbnVsbCxcclxuICAgICAgICBfbGJsTmFtZTogbnVsbCxcclxuICAgICAgICBfbGJsU2NvcmU6IG51bGwsXHJcbiAgICAgICAgX3Njb3JlQmc6IG51bGwsXHJcbiAgICAgICAgX3ZvaWNlbXNnOiBudWxsLFxyXG4gICAgICAgIF9jaGF0QnViYmxlOiBudWxsLFxyXG4gICAgICAgIF9lbW9qaTogbnVsbCxcclxuICAgICAgICBfbGFzdENoYXRUaW1lOiAtMSxcclxuICAgICAgICBfdXNlck5hbWU6IFwiXCIsXHJcbiAgICAgICAgX3Njb3JlOiAwLFxyXG4gICAgICAgIF9pc09mZmxpbmU6IGZhbHNlLFxyXG4gICAgICAgIF9pc1JlYWR5OiBmYWxzZSxcclxuICAgICAgICBfaXNaaHVhbmc6IGZhbHNlLFxyXG4gICAgICAgIF91c2VySWQ6IG51bGwsXHJcbiAgICAgICAgX2lzS2FuUGFpOiBmYWxzZSxcclxuICAgICAgICBfaXNRaVBhaTogZmFsc2UsXHJcbiAgICAgICAgX2lzU2h1OiBmYWxzZSxcclxuICAgICAgICAvLyBfdGltZUxhYmVsOiBudWxsLFxyXG4gICAgICAgIF90aW1lOiAtMSxcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zcHJJY29uID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaGVhZFwiKS5nZXRDb21wb25lbnQoXCJJbWFnZUxvYWRlclwiKTtcclxuICAgICAgICB0aGlzLl9sYmxOYW1lID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwibmFtZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX2xibFNjb3JlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwibW9uZXlcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl9kaWZmX21vbmV5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZGlmZl9tb25leVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJDaGF0QnViYmxlXCIpO1xyXG4gICAgICAgIHRoaXMuX2xhc3RwYWkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsYXN0cGFpXCIpO1xyXG4gICAgICAgIHRoaXMuX2NvbXBsZXRlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY29tcGxldGVcIik7XHJcbiAgICAgICAgdGhpcy5fcWlhbmd6aHUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJxaWFuZ3podVwiKTtcclxuICAgICAgICB0aGlzLl9xaWFuZ3podVRleHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJxaWFuZ3podVRleHRcIik7XHJcbiAgICAgICAgdGhpcy5fZG91bml1X3podSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImRvdW5pdV96aHVcIik7XHJcbiAgICAgICAgdGhpcy5fcGFpID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicGFpXCIpOyAvL+WPquaciXNlYXQw5omN5Lya5pyJXHJcbiAgICAgICAgdGhpcy5fZW1vamkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJlbW9qaVwiKTtcclxuICAgICAgICB0aGlzLl94aWFiZWkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ3hpYWJlaScpO1xyXG4gICAgICAgIHRoaXMuX2JlaXNodVRleHQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiZWlzaHVUZXh0XCIpO1xyXG4gICAgICAgIHRoaXMuX3lvdXNoaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZSgneW91c2hpJyk7XHJcbiAgICAgICAgdGhpcy5fY291bnQgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2NvdW50Jyk7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24gJiYgdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nwckljb24uc2V0VXNlcklEKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uSWNvbkNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBpY29uU3ByaXRlID0gdGhpcy5fc3BySWNvbi5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGlmICh0aGlzLl91c2VySWQgIT0gbnVsbCAmJiB0aGlzLl91c2VySWQgPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0QnlJRCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB2YXIgc2V4ID0gMDtcclxuICAgICAgICAgICAgaWYgKGNjLnZ2LmJhc2VJbmZvTWFwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IGNjLnZ2LmJhc2VJbmZvTWFwW3RoaXMuX3VzZXJJZF07XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNleCA9IGluZm8uc2V4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9sYmxOYW1lICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsTmFtZS5zdHJpbmcgPSB0aGlzLl91c2VyTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUuc3RyaW5nID0gdGhpcy5fc2NvcmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9kaWZmX21vbmV5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGlmZl9tb25leS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fb2ZmbGluZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9vZmZsaW5lLmFjdGl2ZSA9IHRoaXMuX2lzT2ZmbGluZSAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiAoY2MudnYuZ2FtZU5ldE1nci5udW1PZkdhbWVzID4gMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl96aHVhbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5femh1YW5nLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdGhpcy5fdXNlck5hbWUgIT0gbnVsbCAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLl9jaGF0QnViYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9lbW9qaSkge1xyXG4gICAgICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RwYWkpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdHBhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuX2NvbXBsZXRlLmdldENoaWxkQnlOYW1lKCdkb3VuaXVfYmcxJykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuX2NvbXBsZXRlLmdldENoaWxkQnlOYW1lKCd3YW5jaGVuZycpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9jb21wbGV0ZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2JlaXNodVRleHQpIHtcclxuICAgICAgICAgICAgdGhpcy5fYmVpc2h1VGV4dC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3FpYW5nemh1KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3FpYW5nemh1LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcWlhbmd6aHVUZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3FpYW5nemh1VGV4dC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2RvdW5pdV96aHUpIHtcclxuICAgICAgICAgICAgdGhpcy5fZG91bml1X3podS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhaSkge1xyXG4gICAgICAgICAgICB0aGlzLl9wYWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl94aWFiZWkpIHtcclxuICAgICAgICAgICAgdGhpcy5feGlhYmVpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5feW91c2hpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3lvdXNoaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0SW5mbzogZnVuY3Rpb24obmFtZSwgc2NvcmUpIHtcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fc2NvcmUgPSBzY29yZTtcclxuICAgICAgICBpZiAodGhpcy5fc2NvcmUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zY29yZSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9zY29yZUJnICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2NvcmVCZy5hY3RpdmUgPSB0aGlzLl9zY29yZSAhPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fbGJsU2NvcmUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9sYmxTY29yZS5ub2RlLmFjdGl2ZSA9IHRoaXMuX3Njb3JlICE9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfSxcclxuICAgIHNlYXRIaWRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWUgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IDA7XHJcbiAgICB9LFxyXG4gICAgc2V0Wmh1YW5nOiBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX2lzWmh1YW5nID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKHRoaXMuX3podWFuZykge1xyXG4gICAgICAgICAgICB0aGlzLl96aHVhbmcuYWN0aXZlID0gdmFsdWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5femh1YW5nID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiemh1YW5nXCIpO1xyXG4gICAgICAgICAgICB0aGlzLl96aHVhbmcuYWN0aXZlID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldFJlYWR5OiBmdW5jdGlvbihpc1JlYWR5KSB7XHJcbiAgICAgICAgdGhpcy5faXNSZWFkeSA9IGlzUmVhZHk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlYWR5LmFjdGl2ZSA9IHRoaXMuX2lzUmVhZHkgJiYgKGNjLnZ2LmdhbWVOZXRNZ3IubnVtT2ZHYW1lcyA+IDApO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRJRDogZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICB2YXIgaWROb2RlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaWRcIik7XHJcbiAgICAgICAgaWYgKGlkTm9kZSkge1xyXG4gICAgICAgICAgICB2YXIgbGJsID0gaWROb2RlLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgICAgIGxibC5zdHJpbmcgPSBcIklEOlwiICsgaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IGlkO1xyXG4gICAgICAgIGlmICh0aGlzLl9zcHJJY29uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nwckljb24uc2V0VXNlcklEKGlkKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgZ2V0SUQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl91c2VySWQ7XHJcbiAgICB9LFxyXG4gICAgc2V0T2ZmbGluZTogZnVuY3Rpb24oaXNPZmZsaW5lKSB7XHJcbiAgICAgICAgdGhpcy5faXNPZmZsaW5lID0gaXNPZmZsaW5lO1xyXG4gICAgICAgIGlmICh0aGlzLl9vZmZsaW5lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29mZmxpbmUuYWN0aXZlID0gdGhpcy5faXNPZmZsaW5lICYmIHRoaXMuX3VzZXJOYW1lICE9IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNoYXQ6IGZ1bmN0aW9uKGNvbnRlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5fY2hhdEJ1YmJsZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjb250ZW50O1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuZ2V0Q2hpbGRCeU5hbWUoXCJOZXcgTGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjb250ZW50O1xyXG4gICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSA9IDM7XHJcbiAgICB9LFxyXG4gICAgZW1vamk6IGZ1bmN0aW9uKGVtb2ppKSB7XHJcbiAgICAgICAgLy9lbW9qaSA9IEpTT04ucGFyc2UoZW1vamkpO1xyXG4gICAgICAgIGlmICh0aGlzLl9lbW9qaSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coZW1vamkpO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9lbW9qaS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKS5wbGF5KGVtb2ppKTtcclxuICAgICAgICB0aGlzLl9sYXN0Q2hhdFRpbWUgPSAzO1xyXG4gICAgfSxcclxuICAgIHZvaWNlTXNnOiBmdW5jdGlvbihzaG93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3ZvaWNlbXNnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZvaWNlbXNnLmFjdGl2ZSA9IHNob3c7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldE1vbmV5OiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgLy/orr7nva7or6XnjqnlrrbmiYDmi6XmnInnmoTnmoTpkrFcclxuICAgICAgICB0aGlzLl9sYmxTY29yZS5zdHJpbmcgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX3Njb3JlID0gZGF0YTtcclxuICAgIH0sXHJcbiAgICBzZXRUaW1lOiBmdW5jdGlvbihvKSB7XHJcbiAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSA9IDMwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaG93UWlhbmdaaHU6IGZ1bmN0aW9uKGxldmVsKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmICghc2VsZi5fcWlhbmd6aHUpIHJldHVybjtcclxuICAgICAgICBzZWxmLl9xaWFuZ3podS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gc2VsZi5fcWlhbmd6aHUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKGxldmVsIDwgaSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fcWlhbmd6aHUuY2hpbGRyZW5baV0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3FpYW5nemh1LmNoaWxkcmVuW2ldLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaGlkZVFpYW5nWmh1OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9xaWFuZ3podS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93U2VsZlBhaTogZnVuY3Rpb24oc3ByaXRlRnJhbWVzKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChzZWxmLl9wYWkpIHtcclxuICAgICAgICAgICAgc2VsZi5fcGFpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gc2VsZi5fcGFpLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFpID0gc2VsZi5fcGFpLmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhaU9iaiA9IHNwcml0ZUZyYW1lc1tpXTtcclxuICAgICAgICAgICAgICAgIGlmIChwYWlPYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAvL+WmguaenOaciei1hOa6kOWImeaYvuekuu+8jOayoeacieWImemakOiXj1xyXG4gICAgICAgICAgICAgICAgICAgIHBhaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0UGFpKHBhaSwgcGFpT2JqKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBbc2V0UGFpIGRlc2NyaXB0aW9uXVxyXG4gICAgICogQHBhcmFtIHtbdHlwZV19IHBhaSAgICBb54mM55qEbm9kZV1cclxuICAgICAqIEBwYXJhbSB7W3R5cGVdfSBwYWlPYmogW+eJjOeahOi1hOa6kF1cclxuICAgICAqL1xyXG4gICAgc2V0UGFpOiBmdW5jdGlvbihwYWksIHBhaU9iaikge1xyXG4gICAgICAgIHZhciBudW1SZXMgPSBwYWlPYmpbJ251bSddO1xyXG4gICAgICAgIHZhciBodWFzZV9iaWdSZXMgPSBwYWlPYmpbJ2h1YXNlX2JpZyddO1xyXG4gICAgICAgIHZhciBodWFzZV9zbWFsbFJlcyA9IHBhaU9ialsnaHVhc2Vfc21hbGwnXTtcclxuICAgICAgICB2YXIgaG9sZCA9IHBhaU9ialsnaG9sZCddO1xyXG4gICAgICAgIHBhaS5nZXRDaGlsZEJ5TmFtZSgnbnVtJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBudW1SZXM7XHJcbiAgICAgICAgcGFpLmdldENoaWxkQnlOYW1lKCdodWEyJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBodWFzZV9iaWdSZXM7XHJcbiAgICAgICAgcGFpLmdldENoaWxkQnlOYW1lKCdodWExJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBodWFzZV9zbWFsbFJlcztcclxuICAgICAgICBwYWkuaG9sZCA9IGhvbGQ7XHJcbiAgICB9LFxyXG4gICAgc2hvd0JlaVBhaTogZnVuY3Rpb24obnVtKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmICghc2VsZi5fY29tcGxldGUpIHJldHVybjtcclxuICAgICAgICBzZWxmLl9jb21wbGV0ZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gc2VsZi5fY29tcGxldGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgaWYgKGkgPCBudW0pIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX2NvbXBsZXRlLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9jb21wbGV0ZS5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaG93UWlhbmdaaHVUZXh0OiBmdW5jdGlvbihiZWlzaHUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFzZWxmLl9xaWFuZ3podVRleHQpIHJldHVybjtcclxuICAgICAgICBzZWxmLl9xaWFuZ3podVRleHQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX3FpYW5nemh1VGV4dC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoaSA9PSBiZWlzaHUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3FpYW5nemh1VGV4dC5jaGlsZHJlbltpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fcWlhbmd6aHVUZXh0LmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhpZGVRaWFuZ1podVRleHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX3FpYW5nemh1VGV4dCkgcmV0dXJuO1xyXG4gICAgICAgIHNlbGYuX3FpYW5nemh1VGV4dC5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93Wmh1YW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvL+W6hOeahOaYvuekulxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX2RvdW5pdV96aHUpIHJldHVybjtcclxuICAgICAgICBzZWxmLl9kb3VuaXVfemh1LmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgaGlkZVpodWFuZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy/pmpDol4/luoRcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFzZWxmLl9kb3VuaXVfemh1KSByZXR1cm47XHJcbiAgICAgICAgc2VsZi5fZG91bml1X3podS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93WGlhQmVpOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgLy/kuIvms6hcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFzZWxmLl94aWFiZWkpIHJldHVybjtcclxuICAgICAgICBzZWxmLl94aWFiZWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB2YXIgbWF4QmVpc2h1ID0gZGF0YS5tYXhYaWFaaHVCZWlTaHU7XHJcbiAgICAgICAgdmFyIHhpYVpodU9wcyA9IGRhdGEueGlhWmh1T3BzO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gc2VsZi5feGlhYmVpLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gc2VsZi5feGlhYmVpLmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBpZiAoeGlhWmh1T3BzW2ldIDw9IG1heEJlaXNodSkge1xyXG4gICAgICAgICAgICAgICAgdGVtcC5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGVtcC5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRlbXAuZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0geGlhWmh1T3BzW2ldICsgXCLlgI1cIjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaGlkZVhpYUJlaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmICghc2VsZi5feGlhYmVpKSByZXR1cm47XHJcbiAgICAgICAgc2VsZi5feGlhYmVpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHNob3dZb3VTaGk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX3lvdXNoaSkgcmV0dXJuO1xyXG4gICAgICAgIHNlbGYuX3lvdXNoaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGhpZGVZb3VTaGk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX3lvdXNoaSkgcmV0dXJuO1xyXG4gICAgICAgIHNlbGYuX3lvdXNoaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93Q291bnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX2NvdW50KSByZXR1cm47XHJcbiAgICAgICAgc2VsZi5fY291bnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX2NvdW50LmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX2NvdW50LmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoaWRlQ291bnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX2NvdW50KSByZXR1cm47XHJcbiAgICAgICAgc2VsZi5fY291bnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgc2V0Q291bnQ6IGZ1bmN0aW9uKG51bSwgbm9kZU5hbWUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFzZWxmLl9jb3VudCkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBpbmRleCA9IG51bGw7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl9jb3VudC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoaSA+IDIpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IHNlbGYuX2NvdW50LmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBpZiAodGVtcC5hY3RpdmUgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpbmRleCA9PSBudWxsKSByZXR1cm47XHJcbiAgICAgICAgdmFyIGNoaWxkID0gc2VsZi5fY291bnQuY2hpbGRyZW5baW5kZXhdO1xyXG4gICAgICAgIGNoaWxkLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgY2hpbGQubm9kZU5hbWUgPSBub2RlTmFtZTtcclxuICAgICAgICBpZiAobnVtID4gOSkge1xyXG4gICAgICAgICAgICBudW0gPSA5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjaGlsZC5udW0gPSBudW07XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBjaGlsZC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IGNoaWxkLmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICBpZiAoaSA9PSBudW0pIHtcclxuICAgICAgICAgICAgICAgIHRlbXAuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRlbXAuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluZGV4ID09IDIpIHtcclxuICAgICAgICAgICAgLy/lpoLmnpzliY3kuInkuKrloavmu6HkuobvvIzliJnlnKjnrKzlm5vmoLznrpflh7pcclxuICAgICAgICAgICAgdmFyIG51bTAgPSBwYXJzZUludChzZWxmLl9jb3VudC5jaGlsZHJlblswXS5udW0pO1xyXG4gICAgICAgICAgICB2YXIgbnVtMSA9IHBhcnNlSW50KHNlbGYuX2NvdW50LmNoaWxkcmVuWzFdLm51bSk7XHJcbiAgICAgICAgICAgIHZhciBudW0yID0gcGFyc2VJbnQoc2VsZi5fY291bnQuY2hpbGRyZW5bMl0ubnVtKTtcclxuICAgICAgICAgICAgdmFyIHRvdGFsX251bSA9IG51bTAgKyBudW0xICsgbnVtMiArIDM7IC8vKzPnrpflh7rnnJ/lrp7nmoTlgLxcclxuICAgICAgICAgICAgdmFyIHRvdGFsX251bV9zaGkgPSBNYXRoLmZsb29yKHRvdGFsX251bSAvIDEwKTsgLy/ljYHkvY3mlbBcclxuICAgICAgICAgICAgdmFyIHRvdGFsX251bV9nZSA9IHRvdGFsX251bSAlIDEwOyAvL+S4quS9jeaVsFxyXG4gICAgICAgICAgICBzZWxmLl9jb3VudC5nZXRDaGlsZEJ5TmFtZSgncmVzdWx0JykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy/lrZDlhYPntKDlhYjlhajpg6jpmpDol49cclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNlbGYuX2NvdW50LmdldENoaWxkQnlOYW1lKCdyZXN1bHQnKS5jaGlsZHJlbjtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+WIhuexu+aYvuekulxyXG4gICAgICAgICAgICBpZiAodG90YWxfbnVtID4gOSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4X3NoaSA9IHRvdGFsX251bV9zaGkgLSAxO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4X2dlID0gdG90YWxfbnVtX2dlO1xyXG4gICAgICAgICAgICAgICAgdmFyIG45ID0gcmVzdWx0WzldO1xyXG4gICAgICAgICAgICAgICAgbjkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vbjnnmoTlrZDlhYPntKBcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gbjkuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRfbjkgPSBuOS5jaGlsZHJlbltqXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIGNoaWxkX245LmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqID09IDAgJiYgayA9PSBpbmRleF9zaGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5pi+56S65Y2B5L2N5pWwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZF9uOS5jaGlsZHJlbltrXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGogPT0gMSAmJiBrID09IGluZGV4X2dlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aYvuekuuS4quS9jeaVsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRfbjkuY2hpbGRyZW5ba10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkX245LmNoaWxkcmVuW2tdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4X2dlID0gdG90YWxfbnVtX2dlIC0gMTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtpbmRleF9nZV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1bnNldENvdW50OiBmdW5jdGlvbihub2RlTmFtZSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX2NvdW50KSByZXR1cm47XHJcbiAgICAgICAgdmFyIGluZGV4ID0gbnVsbDtcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX2NvdW50LmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gc2VsZi5fY291bnQuY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgIGlmICh0ZW1wLm5vZGVOYW1lID09IG5vZGVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluZGV4ID09IG51bGwpIHJldHVybjtcclxuICAgICAgICBzZWxmLl9jb3VudC5jaGlsZHJlbltpbmRleF0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgc2VsZi5fY291bnQuZ2V0Q2hpbGRCeU5hbWUoJ3Jlc3VsdCcpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHNob3dCZWlTaHVUZXh0OiBmdW5jdGlvbihiZWlzaHUpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFzZWxmLl9iZWlzaHVUZXh0IHx8ICFiZWlzaHUpIHJldHVybjtcclxuICAgICAgICBzZWxmLl9iZWlzaHVUZXh0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdmFyIG51bTAgPSBNYXRoLmZsb29yKHBhcnNlSW50KGJlaXNodSkgLyAxMCk7XHJcbiAgICAgICAgdmFyIG51bTEgPSBwYXJzZUludChiZWlzaHUpICUgMTA7XHJcbiAgICAgICAgdmFyIG51bTBfYXJyID0gc2VsZi5fYmVpc2h1VGV4dC5nZXRDaGlsZEJ5TmFtZSgnbnVtMCcpLmNoaWxkcmVuO1xyXG4gICAgICAgIHZhciBudW0xX2FyciA9IHNlbGYuX2JlaXNodVRleHQuZ2V0Q2hpbGRCeU5hbWUoJ251bTEnKS5jaGlsZHJlbjtcclxuICAgICAgICBmb3IgKHZhciBpIGluIG51bTBfYXJyKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZW1wID0gbnVtMF9hcnJbaV07XHJcbiAgICAgICAgICAgIGlmIChpID09IG51bTApIHtcclxuICAgICAgICAgICAgICAgIHRlbXAuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRlbXAuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBudW0xX2Fycikge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IG51bTFfYXJyW2ldO1xyXG4gICAgICAgICAgICBpZiAoaSA9PSBudW0xKSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhpZGVCZWlTaHVUZXh0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFzZWxmLl9iZWlzaHVUZXh0KSByZXR1cm47XHJcbiAgICAgICAgc2VsZi5fYmVpc2h1VGV4dC5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBnZXROaXVBcnI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoIXNlbGYuX2NvdW50KSByZXR1cm47XHJcbiAgICAgICAgdmFyIG5pdV9hcnIgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX2NvdW50LmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHZhciBuaXUgPSBzZWxmLl9jb3VudC5jaGlsZHJlbltpXS5udW07XHJcbiAgICAgICAgICAgIGlmIChpID4gMiB8fCAhbml1KSByZXR1cm47XHJcbiAgICAgICAgICAgIG5pdV9hcnIucHVzaChuaXUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbml1X2FycjtcclxuICAgIH0sXHJcbiAgICBzbkVuZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy/nrpfniZvnu5PmnZ/vvIzpmpDol49jb3VudOeVjOmdou+8jOaYvuekuuW3suWujOaIkFxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoc2VsZi5fY291bnQpIHtcclxuICAgICAgICAgICAgc2VsZi5fY291bnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzZWxmLl9wYWkpIHtcclxuICAgICAgICAgICAgc2VsZi5fcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuX3BhaS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gc2VsZi5fcGFpLmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgY2hpbGQuaXNDbGlja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBjaGlsZC55ID0gLTk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNlbGYuX3lvdXNoaSkge1xyXG4gICAgICAgICAgICBzZWxmLl95b3VzaGkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuX2NvbXBsZXRlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl9jb21wbGV0ZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBzZWxmLl9jb21wbGV0ZS5jaGlsZHJlbltpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjaGFuZ2VNb25leTogZnVuY3Rpb24obW9uZXkpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2RpZmZfbW9uZXkpIHJldHVybjtcclxuICAgICAgICB2YXIgb2xkX21vbmV5ID0gdGhpcy5fc2NvcmU7XHJcbiAgICAgICAgdmFyIGRpZmZfbW9uZXkgPSBwYXJzZUludChtb25leSkgLSBwYXJzZUludChvbGRfbW9uZXkpO1xyXG4gICAgICAgIGlmIChkaWZmX21vbmV5ID4gMCkge1xyXG4gICAgICAgICAgICBkaWZmX21vbmV5ID0gXCIrXCIgKyBkaWZmX21vbmV5O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9kaWZmX21vbmV5LnN0cmluZyA9IGRpZmZfbW9uZXk7XHJcbiAgICAgICAgdGhpcy5fZGlmZl9tb25leS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fZGlmZl9tb25leS5ub2RlLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgdGhpcy5zZXRNb25leShtb25leSk7XHJcbiAgICAgICAgdmFyIGFjdGlvbiA9IGNjLmZhZGVPdXQoMik7XHJcbiAgICAgICAgdGhpcy5fZGlmZl9tb25leS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgfSxcclxuICAgIHNob3dMYXN0UGFpOiBmdW5jdGlvbihzcHJpdGVGcmFtZXMsIHNjb3JlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmIChzZWxmLl9sYXN0cGFpKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX2xhc3RwYWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBzZWxmLl9sYXN0cGFpLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/niYxcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFpID0gc2VsZi5fbGFzdHBhaS5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFpT2JqID0gc3ByaXRlRnJhbWVzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWlPYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzmnInotYTmupDliJnmmL7npLrvvIzmsqHmnInliJnpmpDol49cclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0UGFpKHBhaSwgcGFpT2JqKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gNikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8v57uT5p6c77yM4oCc5Y2B5bim5LiA4oCd5LmL57G7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGppZWd1byA9IHNlbGYuX2xhc3RwYWkuY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGppZWd1by5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqIGluIGppZWd1by5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBqaWVndW8uY2hpbGRyZW5bal07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29yZVszXSA9PSAnMScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5rKh5pyJ54mbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqaWVndW8uZ2V0Q2hpbGRCeU5hbWUoJ3NhbicpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2NvcmVbM10gPT0gJzQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WNleeJm1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gcGFyc2VJbnQoc2NvcmVbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgamllZ3VvLmdldENoaWxkQnlOYW1lKCdqZycgKyBpbmRleCkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzY29yZVszXSA9PSAnNScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Y+M54mbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqaWVndW8uZ2V0Q2hpbGRCeU5hbWUoJ2pnMCcpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2NvcmVbM10gPT0gJzYnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+eCuOW8uVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgamllZ3VvLmdldENoaWxkQnlOYW1lKCd6aGFkYW4nKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjb3JlWzNdID09ICc3Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kupToirFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGppZWd1by5nZXRDaGlsZEJ5TmFtZSgnd3VodWEnKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjb3JlWzNdID09ICc4Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kupTlsI9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGppZWd1by5nZXRDaGlsZEJ5TmFtZSgnd3V4aWFvJykuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGppZWd1by5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbXBsZXRlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoaWRlTGFzdFBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RwYWkpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdHBhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIHVwZGF0ZTogZnVuY3Rpb24oZHQpIHtcclxuICAgICAgICBpZiAodGhpcy5fbGFzdENoYXRUaW1lID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0Q2hhdFRpbWUgLT0gZHQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9sYXN0Q2hhdFRpbWUgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbW9qaS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3RpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWUgLT0gZHQ7XHJcbiAgICAgICAgICAgIHZhciBwcmUgPSBcIlwiO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fdGltZSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWUgPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ID0gTWF0aC5jZWlsKHRoaXMuX3RpbWUpO1xyXG4gICAgICAgICAgICBpZiAodCA8IDEwKSB7XHJcbiAgICAgICAgICAgICAgICBwcmUgPSBcIjBcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl90aW1lTGFiZWwuc3RyaW5nID0gcHJlICsgdDtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG59KTsiLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX3NlYXRzOiBbXSxcclxuICAgICAgICBfdGltZUxhYmVsOiBudWxsLFxyXG4gICAgICAgIF92b2ljZU1zZ1F1ZXVlOiBbXSxcclxuICAgICAgICBfbGFzdFBsYXlpbmdTZWF0OiBudWxsLFxyXG4gICAgICAgIF9wbGF5aW5nU2VhdDogbnVsbCxcclxuICAgICAgICBfbGFzdFBsYXlUaW1lOiBudWxsLFxyXG4gICAgICAgIF9zaGFyZUNvbnRlbnQ6IG51bGwsXHJcbiAgICAgICAgcGFpZ3JvdXA6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJhY2s6IGNjLk5vZGUsXHJcbiAgICAgICAgZmFuaHVpOiBjYy5Ob2RlLFxyXG4gICAgICAgIGJnOiBjYy5Ob2RlLFxyXG4gICAgICAgIGhlbHBzaG93OiBjYy5Ob2RlLFxyXG4gICAgICAgIGJhY2tBbGVydDogY2MuTm9kZSxcclxuICAgICAgICBiYWNrQWxlcnRfbm86IGNjLk5vZGUsXHJcbiAgICAgICAgZmFuOiBjYy5Ob2RlLFxyXG4gICAgICAgIGppbmJpOiBjYy5Ob2RlLFxyXG4gICAgICAgIGNvdW50ZG93bjogY2MuTGFiZWwsXHJcbiAgICAgICAgd2luOiBjYy5Ob2RlLFxyXG4gICAgICAgIGxvc2U6IGNjLk5vZGUsXHJcbiAgICAgICAgX3BhaTogbnVsbCxcclxuICAgICAgICBfcGFpczogW10sXHJcbiAgICAgICAgX3RleHQ6IG51bGwsXHJcbiAgICAgICAgX3pvbmd6aHU6IG51bGwsXHJcbiAgICAgICAgX2J0bkZpcnN0OiBudWxsLFxyXG4gICAgICAgIF9idG5TZWNvbmQ6IG51bGwsXHJcbiAgICAgICAgX2J0blRoaXJkOiBudWxsLFxyXG4gICAgICAgIF9DaGVja2JveDogW10sXHJcbiAgICAgICAgX3NlY29uZExlZnQ6IFtdLFxyXG4gICAgICAgIF9zZWNvbmRPdGhlcjogW10sXHJcbiAgICAgICAgX3RoaXJkTGVmdDogW10sXHJcbiAgICAgICAgX3RoaXJkT3RoZXI6IFtdLFxyXG4gICAgICAgIF90aGlyZEFsbEluOiBudWxsLFxyXG4gICAgICAgIF90aGlyZEppYXpodTogbnVsbCxcclxuICAgICAgICBfamlhWmh1OiBudWxsLFxyXG4gICAgICAgIF9qaWFaaHVfY292ZXI6IG51bGwsXHJcbiAgICAgICAgX3RpbWVvdXQ6IG51bGwsXHJcbiAgICAgICAgdGltZXJDb3VudGVyOiAwLFxyXG4gICAgfSxcclxuICAgIG9uTG9hZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGNjLnZ2ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChcIlJlQ29ubmVjdFwiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0cy5wdXNoKGNjLmZpbmQoXCJDYW52YXMvc2VhdFwiICsgaSkuZ2V0Q29tcG9uZW50KFwiZHpwa1NlYXRcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl90aW1lTGFiZWwgPSBjYy5maW5kKFwiQ2FudmFzL3RpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl90aXBzID0gY2MuZmluZChcIkNhbnZhcy90aXBzXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fZGlmZW4gPSBjYy5maW5kKFwiQ2FudmFzL2RpZmVuXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fem9uZ3podSA9IGNjLmZpbmQoXCJDYW52YXMvem9uZ3hpYXpodS9sYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX3RleHQgPSBjYy5maW5kKFwiQ2FudmFzL3RleHQwXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fdGV4dC5zdHJpbmcgPSBcIueZveaJi+i1t+Wutig25Lq6Ke+8mlwiICsgY2MudnYuTmV0TWdyLmNvbnN1bWVfbnVtICsgXCIvXCIgKyAyICogY2MudnYuTmV0TWdyLmNvbnN1bWVfbnVtICsgXCIg5omR5YWL54mM77yaNS1BIOmZkOazqCgx5YCN5bqV5rGgKVwiXHJcbiAgICAgICAgdGhpcy5fcGFpID0gY2MuZmluZChcIkNhbnZhcy9wYWlcIik7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9wYWkuY2hpbGRyZW5Db3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BhaXNbaV0gPSB0aGlzLl9wYWkuZ2V0Q2hpbGRCeU5hbWUoXCJwYWlcIiArIGkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2RpZmVuLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9idG5GaXJzdCA9IGNjLmZpbmQoXCJDYW52YXMvYnV0dG9ucy9maXJzdFwiKTtcclxuICAgICAgICB0aGlzLl9idG5TZWNvbmQgPSBjYy5maW5kKFwiQ2FudmFzL2J1dHRvbnMvc2Vjb25kXCIpO1xyXG4gICAgICAgIHRoaXMuX2J0blRoaXJkID0gY2MuZmluZChcIkNhbnZhcy9idXR0b25zL3RoaXJkXCIpO1xyXG4gICAgICAgIHRoaXMuX2J0blRoaXJkLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2J0blNlY29uZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9idG5GaXJzdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2J0bkZpcnN0LmNoaWxkcmVuQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFtpXSA9IHRoaXMuX2J0bkZpcnN0LmNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFtpXS5nZXRDaGlsZEJ5TmFtZSgnYnV0dG9uJykuaW5kZXggPSBpO1xyXG4gICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX0NoZWNrYm94W2ldLmdldENoaWxkQnlOYW1lKCdidXR0b24nKSwgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWNvbmRMZWZ0W2ldID0gdGhpcy5fYnRuU2Vjb25kLmdldENoaWxkQnlOYW1lKCdkaWNoaScgKyBpKTtcclxuICAgICAgICAgICAgdGhpcy5fc2Vjb25kTGVmdFtpXS5pbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fc2Vjb25kTGVmdFtpXSwgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWNvbmRPdGhlcltpXSA9IHRoaXMuX2J0blNlY29uZC5nZXRDaGlsZEJ5TmFtZSgnZGljaGlfY292ZXInICsgaSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlY29uZE90aGVyW2ldLmluZGV4ID0gaTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RoaXJkTGVmdFtpXSA9IHRoaXMuX2J0blRoaXJkLmdldENoaWxkQnlOYW1lKCd0bnVtJyArIGkpO1xyXG4gICAgICAgICAgICB0aGlzLl90aGlyZExlZnRbaV0uaW5kZXggPSBpO1xyXG4gICAgICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX3RoaXJkTGVmdFtpXSwgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLl90aGlyZE90aGVyW2ldID0gdGhpcy5fYnRuVGhpcmQuZ2V0Q2hpbGRCeU5hbWUoJ3RudW1fY292ZXInICsgaSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3RoaXJkT3RoZXJbaV0uaW5kZXggPSBpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fdGhpcmRKaWF6aHUgPSB0aGlzLl9idG5UaGlyZC5nZXRDaGlsZEJ5TmFtZSgndGppYXpodScpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5fdGhpcmRKaWF6aHUsIHRoaXMubm9kZSwgXCJkenBrQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIHRoaXMuX3RoaXJkQWxsSW4gPSB0aGlzLl9idG5UaGlyZC5nZXRDaGlsZEJ5TmFtZSgnc2VsZWN0JykuZ2V0Q2hpbGRCeU5hbWUoJ3F1YW54aWEnKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX3RoaXJkQWxsSW4sIHRoaXMubm9kZSwgXCJkenBrQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIHRoaXMuX2dlblBhaSA9IHRoaXMuX2J0blNlY29uZC5nZXRDaGlsZEJ5TmFtZSgnZ2VucGFpJyk7XHJcbiAgICAgICAgdGhpcy5fcmFuZ1BhaSA9IHRoaXMuX2J0blNlY29uZC5nZXRDaGlsZEJ5TmFtZSgncmFuZ3BhaScpO1xyXG4gICAgICAgIHRoaXMuX3FpUGFpID0gdGhpcy5fYnRuU2Vjb25kLmdldENoaWxkQnlOYW1lKCdxaXBhaScpO1xyXG4gICAgICAgIHRoaXMuX2ppYVpodSA9IHRoaXMuX2J0blNlY29uZC5nZXRDaGlsZEJ5TmFtZSgnamlhemh1Jyk7XHJcbiAgICAgICAgdGhpcy5famlhWmh1X2NvdmVyID0gdGhpcy5fYnRuU2Vjb25kLmdldENoaWxkQnlOYW1lKCdqaWF6aHVfY292ZXInKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX2dlblBhaSwgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9yYW5nUGFpLCB0aGlzLm5vZGUsIFwiZHpwa0FsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX3FpUGFpLCB0aGlzLm5vZGUsIFwiZHpwa0FsbFwiLCBcIm9uQnRuQ2xpY2tlZFwiKTtcclxuICAgICAgICBjYy52di51dGlscy5hZGRDbGlja0V2ZW50KHRoaXMuX2ppYVpodSwgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLmJhY2ssIHRoaXMubm9kZSwgXCJkenBrQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5mYW5odWksIHRoaXMubm9kZSwgXCJkenBrQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5mYW4sIHRoaXMubm9kZSwgXCJkenBrQWxsXCIsIFwib25CdG5DbGlja2VkXCIpO1xyXG4gICAgICAgIGNjLnZ2LnV0aWxzLmFkZENsaWNrRXZlbnQodGhpcy5iZywgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLmJhY2tBbGVydF9ubywgdGhpcy5ub2RlLCBcImR6cGtBbGxcIiwgXCJvbkJ0bkNsaWNrZWRcIik7XHJcbiAgICAgICAgdGhpcy5pbml0VmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdFNlYXRzKCk7XHJcbiAgICAgICAgdGhpcy5pbml0RXZlbnRIYW5kbGVycygpO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwicmVhZHlcIik7XHJcbiAgICAgICAgaWYgKGNjLnZ2LnVzZXJNZ3IucmVjb25uZWN0aW9uID09IDEpIHtcclxuICAgICAgICAgICAgLy/mlq3nur/ph43ov55cclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5yZWNvbm5lY3Rpb24gPSAwO1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImdldEdhbWVJbmZvQnlVc2VyaWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBsYXlCR00oXCJiYWNrLm1wM1wiKTtcclxuICAgICAgICBjYy52di5uZXQuc2VuZChcImdldFVzZXJIb2xkc1wiKTtcclxuICAgIH0sXHJcbiAgICBpbml0VmlldzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5fdGlwcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fem9uZ3podS5zdHJpbmcgPSAwO1xyXG4gICAgICAgIHRoaXMuX2RpZmVuLnN0cmluZyA9IFwi5bqV5rGg77yaXCIgKyAwO1xyXG4gICAgICAgIHRoaXMuX2RpZmVuLm1vbmV5ID0gMDtcclxuICAgIH0sXHJcbiAgICByZXN0YXJ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fem9uZ3podSkgdGhpcy5fem9uZ3podS5zdHJpbmcgPSAwO1xyXG4gICAgICAgIGlmICh0aGlzLl9kaWZlbikge1xyXG4gICAgICAgICAgICB0aGlzLl9kaWZlbi5zdHJpbmcgPSBcIuW6leaxoO+8mlwiICsgMDtcclxuICAgICAgICAgICAgdGhpcy5fZGlmZW4ubW9uZXkgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLndpbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmxvc2UuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3RpcHMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHZhciBzZWF0cyA9IGNjLnZ2Lk5ldE1nci5zZWF0cztcclxuICAgICAgICBpZiAoc2VhdHMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXhCeVVzZXJJZChzZWF0c1tpXS51c2VyaWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnJlc3RhcnQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zdGF0dXMgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwicmVhZHlcIik7XHJcbiAgICB9LFxyXG4gICAgaW5pdFNlYXRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5OZXRNZ3Iuc2VhdHM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXRTaW5nbGVTZWF0KHNlYXRzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaW5pdFNpbmdsZVNlYXQ6IGZ1bmN0aW9uKHNlYXQpIHtcclxuICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKHNlYXQudXNlcmlkKTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0SW5mbyhzZWF0Lm5hbWUsIHNlYXQuc2NvcmUpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zZXRSZWFkeShzZWF0LnJlYWR5KTtcclxuICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0SUQoc2VhdC51c2VyaWQpO1xyXG4gICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS52b2ljZU1zZyhmYWxzZSk7XHJcbiAgICB9LFxyXG4gICAgb25CdG5TZXR0aW5nc0NsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNjLnZ2LnBvcHVwTWdyLnNob3dTZXR0aW5ncygpO1xyXG4gICAgfSxcclxuICAgIC8vIOeCueWHu+WIhuS6q+aMiemSru+8jOS9v+eUqOW+ruS/oeWIhuS6q1xyXG4gICAgb25CdG5XZWljaGF0Q2xpY2tlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuc2hhcmUuc2hvdygpO1xyXG4gICAgfSxcclxuICAgIG9uQnRuQ2xpY2tlZDogZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJiYWNrXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5mYW5odWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwiYmdcIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwc2hvdy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2J0blRoaXJkLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYnRuVGhpcmQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9idG5TZWNvbmQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJmYW5cIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5iYWNrQWxlcnQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwicGFpXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5mYW5odWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaGVscHNob3cuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lID09IFwibm9cIikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5iYWNrQWxlcnQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImJ1dHRvblwiKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fQ2hlY2tib3gubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQuaW5kZXggPT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9DaGVja2JveFtpXS5nZXRDb21wb25lbnQoXCJDaGVja0JveFwiKS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbaV0uZ2V0Q29tcG9uZW50KFwiQ2hlY2tCb3hcIikucmVmcmVzaCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJyYW5ncGFpXCIpIHtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJyYW5ncGFpXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT0gXCJxaXBhaVwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwicWlwYWlcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImdlbnBhaVwiKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZ2VucGFpXCIsIGV2ZW50LnRhcmdldC5tb25leSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZSA9PSBcImppYXpodVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0blRoaXJkLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0blNlY29uZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lLmluZGV4T2YoJ2RpY2hpJykgPiAtMSkge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImppYXpodVwiLCBldmVudC50YXJnZXQubW9uZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5hbWUuaW5kZXhPZigndG51bScpID4gLTEpIHtcclxuICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJqaWF6aHVcIiwgZXZlbnQudGFyZ2V0Lm1vbmV5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5uYW1lLmluZGV4T2YoJ3RqaWF6aHUnKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiamlhemh1XCIsIGV2ZW50LnRhcmdldC5tb25leSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChldmVudC50YXJnZXQubmFtZS5pbmRleE9mKCdxdWFueGlhJykgPiAtMSkge1xyXG4gICAgICAgICAgICBjYy52di5uZXQuc2VuZChcImppYXpodVwiLCBldmVudC50YXJnZXQubW9uZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbkJ0bkV4aXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuYmFja0FsZXJ0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZXhpdFwiKTtcclxuICAgIH0sXHJcbiAgICBvbkJ0bkV4Y2hhbmdlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmJhY2tBbGVydC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmZhbmh1aS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBjYy52di51c2VyTWdyLmV4Y2hhbmdlID0gMTtcclxuICAgICAgICBjYy52di5uZXQuc2VuZChcImV4aXRcIik7XHJcbiAgICB9LFxyXG4gICAgcGxheVZvaWNlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fcGxheWluZ1NlYXQgPT0gbnVsbCAmJiB0aGlzLl92b2ljZU1zZ1F1ZXVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXlWb2ljZVwiKTtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl92b2ljZU1zZ1F1ZXVlLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5OZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLnNlbmRlcik7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbEluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXgoaWR4KTtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWluZ1NlYXQgPSBsb2NhbEluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyh0cnVlKTtcclxuICAgICAgICAgICAgdmFyIG1zZ0luZm8gPSBKU09OLnBhcnNlKGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgICAgIHZhciBtc2dmaWxlID0gXCJ2b2ljZW1zZy5hbXJcIjtcclxuICAgICAgICAgICAgdGhpcy5fbGFzdFBsYXlUaW1lID0gRGF0ZS5ub3coKSArIG1zZ0luZm8udGltZTtcclxuICAgICAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJpZCA9IG1zZ0luZm9bJ21zZyddO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmRvd25sb2FkVm9pY2Uoc2VydmVyaWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLnZ2LnZvaWNlTWdyLndyaXRlVm9pY2UobXNnZmlsZSwgbXNnSW5mby5tc2cpO1xyXG4gICAgICAgICAgICBjYy52di52b2ljZU1nci5wbGF5KG1zZ2ZpbGUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+i9rOaNouWvueW6lOeahOeJjFxyXG4gICAgQ29udmVyc2lvbkNhcmRSZXM6IGZ1bmN0aW9uKG4pIHtcclxuICAgICAgICB2YXIgdHlwZSA9IDQ7XHJcbiAgICAgICAgdmFyIGNvbG9yID0gMTtcclxuICAgICAgICBpZiAobiA+PSAxMyAmJiBuIDwgMjYpIHtcclxuICAgICAgICAgICAgdHlwZSA9IDM7XHJcbiAgICAgICAgICAgIG4gPSBuIC0gMTM7XHJcbiAgICAgICAgICAgIGNvbG9yID0gMjtcclxuICAgICAgICB9IGVsc2UgaWYgKG4gPj0gMjYgJiYgbiA8IDM5KSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAyO1xyXG4gICAgICAgICAgICBuID0gbiAtIDI2O1xyXG4gICAgICAgIH0gZWxzZSBpZiAobiA+PSAzOSAmJiBuIDwgNTIpIHtcclxuICAgICAgICAgICAgdHlwZSA9IDE7XHJcbiAgICAgICAgICAgIG4gPSBuIC0gMzk7XHJcbiAgICAgICAgICAgIGNvbG9yID0gMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0eXBlID0gNDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG51bSA9IDA7XHJcbiAgICAgICAgbnVtID0gbiArIDI7XHJcbiAgICAgICAgaWYgKG51bSA9PSAxNCkge1xyXG4gICAgICAgICAgICBudW0gPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgbnVtOiB0aGlzLnBhaWdyb3VwLmdldFNwcml0ZUZyYW1lKG51bSArIFwiLVwiICsgY29sb3IpLFxyXG4gICAgICAgICAgICBoX3M6IHRoaXMucGFpZ3JvdXAuZ2V0U3ByaXRlRnJhbWUoXCJodWFzZV9zbWFsbDBcIiArIHR5cGUpLFxyXG4gICAgICAgICAgICBoX2I6IHRoaXMucGFpZ3JvdXAuZ2V0U3ByaXRlRnJhbWUoXCJodWFzZV9iaWcwXCIgKyB0eXBlKSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfSxcclxuICAgIHNob3dPdGhlclNlYXQ6IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICB2YXIgc2VhdHMgPSBjYy52di5OZXRNZ3Iuc2VhdHM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWF0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKHNlYXRzW2ldLnVzZXJpZCk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlID09IDEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zaG93QmVpUGFpKHRydWUpOyAvL+aYvuekuueJjOeahOiDjOmdolxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlID09IDIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlYXRzW2luZGV4XS5zaG93T3BzKCk7IC8v6ZqQ6JeP5YW25LuW5qGM5a2Q55qE5pON5L2caWNvblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLmhpZGVTY29yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcbiAgICBzZXRCdG5PcHM6IGZ1bmN0aW9uKHR5cGUsIG9iaikge1xyXG4gICAgICAgIGlmICh0eXBlID09IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnRuRmlyc3QuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0blRoaXJkLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9idG5TZWNvbmQuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fYnRuVGhpcmQuZ2V0Q2hpbGRCeU5hbWUoXCJzZWxlY3RcIikuZ2V0Q2hpbGRCeU5hbWUoXCJzbGlkZXJcIikuZ2V0Q2hpbGRCeU5hbWUoXCJIYW5kbGVcIikueSA9IC0xNzI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09IDIpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnRuU2Vjb25kLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9idG5GaXJzdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9idG5UaGlyZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbMl0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzNdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzRdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZSA9PSAzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0blRoaXJkLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0blNlY29uZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fYnRuRmlyc3QuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09IDQpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnRuVGhpcmQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX2J0blNlY29uZC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fYnRuRmlyc3QuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09IDUpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl90aGlyZExlZnQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RoaXJkTGVmdFtpXS5nZXRDaGlsZEJ5TmFtZSgnbnVtJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBvYmpbaV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90aGlyZExlZnRbaV0ubW9uZXkgPSBvYmpbaV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90aGlyZE90aGVyW2ldLmdldENoaWxkQnlOYW1lKCdudW0nKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IG9ialtpXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JqICYmIHR5cGUgIT0gNSkge1xyXG4gICAgICAgICAgICBpZiAob2JqLmNhbkdlbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2VuUGFpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYW5nUGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2VuUGFpLm1vbmV5ID0gb2JqLkdlbk1vbmV5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2VuUGFpLmdldENoaWxkQnlOYW1lKCdudW0nKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi6LefXCIgKyBvYmouR2VuTW9uZXk7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLm5lZWRBbGxJbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2dlblBhaS5nZXRDaGlsZEJ5TmFtZSgnbnVtJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuWFqOS4i1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ppYVpodS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9qaWFaaHVfY292ZXIuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5famlhWmh1LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5famlhWmh1X2NvdmVyLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2VuUGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFuZ1BhaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5famlhWmh1X2NvdmVyLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWNvbmRMZWZ0W2ldLmdldENoaWxkQnlOYW1lKCd0aXRsZScpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gb2JqLmV4dHJhQWRkT3BzW2ldLmRlc2M7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWNvbmRMZWZ0W2ldLm1vbmV5ID0gb2JqLmV4dHJhQWRkT3BzW2ldLm1vbmV5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2Vjb25kT3RoZXJbaV0uZ2V0Q2hpbGRCeU5hbWUoJ3RpdGxlJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBvYmouZXh0cmFBZGRPcHNbaV0uZGVzYztcclxuICAgICAgICAgICAgICAgIGlmIChvYmouYWRkTWF4TW9uZXkgPj0gb2JqLmV4dHJhQWRkT3BzW2ldLm1vbmV5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2Vjb25kTGVmdFtpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlY29uZE90aGVyW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWNvbmRMZWZ0W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlY29uZE90aGVyW2ldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqLm5lZWRBbGxJbiAmJiB0aGlzLl9nZW5QYWkubW9uZXkgPCBvYmouZXh0cmFBZGRPcHNbaV0ubW9uZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWNvbmRMZWZ0W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlY29uZE90aGVyW2ldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChvYmouYWRkTWF4TW9uZXkgPj0gdGhpcy5fdGhpcmRMZWZ0W2ldLm1vbmV5ICYmIG9iai5hZGRNaW5Nb25leSA8PSB0aGlzLl90aGlyZExlZnRbaV0ubW9uZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90aGlyZExlZnRbaV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90aGlyZE90aGVyW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90aGlyZExlZnRbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGhpcmRPdGhlcltpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICByZWZyZXNoRmlyc3RCdG46IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBpZiAocGFyc2VJbnQoZGF0YS5hcmdTdGF0dXMpID09IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbMV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzJdLmdldENoaWxkQnlOYW1lKFwidGV4dFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi6LefXCIgKyBkYXRhLmdlbk1vbmV5O1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFsxXS5nZXRDb21wb25lbnQoXCJDaGVja0JveFwiKS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzFdLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhcnNlSW50KGRhdGEuYXJnU3RhdHVzKSA9PSAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzFdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFsyXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFsyXS5nZXRDaGlsZEJ5TmFtZShcInRleHRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuWFqOS4i1wiO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFszXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbNF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbMV0uZ2V0Q29tcG9uZW50KFwiQ2hlY2tCb3hcIikuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFsxXS5nZXRDb21wb25lbnQoXCJDaGVja0JveFwiKS5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzNdLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbM10uZ2V0Q29tcG9uZW50KFwiQ2hlY2tCb3hcIikucmVmcmVzaCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94WzJdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFszXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9DaGVja2JveFs0XS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fQ2hlY2tib3hbMl0ubW9uZXkgPSBkYXRhLmdlbk1vbmV5O1xyXG4gICAgICAgIHRoaXMuX0NoZWNrYm94WzJdLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9DaGVja2JveFsyXS5nZXRDb21wb25lbnQoXCJDaGVja0JveFwiKS5yZWZyZXNoKCk7XHJcbiAgICB9LFxyXG4gICAgcHJlcE9wczogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYnRuRmlyc3QuY2hpbGRyZW5Db3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9DaGVja2JveFtpXS5nZXRDb21wb25lbnQoXCJDaGVja0JveFwiKS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA9PSAwICYmIGRhdGEuY2FuR3VvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJyYW5ncGFpXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpID09IDAgJiYgIWRhdGEuY2FuR3VvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJxaXBhaVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpID09IDEgJiYgZGF0YS5jYW5HdW8pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYy52di5uZXQuc2VuZChcInJhbmdwYWlcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA9PSAyICYmIGRhdGEuY2FuR2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MudnYubmV0LnNlbmQoXCJnZW5wYWlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MudnYubmV0LnNlbmQoXCJqaWF6aHVcIiwgdGhpcy5fQ2hlY2tib3hbaV0ubW9uZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT0gMyAmJiBkYXRhLmNhbkdlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZ2VucGFpXCIsIHRoaXMuX0NoZWNrYm94WzJdLm1vbmV5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94W2ldLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94W2ldLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1bmNoZWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYnRuRmlyc3QuY2hpbGRyZW5Db3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX0NoZWNrYm94W2ldLmdldENvbXBvbmVudChcIkNoZWNrQm94XCIpLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fQ2hlY2tib3hbaV0uZ2V0Q29tcG9uZW50KFwiQ2hlY2tCb3hcIikucmVmcmVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvblNsaWRlckJhY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5fdGhpcmRBbGxJbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB2YXIgbnVtID0gMDtcclxuICAgICAgICBpZiAoZXZlbnQucHJvZ3Jlc3MgPj0gMC4xICYmIGV2ZW50LnByb2dyZXNzIDwgMC4yKSB7XHJcbiAgICAgICAgICAgIG51bSA9IDEwMDtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnByb2dyZXNzID49IDAuMiAmJiBldmVudC5wcm9ncmVzcyA8IDAuMykge1xyXG4gICAgICAgICAgICBudW0gPSAyMDA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5wcm9ncmVzcyA+PSAwLjMgJiYgZXZlbnQucHJvZ3Jlc3MgPCAwLjQpIHtcclxuICAgICAgICAgICAgbnVtID0gMzAwO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQucHJvZ3Jlc3MgPj0gMC40ICYmIGV2ZW50LnByb2dyZXNzIDwgMC41KSB7XHJcbiAgICAgICAgICAgIG51bSA9IDQwMDtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnByb2dyZXNzID49IDAuNSAmJiBldmVudC5wcm9ncmVzcyA8IDAuNikge1xyXG4gICAgICAgICAgICBudW0gPSA1MDA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5wcm9ncmVzcyA+PSAwLjYgJiYgZXZlbnQucHJvZ3Jlc3MgPCAwLjcpIHtcclxuICAgICAgICAgICAgbnVtID0gNjAwO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQucHJvZ3Jlc3MgPj0gMC43ICYmIGV2ZW50LnByb2dyZXNzIDwgMC44KSB7XHJcbiAgICAgICAgICAgIG51bSA9IDcwMDtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnByb2dyZXNzID49IDAuOCAmJiBldmVudC5wcm9ncmVzcyA8IDAuOSkge1xyXG4gICAgICAgICAgICBudW0gPSA4MDA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChldmVudC5wcm9ncmVzcyA+PSAwLjkgJiYgZXZlbnQucHJvZ3Jlc3MgPCAxKSB7XHJcbiAgICAgICAgICAgIG51bSA9IDkwMDtcclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnByb2dyZXNzID09IDEpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3NlYXRzWzBdLl9zY29yZSA9PSB0aGlzLl90aGlyZEppYXpodS5tYXhNb25leSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhpcmRBbGxJbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGhpcmRBbGxJbi5tb25leSA9IHRoaXMuX3RoaXJkSmlhemh1Lm1heE1vbmV5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG51bSA9IDEwMDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgodGhpcy5fdGhpcmRKaWF6aHUuZmlyc3RNb25leSArIG51bSkgPj0gdGhpcy5fdGhpcmRKaWF6aHUubWF4TW9uZXkpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGhpcmRKaWF6aHUubW9uZXkgPSB0aGlzLl90aGlyZEppYXpodS5tYXhNb25leTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl90aGlyZEppYXpodS5tb25leSA9IHRoaXMuX3RoaXJkSmlhemh1LmZpcnN0TW9uZXkgKyBudW07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3RoaXJkSmlhemh1LmdldENoaWxkQnlOYW1lKCdsYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5fdGhpcmRKaWF6aHUubW9uZXk7XHJcbiAgICB9LFxyXG4gICAgLy/mlq3nur/ph43ov57liLfmlrDkv6Hmga9cclxuICAgIFJlY29ubmVjdGlvbkluZm86IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBpZiAoZGF0YS5hZGRPcHRpb25zLmxlbmd0aCA9PSA1KSB0aGlzLnNldEJ0bk9wcyg1LCBkYXRhLmFkZE9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX2RpZmVuLnN0cmluZyA9IFwi5bqV5rGg77yaXCIgKyBkYXRhLmRpQ2hpO1xyXG4gICAgICAgIHRoaXMuX2RpZmVuLm1vbmV5ID0gZGF0YS5kaUNoaTtcclxuICAgICAgICB0aGlzLl90aXBzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKGRhdGEuY2lyY2xlSG9sZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuY2lyY2xlSG9sZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYWlSZXMgPSB0aGlzLkNvbnZlcnNpb25DYXJkUmVzKHBhcnNlSW50KGRhdGEuY2lyY2xlSG9sZHNbaV0pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhaXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gcGFpUmVzWydudW0nXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhaXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IHBhaVJlc1snaF9zJ107XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wYWlzW2ldLmdldENoaWxkQnlOYW1lKCdodWEyJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBwYWlSZXNbJ2hfYiddO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fcGFpc1tkYXRhLmNpcmNsZUhvbGRzLmxlbmd0aCAtIDFdKSB0aGlzLl9wYWlzW2RhdGEuY2lyY2xlSG9sZHMubGVuZ3RoIC0gMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhaXNbZGF0YS5jaXJjbGVIb2xkcy5sZW5ndGhdKSB0aGlzLl9wYWlzW2RhdGEuY2lyY2xlSG9sZHMubGVuZ3RoXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhaXNbZGF0YS5jaXJjbGVIb2xkcy5sZW5ndGggKyAxXSkgdGhpcy5fcGFpc1tkYXRhLmNpcmNsZUhvbGRzLmxlbmd0aCArIDFdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9wYWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnBsYXllcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXhCeVVzZXJJZChkYXRhLnBsYXllcnNbaV0udXNlcmlkKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEucGxheWVyc1tpXS5jYW5PcHMpIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIGluZGV4ICsgJy90b2dnbGUnKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnNldFRpbWUoZGF0YS50aW1lcl9Db3VudGVyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIGluZGV4ICsgJy90b2dnbGUnKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgemh1ID0ge1xyXG4gICAgICAgICAgICAgICAgbW9uZXk6IGRhdGEucGxheWVyc1tpXS5jWmh1LFxyXG4gICAgICAgICAgICAgICAgdHlwZTogMSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5fc2VhdHNbaW5kZXhdLnNldFpodSh6aHUpO1xyXG4gICAgICAgICAgICB0aGlzLl9zZWF0c1tpbmRleF0uc2V0TW9uZXkoZGF0YS5wbGF5ZXJzW2ldLm1vbmV5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaG93T3RoZXJTZWF0KDEpO1xyXG4gICAgICAgIGNjLnZ2Lm5ldC5zZW5kKFwiZ2V0VXNlckluZm9CeVVzZXJpZFwiKTtcclxuICAgIH0sXHJcbiAgICBpbml0RXZlbnRIYW5kbGVyczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuTmV0TWdyLmRhdGFFdmVudEhhbmRsZXIgPSB0aGlzLm5vZGU7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignbmV3X3VzZXInLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIC8v5paw5Lq65Yqg5YWl5oi/6Ze0XHJcbiAgICAgICAgICAgIHNlbGYuaW5pdFNpbmdsZVNlYXQoZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9iZWdpbicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgc2VsZi5fdGlwcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEucGxheWVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlYXQgPSBjYy52di5OZXRNZ3IuZ2V0U2VhdEJ5SUQoZGF0YS5wbGF5ZXJzW2ldLnVzZXJpZCk7XHJcbiAgICAgICAgICAgICAgICBzZWF0LnNjb3JlID0gZGF0YS5wbGF5ZXJzW2ldLm1vbmV5O1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXhCeVVzZXJJZChkYXRhLnBsYXllcnNbaV0udXNlcmlkKTtcclxuICAgICAgICAgICAgICAgIHZhciB6aHUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9uZXk6IGRhdGEucGxheWVyc1tpXS5jWmh1LFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IDEsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNldFpodSh6aHUpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNldE1vbmV5KHNlYXQuc2NvcmUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5nYW1lSW5mby5hZGRPcHRpb25zLmxlbmd0aCA9PSA1KSBzZWxmLnNldEJ0bk9wcyg1LCBkYXRhLmdhbWVJbmZvLmFkZE9wdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignc29ja2V0X015SG9sZHMnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuX3NlYXRzWzBdLl9wYWkuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGlwcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzWzBdLnNldFBhaShkYXRhLCBzZWxmKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9kaUNoaVVwZGF0ZScsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5fZGlmZW4uc3RyaW5nID0gXCLlupXmsaDvvJpcIiArIGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLl9kaWZlbi5tb25leSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9teUluZm8nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGNjLnZ2Lk5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWQoZGF0YS51c2VyaWQpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2V0UGFpKGRhdGEuaG9sZHMsIHNlbGYpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2V0TW9uZXkoZGF0YS5tb25leSk7XHJcbiAgICAgICAgICAgIHNlbGYuc2hvd090aGVyU2VhdCgxKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfbXlUdXJuJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKGRhdGEudXNlcmlkKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCA1OyB0KyspIHtcclxuICAgICAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIHQgKyAnL3RvZ2dsZScpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0JyArIGluZGV4ICsgJy90b2dnbGUnKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2V0VGltZSgpO1xyXG4gICAgICAgICAgICBzZWxmLnNldEJ0bk9wcygxLCBkYXRhKTtcclxuICAgICAgICAgICAgc2VsZi5fdGhpcmRKaWF6aHUuZ2V0Q2hpbGRCeU5hbWUoJ2xhYmVsJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRhLmFkZE1pbk1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLl90aGlyZEppYXpodS5tb25leSA9IGRhdGEuYWRkTWluTW9uZXk7XHJcbiAgICAgICAgICAgIHNlbGYuX3RoaXJkSmlhemh1LmZpcnN0TW9uZXkgPSBkYXRhLmFkZE1pbk1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLl90aGlyZEppYXpodS5tYXhNb25leSA9IGRhdGEuYWRkTWF4TW9uZXk7XHJcbiAgICAgICAgICAgIHNlbGYucHJlcE9wcyhkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfdHVybkNoYW5nZWQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGNjLnZ2Lk5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWQoZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IDU7IHQrKykge1xyXG4gICAgICAgICAgICAgICAgY2MuZmluZCgnQ2FudmFzL3NlYXQnICsgdCArICcvdG9nZ2xlJykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2MuZmluZCgnQ2FudmFzL3NlYXQnICsgaW5kZXggKyAnL3RvZ2dsZScpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zZXRUaW1lKCk7XHJcbiAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0MC90b2dnbGUnKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX3NlYXRzWzBdLl9wYWkuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fc2VhdHNbMF0uc3RhdHVzID09IFwiQWxsSW5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0QnRuT3BzKDQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNldEJ0bk9wcygyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9vbmVHdW8nLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGNjLnZ2Lk5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWQoZGF0YS5kZXRhaWwpO1xyXG4gICAgICAgICAgICBjYy5maW5kKCdDYW52YXMvc2VhdCcgKyBpbmRleCArICcvdG9nZ2xlJykuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zaG93T3BzKCdyYW5ncGFpJyk7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLl9zZWF0c1swXS5fcGFpLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zZXRCdG5PcHMoMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfb25lR2VuJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKGRhdGEudXNlcmlkKTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNob3dPcHMoJ2dlbnBhaScpO1xyXG4gICAgICAgICAgICB2YXIgZCA9IHtcclxuICAgICAgICAgICAgICAgIG1vbmV5OiBkYXRhLmNaaHUsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAxXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNldE1vbmV5KGRhdGEubW9uZXkpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2V0Wmh1KGQpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5fc2VhdHNbMF0uX3BhaS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0QnRuT3BzKDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX29uZUFkZCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXhCeVVzZXJJZChkYXRhLnVzZXJpZCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zaG93T3BzKCdqaWF6aHUnKTtcclxuICAgICAgICAgICAgdmFyIGQgPSB7XHJcbiAgICAgICAgICAgICAgICBtb25leTogZGF0YS5jWmh1LFxyXG4gICAgICAgICAgICAgICAgdHlwZTogMVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zZXRNb25leShkYXRhLm1vbmV5KTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNldFpodShkKTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX3NlYXRzWzBdLl9wYWkuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNldEJ0bk9wcygyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9vbmVBbGxJbicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXhCeVVzZXJJZChkYXRhLnVzZXJpZCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zaG93T3BzKCdxdWFueGlhJyk7XHJcbiAgICAgICAgICAgIHZhciBkID0ge1xyXG4gICAgICAgICAgICAgICAgbW9uZXk6IGRhdGEuY1podSxcclxuICAgICAgICAgICAgICAgIHR5cGU6IDFcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2V0TW9uZXkoZGF0YS5tb25leSk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zZXRaaHUoZCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zdGF0dXMgPSBkYXRhLnN0YXR1cztcclxuICAgICAgICAgICAgaWYgKHNlbGYuX3NlYXRzWzBdLl9wYWkuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2MudnYudXNlck1nci51c2VySWQgPT0gZGF0YS51c2VyaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNldEJ0bk9wcyg0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9vbmVRdWl0JywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICAgICAgY2MuZmluZCgnQ2FudmFzL3NlYXQnICsgaW5kZXggKyAnL3RvZ2dsZScpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2hvd09wcygncWlwYWknKTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNob3dCZWlQYWkoZmFsc2UpO1xyXG4gICAgICAgICAgICBpZiAoY2MudnYudXNlck1nci51c2VySWQgPT0gZGF0YS5kZXRhaWwpIHNlbGYuc2V0QnRuT3BzKDQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9hbGxHdW8nLGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuX3NlYXRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZihzZWxmLl9zZWF0c1tpXS5ub2RlLmFjdGl2ZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbmV5OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAxXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzW2ldLnNldFpodShkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfcGxheWVyc0luTmV3Q2lyY2xlJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWF0ID0gY2MudnYuTmV0TWdyLmdldFNlYXRCeUlEKGRhdGFbaV0udXNlcmlkKTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VhdC5zY29yZSA9IGRhdGEubW9uZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXhCeVVzZXJJZChkYXRhW2ldLnVzZXJpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2MuZmluZCgnQ2FudmFzL3NlYXQnICsgaW5kZXggKyAnL3RvZ2dsZScpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9zZWF0c1tpbmRleF0uc3RhdHVzICE9IFwiQWxsSW5cIikgc2VsZi5fc2VhdHNbaW5kZXhdLnNob3dPcHMoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2V0TW9uZXkoZGF0YVtpXS5tb25leSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdmFyIGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIG1vbmV5OiBkYXRhW2ldLmNaaHUsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHR5cGU6IDFcclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5fc2VhdHNbaW5kZXhdLnNldFpodShkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5fc2VhdHNbaW5kZXhdLl9wYWltaWFuICYmICFzZWxmLl9zZWF0c1tpbmRleF0uX3BhaW1pYW4uYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5oaWRlU2NvcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuX3NlYXRzWzBdLl9wYWkuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9zZWF0c1tpbmRleF0uc3RhdHVzID09IFwiQWxsSW5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRCdG5PcHMoNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNldEJ0bk9wcygyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzWzBdLmhpZGVTY29yZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfbmV3Q2lyY2xlJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLl96b25nemh1LnN0cmluZyA9IHNlbGYuX2RpZmVuLm1vbmV5O1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuY2lyY2xlSG9sZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYWlSZXMgPSBzZWxmLkNvbnZlcnNpb25DYXJkUmVzKHBhcnNlSW50KGRhdGEuY2lyY2xlSG9sZHNbaV0pKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3BhaXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gcGFpUmVzWydudW0nXTtcclxuICAgICAgICAgICAgICAgIHNlbGYuX3BhaXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IHBhaVJlc1snaF9zJ107XHJcbiAgICAgICAgICAgICAgICBzZWxmLl9wYWlzW2ldLmdldENoaWxkQnlOYW1lKCdodWEyJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBwYWlSZXNbJ2hfYiddO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5fcGFpc1tkYXRhLmNpcmNsZUhvbGRzLmxlbmd0aCAtIDFdKSBzZWxmLl9wYWlzW2RhdGEuY2lyY2xlSG9sZHMubGVuZ3RoIC0gMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX3BhaXNbZGF0YS5jaXJjbGVIb2xkcy5sZW5ndGhdKSBzZWxmLl9wYWlzW2RhdGEuY2lyY2xlSG9sZHMubGVuZ3RoXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX3BhaXNbZGF0YS5jaXJjbGVIb2xkcy5sZW5ndGggKyAxXSkgc2VsZi5fcGFpc1tkYXRhLmNpcmNsZUhvbGRzLmxlbmd0aCArIDFdLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLl9wYWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfY2FjdWxhdGVSZXN1bHQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNjLmZpbmQoJ0NhbnZhcy9zZWF0MC90b2dnbGUnKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfbXlBUkdTdGF0dXNDaGFuZ2VkJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBzZWxmLnJlZnJlc2hGaXJzdEJ0bihkYXRhLmRldGFpbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX2dhbWVJbmZvQnlJZCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi5SZWNvbm5lY3Rpb25JbmZvKGRhdGEuZGV0YWlsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfdXNlckluZm9CeUlkJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKGRhdGEudXNlcmlkKTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbaW5kZXhdLnNldFBhaShkYXRhLmhvbGRzLCBzZWxmKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuY2FuT3BzKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNldEJ0bk9wcygxLCBkYXRhKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuc2V0QnRuT3BzKDIsIGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlbGYuX3RoaXJkSmlhemh1LmdldENoaWxkQnlOYW1lKCdsYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZGF0YS5hZGRNaW5Nb25leTtcclxuICAgICAgICAgICAgc2VsZi5fdGhpcmRKaWF6aHUubW9uZXkgPSBkYXRhLmFkZE1pbk1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLl90aGlyZEppYXpodS5maXJzdE1vbmV5ID0gZGF0YS5hZGRNaW5Nb25leTtcclxuICAgICAgICAgICAgc2VsZi5fdGhpcmRKaWF6aHUubWF4TW9uZXkgPSBkYXRhLmFkZE1heE1vbmV5O1xyXG4gICAgICAgICAgICBzZWxmLnByZXBPcHMoZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdnYW1lX3dpbm5lcicsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgc2VsZi53aW4uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2dhbWVfbG9zZXInLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHNlbGYubG9zZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZ2FtZV9vdmVyJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLnNob3dPdGhlclNlYXQoMik7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlYXQgPSBjYy52di5OZXRNZ3IuZ2V0U2VhdEJ5SUQoZGF0YVtpXS51c2VyaWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWF0LnNjb3JlID0gZGF0YVtpXS5tb25leTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBjYy52di5OZXRNZ3IuZ2V0TG9jYWxJbmRleEJ5VXNlcklkKGRhdGFbaV0udXNlcmlkKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2hvd0hvbGRzUGFpKGRhdGFbaV0uaG9sZHMsIHNlbGYpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zZXRNb25leShkYXRhW2ldLm1vbmV5KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtpXS5pc1dpbm5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2hvd1dpblRleHQocGFyc2VJbnQoZGF0YVtpXS5zY29yZVswXSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3NlYXRzW2luZGV4XS5zaG93V2luVGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLnNldEJ0bk9wcyg0KTtcclxuICAgICAgICAgICAgc2VsZi5fdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlc3RhcnQoKTtcclxuICAgICAgICAgICAgfSwgMzAwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCd1c2VyX3N0YXRlX2NoYW5nZWQnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGNjLnZ2Lk5ldE1nci5nZXRMb2NhbEluZGV4QnlVc2VySWQoc2VhdC51c2VyaWQpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tpbmRleF0uc2VhdEhpZGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ2V4aXRfcmVzdWx0JywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHNlbGYuX3RpbWVvdXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbigndm9pY2VfbXNnJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLl92b2ljZU1zZ1F1ZXVlLnB1c2goZGF0YSk7XHJcbiAgICAgICAgICAgIHNlbGYucGxheVZvaWNlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdjaGF0X3B1c2gnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5OZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLnNlbmRlcik7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbElkeCA9IGNjLnZ2Lk5ldE1nci5nZXRMb2NhbEluZGV4KGlkeCk7XHJcbiAgICAgICAgICAgIHNlbGYuX3NlYXRzW2xvY2FsSWR4XS5jaGF0KGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdxdWlja19jaGF0X3B1c2gnLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YS5kZXRhaWw7XHJcbiAgICAgICAgICAgIHZhciBpZHggPSBjYy52di5OZXRNZ3IuZ2V0U2VhdEluZGV4QnlJRChkYXRhLnNlbmRlcik7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbElkeCA9IGNjLnZ2Lk5ldE1nci5nZXRMb2NhbEluZGV4KGlkeCk7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGRhdGEuY29udGVudDtcclxuICAgICAgICAgICAgdmFyIGluZm8gPSBjYy52di56amhjaGF0LmdldFF1aWNrQ2hhdEluZm8oaW5kZXgpO1xyXG4gICAgICAgICAgICBzZWxmLl9zZWF0c1tsb2NhbElkeF0uY2hhdChpbmZvLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICBjYy52di5hdWRpb01nci5wbGF5U0ZYKGluZm8uc291bmQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZW1vamlfcHVzaCcsIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBkYXRhLmRldGFpbDtcclxuICAgICAgICAgICAgdmFyIGlkeCA9IGNjLnZ2Lk5ldE1nci5nZXRTZWF0SW5kZXhCeUlEKGRhdGEuc2VuZGVyKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsSWR4ID0gY2MudnYuTmV0TWdyLmdldExvY2FsSW5kZXgoaWR4KTtcclxuICAgICAgICAgICAgc2VsZi5fc2VhdHNbbG9jYWxJZHhdLmVtb2ppKGRhdGEuY29udGVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdjb3VudF9kb3duJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGEuZGV0YWlsO1xyXG4gICAgICAgICAgICBzZWxmLmNvdW50ZG93bi5zdHJpbmcgPSBkYXRhLmNvdW50RG93bjtcclxuICAgICAgICAgICAgc2VsZi5jb3VudGRvd24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5jb3VudERvd24gPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jb3VudGRvd24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbignZXhpdF9yb29tJywgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHNlbGYuX3RpbWVvdXQpO1xyXG4gICAgICAgICAgICAvL+WIt+aWsOeUqOaIt+mSseW4geaVsOmHj1xyXG4gICAgICAgICAgICBzZWxmLmdldEdlbXNBbmRDb2lucygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8v6K6+572u6YeR5biB6ZK755+z5pWw6YePXHJcbiAgICBnZXRHZW1zQW5kQ29pbnM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjYy52di51c2VyTWdyLmdldEdlbXNBbmRDb2lucyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGNjLnZ2LnVzZXJNZ3IuZ2VtcyA9IGRhdGEuZ2VtcztcclxuICAgICAgICAgICAgY2MudnYudXNlck1nci5jb2lucyA9IGRhdGEuY29pbnM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgb25QbGF5ZXJPdmVyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xyXG4gICAgICAgICAgICB3aW5kb3cuc3RvcFBsYXlWb2ljZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2MudnYuYXVkaW9NZ3IucmVzdW1lQWxsKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvblBsYXlDYWxsYmFjazpcIiArIHRoaXMuX3BsYXlpbmdTZWF0KTtcclxuICAgICAgICB2YXIgbG9jYWxJbmRleCA9IHRoaXMuX3BsYXlpbmdTZWF0O1xyXG4gICAgICAgIHRoaXMuX3BsYXlpbmdTZWF0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9zZWF0c1tsb2NhbEluZGV4XS52b2ljZU1zZyhmYWxzZSk7XHJcbiAgICB9LFxyXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBjYy52di52b2ljZU1nci5zdG9wKCk7XHJcbiAgICAgICAgLy8gICAgICAgIGNjLnZ2LnZvaWNlTWdyLm9uUGxheUNhbGxiYWNrID0gbnVsbDtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge1xyXG4gICAgICAgIGlmICh3aW5kb3cudm9pY2UgJiYgd2luZG93LnZvaWNlLmxvY2FsSWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxJZCA9IHdpbmRvdy52b2ljZS5sb2NhbElkO1xyXG4gICAgICAgICAgICB3aW5kb3cudm9pY2UubG9jYWxJZCA9IG51bGw7XHJcbiAgICAgICAgICAgIGNjLnZ2LmF1ZGlvTWdyLnBhdXNlQWxsKCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5wbGF5Vm9pY2UobG9jYWxJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCAvIDYwKTtcclxuICAgICAgICBpZiAodGhpcy5fbGFzdE1pbnV0ZSAhPSBtaW51dGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xhc3RNaW51dGUgPSBtaW51dGVzO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgIHZhciBoID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICBoID0gaCA8IDEwID8gXCIwXCIgKyBoIDogaDtcclxuICAgICAgICAgICAgdmFyIG0gPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgbSA9IG0gPCAxMCA/IFwiMFwiICsgbSA6IG07XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBcIlwiICsgaCArIFwiOlwiICsgbTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xhc3RQbGF5VGltZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChEYXRlLm5vdygpID4gdGhpcy5fbGFzdFBsYXlUaW1lICsgMjAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uUGxheWVyT3ZlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFBsYXlUaW1lID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheVZvaWNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7IiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIF9zcHJJY29uOiBudWxsLFxyXG4gICAgICAgIF9yZWFkeTogbnVsbCxcclxuICAgICAgICBfbGJsTmFtZTogbnVsbCxcclxuICAgICAgICBfbGJsU2NvcmU6IG51bGwsXHJcbiAgICAgICAgX3ZvaWNlbXNnOiBudWxsLFxyXG4gICAgICAgIF9jaGF0QnViYmxlOiBudWxsLFxyXG4gICAgICAgIF9lbW9qaTogbnVsbCxcclxuICAgICAgICBfbGFzdENoYXRUaW1lOiAtMSxcclxuICAgICAgICBfdXNlck5hbWU6IFwiXCIsXHJcbiAgICAgICAgX3Njb3JlOiAwLFxyXG4gICAgICAgIF9pc09mZmxpbmU6IGZhbHNlLFxyXG4gICAgICAgIF91c2VySWQ6IG51bGwsXHJcbiAgICAgICAgX3RpbWU6IC0xLFxyXG4gICAgICAgIF9vcDogbnVsbCxcclxuICAgICAgICBfcGFpOiBudWxsLFxyXG4gICAgICAgIF9wYWlzOiBbXSxcclxuICAgICAgICBfcGFpMTogbnVsbCxcclxuICAgICAgICBfcGFpczE6IFtdLFxyXG4gICAgICAgIF9wYWltaWFuOiBudWxsLFxyXG4gICAgICAgIF90aW1lTGFiZWw6IG51bGwsXHJcbiAgICAgICAgX3RpbWU6IC0xLFxyXG4gICAgICAgIF90b2dnbGU6IG51bGwsXHJcbiAgICB9LFxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjYy52diA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc3BySWNvbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImhlYWRcIikuZ2V0Q29tcG9uZW50KFwiSW1hZ2VMb2FkZXJcIik7XHJcbiAgICAgICAgdGhpcy5fbGJsTmFtZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIm5hbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl9sYmxTY29yZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIm1vbmV5XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fb3AgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0ZXh0XCIpO1xyXG4gICAgICAgIHRoaXMuX3hpYXpodSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS5nZXRDaGlsZEJ5TmFtZShcIm1vbmV5XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fcGFpID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicGFpXCIpO1xyXG4gICAgICAgIHRoaXMuX3BhaTEgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJqaWVndW9cIik7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhaSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3BhaS5jaGlsZHJlbkNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhaXNbaV0gPSB0aGlzLl9wYWkuZ2V0Q2hpbGRCeU5hbWUoXCJwYWlcIiArIGkpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcGFpMSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3BhaTEuY2hpbGRyZW5Db3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wYWlzMVtpXSA9IHRoaXMuX3BhaTEuZ2V0Q2hpbGRCeU5hbWUoXCJwYWlcIiArIGkpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9wYWltaWFuID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicGFpbWlhblwiKTtcclxuICAgICAgICB0aGlzLl9jaGF0QnViYmxlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiQ2hhdEJ1YmJsZVwiKTtcclxuICAgICAgICB0aGlzLl9lbW9qaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImVtb2ppXCIpO1xyXG4gICAgICAgIHRoaXMuX2NvdW50ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKCdjb3VudCcpO1xyXG4gICAgICAgIHRoaXMuX29wLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3hpYXpodS5zdHJpbmcgPSAwO1xyXG4gICAgICAgIGlmICh0aGlzLl9wYWkpIHRoaXMuX3BhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5fcGFpbWlhbikgdGhpcy5fcGFpbWlhbi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5fc3BySWNvbiAmJiB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc3BySWNvbi5zZXRVc2VySUQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwidG9nZ2xlXCIpO1xyXG4gICAgICAgIHRoaXMuX3RpbWVMYWJlbCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInRvZ2dsZVwiKS5nZXRDaGlsZEJ5TmFtZShcImxibFRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLl90aW1lTGFiZWwuc3RyaW5nID0gXCIwMFwiO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfSxcclxuICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9sYmxOYW1lICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsTmFtZS5zdHJpbmcgPSB0aGlzLl91c2VyTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUuc3RyaW5nID0gdGhpcy5fc2NvcmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9jaGF0QnViYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9lbW9qaSkge1xyXG4gICAgICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhaW1pYW4pIHRoaXMuX3BhaW1pYW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhaSkgdGhpcy5fcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9wYWkxKSB0aGlzLl9wYWkxLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0aGlzLl91c2VyTmFtZSAhPSBudWxsICYmIHRoaXMuX3VzZXJOYW1lICE9IFwiXCI7XHJcbiAgICB9LFxyXG4gICAgcmVzdGFydDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhaW1pYW4pIHRoaXMuX3BhaW1pYW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhaSkgdGhpcy5fcGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9wYWkxKSB0aGlzLl9wYWkxLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9vcCkgdGhpcy5fb3AuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibE5hbWUpIHRoaXMuX2xibE5hbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImNvdmVyXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzZXRJbmZvOiBmdW5jdGlvbihuYW1lLCBzY29yZSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9zY29yZSA9IHNjb3JlO1xyXG4gICAgICAgIGlmICh0aGlzLl9zY29yZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Njb3JlID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUubm9kZS5hY3RpdmUgPSB0aGlzLl9zY29yZSAhPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgIH0sXHJcbiAgICBoaWRlU2NvcmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzZXRaaHU6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWUgPSAwO1xyXG4gICAgICAgIGlmIChkYXRhLm1vbmV5ID4gMCkge1xyXG4gICAgICAgICAgICB0aW1lID0gMzUwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbihuKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBuID8gbi5hY3RpdmUgPSBmYWxzZSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS5hY3RpdmUpIHNlbGYubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEubW9uZXkgPT0gMCkgc2VsZi5ub2RlLmdldENoaWxkQnlOYW1lKFwieGlhemh1XCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHlwZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5feGlhemh1LnN0cmluZyA9IGRhdGEubW9uZXk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3hpYXpodS5zdHJpbmcgPSBwYXJzZUludChzZWxmLl94aWF6aHUuc3RyaW5nKSArIGRhdGEubW9uZXk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRpbWUpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoZGF0YS5tb25leSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93WGlhWmh1QW5pbShmbik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm4obnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNlYXRIaWRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5feGlhemh1LnN0cmluZyA9IDA7XHJcbiAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieGlhemh1XCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX29wLmFjdGl2ZSA9IGZhbHNlXHJcbiAgICAgICAgdGhpcy5fdXNlck5hbWUgPSBcIlwiO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fb3AuY2hpbGRyZW5Db3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29wLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRSZWFkeTogZnVuY3Rpb24oaXNSZWFkeSkge1xyXG4gICAgICAgIHRoaXMuX2lzUmVhZHkgPSBpc1JlYWR5O1xyXG4gICAgICAgIGlmICh0aGlzLl9yZWFkeSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZWFkeS5hY3RpdmUgPSB0aGlzLl9pc1JlYWR5ICYmIChjYy52di5nYW1lTmV0TWdyLm51bU9mR2FtZXMgPiAwKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0SUQ6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgICAgdmFyIGlkTm9kZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImlkXCIpO1xyXG4gICAgICAgIGlmIChpZE5vZGUpIHtcclxuICAgICAgICAgICAgdmFyIGxibCA9IGlkTm9kZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgICAgICBsYmwuc3RyaW5nID0gXCJJRDpcIiArIGlkO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VySWQgPSBpZDtcclxuICAgICAgICBpZiAodGhpcy5fc3BySWNvbikge1xyXG4gICAgICAgICAgICB0aGlzLl9zcHJJY29uLnNldFVzZXJJRChpZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGdldElEOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xyXG4gICAgfSxcclxuICAgIGNoYXQ6IGZ1bmN0aW9uKGNvbnRlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5fY2hhdEJ1YmJsZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjb250ZW50O1xyXG4gICAgICAgIHRoaXMuX2NoYXRCdWJibGUuZ2V0Q2hpbGRCeU5hbWUoXCJOZXcgTGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjb250ZW50O1xyXG4gICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSA9IDM7XHJcbiAgICB9LFxyXG4gICAgZW1vamk6IGZ1bmN0aW9uKGVtb2ppKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Vtb2ppID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2Vtb2ppLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fZW1vamkuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbikucGxheShlbW9qaSk7XHJcbiAgICAgICAgdGhpcy5fbGFzdENoYXRUaW1lID0gMztcclxuICAgIH0sXHJcbiAgICB2b2ljZU1zZzogZnVuY3Rpb24oc2hvdykge1xyXG4gICAgICAgIGlmICh0aGlzLl92b2ljZW1zZykge1xyXG4gICAgICAgICAgICB0aGlzLl92b2ljZW1zZy5hY3RpdmUgPSBzaG93O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaG93WGlhWmh1QW5pbTogZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgeCA9IHRoaXMuX2xibFNjb3JlLm5vZGUueDtcclxuICAgICAgICB2YXIgeSA9IHRoaXMuX2xibFNjb3JlLm5vZGUueTtcclxuICAgICAgICB2YXIgZW5kWCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS54O1xyXG4gICAgICAgIHZhciBlbmRZID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieGlhemh1XCIpLnk7XHJcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2NoaXBzJyk7XHJcbiAgICAgICAgdmFyIG5ld05vZGUgPSBjYy5pbnN0YW50aWF0ZShub2RlKTtcclxuICAgICAgICBuZXdOb2RlLm5hbWUgPSBcImNoaXBzXCI7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5ld05vZGUpO1xyXG4gICAgICAgIG5ld05vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBuZXdOb2RlLnNwcml0ZUZyYW1lID0gbm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZTtcclxuICAgICAgICBuZXdOb2RlLnggPSB4O1xyXG4gICAgICAgIG5ld05vZGUueSA9IHk7XHJcbiAgICAgICAgdmFyIGFjdGlvbiA9IGNjLm1vdmVUbygwLjM1LCBjYy5wKGVuZFgsIGVuZFkpKTtcclxuICAgICAgICBuZXdOb2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICAgIGNhbGxiYWNrKG5ld05vZGUpO1xyXG4gICAgfSxcclxuICAgIHNob3dPcHM6IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX29wKSByZXR1cm47XHJcbiAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fb3AuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9vcC5jaGlsZHJlbkNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vcC5jaGlsZHJlbltpXS5uYW1lID09IHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vcC5jaGlsZHJlbltpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vcC5jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT0gXCJxaXBhaVwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjb3ZlclwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2xibE5hbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fb3AuZ2V0Q2hpbGRCeU5hbWUoXCJxaXBhaVwiKS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xibE5hbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xibE5hbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb3AuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0UGFpOiBmdW5jdGlvbihkYXRhLCBwYXJlbnQpIHtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT0gMiAmJiB0aGlzLl9wYWlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFpUmVzID0gcGFyZW50LkNvbnZlcnNpb25DYXJkUmVzKHBhcnNlSW50KGRhdGFbaV0pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhaXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gcGFpUmVzWydudW0nXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhaXNbaV0uZ2V0Q2hpbGRCeU5hbWUoJ2h1YTEnKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IHBhaVJlc1snaF9zJ107XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wYWlzW2ldLmdldENoaWxkQnlOYW1lKCdodWEyJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBwYWlSZXNbJ2hfYiddO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLl9wYWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2hvd0hvbGRzUGFpOiBmdW5jdGlvbihkYXRhLCBwYXJlbnQpIHtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT0gMiAmJiB0aGlzLl9wYWlzMSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYWlSZXMgPSBwYXJlbnQuQ29udmVyc2lvbkNhcmRSZXMocGFyc2VJbnQoZGF0YVtpXSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGFpczFbaV0uZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gcGFpUmVzWydudW0nXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhaXMxW2ldLmdldENoaWxkQnlOYW1lKCdodWExJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBwYWlSZXNbJ2hfcyddO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGFpczFbaV0uZ2V0Q2hpbGRCeU5hbWUoJ2h1YTInKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IHBhaVJlc1snaF9iJ107XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuX3BhaTEuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhaW1pYW4pIHRoaXMuX3BhaW1pYW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9wYWkpIHRoaXMuX3BhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2hvd1dpblRleHQ6IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICB2YXIgdGl0bGUgPSBcIlwiO1xyXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIDk6XHJcbiAgICAgICAgICAgICAgICB0aXRsZSA9IFwi55qH5a625ZCM6Iqx6aG66LWiXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICAgICAgdGl0bGUgPSBcIuWQjOiKsemhuui1olwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgIHRpdGxlID0gXCLph5HliJrotaJcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICB0aXRsZSA9IFwi6JGr6Iqm6LWiXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgdGl0bGUgPSBcIuWQjOiKsei1olwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgIHRpdGxlID0gXCLpobrlrZDotaJcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICB0aXRsZSA9IFwi5LiJ5p2h6LWiXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgdGl0bGUgPSBcIuWPjOWvuei1olwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgIHRpdGxlID0gXCLkuIDlr7notaJcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICB0aXRsZSA9IFwi6auY54mM6LWiXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRpdGxlID09IFwiXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY292ZXJcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5fbGJsTmFtZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhaTEuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYmxOYW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYmxOYW1lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9wYWkxLmdldENoaWxkQnlOYW1lKFwidGV4dFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInhpYXpodVwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93QmVpUGFpOiBmdW5jdGlvbihmbGFnKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9wYWltaWFuKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fcGFpbWlhbi5hY3RpdmUgPSBmbGFnO1xyXG4gICAgfSxcclxuICAgIHNldE1vbmV5OiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgLy/orr7nva7or6XnjqnlrrbmiYDmi6XmnInnmoTnmoTpkrFcclxuICAgICAgICB0aGlzLl9sYmxTY29yZS5zdHJpbmcgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuX3Njb3JlID0gZGF0YTtcclxuICAgIH0sXHJcbiAgICBzZXRUaW1lOiBmdW5jdGlvbihvKSB7XHJcbiAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSA9IG87XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSA9IDMwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9sYXN0Q2hhdFRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSAtPSBkdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RDaGF0VGltZSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Vtb2ppLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pLnN0b3AoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fdGltZSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSAtPSBkdDtcclxuICAgICAgICAgICAgdmFyIHByZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHQgPSBNYXRoLmNlaWwodGhpcy5fdGltZSk7XHJcbiAgICAgICAgICAgIGlmICh0IDwgMTApIHtcclxuICAgICAgICAgICAgICAgIHByZSA9IFwiMFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBwcmUgKyB0O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyIsImlmICghQ0NfSlNCICYmICFjYy5zeXMuaXNOYXRpdmUpIHtcblx0KGZ1bmN0aW9uIChmKSB7XG5cdFx0aWYgKHR5cGVvZiBleHBvcnRzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdG1vZHVsZS5leHBvcnRzID0gZigpXG5cdFx0fSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkge1xuXHRcdFx0ZGVmaW5lKFtdLCBmKVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgZztcblx0XHRcdGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGcgPSB3aW5kb3dcblx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRnID0gZ2xvYmFsXG5cdFx0XHR9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGcgPSBzZWxmXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRnID0gdGhpc1xuXHRcdFx0fVxuXHRcdFx0Zy5pbyA9IGYoKVxuXHRcdH1cblx0fSkoZnVuY3Rpb24gKCkge1xuXHRcdHZhciBkZWZpbmUsIG1vZHVsZSwgZXhwb3J0cztcblx0XHRyZXR1cm4gKGZ1bmN0aW9uIGUodCwgbiwgcikge1xuXHRcdFx0ZnVuY3Rpb24gcyhvLCB1KSB7XG5cdFx0XHRcdGlmICghbltvXSkge1xuXHRcdFx0XHRcdGlmICghdFtvXSkge1xuXHRcdFx0XHRcdFx0dmFyIGEgPSB0eXBlb2YgcmVxdWlyZSA9PSBcImZ1bmN0aW9uXCIgJiYgcmVxdWlyZTtcblx0XHRcdFx0XHRcdGlmICghdSAmJiBhKSByZXR1cm4gYShvLCAhMCk7XG5cdFx0XHRcdFx0XHRpZiAoaSkgcmV0dXJuIGkobywgITApO1xuXHRcdFx0XHRcdFx0dmFyIGYgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgbyArIFwiJ1wiKTtcblx0XHRcdFx0XHRcdHRocm93IGYuY29kZSA9IFwiTU9EVUxFX05PVF9GT1VORFwiLCBmXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHZhciBsID0gbltvXSA9IHtcblx0XHRcdFx0XHRcdGV4cG9ydHM6IHt9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR0W29dWzBdLmNhbGwobC5leHBvcnRzLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdFx0dmFyIG4gPSB0W29dWzFdW2VdO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHMobiA/IG4gOiBlKVxuXHRcdFx0XHRcdH0sIGwsIGwuZXhwb3J0cywgZSwgdCwgbiwgcilcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbltvXS5leHBvcnRzXG5cdFx0XHR9XG5cdFx0XHR2YXIgaSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlO1xuXHRcdFx0Zm9yICh2YXIgbyA9IDA7IG8gPCByLmxlbmd0aDsgbysrKSBzKHJbb10pO1xuXHRcdFx0cmV0dXJuIHNcblx0XHR9KSh7XG5cdFx0XHQxOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gX2RlcmVxXygnLi9saWIvJyk7XG5cblx0XHRcdH0sIHtcblx0XHRcdFx0XCIuL2xpYi9cIjogMlxuXHRcdFx0fV0sXG5cdFx0XHQyOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gX2RlcmVxXygnLi9zb2NrZXQnKTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRXhwb3J0cyBwYXJzZXJcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICpcblx0XHRcdFx0ICovXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzLnBhcnNlciA9IF9kZXJlcV8oJ2VuZ2luZS5pby1wYXJzZXInKTtcblxuXHRcdFx0fSwge1xuXHRcdFx0XHRcIi4vc29ja2V0XCI6IDMsXG5cdFx0XHRcdFwiZW5naW5lLmlvLXBhcnNlclwiOiAxOVxuXHRcdFx0fV0sXG5cdFx0XHQzOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgdHJhbnNwb3J0cyA9IF9kZXJlcV8oJy4vdHJhbnNwb3J0cycpO1xuXHRcdFx0XHRcdHZhciBFbWl0dGVyID0gX2RlcmVxXygnY29tcG9uZW50LWVtaXR0ZXInKTtcblx0XHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdlbmdpbmUuaW8tY2xpZW50OnNvY2tldCcpO1xuXHRcdFx0XHRcdHZhciBpbmRleCA9IF9kZXJlcV8oJ2luZGV4b2YnKTtcblx0XHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnZW5naW5lLmlvLXBhcnNlcicpO1xuXHRcdFx0XHRcdHZhciBwYXJzZXVyaSA9IF9kZXJlcV8oJ3BhcnNldXJpJyk7XG5cdFx0XHRcdFx0dmFyIHBhcnNlanNvbiA9IF9kZXJlcV8oJ3BhcnNlanNvbicpO1xuXHRcdFx0XHRcdHZhciBwYXJzZXFzID0gX2RlcmVxXygncGFyc2VxcycpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTW9kdWxlIGV4cG9ydHMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IFNvY2tldDtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE5vb3AgZnVuY3Rpb24uXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogU29ja2V0IGNvbnN0cnVjdG9yLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSB1cmkgb3Igb3B0aW9uc1xuXHRcdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG5cdFx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIFNvY2tldCh1cmksIG9wdHMpIHtcblx0XHRcdFx0XHRcdGlmICghKHRoaXMgaW5zdGFuY2VvZiBTb2NrZXQpKSByZXR1cm4gbmV3IFNvY2tldCh1cmksIG9wdHMpO1xuXG5cdFx0XHRcdFx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblxuXHRcdFx0XHRcdFx0aWYgKHVyaSAmJiAnb2JqZWN0JyA9PSB0eXBlb2YgdXJpKSB7XG5cdFx0XHRcdFx0XHRcdG9wdHMgPSB1cmk7XG5cdFx0XHRcdFx0XHRcdHVyaSA9IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICh1cmkpIHtcblx0XHRcdFx0XHRcdFx0dXJpID0gcGFyc2V1cmkodXJpKTtcblx0XHRcdFx0XHRcdFx0b3B0cy5ob3N0bmFtZSA9IHVyaS5ob3N0O1xuXHRcdFx0XHRcdFx0XHRvcHRzLnNlY3VyZSA9IHVyaS5wcm90b2NvbCA9PSAnaHR0cHMnIHx8IHVyaS5wcm90b2NvbCA9PSAnd3NzJztcblx0XHRcdFx0XHRcdFx0b3B0cy5wb3J0ID0gdXJpLnBvcnQ7XG5cdFx0XHRcdFx0XHRcdGlmICh1cmkucXVlcnkpIG9wdHMucXVlcnkgPSB1cmkucXVlcnk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG9wdHMuaG9zdCkge1xuXHRcdFx0XHRcdFx0XHRvcHRzLmhvc3RuYW1lID0gcGFyc2V1cmkob3B0cy5ob3N0KS5ob3N0O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0aGlzLnNlY3VyZSA9IG51bGwgIT0gb3B0cy5zZWN1cmUgPyBvcHRzLnNlY3VyZSA6XG5cdFx0XHRcdFx0XHRcdChnbG9iYWwubG9jYXRpb24gJiYgJ2h0dHBzOicgPT0gbG9jYXRpb24ucHJvdG9jb2wpO1xuXG5cdFx0XHRcdFx0XHRpZiAob3B0cy5ob3N0bmFtZSAmJiAhb3B0cy5wb3J0KSB7XG5cdFx0XHRcdFx0XHRcdC8vIGlmIG5vIHBvcnQgaXMgc3BlY2lmaWVkIG1hbnVhbGx5LCB1c2UgdGhlIHByb3RvY29sIGRlZmF1bHRcblx0XHRcdFx0XHRcdFx0b3B0cy5wb3J0ID0gdGhpcy5zZWN1cmUgPyAnNDQzJyA6ICc4MCc7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMuYWdlbnQgPSBvcHRzLmFnZW50IHx8IGZhbHNlO1xuXHRcdFx0XHRcdFx0dGhpcy5ob3N0bmFtZSA9IG9wdHMuaG9zdG5hbWUgfHxcblx0XHRcdFx0XHRcdFx0KGdsb2JhbC5sb2NhdGlvbiA/IGxvY2F0aW9uLmhvc3RuYW1lIDogJ2xvY2FsaG9zdCcpO1xuXHRcdFx0XHRcdFx0dGhpcy5wb3J0ID0gb3B0cy5wb3J0IHx8IChnbG9iYWwubG9jYXRpb24gJiYgbG9jYXRpb24ucG9ydCA/XG5cdFx0XHRcdFx0XHRcdGxvY2F0aW9uLnBvcnQgOlxuXHRcdFx0XHRcdFx0XHQodGhpcy5zZWN1cmUgPyA0NDMgOiA4MCkpO1xuXHRcdFx0XHRcdFx0dGhpcy5xdWVyeSA9IG9wdHMucXVlcnkgfHwge307XG5cdFx0XHRcdFx0XHRpZiAoJ3N0cmluZycgPT0gdHlwZW9mIHRoaXMucXVlcnkpIHRoaXMucXVlcnkgPSBwYXJzZXFzLmRlY29kZSh0aGlzLnF1ZXJ5KTtcblx0XHRcdFx0XHRcdHRoaXMudXBncmFkZSA9IGZhbHNlICE9PSBvcHRzLnVwZ3JhZGU7XG5cdFx0XHRcdFx0XHR0aGlzLnBhdGggPSAob3B0cy5wYXRoIHx8ICcvZW5naW5lLmlvJykucmVwbGFjZSgvXFwvJC8sICcnKSArICcvJztcblx0XHRcdFx0XHRcdHRoaXMuZm9yY2VKU09OUCA9ICEhb3B0cy5mb3JjZUpTT05QO1xuXHRcdFx0XHRcdFx0dGhpcy5qc29ucCA9IGZhbHNlICE9PSBvcHRzLmpzb25wO1xuXHRcdFx0XHRcdFx0dGhpcy5mb3JjZUJhc2U2NCA9ICEhb3B0cy5mb3JjZUJhc2U2NDtcblx0XHRcdFx0XHRcdHRoaXMuZW5hYmxlc1hEUiA9ICEhb3B0cy5lbmFibGVzWERSO1xuXHRcdFx0XHRcdFx0dGhpcy50aW1lc3RhbXBQYXJhbSA9IG9wdHMudGltZXN0YW1wUGFyYW0gfHwgJ3QnO1xuXHRcdFx0XHRcdFx0dGhpcy50aW1lc3RhbXBSZXF1ZXN0cyA9IG9wdHMudGltZXN0YW1wUmVxdWVzdHM7XG5cdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydHMgPSBvcHRzLnRyYW5zcG9ydHMgfHwgWydwb2xsaW5nJywgJ3dlYnNvY2tldCddO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJyc7XG5cdFx0XHRcdFx0XHR0aGlzLndyaXRlQnVmZmVyID0gW107XG5cdFx0XHRcdFx0XHR0aGlzLnBvbGljeVBvcnQgPSBvcHRzLnBvbGljeVBvcnQgfHwgODQzO1xuXHRcdFx0XHRcdFx0dGhpcy5yZW1lbWJlclVwZ3JhZGUgPSBvcHRzLnJlbWVtYmVyVXBncmFkZSB8fCBmYWxzZTtcblx0XHRcdFx0XHRcdHRoaXMuYmluYXJ5VHlwZSA9IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLm9ubHlCaW5hcnlVcGdyYWRlcyA9IG9wdHMub25seUJpbmFyeVVwZ3JhZGVzO1xuXHRcdFx0XHRcdFx0dGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSA9IGZhbHNlICE9PSBvcHRzLnBlck1lc3NhZ2VEZWZsYXRlID8gKG9wdHMucGVyTWVzc2FnZURlZmxhdGUgfHwge30pIDogZmFsc2U7XG5cblx0XHRcdFx0XHRcdGlmICh0cnVlID09PSB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlKSB0aGlzLnBlck1lc3NhZ2VEZWZsYXRlID0ge307XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wZXJNZXNzYWdlRGVmbGF0ZSAmJiBudWxsID09IHRoaXMucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkID0gMTAyNDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gU1NMIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0XHR0aGlzLnBmeCA9IG9wdHMucGZ4IHx8IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLmtleSA9IG9wdHMua2V5IHx8IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLnBhc3NwaHJhc2UgPSBvcHRzLnBhc3NwaHJhc2UgfHwgbnVsbDtcblx0XHRcdFx0XHRcdHRoaXMuY2VydCA9IG9wdHMuY2VydCB8fCBudWxsO1xuXHRcdFx0XHRcdFx0dGhpcy5jYSA9IG9wdHMuY2EgfHwgbnVsbDtcblx0XHRcdFx0XHRcdHRoaXMuY2lwaGVycyA9IG9wdHMuY2lwaGVycyB8fCBudWxsO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWplY3RVbmF1dGhvcml6ZWQgPSBvcHRzLnJlamVjdFVuYXV0aG9yaXplZCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IG9wdHMucmVqZWN0VW5hdXRob3JpemVkO1xuXG5cdFx0XHRcdFx0XHQvLyBvdGhlciBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0dmFyIGZyZWVHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbDtcblx0XHRcdFx0XHRcdGlmIChmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCkge1xuXHRcdFx0XHRcdFx0XHRpZiAob3B0cy5leHRyYUhlYWRlcnMgJiYgT2JqZWN0LmtleXMob3B0cy5leHRyYUhlYWRlcnMpLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmV4dHJhSGVhZGVycyA9IG9wdHMuZXh0cmFIZWFkZXJzO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMub3BlbigpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFNvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPSBmYWxzZTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1peCBpbiBgRW1pdHRlcmAuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRFbWl0dGVyKFNvY2tldC5wcm90b3R5cGUpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogUHJvdG9jb2wgdmVyc2lvbi5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG9jb2wgPSBwYXJzZXIucHJvdG9jb2w7IC8vIHRoaXMgaXMgYW4gaW50XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBFeHBvc2UgZGVwcyBmb3IgbGVnYWN5IGNvbXBhdGliaWxpdHlcblx0XHRcdFx0XHQgKiBhbmQgc3RhbmRhbG9uZSBicm93c2VyIGFjY2Vzcy5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5Tb2NrZXQgPSBTb2NrZXQ7XG5cdFx0XHRcdFx0U29ja2V0LlRyYW5zcG9ydCA9IF9kZXJlcV8oJy4vdHJhbnNwb3J0Jyk7XG5cdFx0XHRcdFx0U29ja2V0LnRyYW5zcG9ydHMgPSBfZGVyZXFfKCcuL3RyYW5zcG9ydHMnKTtcblx0XHRcdFx0XHRTb2NrZXQucGFyc2VyID0gX2RlcmVxXygnZW5naW5lLmlvLXBhcnNlcicpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ3JlYXRlcyB0cmFuc3BvcnQgb2YgdGhlIGdpdmVuIHR5cGUuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gdHJhbnNwb3J0IG5hbWVcblx0XHRcdFx0XHQgKiBAcmV0dXJuIHtUcmFuc3BvcnR9XG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmNyZWF0ZVRyYW5zcG9ydCA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygnY3JlYXRpbmcgdHJhbnNwb3J0IFwiJXNcIicsIG5hbWUpO1xuXHRcdFx0XHRcdFx0dmFyIHF1ZXJ5ID0gY2xvbmUodGhpcy5xdWVyeSk7XG5cblx0XHRcdFx0XHRcdC8vIGFwcGVuZCBlbmdpbmUuaW8gcHJvdG9jb2wgaWRlbnRpZmllclxuXHRcdFx0XHRcdFx0cXVlcnkuRUlPID0gcGFyc2VyLnByb3RvY29sO1xuXG5cdFx0XHRcdFx0XHQvLyB0cmFuc3BvcnQgbmFtZVxuXHRcdFx0XHRcdFx0cXVlcnkudHJhbnNwb3J0ID0gbmFtZTtcblxuXHRcdFx0XHRcdFx0Ly8gc2Vzc2lvbiBpZCBpZiB3ZSBhbHJlYWR5IGhhdmUgb25lXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5pZCkgcXVlcnkuc2lkID0gdGhpcy5pZDtcblxuXHRcdFx0XHRcdFx0dmFyIHRyYW5zcG9ydCA9IG5ldyB0cmFuc3BvcnRzW25hbWVdKHtcblx0XHRcdFx0XHRcdFx0YWdlbnQ6IHRoaXMuYWdlbnQsXG5cdFx0XHRcdFx0XHRcdGhvc3RuYW1lOiB0aGlzLmhvc3RuYW1lLFxuXHRcdFx0XHRcdFx0XHRwb3J0OiB0aGlzLnBvcnQsXG5cdFx0XHRcdFx0XHRcdHNlY3VyZTogdGhpcy5zZWN1cmUsXG5cdFx0XHRcdFx0XHRcdHBhdGg6IHRoaXMucGF0aCxcblx0XHRcdFx0XHRcdFx0cXVlcnk6IHF1ZXJ5LFxuXHRcdFx0XHRcdFx0XHRmb3JjZUpTT05QOiB0aGlzLmZvcmNlSlNPTlAsXG5cdFx0XHRcdFx0XHRcdGpzb25wOiB0aGlzLmpzb25wLFxuXHRcdFx0XHRcdFx0XHRmb3JjZUJhc2U2NDogdGhpcy5mb3JjZUJhc2U2NCxcblx0XHRcdFx0XHRcdFx0ZW5hYmxlc1hEUjogdGhpcy5lbmFibGVzWERSLFxuXHRcdFx0XHRcdFx0XHR0aW1lc3RhbXBSZXF1ZXN0czogdGhpcy50aW1lc3RhbXBSZXF1ZXN0cyxcblx0XHRcdFx0XHRcdFx0dGltZXN0YW1wUGFyYW06IHRoaXMudGltZXN0YW1wUGFyYW0sXG5cdFx0XHRcdFx0XHRcdHBvbGljeVBvcnQ6IHRoaXMucG9saWN5UG9ydCxcblx0XHRcdFx0XHRcdFx0c29ja2V0OiB0aGlzLFxuXHRcdFx0XHRcdFx0XHRwZng6IHRoaXMucGZ4LFxuXHRcdFx0XHRcdFx0XHRrZXk6IHRoaXMua2V5LFxuXHRcdFx0XHRcdFx0XHRwYXNzcGhyYXNlOiB0aGlzLnBhc3NwaHJhc2UsXG5cdFx0XHRcdFx0XHRcdGNlcnQ6IHRoaXMuY2VydCxcblx0XHRcdFx0XHRcdFx0Y2E6IHRoaXMuY2EsXG5cdFx0XHRcdFx0XHRcdGNpcGhlcnM6IHRoaXMuY2lwaGVycyxcblx0XHRcdFx0XHRcdFx0cmVqZWN0VW5hdXRob3JpemVkOiB0aGlzLnJlamVjdFVuYXV0aG9yaXplZCxcblx0XHRcdFx0XHRcdFx0cGVyTWVzc2FnZURlZmxhdGU6IHRoaXMucGVyTWVzc2FnZURlZmxhdGUsXG5cdFx0XHRcdFx0XHRcdGV4dHJhSGVhZGVyczogdGhpcy5leHRyYUhlYWRlcnNcblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJhbnNwb3J0O1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRmdW5jdGlvbiBjbG9uZShvYmopIHtcblx0XHRcdFx0XHRcdHZhciBvID0ge307XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpIGluIG9iaikge1xuXHRcdFx0XHRcdFx0XHRpZiAob2JqLmhhc093blByb3BlcnR5KGkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0b1tpXSA9IG9ialtpXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogSW5pdGlhbGl6ZXMgdHJhbnNwb3J0IHRvIHVzZSBhbmQgc3RhcnRzIHByb2JlLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHRyYW5zcG9ydDtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnJlbWVtYmVyVXBncmFkZSAmJiBTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzICYmIHRoaXMudHJhbnNwb3J0cy5pbmRleE9mKCd3ZWJzb2NrZXQnKSAhPSAtMSkge1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQgPSAnd2Vic29ja2V0Jztcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoMCA9PT0gdGhpcy50cmFuc3BvcnRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHQvLyBFbWl0IGVycm9yIG9uIG5leHQgdGljayBzbyBpdCBjYW4gYmUgbGlzdGVuZWQgdG9cblx0XHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ2Vycm9yJywgJ05vIHRyYW5zcG9ydHMgYXZhaWxhYmxlJyk7XG5cdFx0XHRcdFx0XHRcdH0sIDApO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQgPSB0aGlzLnRyYW5zcG9ydHNbMF07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnb3BlbmluZyc7XG5cblx0XHRcdFx0XHRcdC8vIFJldHJ5IHdpdGggdGhlIG5leHQgdHJhbnNwb3J0IGlmIHRoZSB0cmFuc3BvcnQgaXMgZGlzYWJsZWQgKGpzb25wOiBmYWxzZSlcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydCA9IHRoaXMuY3JlYXRlVHJhbnNwb3J0KHRyYW5zcG9ydCk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMudHJhbnNwb3J0cy5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLm9wZW4oKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQub3BlbigpO1xuXHRcdFx0XHRcdFx0dGhpcy5zZXRUcmFuc3BvcnQodHJhbnNwb3J0KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQuIERpc2FibGVzIHRoZSBleGlzdGluZyBvbmUgKGlmIGFueSkuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuc2V0VHJhbnNwb3J0ID0gZnVuY3Rpb24gKHRyYW5zcG9ydCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3NldHRpbmcgdHJhbnNwb3J0ICVzJywgdHJhbnNwb3J0Lm5hbWUpO1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0XHRpZiAodGhpcy50cmFuc3BvcnQpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2NsZWFyaW5nIGV4aXN0aW5nIHRyYW5zcG9ydCAlcycsIHRoaXMudHJhbnNwb3J0Lm5hbWUpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gc2V0IHVwIHRyYW5zcG9ydFxuXHRcdFx0XHRcdFx0dGhpcy50cmFuc3BvcnQgPSB0cmFuc3BvcnQ7XG5cblx0XHRcdFx0XHRcdC8vIHNldCB1cCB0cmFuc3BvcnQgbGlzdGVuZXJzXG5cdFx0XHRcdFx0XHR0cmFuc3BvcnRcblx0XHRcdFx0XHRcdFx0Lm9uKCdkcmFpbicsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLm9uRHJhaW4oKTtcblx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRcdFx0Lm9uKCdwYWNrZXQnLCBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5vblBhY2tldChwYWNrZXQpO1xuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0XHQub24oJ2Vycm9yJywgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLm9uRXJyb3IoZSk7XG5cdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHRcdC5vbignY2xvc2UnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5vbkNsb3NlKCd0cmFuc3BvcnQgY2xvc2UnKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIFByb2JlcyBhIHRyYW5zcG9ydC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSB0cmFuc3BvcnQgbmFtZVxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5wcm9iZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygncHJvYmluZyB0cmFuc3BvcnQgXCIlc1wiJywgbmFtZSk7XG5cdFx0XHRcdFx0XHR2YXIgdHJhbnNwb3J0ID0gdGhpcy5jcmVhdGVUcmFuc3BvcnQobmFtZSwge1xuXHRcdFx0XHRcdFx0XHRcdHByb2JlOiAxXG5cdFx0XHRcdFx0XHRcdH0pLFxuXHRcdFx0XHRcdFx0XHRmYWlsZWQgPSBmYWxzZSxcblx0XHRcdFx0XHRcdFx0c2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRcdFNvY2tldC5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPSBmYWxzZTtcblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gb25UcmFuc3BvcnRPcGVuKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5vbmx5QmluYXJ5VXBncmFkZXMpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgdXBncmFkZUxvc2VzQmluYXJ5ID0gIXRoaXMuc3VwcG9ydHNCaW5hcnkgJiYgc2VsZi50cmFuc3BvcnQuc3VwcG9ydHNCaW5hcnk7XG5cdFx0XHRcdFx0XHRcdFx0ZmFpbGVkID0gZmFpbGVkIHx8IHVwZ3JhZGVMb3Nlc0JpbmFyeTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAoZmFpbGVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3Byb2JlIHRyYW5zcG9ydCBcIiVzXCIgb3BlbmVkJywgbmFtZSk7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5zZW5kKFt7XG5cdFx0XHRcdFx0XHRcdFx0dHlwZTogJ3BpbmcnLFxuXHRcdFx0XHRcdFx0XHRcdGRhdGE6ICdwcm9iZSdcblx0XHRcdFx0XHRcdFx0fV0pO1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQub25jZSgncGFja2V0JywgZnVuY3Rpb24gKG1zZykge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChmYWlsZWQpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0XHRpZiAoJ3BvbmcnID09IG1zZy50eXBlICYmICdwcm9iZScgPT0gbXNnLmRhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRlYnVnKCdwcm9iZSB0cmFuc3BvcnQgXCIlc1wiIHBvbmcnLCBuYW1lKTtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYudXBncmFkaW5nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZW1pdCgndXBncmFkaW5nJywgdHJhbnNwb3J0KTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICghdHJhbnNwb3J0KSByZXR1cm47XG5cdFx0XHRcdFx0XHRcdFx0XHRTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gJ3dlYnNvY2tldCcgPT0gdHJhbnNwb3J0Lm5hbWU7XG5cblx0XHRcdFx0XHRcdFx0XHRcdGRlYnVnKCdwYXVzaW5nIGN1cnJlbnQgdHJhbnNwb3J0IFwiJXNcIicsIHNlbGYudHJhbnNwb3J0Lm5hbWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi50cmFuc3BvcnQucGF1c2UoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZmFpbGVkKSByZXR1cm47XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICgnY2xvc2VkJyA9PSBzZWxmLnJlYWR5U3RhdGUpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ2NoYW5naW5nIHRyYW5zcG9ydCBhbmQgc2VuZGluZyB1cGdyYWRlIHBhY2tldCcpO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNsZWFudXAoKTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZWxmLnNldFRyYW5zcG9ydCh0cmFuc3BvcnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQuc2VuZChbe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6ICd1cGdyYWRlJ1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZW1pdCgndXBncmFkZScsIHRyYW5zcG9ydCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyYW5zcG9ydCA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYudXBncmFkaW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZmx1c2goKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBmYWlsZWQnLCBuYW1lKTtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoJ3Byb2JlIGVycm9yJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnIudHJhbnNwb3J0ID0gdHJhbnNwb3J0Lm5hbWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ3VwZ3JhZGVFcnJvcicsIGVycik7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gZnJlZXplVHJhbnNwb3J0KCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoZmFpbGVkKSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0Ly8gQW55IGNhbGxiYWNrIGNhbGxlZCBieSB0cmFuc3BvcnQgc2hvdWxkIGJlIGlnbm9yZWQgc2luY2Ugbm93XG5cdFx0XHRcdFx0XHRcdGZhaWxlZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0Y2xlYW51cCgpO1xuXG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5jbG9zZSgpO1xuXHRcdFx0XHRcdFx0XHR0cmFuc3BvcnQgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL0hhbmRsZSBhbnkgZXJyb3IgdGhhdCBoYXBwZW5zIHdoaWxlIHByb2Jpbmdcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIG9uZXJyb3IoZXJyKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigncHJvYmUgZXJyb3I6ICcgKyBlcnIpO1xuXHRcdFx0XHRcdFx0XHRlcnJvci50cmFuc3BvcnQgPSB0cmFuc3BvcnQubmFtZTtcblxuXHRcdFx0XHRcdFx0XHRmcmVlemVUcmFuc3BvcnQoKTtcblxuXHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJvYmUgdHJhbnNwb3J0IFwiJXNcIiBmYWlsZWQgYmVjYXVzZSBvZiBlcnJvcjogJXMnLCBuYW1lLCBlcnIpO1xuXG5cdFx0XHRcdFx0XHRcdHNlbGYuZW1pdCgndXBncmFkZUVycm9yJywgZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBvblRyYW5zcG9ydENsb3NlKCkge1xuXHRcdFx0XHRcdFx0XHRvbmVycm9yKFwidHJhbnNwb3J0IGNsb3NlZFwiKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly9XaGVuIHRoZSBzb2NrZXQgaXMgY2xvc2VkIHdoaWxlIHdlJ3JlIHByb2Jpbmdcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIG9uY2xvc2UoKSB7XG5cdFx0XHRcdFx0XHRcdG9uZXJyb3IoXCJzb2NrZXQgY2xvc2VkXCIpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL1doZW4gdGhlIHNvY2tldCBpcyB1cGdyYWRlZCB3aGlsZSB3ZSdyZSBwcm9iaW5nXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBvbnVwZ3JhZGUodG8pIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRyYW5zcG9ydCAmJiB0by5uYW1lICE9IHRyYW5zcG9ydC5uYW1lKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ1wiJXNcIiB3b3JrcyAtIGFib3J0aW5nIFwiJXNcIicsIHRvLm5hbWUsIHRyYW5zcG9ydC5uYW1lKTtcblx0XHRcdFx0XHRcdFx0XHRmcmVlemVUcmFuc3BvcnQoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL1JlbW92ZSBhbGwgbGlzdGVuZXJzIG9uIHRoZSB0cmFuc3BvcnQgYW5kIG9uIHNlbGZcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGNsZWFudXAoKSB7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcignb3BlbicsIG9uVHJhbnNwb3J0T3Blbik7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcignZXJyb3InLCBvbmVycm9yKTtcblx0XHRcdFx0XHRcdFx0dHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uVHJhbnNwb3J0Q2xvc2UpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uY2xvc2UpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnJlbW92ZUxpc3RlbmVyKCd1cGdyYWRpbmcnLCBvbnVwZ3JhZGUpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQub25jZSgnb3BlbicsIG9uVHJhbnNwb3J0T3Blbik7XG5cdFx0XHRcdFx0XHR0cmFuc3BvcnQub25jZSgnZXJyb3InLCBvbmVycm9yKTtcblx0XHRcdFx0XHRcdHRyYW5zcG9ydC5vbmNlKCdjbG9zZScsIG9uVHJhbnNwb3J0Q2xvc2UpO1xuXG5cdFx0XHRcdFx0XHR0aGlzLm9uY2UoJ2Nsb3NlJywgb25jbG9zZSk7XG5cdFx0XHRcdFx0XHR0aGlzLm9uY2UoJ3VwZ3JhZGluZycsIG9udXBncmFkZSk7XG5cblx0XHRcdFx0XHRcdHRyYW5zcG9ydC5vcGVuKCk7XG5cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2FsbGVkIHdoZW4gY29ubmVjdGlvbiBpcyBkZWVtZWQgb3Blbi5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdzb2NrZXQgb3BlbicpO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ29wZW4nO1xuXHRcdFx0XHRcdFx0U29ja2V0LnByaW9yV2Vic29ja2V0U3VjY2VzcyA9ICd3ZWJzb2NrZXQnID09IHRoaXMudHJhbnNwb3J0Lm5hbWU7XG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ29wZW4nKTtcblx0XHRcdFx0XHRcdHRoaXMuZmx1c2goKTtcblxuXHRcdFx0XHRcdFx0Ly8gd2UgY2hlY2sgZm9yIGByZWFkeVN0YXRlYCBpbiBjYXNlIGFuIGBvcGVuYFxuXHRcdFx0XHRcdFx0Ly8gbGlzdGVuZXIgYWxyZWFkeSBjbG9zZWQgdGhlIHNvY2tldFxuXHRcdFx0XHRcdFx0aWYgKCdvcGVuJyA9PSB0aGlzLnJlYWR5U3RhdGUgJiYgdGhpcy51cGdyYWRlICYmIHRoaXMudHJhbnNwb3J0LnBhdXNlKSB7XG5cdFx0XHRcdFx0XHRcdGRlYnVnKCdzdGFydGluZyB1cGdyYWRlIHByb2JlcycpO1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMudXBncmFkZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5wcm9iZSh0aGlzLnVwZ3JhZGVzW2ldKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBIYW5kbGVzIGEgcGFja2V0LlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uUGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0aWYgKCdvcGVuaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1Zygnc29ja2V0IHJlY2VpdmU6IHR5cGUgXCIlc1wiLCBkYXRhIFwiJXNcIicsIHBhY2tldC50eXBlLCBwYWNrZXQuZGF0YSk7XG5cblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdwYWNrZXQnLCBwYWNrZXQpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIFNvY2tldCBpcyBsaXZlIC0gYW55IHBhY2tldCBjb3VudHNcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdoZWFydGJlYXQnKTtcblxuXHRcdFx0XHRcdFx0XHRzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAnb3Blbic6XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9uSGFuZHNoYWtlKHBhcnNlanNvbihwYWNrZXQuZGF0YSkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0XHRjYXNlICdwb25nJzpcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuc2V0UGluZygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdwb25nJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgJ2Vycm9yJzpcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoJ3NlcnZlciBlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyLmNvZGUgPSBwYWNrZXQuZGF0YTtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMub25FcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdFx0XHRjYXNlICdtZXNzYWdlJzpcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZGF0YScsIHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnbWVzc2FnZScsIHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRkZWJ1ZygncGFja2V0IHJlY2VpdmVkIHdpdGggc29ja2V0IHJlYWR5U3RhdGUgXCIlc1wiJywgdGhpcy5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2FsbGVkIHVwb24gaGFuZHNoYWtlIGNvbXBsZXRpb24uXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gaGFuZHNoYWtlIG9ialxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbkhhbmRzaGFrZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2hhbmRzaGFrZScsIGRhdGEpO1xuXHRcdFx0XHRcdFx0dGhpcy5pZCA9IGRhdGEuc2lkO1xuXHRcdFx0XHRcdFx0dGhpcy50cmFuc3BvcnQucXVlcnkuc2lkID0gZGF0YS5zaWQ7XG5cdFx0XHRcdFx0XHR0aGlzLnVwZ3JhZGVzID0gdGhpcy5maWx0ZXJVcGdyYWRlcyhkYXRhLnVwZ3JhZGVzKTtcblx0XHRcdFx0XHRcdHRoaXMucGluZ0ludGVydmFsID0gZGF0YS5waW5nSW50ZXJ2YWw7XG5cdFx0XHRcdFx0XHR0aGlzLnBpbmdUaW1lb3V0ID0gZGF0YS5waW5nVGltZW91dDtcblx0XHRcdFx0XHRcdHRoaXMub25PcGVuKCk7XG5cdFx0XHRcdFx0XHQvLyBJbiBjYXNlIG9wZW4gaGFuZGxlciBjbG9zZXMgc29ja2V0XG5cdFx0XHRcdFx0XHRpZiAoJ2Nsb3NlZCcgPT0gdGhpcy5yZWFkeVN0YXRlKSByZXR1cm47XG5cdFx0XHRcdFx0XHR0aGlzLnNldFBpbmcoKTtcblxuXHRcdFx0XHRcdFx0Ly8gUHJvbG9uZyBsaXZlbmVzcyBvZiBzb2NrZXQgb24gaGVhcnRiZWF0XG5cdFx0XHRcdFx0XHR0aGlzLnJlbW92ZUxpc3RlbmVyKCdoZWFydGJlYXQnLCB0aGlzLm9uSGVhcnRiZWF0KTtcblx0XHRcdFx0XHRcdHRoaXMub24oJ2hlYXJ0YmVhdCcsIHRoaXMub25IZWFydGJlYXQpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBSZXNldHMgcGluZyB0aW1lb3V0LlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uSGVhcnRiZWF0ID0gZnVuY3Rpb24gKHRpbWVvdXQpIHtcblx0XHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnBpbmdUaW1lb3V0VGltZXIpO1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0c2VsZi5waW5nVGltZW91dFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdGlmICgnY2xvc2VkJyA9PSBzZWxmLnJlYWR5U3RhdGUpIHJldHVybjtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkNsb3NlKCdwaW5nIHRpbWVvdXQnKTtcblx0XHRcdFx0XHRcdH0sIHRpbWVvdXQgfHwgKHNlbGYucGluZ0ludGVydmFsICsgc2VsZi5waW5nVGltZW91dCkpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBQaW5ncyBzZXJ2ZXIgZXZlcnkgYHRoaXMucGluZ0ludGVydmFsYCBhbmQgZXhwZWN0cyByZXNwb25zZVxuXHRcdFx0XHRcdCAqIHdpdGhpbiBgdGhpcy5waW5nVGltZW91dGAgb3IgY2xvc2VzIGNvbm5lY3Rpb24uXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuc2V0UGluZyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRcdGNsZWFyVGltZW91dChzZWxmLnBpbmdJbnRlcnZhbFRpbWVyKTtcblx0XHRcdFx0XHRcdHNlbGYucGluZ0ludGVydmFsVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3dyaXRpbmcgcGluZyBwYWNrZXQgLSBleHBlY3RpbmcgcG9uZyB3aXRoaW4gJXNtcycsIHNlbGYucGluZ1RpbWVvdXQpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnBpbmcoKTtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkhlYXJ0YmVhdChzZWxmLnBpbmdUaW1lb3V0KTtcblx0XHRcdFx0XHRcdH0sIHNlbGYucGluZ0ludGVydmFsKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogU2VuZHMgYSBwaW5nIHBhY2tldC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5waW5nID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0dGhpcy5zZW5kUGFja2V0KCdwaW5nJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ3BpbmcnKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsZWQgb24gYGRyYWluYCBldmVudFxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uRHJhaW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLndyaXRlQnVmZmVyLnNwbGljZSgwLCB0aGlzLnByZXZCdWZmZXJMZW4pO1xuXG5cdFx0XHRcdFx0XHQvLyBzZXR0aW5nIHByZXZCdWZmZXJMZW4gPSAwIGlzIHZlcnkgaW1wb3J0YW50XG5cdFx0XHRcdFx0XHQvLyBmb3IgZXhhbXBsZSwgd2hlbiB1cGdyYWRpbmcsIHVwZ3JhZGUgcGFja2V0IGlzIHNlbnQgb3Zlcixcblx0XHRcdFx0XHRcdC8vIGFuZCBhIG5vbnplcm8gcHJldkJ1ZmZlckxlbiBjb3VsZCBjYXVzZSBwcm9ibGVtcyBvbiBgZHJhaW5gXG5cdFx0XHRcdFx0XHR0aGlzLnByZXZCdWZmZXJMZW4gPSAwO1xuXG5cdFx0XHRcdFx0XHRpZiAoMCA9PT0gdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdkcmFpbicpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5mbHVzaCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBGbHVzaCB3cml0ZSBidWZmZXJzLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0aWYgKCdjbG9zZWQnICE9IHRoaXMucmVhZHlTdGF0ZSAmJiB0aGlzLnRyYW5zcG9ydC53cml0YWJsZSAmJlxuXHRcdFx0XHRcdFx0XHQhdGhpcy51cGdyYWRpbmcgJiYgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2ZsdXNoaW5nICVkIHBhY2tldHMgaW4gc29ja2V0JywgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydC5zZW5kKHRoaXMud3JpdGVCdWZmZXIpO1xuXHRcdFx0XHRcdFx0XHQvLyBrZWVwIHRyYWNrIG9mIGN1cnJlbnQgbGVuZ3RoIG9mIHdyaXRlQnVmZmVyXG5cdFx0XHRcdFx0XHRcdC8vIHNwbGljZSB3cml0ZUJ1ZmZlciBhbmQgY2FsbGJhY2tCdWZmZXIgb24gYGRyYWluYFxuXHRcdFx0XHRcdFx0XHR0aGlzLnByZXZCdWZmZXJMZW4gPSB0aGlzLndyaXRlQnVmZmVyLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdmbHVzaCcpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBTZW5kcyBhIG1lc3NhZ2UuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZS5cblx0XHRcdFx0XHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBmdW5jdGlvbi5cblx0XHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5cblx0XHRcdFx0XHQgKiBAcmV0dXJuIHtTb2NrZXR9IGZvciBjaGFpbmluZy5cblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS53cml0ZSA9XG5cdFx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAobXNnLCBvcHRpb25zLCBmbikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNlbmRQYWNrZXQoJ21lc3NhZ2UnLCBtc2csIG9wdGlvbnMsIGZuKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogU2VuZHMgYSBwYWNrZXQuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gcGFja2V0IHR5cGUuXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGRhdGEuXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgZnVuY3Rpb24uXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLnNlbmRQYWNrZXQgPSBmdW5jdGlvbiAodHlwZSwgZGF0YSwgb3B0aW9ucywgZm4pIHtcblx0XHRcdFx0XHRcdGlmICgnZnVuY3Rpb24nID09IHR5cGVvZiBkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdGZuID0gZGF0YTtcblx0XHRcdFx0XHRcdFx0ZGF0YSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIG9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdFx0Zm4gPSBvcHRpb25zO1xuXHRcdFx0XHRcdFx0XHRvcHRpb25zID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKCdjbG9zaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ2Nsb3NlZCcgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0XHRcdFx0XHRvcHRpb25zLmNvbXByZXNzID0gZmFsc2UgIT09IG9wdGlvbnMuY29tcHJlc3M7XG5cblx0XHRcdFx0XHRcdHZhciBwYWNrZXQgPSB7XG5cdFx0XHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0XHRcdGRhdGE6IGRhdGEsXG5cdFx0XHRcdFx0XHRcdG9wdGlvbnM6IG9wdGlvbnNcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ3BhY2tldENyZWF0ZScsIHBhY2tldCk7XG5cdFx0XHRcdFx0XHR0aGlzLndyaXRlQnVmZmVyLnB1c2gocGFja2V0KTtcblx0XHRcdFx0XHRcdGlmIChmbikgdGhpcy5vbmNlKCdmbHVzaCcsIGZuKTtcblx0XHRcdFx0XHRcdHRoaXMuZmx1c2goKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2xvc2VzIHRoZSBjb25uZWN0aW9uLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0aWYgKCdvcGVuaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnY2xvc2luZyc7XG5cblx0XHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLndyaXRlQnVmZmVyLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMub25jZSgnZHJhaW4nLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy51cGdyYWRpbmcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0d2FpdEZvclVwZ3JhZGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAodGhpcy51cGdyYWRpbmcpIHtcblx0XHRcdFx0XHRcdFx0XHR3YWl0Rm9yVXBncmFkZSgpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gY2xvc2UoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25DbG9zZSgnZm9yY2VkIGNsb3NlJyk7XG5cdFx0XHRcdFx0XHRcdGRlYnVnKCdzb2NrZXQgY2xvc2luZyAtIHRlbGxpbmcgdHJhbnNwb3J0IHRvIGNsb3NlJyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYudHJhbnNwb3J0LmNsb3NlKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGNsZWFudXBBbmRDbG9zZSgpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVMaXN0ZW5lcigndXBncmFkZScsIGNsZWFudXBBbmRDbG9zZSk7XG5cdFx0XHRcdFx0XHRcdHNlbGYucmVtb3ZlTGlzdGVuZXIoJ3VwZ3JhZGVFcnJvcicsIGNsZWFudXBBbmRDbG9zZSk7XG5cdFx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHdhaXRGb3JVcGdyYWRlKCkge1xuXHRcdFx0XHRcdFx0XHQvLyB3YWl0IGZvciB1cGdyYWRlIHRvIGZpbmlzaCBzaW5jZSB3ZSBjYW4ndCBzZW5kIHBhY2tldHMgd2hpbGUgcGF1c2luZyBhIHRyYW5zcG9ydFxuXHRcdFx0XHRcdFx0XHRzZWxmLm9uY2UoJ3VwZ3JhZGUnLCBjbGVhbnVwQW5kQ2xvc2UpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uY2UoJ3VwZ3JhZGVFcnJvcicsIGNsZWFudXBBbmRDbG9zZSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgZXJyb3Jcblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3NvY2tldCBlcnJvciAlaicsIGVycik7XG5cdFx0XHRcdFx0XHRTb2NrZXQucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblx0XHRcdFx0XHRcdHRoaXMub25DbG9zZSgndHJhbnNwb3J0IGVycm9yJywgZXJyKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2FsbGVkIHVwb24gdHJhbnNwb3J0IGNsb3NlLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAocmVhc29uLCBkZXNjKSB7XG5cdFx0XHRcdFx0XHRpZiAoJ29wZW5pbmcnID09IHRoaXMucmVhZHlTdGF0ZSB8fCAnb3BlbicgPT0gdGhpcy5yZWFkeVN0YXRlIHx8ICdjbG9zaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3NvY2tldCBjbG9zZSB3aXRoIHJlYXNvbjogXCIlc1wiJywgcmVhc29uKTtcblx0XHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGNsZWFyIHRpbWVyc1xuXHRcdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy5waW5nSW50ZXJ2YWxUaW1lcik7XG5cdFx0XHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnBpbmdUaW1lb3V0VGltZXIpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIHN0b3AgZXZlbnQgZnJvbSBmaXJpbmcgYWdhaW4gZm9yIHRyYW5zcG9ydFxuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoJ2Nsb3NlJyk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gZW5zdXJlIHRyYW5zcG9ydCB3b24ndCBzdGF5IG9wZW5cblx0XHRcdFx0XHRcdFx0dGhpcy50cmFuc3BvcnQuY2xvc2UoKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBpZ25vcmUgZnVydGhlciB0cmFuc3BvcnQgY29tbXVuaWNhdGlvblxuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBzZXQgcmVhZHkgc3RhdGVcblx0XHRcdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ2Nsb3NlZCc7XG5cblx0XHRcdFx0XHRcdFx0Ly8gY2xlYXIgc2Vzc2lvbiBpZFxuXHRcdFx0XHRcdFx0XHR0aGlzLmlkID0gbnVsbDtcblxuXHRcdFx0XHRcdFx0XHQvLyBlbWl0IGNsb3NlIGV2ZW50XG5cdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnY2xvc2UnLCByZWFzb24sIGRlc2MpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGNsZWFuIGJ1ZmZlcnMgYWZ0ZXIsIHNvIHVzZXJzIGNhbiBzdGlsbFxuXHRcdFx0XHRcdFx0XHQvLyBncmFiIHRoZSBidWZmZXJzIG9uIGBjbG9zZWAgZXZlbnRcblx0XHRcdFx0XHRcdFx0c2VsZi53cml0ZUJ1ZmZlciA9IFtdO1xuXHRcdFx0XHRcdFx0XHRzZWxmLnByZXZCdWZmZXJMZW4gPSAwO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBGaWx0ZXJzIHVwZ3JhZGVzLCByZXR1cm5pbmcgb25seSB0aG9zZSBtYXRjaGluZyBjbGllbnQgdHJhbnNwb3J0cy5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7QXJyYXl9IHNlcnZlciB1cGdyYWRlc1xuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmZpbHRlclVwZ3JhZGVzID0gZnVuY3Rpb24gKHVwZ3JhZGVzKSB7XG5cdFx0XHRcdFx0XHR2YXIgZmlsdGVyZWRVcGdyYWRlcyA9IFtdO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGogPSB1cGdyYWRlcy5sZW5ndGg7IGkgPCBqOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0aWYgKH5pbmRleCh0aGlzLnRyYW5zcG9ydHMsIHVwZ3JhZGVzW2ldKSkgZmlsdGVyZWRVcGdyYWRlcy5wdXNoKHVwZ3JhZGVzW2ldKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHJldHVybiBmaWx0ZXJlZFVwZ3JhZGVzO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KVxuXHRcdFx0fSwge1xuXHRcdFx0XHRcIi4vdHJhbnNwb3J0XCI6IDQsXG5cdFx0XHRcdFwiLi90cmFuc3BvcnRzXCI6IDUsXG5cdFx0XHRcdFwiY29tcG9uZW50LWVtaXR0ZXJcIjogMTUsXG5cdFx0XHRcdFwiZGVidWdcIjogMTcsXG5cdFx0XHRcdFwiZW5naW5lLmlvLXBhcnNlclwiOiAxOSxcblx0XHRcdFx0XCJpbmRleG9mXCI6IDIzLFxuXHRcdFx0XHRcInBhcnNlanNvblwiOiAyNixcblx0XHRcdFx0XCJwYXJzZXFzXCI6IDI3LFxuXHRcdFx0XHRcInBhcnNldXJpXCI6IDI4XG5cdFx0XHR9XSxcblx0XHRcdDQ6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnZW5naW5lLmlvLXBhcnNlcicpO1xuXHRcdFx0XHR2YXIgRW1pdHRlciA9IF9kZXJlcV8oJ2NvbXBvbmVudC1lbWl0dGVyJyk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IFRyYW5zcG9ydDtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogVHJhbnNwb3J0IGFic3RyYWN0IGNvbnN0cnVjdG9yLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5cblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIFRyYW5zcG9ydChvcHRzKSB7XG5cdFx0XHRcdFx0dGhpcy5wYXRoID0gb3B0cy5wYXRoO1xuXHRcdFx0XHRcdHRoaXMuaG9zdG5hbWUgPSBvcHRzLmhvc3RuYW1lO1xuXHRcdFx0XHRcdHRoaXMucG9ydCA9IG9wdHMucG9ydDtcblx0XHRcdFx0XHR0aGlzLnNlY3VyZSA9IG9wdHMuc2VjdXJlO1xuXHRcdFx0XHRcdHRoaXMucXVlcnkgPSBvcHRzLnF1ZXJ5O1xuXHRcdFx0XHRcdHRoaXMudGltZXN0YW1wUGFyYW0gPSBvcHRzLnRpbWVzdGFtcFBhcmFtO1xuXHRcdFx0XHRcdHRoaXMudGltZXN0YW1wUmVxdWVzdHMgPSBvcHRzLnRpbWVzdGFtcFJlcXVlc3RzO1xuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICcnO1xuXHRcdFx0XHRcdHRoaXMuYWdlbnQgPSBvcHRzLmFnZW50IHx8IGZhbHNlO1xuXHRcdFx0XHRcdHRoaXMuc29ja2V0ID0gb3B0cy5zb2NrZXQ7XG5cdFx0XHRcdFx0dGhpcy5lbmFibGVzWERSID0gb3B0cy5lbmFibGVzWERSO1xuXG5cdFx0XHRcdFx0Ly8gU1NMIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0dGhpcy5wZnggPSBvcHRzLnBmeDtcblx0XHRcdFx0XHR0aGlzLmtleSA9IG9wdHMua2V5O1xuXHRcdFx0XHRcdHRoaXMucGFzc3BocmFzZSA9IG9wdHMucGFzc3BocmFzZTtcblx0XHRcdFx0XHR0aGlzLmNlcnQgPSBvcHRzLmNlcnQ7XG5cdFx0XHRcdFx0dGhpcy5jYSA9IG9wdHMuY2E7XG5cdFx0XHRcdFx0dGhpcy5jaXBoZXJzID0gb3B0cy5jaXBoZXJzO1xuXHRcdFx0XHRcdHRoaXMucmVqZWN0VW5hdXRob3JpemVkID0gb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cblx0XHRcdFx0XHQvLyBvdGhlciBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTWl4IGluIGBFbWl0dGVyYC5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0RW1pdHRlcihUcmFuc3BvcnQucHJvdG90eXBlKTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRW1pdHMgYW4gZXJyb3IuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcblx0XHRcdFx0ICogQHJldHVybiB7VHJhbnNwb3J0fSBmb3IgY2hhaW5pbmdcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKG1zZywgZGVzYykge1xuXHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IobXNnKTtcblx0XHRcdFx0XHRlcnIudHlwZSA9ICdUcmFuc3BvcnRFcnJvcic7XG5cdFx0XHRcdFx0ZXJyLmRlc2NyaXB0aW9uID0gZGVzYztcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogT3BlbnMgdGhlIHRyYW5zcG9ydC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICgnY2xvc2VkJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJycgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnb3BlbmluZyc7XG5cdFx0XHRcdFx0XHR0aGlzLmRvT3BlbigpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDbG9zZXMgdGhlIHRyYW5zcG9ydC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0aWYgKCdvcGVuaW5nJyA9PSB0aGlzLnJlYWR5U3RhdGUgfHwgJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0dGhpcy5kb0Nsb3NlKCk7XG5cdFx0XHRcdFx0XHR0aGlzLm9uQ2xvc2UoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2VuZHMgbXVsdGlwbGUgcGFja2V0cy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtBcnJheX0gcGFja2V0c1xuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0VHJhbnNwb3J0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKHBhY2tldHMpIHtcblx0XHRcdFx0XHRpZiAoJ29wZW4nID09IHRoaXMucmVhZHlTdGF0ZSkge1xuXHRcdFx0XHRcdFx0dGhpcy53cml0ZShwYWNrZXRzKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdUcmFuc3BvcnQgbm90IG9wZW4nKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIG9wZW5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdvcGVuJztcblx0XHRcdFx0XHR0aGlzLndyaXRhYmxlID0gdHJ1ZTtcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ29wZW4nKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2FsbGVkIHdpdGggZGF0YS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGRhdGFcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25EYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHR2YXIgcGFja2V0ID0gcGFyc2VyLmRlY29kZVBhY2tldChkYXRhLCB0aGlzLnNvY2tldC5iaW5hcnlUeXBlKTtcblx0XHRcdFx0XHR0aGlzLm9uUGFja2V0KHBhY2tldCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB3aXRoIGEgZGVjb2RlZCBwYWNrZXQuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25QYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdwYWNrZXQnLCBwYWNrZXQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDYWxsZWQgdXBvbiBjbG9zZS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnY2xvc2VkJztcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ2Nsb3NlJyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdH0sIHtcblx0XHRcdFx0XCJjb21wb25lbnQtZW1pdHRlclwiOiAxNSxcblx0XHRcdFx0XCJlbmdpbmUuaW8tcGFyc2VyXCI6IDE5XG5cdFx0XHR9XSxcblx0XHRcdDU6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTW9kdWxlIGRlcGVuZGVuY2llc1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0dmFyIFhNTEh0dHBSZXF1ZXN0ID0gX2RlcmVxXygneG1saHR0cHJlcXVlc3Qtc3NsJyk7XG5cdFx0XHRcdFx0dmFyIFhIUiA9IF9kZXJlcV8oJy4vcG9sbGluZy14aHInKTtcblx0XHRcdFx0XHR2YXIgSlNPTlAgPSBfZGVyZXFfKCcuL3BvbGxpbmctanNvbnAnKTtcblx0XHRcdFx0XHR2YXIgd2Vic29ja2V0ID0gX2RlcmVxXygnLi93ZWJzb2NrZXQnKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEV4cG9ydCB0cmFuc3BvcnRzLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5wb2xsaW5nID0gcG9sbGluZztcblx0XHRcdFx0XHRleHBvcnRzLndlYnNvY2tldCA9IHdlYnNvY2tldDtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIFBvbGxpbmcgdHJhbnNwb3J0IHBvbHltb3JwaGljIGNvbnN0cnVjdG9yLlxuXHRcdFx0XHRcdCAqIERlY2lkZXMgb24geGhyIHZzIGpzb25wIGJhc2VkIG9uIGZlYXR1cmUgZGV0ZWN0aW9uLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBwb2xsaW5nKG9wdHMpIHtcblx0XHRcdFx0XHRcdHZhciB4aHI7XG5cdFx0XHRcdFx0XHR2YXIgeGQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHZhciB4cyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0dmFyIGpzb25wID0gZmFsc2UgIT09IG9wdHMuanNvbnA7XG5cblx0XHRcdFx0XHRcdGlmIChnbG9iYWwubG9jYXRpb24pIHtcblx0XHRcdFx0XHRcdFx0dmFyIGlzU1NMID0gJ2h0dHBzOicgPT0gbG9jYXRpb24ucHJvdG9jb2w7XG5cdFx0XHRcdFx0XHRcdHZhciBwb3J0ID0gbG9jYXRpb24ucG9ydDtcblxuXHRcdFx0XHRcdFx0XHQvLyBzb21lIHVzZXIgYWdlbnRzIGhhdmUgZW1wdHkgYGxvY2F0aW9uLnBvcnRgXG5cdFx0XHRcdFx0XHRcdGlmICghcG9ydCkge1xuXHRcdFx0XHRcdFx0XHRcdHBvcnQgPSBpc1NTTCA/IDQ0MyA6IDgwO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0eGQgPSBvcHRzLmhvc3RuYW1lICE9IGxvY2F0aW9uLmhvc3RuYW1lIHx8IHBvcnQgIT0gb3B0cy5wb3J0O1xuXHRcdFx0XHRcdFx0XHR4cyA9IG9wdHMuc2VjdXJlICE9IGlzU1NMO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRvcHRzLnhkb21haW4gPSB4ZDtcblx0XHRcdFx0XHRcdG9wdHMueHNjaGVtZSA9IHhzO1xuXHRcdFx0XHRcdFx0eGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KG9wdHMpO1xuXG5cdFx0XHRcdFx0XHRpZiAoJ29wZW4nIGluIHhociAmJiAhb3B0cy5mb3JjZUpTT05QKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuZXcgWEhSKG9wdHMpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0aWYgKCFqc29ucCkgdGhyb3cgbmV3IEVycm9yKCdKU09OUCBkaXNhYmxlZCcpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbmV3IEpTT05QKG9wdHMpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiLi9wb2xsaW5nLWpzb25wXCI6IDYsXG5cdFx0XHRcdFwiLi9wb2xsaW5nLXhoclwiOiA3LFxuXHRcdFx0XHRcIi4vd2Vic29ja2V0XCI6IDksXG5cdFx0XHRcdFwieG1saHR0cHJlcXVlc3Qtc3NsXCI6IDEwXG5cdFx0XHR9XSxcblx0XHRcdDY6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBNb2R1bGUgcmVxdWlyZW1lbnRzLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0dmFyIFBvbGxpbmcgPSBfZGVyZXFfKCcuL3BvbGxpbmcnKTtcblx0XHRcdFx0XHR2YXIgaW5oZXJpdCA9IF9kZXJlcV8oJ2NvbXBvbmVudC1pbmhlcml0Jyk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBNb2R1bGUgZXhwb3J0cy5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gSlNPTlBQb2xsaW5nO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2FjaGVkIHJlZ3VsYXIgZXhwcmVzc2lvbnMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgck5ld2xpbmUgPSAvXFxuL2c7XG5cdFx0XHRcdFx0dmFyIHJFc2NhcGVkTmV3bGluZSA9IC9cXFxcbi9nO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogR2xvYmFsIEpTT05QIGNhbGxiYWNrcy5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBjYWxsYmFja3M7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsYmFja3MgY291bnQuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgaW5kZXggPSAwO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTm9vcC5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGVtcHR5KCkge31cblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEpTT05QIFBvbGxpbmcgY29uc3RydWN0b3IuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gb3B0cy5cblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gSlNPTlBQb2xsaW5nKG9wdHMpIHtcblx0XHRcdFx0XHRcdFBvbGxpbmcuY2FsbCh0aGlzLCBvcHRzKTtcblxuXHRcdFx0XHRcdFx0dGhpcy5xdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG5cblx0XHRcdFx0XHRcdC8vIGRlZmluZSBnbG9iYWwgY2FsbGJhY2tzIGFycmF5IGlmIG5vdCBwcmVzZW50XG5cdFx0XHRcdFx0XHQvLyB3ZSBkbyB0aGlzIGhlcmUgKGxhemlseSkgdG8gYXZvaWQgdW5uZWVkZWQgZ2xvYmFsIHBvbGx1dGlvblxuXHRcdFx0XHRcdFx0aWYgKCFjYWxsYmFja3MpIHtcblx0XHRcdFx0XHRcdFx0Ly8gd2UgbmVlZCB0byBjb25zaWRlciBtdWx0aXBsZSBlbmdpbmVzIGluIHRoZSBzYW1lIHBhZ2Vcblx0XHRcdFx0XHRcdFx0aWYgKCFnbG9iYWwuX19fZWlvKSBnbG9iYWwuX19fZWlvID0gW107XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrcyA9IGdsb2JhbC5fX19laW87XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGNhbGxiYWNrIGlkZW50aWZpZXJcblx0XHRcdFx0XHRcdHRoaXMuaW5kZXggPSBjYWxsYmFja3MubGVuZ3RoO1xuXG5cdFx0XHRcdFx0XHQvLyBhZGQgY2FsbGJhY2sgdG8ganNvbnAgZ2xvYmFsXG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0XHRjYWxsYmFja3MucHVzaChmdW5jdGlvbiAobXNnKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25EYXRhKG1zZyk7XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0Ly8gYXBwZW5kIHRvIHF1ZXJ5IHN0cmluZ1xuXHRcdFx0XHRcdFx0dGhpcy5xdWVyeS5qID0gdGhpcy5pbmRleDtcblxuXHRcdFx0XHRcdFx0Ly8gcHJldmVudCBzcHVyaW91cyBlcnJvcnMgZnJvbSBiZWluZyBlbWl0dGVkIHdoZW4gdGhlIHdpbmRvdyBpcyB1bmxvYWRlZFxuXHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5kb2N1bWVudCAmJiBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0XHRcdFx0XHRnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChzZWxmLnNjcmlwdCkgc2VsZi5zY3JpcHQub25lcnJvciA9IGVtcHR5O1xuXHRcdFx0XHRcdFx0XHR9LCBmYWxzZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogSW5oZXJpdHMgZnJvbSBQb2xsaW5nLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0aW5oZXJpdChKU09OUFBvbGxpbmcsIFBvbGxpbmcpO1xuXG5cdFx0XHRcdFx0Lypcblx0XHRcdFx0XHQgKiBKU09OUCBvbmx5IHN1cHBvcnRzIGJpbmFyeSBhcyBiYXNlNjQgZW5jb2RlZCBzdHJpbmdzXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRKU09OUFBvbGxpbmcucHJvdG90eXBlLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDbG9zZXMgdGhlIHNvY2tldC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5kb0Nsb3NlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMuc2NyaXB0KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2NyaXB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5zY3JpcHQpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNjcmlwdCA9IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLmZvcm0pIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5mb3JtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5mb3JtKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5mb3JtID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0dGhpcy5pZnJhbWUgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS5kb0Nsb3NlLmNhbGwodGhpcyk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIFN0YXJ0cyBhIHBvbGwgY3ljbGUuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdEpTT05QUG9sbGluZy5wcm90b3R5cGUuZG9Qb2xsID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0dmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5zY3JpcHQpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNjcmlwdCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2NyaXB0ID0gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0c2NyaXB0LmFzeW5jID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHNjcmlwdC5zcmMgPSB0aGlzLnVyaSgpO1xuXHRcdFx0XHRcdFx0c2NyaXB0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uRXJyb3IoJ2pzb25wIHBvbGwgZXJyb3InLCBlKTtcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdHZhciBpbnNlcnRBdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcblx0XHRcdFx0XHRcdGlmIChpbnNlcnRBdCkge1xuXHRcdFx0XHRcdFx0XHRpbnNlcnRBdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzY3JpcHQsIGluc2VydEF0KTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdChkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKHNjcmlwdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLnNjcmlwdCA9IHNjcmlwdDtcblxuXHRcdFx0XHRcdFx0dmFyIGlzVUFnZWNrbyA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBuYXZpZ2F0b3IgJiYgL2dlY2tvL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcblxuXHRcdFx0XHRcdFx0aWYgKGlzVUFnZWNrbykge1xuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG5cdFx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuXHRcdFx0XHRcdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaWZyYW1lKTtcblx0XHRcdFx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogV3JpdGVzIHdpdGggYSBoaWRkZW4gaWZyYW1lLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGRhdGEgdG8gc2VuZFxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxlZCB1cG9uIGZsdXNoLlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0SlNPTlBQb2xsaW5nLnByb3RvdHlwZS5kb1dyaXRlID0gZnVuY3Rpb24gKGRhdGEsIGZuKSB7XG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRcdGlmICghdGhpcy5mb3JtKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpO1xuXHRcdFx0XHRcdFx0XHR2YXIgYXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG5cdFx0XHRcdFx0XHRcdHZhciBpZCA9IHRoaXMuaWZyYW1lSWQgPSAnZWlvX2lmcmFtZV8nICsgdGhpcy5pbmRleDtcblx0XHRcdFx0XHRcdFx0dmFyIGlmcmFtZTtcblxuXHRcdFx0XHRcdFx0XHRmb3JtLmNsYXNzTmFtZSA9ICdzb2NrZXRpbyc7XG5cdFx0XHRcdFx0XHRcdGZvcm0uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuXHRcdFx0XHRcdFx0XHRmb3JtLnN0eWxlLnRvcCA9ICctMTAwMHB4Jztcblx0XHRcdFx0XHRcdFx0Zm9ybS5zdHlsZS5sZWZ0ID0gJy0xMDAwcHgnO1xuXHRcdFx0XHRcdFx0XHRmb3JtLnRhcmdldCA9IGlkO1xuXHRcdFx0XHRcdFx0XHRmb3JtLm1ldGhvZCA9ICdQT1NUJztcblx0XHRcdFx0XHRcdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ2FjY2VwdC1jaGFyc2V0JywgJ3V0Zi04Jyk7XG5cdFx0XHRcdFx0XHRcdGFyZWEubmFtZSA9ICdkJztcblx0XHRcdFx0XHRcdFx0Zm9ybS5hcHBlbmRDaGlsZChhcmVhKTtcblx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmb3JtKTtcblxuXHRcdFx0XHRcdFx0XHR0aGlzLmZvcm0gPSBmb3JtO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmFyZWEgPSBhcmVhO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0aGlzLmZvcm0uYWN0aW9uID0gdGhpcy51cmkoKTtcblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gY29tcGxldGUoKSB7XG5cdFx0XHRcdFx0XHRcdGluaXRJZnJhbWUoKTtcblx0XHRcdFx0XHRcdFx0Zm4oKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gaW5pdElmcmFtZSgpIHtcblx0XHRcdFx0XHRcdFx0aWYgKHNlbGYuaWZyYW1lKSB7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYuZm9ybS5yZW1vdmVDaGlsZChzZWxmLmlmcmFtZSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKCdqc29ucCBwb2xsaW5nIGlmcmFtZSByZW1vdmFsIGVycm9yJywgZSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHQvLyBpZTYgZHluYW1pYyBpZnJhbWVzIHdpdGggdGFyZ2V0PVwiXCIgc3VwcG9ydCAodGhhbmtzIENocmlzIExhbWJhY2hlcilcblx0XHRcdFx0XHRcdFx0XHR2YXIgaHRtbCA9ICc8aWZyYW1lIHNyYz1cImphdmFzY3JpcHQ6MFwiIG5hbWU9XCInICsgc2VsZi5pZnJhbWVJZCArICdcIj4nO1xuXHRcdFx0XHRcdFx0XHRcdGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaHRtbCk7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0XHRpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcblx0XHRcdFx0XHRcdFx0XHRpZnJhbWUubmFtZSA9IHNlbGYuaWZyYW1lSWQ7XG5cdFx0XHRcdFx0XHRcdFx0aWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0OjAnO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWZyYW1lLmlkID0gc2VsZi5pZnJhbWVJZDtcblxuXHRcdFx0XHRcdFx0XHRzZWxmLmZvcm0uYXBwZW5kQ2hpbGQoaWZyYW1lKTtcblx0XHRcdFx0XHRcdFx0c2VsZi5pZnJhbWUgPSBpZnJhbWU7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGluaXRJZnJhbWUoKTtcblxuXHRcdFx0XHRcdFx0Ly8gZXNjYXBlIFxcbiB0byBwcmV2ZW50IGl0IGZyb20gYmVpbmcgY29udmVydGVkIGludG8gXFxyXFxuIGJ5IHNvbWUgVUFzXG5cdFx0XHRcdFx0XHQvLyBkb3VibGUgZXNjYXBpbmcgaXMgcmVxdWlyZWQgZm9yIGVzY2FwZWQgbmV3IGxpbmVzIGJlY2F1c2UgdW5lc2NhcGluZyBvZiBuZXcgbGluZXMgY2FuIGJlIGRvbmUgc2FmZWx5IG9uIHNlcnZlci1zaWRlXG5cdFx0XHRcdFx0XHRkYXRhID0gZGF0YS5yZXBsYWNlKHJFc2NhcGVkTmV3bGluZSwgJ1xcXFxcXG4nKTtcblx0XHRcdFx0XHRcdHRoaXMuYXJlYS52YWx1ZSA9IGRhdGEucmVwbGFjZShyTmV3bGluZSwgJ1xcXFxuJyk7XG5cblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZm9ybS5zdWJtaXQoKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLmlmcmFtZS5hdHRhY2hFdmVudCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmlmcmFtZS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHNlbGYuaWZyYW1lLnJlYWR5U3RhdGUgPT0gJ2NvbXBsZXRlJykge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29tcGxldGUoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmlmcmFtZS5vbmxvYWQgPSBjb21wbGV0ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSlcblx0XHRcdH0sIHtcblx0XHRcdFx0XCIuL3BvbGxpbmdcIjogOCxcblx0XHRcdFx0XCJjb21wb25lbnQtaW5oZXJpdFwiOiAxNlxuXHRcdFx0fV0sXG5cdFx0XHQ3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSByZXF1aXJlbWVudHMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgWE1MSHR0cFJlcXVlc3QgPSBfZGVyZXFfKCd4bWxodHRwcmVxdWVzdC1zc2wnKTtcblx0XHRcdFx0XHR2YXIgUG9sbGluZyA9IF9kZXJlcV8oJy4vcG9sbGluZycpO1xuXHRcdFx0XHRcdHZhciBFbWl0dGVyID0gX2RlcmVxXygnY29tcG9uZW50LWVtaXR0ZXInKTtcblx0XHRcdFx0XHR2YXIgaW5oZXJpdCA9IF9kZXJlcV8oJ2NvbXBvbmVudC1pbmhlcml0Jyk7XG5cdFx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnZW5naW5lLmlvLWNsaWVudDpwb2xsaW5nLXhocicpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTW9kdWxlIGV4cG9ydHMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IFhIUjtcblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cy5SZXF1ZXN0ID0gUmVxdWVzdDtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEVtcHR5IGZ1bmN0aW9uXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBlbXB0eSgpIHt9XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBYSFIgUG9sbGluZyBjb25zdHJ1Y3Rvci5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzXG5cdFx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIFhIUihvcHRzKSB7XG5cdFx0XHRcdFx0XHRQb2xsaW5nLmNhbGwodGhpcywgb3B0cyk7XG5cblx0XHRcdFx0XHRcdGlmIChnbG9iYWwubG9jYXRpb24pIHtcblx0XHRcdFx0XHRcdFx0dmFyIGlzU1NMID0gJ2h0dHBzOicgPT0gbG9jYXRpb24ucHJvdG9jb2w7XG5cdFx0XHRcdFx0XHRcdHZhciBwb3J0ID0gbG9jYXRpb24ucG9ydDtcblxuXHRcdFx0XHRcdFx0XHQvLyBzb21lIHVzZXIgYWdlbnRzIGhhdmUgZW1wdHkgYGxvY2F0aW9uLnBvcnRgXG5cdFx0XHRcdFx0XHRcdGlmICghcG9ydCkge1xuXHRcdFx0XHRcdFx0XHRcdHBvcnQgPSBpc1NTTCA/IDQ0MyA6IDgwO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0dGhpcy54ZCA9IG9wdHMuaG9zdG5hbWUgIT0gZ2xvYmFsLmxvY2F0aW9uLmhvc3RuYW1lIHx8XG5cdFx0XHRcdFx0XHRcdFx0cG9ydCAhPSBvcHRzLnBvcnQ7XG5cdFx0XHRcdFx0XHRcdHRoaXMueHMgPSBvcHRzLnNlY3VyZSAhPSBpc1NTTDtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuZXh0cmFIZWFkZXJzID0gb3B0cy5leHRyYUhlYWRlcnM7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogSW5oZXJpdHMgZnJvbSBQb2xsaW5nLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0aW5oZXJpdChYSFIsIFBvbGxpbmcpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogWEhSIHN1cHBvcnRzIGJpbmFyeVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0WEhSLnByb3RvdHlwZS5zdXBwb3J0c0JpbmFyeSA9IHRydWU7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDcmVhdGVzIGEgcmVxdWVzdC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2Rcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChvcHRzKSB7XG5cdFx0XHRcdFx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblx0XHRcdFx0XHRcdG9wdHMudXJpID0gdGhpcy51cmkoKTtcblx0XHRcdFx0XHRcdG9wdHMueGQgPSB0aGlzLnhkO1xuXHRcdFx0XHRcdFx0b3B0cy54cyA9IHRoaXMueHM7XG5cdFx0XHRcdFx0XHRvcHRzLmFnZW50ID0gdGhpcy5hZ2VudCB8fCBmYWxzZTtcblx0XHRcdFx0XHRcdG9wdHMuc3VwcG9ydHNCaW5hcnkgPSB0aGlzLnN1cHBvcnRzQmluYXJ5O1xuXHRcdFx0XHRcdFx0b3B0cy5lbmFibGVzWERSID0gdGhpcy5lbmFibGVzWERSO1xuXG5cdFx0XHRcdFx0XHQvLyBTU0wgb3B0aW9ucyBmb3IgTm9kZS5qcyBjbGllbnRcblx0XHRcdFx0XHRcdG9wdHMucGZ4ID0gdGhpcy5wZng7XG5cdFx0XHRcdFx0XHRvcHRzLmtleSA9IHRoaXMua2V5O1xuXHRcdFx0XHRcdFx0b3B0cy5wYXNzcGhyYXNlID0gdGhpcy5wYXNzcGhyYXNlO1xuXHRcdFx0XHRcdFx0b3B0cy5jZXJ0ID0gdGhpcy5jZXJ0O1xuXHRcdFx0XHRcdFx0b3B0cy5jYSA9IHRoaXMuY2E7XG5cdFx0XHRcdFx0XHRvcHRzLmNpcGhlcnMgPSB0aGlzLmNpcGhlcnM7XG5cdFx0XHRcdFx0XHRvcHRzLnJlamVjdFVuYXV0aG9yaXplZCA9IHRoaXMucmVqZWN0VW5hdXRob3JpemVkO1xuXG5cdFx0XHRcdFx0XHQvLyBvdGhlciBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0b3B0cy5leHRyYUhlYWRlcnMgPSB0aGlzLmV4dHJhSGVhZGVycztcblxuXHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBSZXF1ZXN0KG9wdHMpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBTZW5kcyBkYXRhLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGRhdGEgdG8gc2VuZC5cblx0XHRcdFx0XHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsZWQgdXBvbiBmbHVzaC5cblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUuZG9Xcml0ZSA9IGZ1bmN0aW9uIChkYXRhLCBmbikge1xuXHRcdFx0XHRcdFx0dmFyIGlzQmluYXJ5ID0gdHlwZW9mIGRhdGEgIT09ICdzdHJpbmcnICYmIGRhdGEgIT09IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdHZhciByZXEgPSB0aGlzLnJlcXVlc3Qoe1xuXHRcdFx0XHRcdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdFx0XHRcdFx0ZGF0YTogZGF0YSxcblx0XHRcdFx0XHRcdFx0aXNCaW5hcnk6IGlzQmluYXJ5XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRcdHJlcS5vbignc3VjY2VzcycsIGZuKTtcblx0XHRcdFx0XHRcdHJlcS5vbignZXJyb3InLCBmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25FcnJvcigneGhyIHBvc3QgZXJyb3InLCBlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR0aGlzLnNlbmRYaHIgPSByZXE7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIFN0YXJ0cyBhIHBvbGwgY3ljbGUuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFhIUi5wcm90b3R5cGUuZG9Qb2xsID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3hociBwb2xsJyk7XG5cdFx0XHRcdFx0XHR2YXIgcmVxID0gdGhpcy5yZXF1ZXN0KCk7XG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0XHRyZXEub24oJ2RhdGEnLCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uRGF0YShkYXRhKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0cmVxLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKCd4aHIgcG9sbCBlcnJvcicsIGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdHRoaXMucG9sbFhociA9IHJlcTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogUmVxdWVzdCBjb25zdHJ1Y3RvclxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gUmVxdWVzdChvcHRzKSB7XG5cdFx0XHRcdFx0XHR0aGlzLm1ldGhvZCA9IG9wdHMubWV0aG9kIHx8ICdHRVQnO1xuXHRcdFx0XHRcdFx0dGhpcy51cmkgPSBvcHRzLnVyaTtcblx0XHRcdFx0XHRcdHRoaXMueGQgPSAhIW9wdHMueGQ7XG5cdFx0XHRcdFx0XHR0aGlzLnhzID0gISFvcHRzLnhzO1xuXHRcdFx0XHRcdFx0dGhpcy5hc3luYyA9IGZhbHNlICE9PSBvcHRzLmFzeW5jO1xuXHRcdFx0XHRcdFx0dGhpcy5kYXRhID0gdW5kZWZpbmVkICE9IG9wdHMuZGF0YSA/IG9wdHMuZGF0YSA6IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLmFnZW50ID0gb3B0cy5hZ2VudDtcblx0XHRcdFx0XHRcdHRoaXMuaXNCaW5hcnkgPSBvcHRzLmlzQmluYXJ5O1xuXHRcdFx0XHRcdFx0dGhpcy5zdXBwb3J0c0JpbmFyeSA9IG9wdHMuc3VwcG9ydHNCaW5hcnk7XG5cdFx0XHRcdFx0XHR0aGlzLmVuYWJsZXNYRFIgPSBvcHRzLmVuYWJsZXNYRFI7XG5cblx0XHRcdFx0XHRcdC8vIFNTTCBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0dGhpcy5wZnggPSBvcHRzLnBmeDtcblx0XHRcdFx0XHRcdHRoaXMua2V5ID0gb3B0cy5rZXk7XG5cdFx0XHRcdFx0XHR0aGlzLnBhc3NwaHJhc2UgPSBvcHRzLnBhc3NwaHJhc2U7XG5cdFx0XHRcdFx0XHR0aGlzLmNlcnQgPSBvcHRzLmNlcnQ7XG5cdFx0XHRcdFx0XHR0aGlzLmNhID0gb3B0cy5jYTtcblx0XHRcdFx0XHRcdHRoaXMuY2lwaGVycyA9IG9wdHMuY2lwaGVycztcblx0XHRcdFx0XHRcdHRoaXMucmVqZWN0VW5hdXRob3JpemVkID0gb3B0cy5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cblx0XHRcdFx0XHRcdC8vIG90aGVyIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0XHR0aGlzLmV4dHJhSGVhZGVycyA9IG9wdHMuZXh0cmFIZWFkZXJzO1xuXG5cdFx0XHRcdFx0XHR0aGlzLmNyZWF0ZSgpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1peCBpbiBgRW1pdHRlcmAuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRFbWl0dGVyKFJlcXVlc3QucHJvdG90eXBlKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIENyZWF0ZXMgdGhlIFhIUiBvYmplY3QgYW5kIHNlbmRzIHRoZSByZXF1ZXN0LlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRSZXF1ZXN0LnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHR2YXIgb3B0cyA9IHtcblx0XHRcdFx0XHRcdFx0YWdlbnQ6IHRoaXMuYWdlbnQsXG5cdFx0XHRcdFx0XHRcdHhkb21haW46IHRoaXMueGQsXG5cdFx0XHRcdFx0XHRcdHhzY2hlbWU6IHRoaXMueHMsXG5cdFx0XHRcdFx0XHRcdGVuYWJsZXNYRFI6IHRoaXMuZW5hYmxlc1hEUlxuXHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0Ly8gU1NMIG9wdGlvbnMgZm9yIE5vZGUuanMgY2xpZW50XG5cdFx0XHRcdFx0XHRvcHRzLnBmeCA9IHRoaXMucGZ4O1xuXHRcdFx0XHRcdFx0b3B0cy5rZXkgPSB0aGlzLmtleTtcblx0XHRcdFx0XHRcdG9wdHMucGFzc3BocmFzZSA9IHRoaXMucGFzc3BocmFzZTtcblx0XHRcdFx0XHRcdG9wdHMuY2VydCA9IHRoaXMuY2VydDtcblx0XHRcdFx0XHRcdG9wdHMuY2EgPSB0aGlzLmNhO1xuXHRcdFx0XHRcdFx0b3B0cy5jaXBoZXJzID0gdGhpcy5jaXBoZXJzO1xuXHRcdFx0XHRcdFx0b3B0cy5yZWplY3RVbmF1dGhvcml6ZWQgPSB0aGlzLnJlamVjdFVuYXV0aG9yaXplZDtcblxuXHRcdFx0XHRcdFx0dmFyIHhociA9IHRoaXMueGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KG9wdHMpO1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1ZygneGhyIG9wZW4gJXM6ICVzJywgdGhpcy5tZXRob2QsIHRoaXMudXJpKTtcblx0XHRcdFx0XHRcdFx0eGhyLm9wZW4odGhpcy5tZXRob2QsIHRoaXMudXJpLCB0aGlzLmFzeW5jKTtcblx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5leHRyYUhlYWRlcnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHhoci5zZXREaXNhYmxlSGVhZGVyQ2hlY2sodHJ1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpIGluIHRoaXMuZXh0cmFIZWFkZXJzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLmV4dHJhSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyKGksIHRoaXMuZXh0cmFIZWFkZXJzW2ldKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuc3VwcG9ydHNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBUaGlzIGhhcyB0byBiZSBkb25lIGFmdGVyIG9wZW4gYmVjYXVzZSBGaXJlZm94IGlzIHN0dXBpZFxuXHRcdFx0XHRcdFx0XHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTMyMTY5MDMvZ2V0LWJpbmFyeS1kYXRhLXdpdGgteG1saHR0cHJlcXVlc3QtaW4tYS1maXJlZm94LWV4dGVuc2lvblxuXHRcdFx0XHRcdFx0XHRcdHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKCdQT1NUJyA9PSB0aGlzLm1ldGhvZCkge1xuXHRcdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5pc0JpbmFyeSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0eGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7fVxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0Ly8gaWU2IGNoZWNrXG5cdFx0XHRcdFx0XHRcdGlmICgnd2l0aENyZWRlbnRpYWxzJyBpbiB4aHIpIHtcblx0XHRcdFx0XHRcdFx0XHR4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLmhhc1hEUigpKSB7XG5cdFx0XHRcdFx0XHRcdFx0eGhyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYub25Mb2FkKCk7XG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHR4aHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYub25FcnJvcih4aHIucmVzcG9uc2VUZXh0KTtcblx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoNCAhPSB4aHIucmVhZHlTdGF0ZSkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKDIwMCA9PSB4aHIuc3RhdHVzIHx8IDEyMjMgPT0geGhyLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZWxmLm9uTG9hZCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbWFrZSBzdXJlIHRoZSBgZXJyb3JgIGV2ZW50IGhhbmRsZXIgdGhhdCdzIHVzZXItc2V0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRvZXMgbm90IHRocm93IGluIHRoZSBzYW1lIHRpY2sgYW5kIGdldHMgY2F1Z2h0IGhlcmVcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKHhoci5zdGF0dXMpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9LCAwKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3hociBkYXRhICVzJywgdGhpcy5kYXRhKTtcblx0XHRcdFx0XHRcdFx0eGhyLnNlbmQodGhpcy5kYXRhKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0Ly8gTmVlZCB0byBkZWZlciBzaW5jZSAuY3JlYXRlKCkgaXMgY2FsbGVkIGRpcmVjdGx5IGZocm9tIHRoZSBjb25zdHJ1Y3RvclxuXHRcdFx0XHRcdFx0XHQvLyBhbmQgdGh1cyB0aGUgJ2Vycm9yJyBldmVudCBjYW4gb25seSBiZSBvbmx5IGJvdW5kICphZnRlciogdGhpcyBleGNlcHRpb25cblx0XHRcdFx0XHRcdFx0Ly8gb2NjdXJzLiAgVGhlcmVmb3JlLCBhbHNvLCB3ZSBjYW5ub3QgdGhyb3cgaGVyZSBhdCBhbGwuXG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdHNlbGYub25FcnJvcihlKTtcblx0XHRcdFx0XHRcdFx0fSwgMCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5kb2N1bWVudCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmluZGV4ID0gUmVxdWVzdC5yZXF1ZXN0c0NvdW50Kys7XG5cdFx0XHRcdFx0XHRcdFJlcXVlc3QucmVxdWVzdHNbdGhpcy5pbmRleF0gPSB0aGlzO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsZWQgdXBvbiBzdWNjZXNzZnVsIHJlc3BvbnNlLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRSZXF1ZXN0LnByb3RvdHlwZS5vblN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ3N1Y2Nlc3MnKTtcblx0XHRcdFx0XHRcdHRoaXMuY2xlYW51cCgpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsZWQgaWYgd2UgaGF2ZSBkYXRhLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRSZXF1ZXN0LnByb3RvdHlwZS5vbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdkYXRhJywgZGF0YSk7XG5cdFx0XHRcdFx0XHR0aGlzLm9uU3VjY2VzcygpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsZWQgdXBvbiBlcnJvci5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0UmVxdWVzdC5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuXHRcdFx0XHRcdFx0dGhpcy5jbGVhbnVwKHRydWUpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDbGVhbnMgdXAgaG91c2UuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFJlcXVlc3QucHJvdG90eXBlLmNsZWFudXAgPSBmdW5jdGlvbiAoZnJvbUVycm9yKSB7XG5cdFx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHRoaXMueGhyIHx8IG51bGwgPT09IHRoaXMueGhyKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8vIHhtbGh0dHByZXF1ZXN0XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5oYXNYRFIoKSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnhoci5vbmxvYWQgPSB0aGlzLnhoci5vbmVycm9yID0gZW1wdHk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKGZyb21FcnJvcikge1xuXHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMueGhyLmFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmIChnbG9iYWwuZG9jdW1lbnQpIHtcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIFJlcXVlc3QucmVxdWVzdHNbdGhpcy5pbmRleF07XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMueGhyID0gbnVsbDtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2FsbGVkIHVwb24gbG9hZC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0UmVxdWVzdC5wcm90b3R5cGUub25Mb2FkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIGRhdGE7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHR2YXIgY29udGVudFR5cGU7XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudFR5cGUgPSB0aGlzLnhoci5nZXRSZXNwb25zZUhlYWRlcignQ29udGVudC1UeXBlJykuc3BsaXQoJzsnKVswXTtcblx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlID09PSAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJykge1xuXHRcdFx0XHRcdFx0XHRcdGRhdGEgPSB0aGlzLnhoci5yZXNwb25zZTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoIXRoaXMuc3VwcG9ydHNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSB0aGlzLnhoci5yZXNwb25zZVRleHQ7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KHRoaXMueGhyLnJlc3BvbnNlKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciB1aThBcnIgPSBuZXcgVWludDhBcnJheSh0aGlzLnhoci5yZXNwb25zZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBkYXRhQXJyYXkgPSBbXTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaWR4ID0gMCwgbGVuZ3RoID0gdWk4QXJyLmxlbmd0aDsgaWR4IDwgbGVuZ3RoOyBpZHgrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGFBcnJheS5wdXNoKHVpOEFycltpZHhdKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGRhdGFBcnJheSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMub25FcnJvcihlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmIChudWxsICE9IGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5vbkRhdGEoZGF0YSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIENoZWNrIGlmIGl0IGhhcyBYRG9tYWluUmVxdWVzdC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0UmVxdWVzdC5wcm90b3R5cGUuaGFzWERSID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuICd1bmRlZmluZWQnICE9PSB0eXBlb2YgZ2xvYmFsLlhEb21haW5SZXF1ZXN0ICYmICF0aGlzLnhzICYmIHRoaXMuZW5hYmxlc1hEUjtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQWJvcnRzIHRoZSByZXF1ZXN0LlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdFJlcXVlc3QucHJvdG90eXBlLmFib3J0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dGhpcy5jbGVhbnVwKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEFib3J0cyBwZW5kaW5nIHJlcXVlc3RzIHdoZW4gdW5sb2FkaW5nIHRoZSB3aW5kb3cuIFRoaXMgaXMgbmVlZGVkIHRvIHByZXZlbnRcblx0XHRcdFx0XHQgKiBtZW1vcnkgbGVha3MgKGUuZy4gd2hlbiB1c2luZyBJRSkgYW5kIHRvIGVuc3VyZSB0aGF0IG5vIHNwdXJpb3VzIGVycm9yIGlzXG5cdFx0XHRcdFx0ICogZW1pdHRlZC5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGlmIChnbG9iYWwuZG9jdW1lbnQpIHtcblx0XHRcdFx0XHRcdFJlcXVlc3QucmVxdWVzdHNDb3VudCA9IDA7XG5cdFx0XHRcdFx0XHRSZXF1ZXN0LnJlcXVlc3RzID0ge307XG5cdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLmF0dGFjaEV2ZW50KSB7XG5cdFx0XHRcdFx0XHRcdGdsb2JhbC5hdHRhY2hFdmVudCgnb251bmxvYWQnLCB1bmxvYWRIYW5kbGVyKTtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHtcblx0XHRcdFx0XHRcdFx0Z2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHVubG9hZEhhbmRsZXIsIGZhbHNlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRmdW5jdGlvbiB1bmxvYWRIYW5kbGVyKCkge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSBpbiBSZXF1ZXN0LnJlcXVlc3RzKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChSZXF1ZXN0LnJlcXVlc3RzLmhhc093blByb3BlcnR5KGkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0UmVxdWVzdC5yZXF1ZXN0c1tpXS5hYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSlcblx0XHRcdH0sIHtcblx0XHRcdFx0XCIuL3BvbGxpbmdcIjogOCxcblx0XHRcdFx0XCJjb21wb25lbnQtZW1pdHRlclwiOiAxNSxcblx0XHRcdFx0XCJjb21wb25lbnQtaW5oZXJpdFwiOiAxNixcblx0XHRcdFx0XCJkZWJ1Z1wiOiAxNyxcblx0XHRcdFx0XCJ4bWxodHRwcmVxdWVzdC1zc2xcIjogMTBcblx0XHRcdH1dLFxuXHRcdFx0ODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdHZhciBUcmFuc3BvcnQgPSBfZGVyZXFfKCcuLi90cmFuc3BvcnQnKTtcblx0XHRcdFx0dmFyIHBhcnNlcXMgPSBfZGVyZXFfKCdwYXJzZXFzJyk7XG5cdFx0XHRcdHZhciBwYXJzZXIgPSBfZGVyZXFfKCdlbmdpbmUuaW8tcGFyc2VyJyk7XG5cdFx0XHRcdHZhciBpbmhlcml0ID0gX2RlcmVxXygnY29tcG9uZW50LWluaGVyaXQnKTtcblx0XHRcdFx0dmFyIHllYXN0ID0gX2RlcmVxXygneWVhc3QnKTtcblx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnZW5naW5lLmlvLWNsaWVudDpwb2xsaW5nJyk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IFBvbGxpbmc7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIElzIFhIUjIgc3VwcG9ydGVkP1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgaGFzWEhSMiA9IChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dmFyIFhNTEh0dHBSZXF1ZXN0ID0gX2RlcmVxXygneG1saHR0cHJlcXVlc3Qtc3NsJyk7XG5cdFx0XHRcdFx0dmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCh7XG5cdFx0XHRcdFx0XHR4ZG9tYWluOiBmYWxzZVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHJldHVybiBudWxsICE9IHhoci5yZXNwb25zZVR5cGU7XG5cdFx0XHRcdH0pKCk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFBvbGxpbmcgaW50ZXJmYWNlLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gb3B0c1xuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gUG9sbGluZyhvcHRzKSB7XG5cdFx0XHRcdFx0dmFyIGZvcmNlQmFzZTY0ID0gKG9wdHMgJiYgb3B0cy5mb3JjZUJhc2U2NCk7XG5cdFx0XHRcdFx0aWYgKCFoYXNYSFIyIHx8IGZvcmNlQmFzZTY0KSB7XG5cdFx0XHRcdFx0XHR0aGlzLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFRyYW5zcG9ydC5jYWxsKHRoaXMsIG9wdHMpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEluaGVyaXRzIGZyb20gVHJhbnNwb3J0LlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRpbmhlcml0KFBvbGxpbmcsIFRyYW5zcG9ydCk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFRyYW5zcG9ydCBuYW1lLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS5uYW1lID0gJ3BvbGxpbmcnO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBPcGVucyB0aGUgc29ja2V0ICh0cmlnZ2VycyBwb2xsaW5nKS4gV2Ugd3JpdGUgYSBQSU5HIG1lc3NhZ2UgdG8gZGV0ZXJtaW5lXG5cdFx0XHRcdCAqIHdoZW4gdGhlIHRyYW5zcG9ydCBpcyBvcGVuLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0UG9sbGluZy5wcm90b3R5cGUuZG9PcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMucG9sbCgpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQYXVzZXMgcG9sbGluZy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgdXBvbiBidWZmZXJzIGFyZSBmbHVzaGVkIGFuZCB0cmFuc3BvcnQgaXMgcGF1c2VkXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRQb2xsaW5nLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIChvblBhdXNlKSB7XG5cdFx0XHRcdFx0dmFyIHBlbmRpbmcgPSAwO1xuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdwYXVzaW5nJztcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHBhdXNlKCkge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3BhdXNlZCcpO1xuXHRcdFx0XHRcdFx0c2VsZi5yZWFkeVN0YXRlID0gJ3BhdXNlZCc7XG5cdFx0XHRcdFx0XHRvblBhdXNlKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHRoaXMucG9sbGluZyB8fCAhdGhpcy53cml0YWJsZSkge1xuXHRcdFx0XHRcdFx0dmFyIHRvdGFsID0gMDtcblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucG9sbGluZykge1xuXHRcdFx0XHRcdFx0XHRkZWJ1Zygnd2UgYXJlIGN1cnJlbnRseSBwb2xsaW5nIC0gd2FpdGluZyB0byBwYXVzZScpO1xuXHRcdFx0XHRcdFx0XHR0b3RhbCsrO1xuXHRcdFx0XHRcdFx0XHR0aGlzLm9uY2UoJ3BvbGxDb21wbGV0ZScsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJlLXBhdXNlIHBvbGxpbmcgY29tcGxldGUnKTtcblx0XHRcdFx0XHRcdFx0XHQtLXRvdGFsIHx8IHBhdXNlKCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMud3JpdGFibGUpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ3dlIGFyZSBjdXJyZW50bHkgd3JpdGluZyAtIHdhaXRpbmcgdG8gcGF1c2UnKTtcblx0XHRcdFx0XHRcdFx0dG90YWwrKztcblx0XHRcdFx0XHRcdFx0dGhpcy5vbmNlKCdkcmFpbicsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRkZWJ1ZygncHJlLXBhdXNlIHdyaXRpbmcgY29tcGxldGUnKTtcblx0XHRcdFx0XHRcdFx0XHQtLXRvdGFsIHx8IHBhdXNlKCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRwYXVzZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU3RhcnRzIHBvbGxpbmcgY3ljbGUuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFBvbGxpbmcucHJvdG90eXBlLnBvbGwgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0ZGVidWcoJ3BvbGxpbmcnKTtcblx0XHRcdFx0XHR0aGlzLnBvbGxpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZG9Qb2xsKCk7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdwb2xsJyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE92ZXJsb2FkcyBvbkRhdGEgdG8gZGV0ZWN0IHBheWxvYWRzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0UG9sbGluZy5wcm90b3R5cGUub25EYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0ZGVidWcoJ3BvbGxpbmcgZ290IGRhdGEgJXMnLCBkYXRhKTtcblx0XHRcdFx0XHR2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAocGFja2V0LCBpbmRleCwgdG90YWwpIHtcblx0XHRcdFx0XHRcdC8vIGlmIGl0cyB0aGUgZmlyc3QgbWVzc2FnZSB3ZSBjb25zaWRlciB0aGUgdHJhbnNwb3J0IG9wZW5cblx0XHRcdFx0XHRcdGlmICgnb3BlbmluZycgPT0gc2VsZi5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25PcGVuKCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGlmIGl0cyBhIGNsb3NlIHBhY2tldCwgd2UgY2xvc2UgdGhlIG9uZ29pbmcgcmVxdWVzdHNcblx0XHRcdFx0XHRcdGlmICgnY2xvc2UnID09IHBhY2tldC50eXBlKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25DbG9zZSgpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIG90aGVyd2lzZSBieXBhc3Mgb25EYXRhIGFuZCBoYW5kbGUgdGhlIG1lc3NhZ2Vcblx0XHRcdFx0XHRcdHNlbGYub25QYWNrZXQocGFja2V0KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0Ly8gZGVjb2RlIHBheWxvYWRcblx0XHRcdFx0XHRwYXJzZXIuZGVjb2RlUGF5bG9hZChkYXRhLCB0aGlzLnNvY2tldC5iaW5hcnlUeXBlLCBjYWxsYmFjayk7XG5cblx0XHRcdFx0XHQvLyBpZiBhbiBldmVudCBkaWQgbm90IHRyaWdnZXIgY2xvc2luZ1xuXHRcdFx0XHRcdGlmICgnY2xvc2VkJyAhPSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdC8vIGlmIHdlIGdvdCBkYXRhIHdlJ3JlIG5vdCBwb2xsaW5nXG5cdFx0XHRcdFx0XHR0aGlzLnBvbGxpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgncG9sbENvbXBsZXRlJyk7XG5cblx0XHRcdFx0XHRcdGlmICgnb3BlbicgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMucG9sbCgpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2lnbm9yaW5nIHBvbGwgLSB0cmFuc3BvcnQgc3RhdGUgXCIlc1wiJywgdGhpcy5yZWFkeVN0YXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEZvciBwb2xsaW5nLCBzZW5kIGEgY2xvc2UgcGFja2V0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0UG9sbGluZy5wcm90b3R5cGUuZG9DbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRmdW5jdGlvbiBjbG9zZSgpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCd3cml0aW5nIGNsb3NlIHBhY2tldCcpO1xuXHRcdFx0XHRcdFx0c2VsZi53cml0ZShbe1xuXHRcdFx0XHRcdFx0XHR0eXBlOiAnY2xvc2UnXG5cdFx0XHRcdFx0XHR9XSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCdvcGVuJyA9PSB0aGlzLnJlYWR5U3RhdGUpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCd0cmFuc3BvcnQgb3BlbiAtIGNsb3NpbmcnKTtcblx0XHRcdFx0XHRcdGNsb3NlKCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIGluIGNhc2Ugd2UncmUgdHJ5aW5nIHRvIGNsb3NlIHdoaWxlXG5cdFx0XHRcdFx0XHQvLyBoYW5kc2hha2luZyBpcyBpbiBwcm9ncmVzcyAoR0gtMTY0KVxuXHRcdFx0XHRcdFx0ZGVidWcoJ3RyYW5zcG9ydCBub3Qgb3BlbiAtIGRlZmVycmluZyBjbG9zZScpO1xuXHRcdFx0XHRcdFx0dGhpcy5vbmNlKCdvcGVuJywgY2xvc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogV3JpdGVzIGEgcGFja2V0cyBwYXlsb2FkLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge0FycmF5fSBkYXRhIHBhY2tldHNcblx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbn0gZHJhaW4gY2FsbGJhY2tcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFBvbGxpbmcucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKHBhY2tldHMpIHtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0dGhpcy53cml0YWJsZSA9IGZhbHNlO1xuXHRcdFx0XHRcdHZhciBjYWxsYmFja2ZuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0c2VsZi53cml0YWJsZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ2RyYWluJyk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRwYXJzZXIuZW5jb2RlUGF5bG9hZChwYWNrZXRzLCB0aGlzLnN1cHBvcnRzQmluYXJ5LCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0c2VsZi5kb1dyaXRlKGRhdGEsIGNhbGxiYWNrZm4pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0UG9sbGluZy5wcm90b3R5cGUudXJpID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHZhciBxdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG5cdFx0XHRcdFx0dmFyIHNjaGVtYSA9IHRoaXMuc2VjdXJlID8gJ2h0dHBzJyA6ICdodHRwJztcblx0XHRcdFx0XHR2YXIgcG9ydCA9ICcnO1xuXG5cdFx0XHRcdFx0Ly8gY2FjaGUgYnVzdGluZyBpcyBmb3JjZWRcblx0XHRcdFx0XHRpZiAoZmFsc2UgIT09IHRoaXMudGltZXN0YW1wUmVxdWVzdHMpIHtcblx0XHRcdFx0XHRcdHF1ZXJ5W3RoaXMudGltZXN0YW1wUGFyYW1dID0geWVhc3QoKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoIXRoaXMuc3VwcG9ydHNCaW5hcnkgJiYgIXF1ZXJ5LnNpZCkge1xuXHRcdFx0XHRcdFx0cXVlcnkuYjY0ID0gMTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRxdWVyeSA9IHBhcnNlcXMuZW5jb2RlKHF1ZXJ5KTtcblxuXHRcdFx0XHRcdC8vIGF2b2lkIHBvcnQgaWYgZGVmYXVsdCBmb3Igc2NoZW1hXG5cdFx0XHRcdFx0aWYgKHRoaXMucG9ydCAmJiAoKCdodHRwcycgPT0gc2NoZW1hICYmIHRoaXMucG9ydCAhPSA0NDMpIHx8XG5cdFx0XHRcdFx0XHRcdCgnaHR0cCcgPT0gc2NoZW1hICYmIHRoaXMucG9ydCAhPSA4MCkpKSB7XG5cdFx0XHRcdFx0XHRwb3J0ID0gJzonICsgdGhpcy5wb3J0O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIHByZXBlbmQgPyB0byBxdWVyeVxuXHRcdFx0XHRcdGlmIChxdWVyeS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdHF1ZXJ5ID0gJz8nICsgcXVlcnk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGlwdjYgPSB0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSAhPT0gLTE7XG5cdFx0XHRcdFx0cmV0dXJuIHNjaGVtYSArICc6Ly8nICsgKGlwdjYgPyAnWycgKyB0aGlzLmhvc3RuYW1lICsgJ10nIDogdGhpcy5ob3N0bmFtZSkgKyBwb3J0ICsgdGhpcy5wYXRoICsgcXVlcnk7XG5cdFx0XHRcdH07XG5cblx0XHRcdH0sIHtcblx0XHRcdFx0XCIuLi90cmFuc3BvcnRcIjogNCxcblx0XHRcdFx0XCJjb21wb25lbnQtaW5oZXJpdFwiOiAxNixcblx0XHRcdFx0XCJkZWJ1Z1wiOiAxNyxcblx0XHRcdFx0XCJlbmdpbmUuaW8tcGFyc2VyXCI6IDE5LFxuXHRcdFx0XHRcInBhcnNlcXNcIjogMjcsXG5cdFx0XHRcdFwieG1saHR0cHJlcXVlc3Qtc3NsXCI6IDEwLFxuXHRcdFx0XHRcInllYXN0XCI6IDMwXG5cdFx0XHR9XSxcblx0XHRcdDk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTW9kdWxlIGRlcGVuZGVuY2llcy5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBUcmFuc3BvcnQgPSBfZGVyZXFfKCcuLi90cmFuc3BvcnQnKTtcblx0XHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnZW5naW5lLmlvLXBhcnNlcicpO1xuXHRcdFx0XHRcdHZhciBwYXJzZXFzID0gX2RlcmVxXygncGFyc2VxcycpO1xuXHRcdFx0XHRcdHZhciBpbmhlcml0ID0gX2RlcmVxXygnY29tcG9uZW50LWluaGVyaXQnKTtcblx0XHRcdFx0XHR2YXIgeWVhc3QgPSBfZGVyZXFfKCd5ZWFzdCcpO1xuXHRcdFx0XHRcdHZhciBkZWJ1ZyA9IF9kZXJlcV8oJ2RlYnVnJykoJ2VuZ2luZS5pby1jbGllbnQ6d2Vic29ja2V0Jyk7XG5cdFx0XHRcdFx0dmFyIEJyb3dzZXJXZWJTb2NrZXQgPSBnbG9iYWwuV2ViU29ja2V0IHx8IGdsb2JhbC5Nb3pXZWJTb2NrZXQ7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBHZXQgZWl0aGVyIHRoZSBgV2ViU29ja2V0YCBvciBgTW96V2ViU29ja2V0YCBnbG9iYWxzXG5cdFx0XHRcdFx0ICogaW4gdGhlIGJyb3dzZXIgb3IgdHJ5IHRvIHJlc29sdmUgV2ViU29ja2V0LWNvbXBhdGlibGVcblx0XHRcdFx0XHQgKiBpbnRlcmZhY2UgZXhwb3NlZCBieSBgd3NgIGZvciBOb2RlLWxpa2UgZW52aXJvbm1lbnQuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgV2ViU29ja2V0ID0gQnJvd3NlcldlYlNvY2tldDtcblx0XHRcdFx0XHRpZiAoIVdlYlNvY2tldCAmJiB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0V2ViU29ja2V0ID0gX2RlcmVxXygnd3MnKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTW9kdWxlIGV4cG9ydHMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IFdTO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogV2ViU29ja2V0IHRyYW5zcG9ydCBjb25zdHJ1Y3Rvci5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkge09iamVjdH0gY29ubmVjdGlvbiBvcHRpb25zXG5cdFx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIFdTKG9wdHMpIHtcblx0XHRcdFx0XHRcdHZhciBmb3JjZUJhc2U2NCA9IChvcHRzICYmIG9wdHMuZm9yY2VCYXNlNjQpO1xuXHRcdFx0XHRcdFx0aWYgKGZvcmNlQmFzZTY0KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc3VwcG9ydHNCaW5hcnkgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHRoaXMucGVyTWVzc2FnZURlZmxhdGUgPSBvcHRzLnBlck1lc3NhZ2VEZWZsYXRlO1xuXHRcdFx0XHRcdFx0VHJhbnNwb3J0LmNhbGwodGhpcywgb3B0cyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogSW5oZXJpdHMgZnJvbSBUcmFuc3BvcnQuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRpbmhlcml0KFdTLCBUcmFuc3BvcnQpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogVHJhbnNwb3J0IG5hbWUuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLm5hbWUgPSAnd2Vic29ja2V0JztcblxuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0ICogV2ViU29ja2V0cyBzdXBwb3J0IGJpbmFyeVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLnN1cHBvcnRzQmluYXJ5ID0gdHJ1ZTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE9wZW5zIHNvY2tldC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLmRvT3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmICghdGhpcy5jaGVjaygpKSB7XG5cdFx0XHRcdFx0XHRcdC8vIGxldCBwcm9iZSB0aW1lb3V0XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0dmFyIHVyaSA9IHRoaXMudXJpKCk7XG5cdFx0XHRcdFx0XHR2YXIgcHJvdG9jb2xzID0gdm9pZCgwKTtcblx0XHRcdFx0XHRcdHZhciBvcHRzID0ge1xuXHRcdFx0XHRcdFx0XHRhZ2VudDogdGhpcy5hZ2VudCxcblx0XHRcdFx0XHRcdFx0cGVyTWVzc2FnZURlZmxhdGU6IHRoaXMucGVyTWVzc2FnZURlZmxhdGVcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdC8vIFNTTCBvcHRpb25zIGZvciBOb2RlLmpzIGNsaWVudFxuXHRcdFx0XHRcdFx0b3B0cy5wZnggPSB0aGlzLnBmeDtcblx0XHRcdFx0XHRcdG9wdHMua2V5ID0gdGhpcy5rZXk7XG5cdFx0XHRcdFx0XHRvcHRzLnBhc3NwaHJhc2UgPSB0aGlzLnBhc3NwaHJhc2U7XG5cdFx0XHRcdFx0XHRvcHRzLmNlcnQgPSB0aGlzLmNlcnQ7XG5cdFx0XHRcdFx0XHRvcHRzLmNhID0gdGhpcy5jYTtcblx0XHRcdFx0XHRcdG9wdHMuY2lwaGVycyA9IHRoaXMuY2lwaGVycztcblx0XHRcdFx0XHRcdG9wdHMucmVqZWN0VW5hdXRob3JpemVkID0gdGhpcy5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5leHRyYUhlYWRlcnMpIHtcblx0XHRcdFx0XHRcdFx0b3B0cy5oZWFkZXJzID0gdGhpcy5leHRyYUhlYWRlcnM7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMud3MgPSBCcm93c2VyV2ViU29ja2V0ID8gbmV3IFdlYlNvY2tldCh1cmkpIDogbmV3IFdlYlNvY2tldCh1cmksIHByb3RvY29scywgb3B0cyk7XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLndzLmJpbmFyeVR5cGUgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICh0aGlzLndzLnN1cHBvcnRzICYmIHRoaXMud3Muc3VwcG9ydHMuYmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc3VwcG9ydHNCaW5hcnkgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHR0aGlzLndzLmJpbmFyeVR5cGUgPSAnYnVmZmVyJztcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMud3MuYmluYXJ5VHlwZSA9ICdhcnJheWJ1ZmZlcic7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQWRkcyBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIHNvY2tldFxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRcdHRoaXMud3Mub25vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLm9uT3BlbigpO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdHRoaXMud3Mub25jbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkNsb3NlKCk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0dGhpcy53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXYpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkRhdGEoZXYuZGF0YSk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0dGhpcy53cy5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vbkVycm9yKCd3ZWJzb2NrZXQgZXJyb3InLCBlKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE92ZXJyaWRlIGBvbkRhdGFgIHRvIHVzZSBhIHRpbWVyIG9uIGlPUy5cblx0XHRcdFx0XHQgKiBTZWU6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL21sb3VnaHJhbi8yMDUyMDA2XG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2YgbmF2aWdhdG9yICYmXG5cdFx0XHRcdFx0XHQvaVBhZHxpUGhvbmV8aVBvZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcblx0XHRcdFx0XHRcdFdTLnByb3RvdHlwZS5vbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25EYXRhLmNhbGwoc2VsZiwgZGF0YSk7XG5cdFx0XHRcdFx0XHRcdH0sIDApO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBXcml0ZXMgZGF0YSB0byBzb2NrZXQuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBvZiBwYWNrZXRzLlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0V1MucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKHBhY2tldHMpIHtcblx0XHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHRcdHRoaXMud3JpdGFibGUgPSBmYWxzZTtcblxuXHRcdFx0XHRcdFx0Ly8gZW5jb2RlUGFja2V0IGVmZmljaWVudCBhcyBpdCB1c2VzIFdTIGZyYW1pbmdcblx0XHRcdFx0XHRcdC8vIG5vIG5lZWQgZm9yIGVuY29kZVBheWxvYWRcblx0XHRcdFx0XHRcdHZhciB0b3RhbCA9IHBhY2tldHMubGVuZ3RoO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSB0b3RhbDsgaSA8IGw7IGkrKykge1xuXHRcdFx0XHRcdFx0XHQoZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0XHRcdHBhcnNlci5lbmNvZGVQYWNrZXQocGFja2V0LCBzZWxmLnN1cHBvcnRzQmluYXJ5LCBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFCcm93c2VyV2ViU29ja2V0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGFsd2F5cyBjcmVhdGUgYSBuZXcgb2JqZWN0IChHSC00MzcpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBvcHRzID0ge307XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChwYWNrZXQub3B0aW9ucykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdG9wdHMuY29tcHJlc3MgPSBwYWNrZXQub3B0aW9ucy5jb21wcmVzcztcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChzZWxmLnBlck1lc3NhZ2VEZWZsYXRlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGxlbiA9ICdzdHJpbmcnID09IHR5cGVvZiBkYXRhID8gZ2xvYmFsLkJ1ZmZlci5ieXRlTGVuZ3RoKGRhdGEpIDogZGF0YS5sZW5ndGg7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGxlbiA8IHNlbGYucGVyTWVzc2FnZURlZmxhdGUudGhyZXNob2xkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRvcHRzLmNvbXByZXNzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdC8vU29tZXRpbWVzIHRoZSB3ZWJzb2NrZXQgaGFzIGFscmVhZHkgYmVlbiBjbG9zZWQgYnV0IHRoZSBicm93c2VyIGRpZG4ndFxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9oYXZlIGEgY2hhbmNlIG9mIGluZm9ybWluZyB1cyBhYm91dCBpdCB5ZXQsIGluIHRoYXQgY2FzZSBzZW5kIHdpbGxcblx0XHRcdFx0XHRcdFx0XHRcdC8vdGhyb3cgYW4gZXJyb3Jcblx0XHRcdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChCcm93c2VyV2ViU29ja2V0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVHlwZUVycm9yIGlzIHRocm93biB3aGVuIHBhc3NpbmcgdGhlIHNlY29uZCBhcmd1bWVudCBvbiBTYWZhcmlcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzZWxmLndzLnNlbmQoZGF0YSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2VsZi53cy5zZW5kKGRhdGEsIG9wdHMpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRlYnVnKCd3ZWJzb2NrZXQgY2xvc2VkIGJlZm9yZSBvbmNsb3NlIGV2ZW50Jyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdC0tdG90YWwgfHwgZG9uZSgpO1xuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHR9KShwYWNrZXRzW2ldKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gZG9uZSgpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5lbWl0KCdmbHVzaCcpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGZha2UgZHJhaW5cblx0XHRcdFx0XHRcdFx0Ly8gZGVmZXIgdG8gbmV4dCB0aWNrIHRvIGFsbG93IFNvY2tldCB0byBjbGVhciB3cml0ZUJ1ZmZlclxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLndyaXRhYmxlID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXQoJ2RyYWluJyk7XG5cdFx0XHRcdFx0XHRcdH0sIDApO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDYWxsZWQgdXBvbiBjbG9zZVxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFRyYW5zcG9ydC5wcm90b3R5cGUub25DbG9zZS5jYWxsKHRoaXMpO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDbG9zZXMgc29ja2V0LlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUuZG9DbG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YgdGhpcy53cyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy53cy5jbG9zZSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUudXJpID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0dmFyIHF1ZXJ5ID0gdGhpcy5xdWVyeSB8fCB7fTtcblx0XHRcdFx0XHRcdHZhciBzY2hlbWEgPSB0aGlzLnNlY3VyZSA/ICd3c3MnIDogJ3dzJztcblx0XHRcdFx0XHRcdHZhciBwb3J0ID0gJyc7XG5cblx0XHRcdFx0XHRcdC8vIGF2b2lkIHBvcnQgaWYgZGVmYXVsdCBmb3Igc2NoZW1hXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wb3J0ICYmICgoJ3dzcycgPT0gc2NoZW1hICYmIHRoaXMucG9ydCAhPSA0NDMpIHx8XG5cdFx0XHRcdFx0XHRcdFx0KCd3cycgPT0gc2NoZW1hICYmIHRoaXMucG9ydCAhPSA4MCkpKSB7XG5cdFx0XHRcdFx0XHRcdHBvcnQgPSAnOicgKyB0aGlzLnBvcnQ7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGFwcGVuZCB0aW1lc3RhbXAgdG8gVVJJXG5cdFx0XHRcdFx0XHRpZiAodGhpcy50aW1lc3RhbXBSZXF1ZXN0cykge1xuXHRcdFx0XHRcdFx0XHRxdWVyeVt0aGlzLnRpbWVzdGFtcFBhcmFtXSA9IHllYXN0KCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGNvbW11bmljYXRlIGJpbmFyeSBzdXBwb3J0IGNhcGFiaWxpdGllc1xuXHRcdFx0XHRcdFx0aWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdHF1ZXJ5LmI2NCA9IDE7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHF1ZXJ5ID0gcGFyc2Vxcy5lbmNvZGUocXVlcnkpO1xuXG5cdFx0XHRcdFx0XHQvLyBwcmVwZW5kID8gdG8gcXVlcnlcblx0XHRcdFx0XHRcdGlmIChxdWVyeS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0cXVlcnkgPSAnPycgKyBxdWVyeTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGlwdjYgPSB0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSAhPT0gLTE7XG5cdFx0XHRcdFx0XHRyZXR1cm4gc2NoZW1hICsgJzovLycgKyAoaXB2NiA/ICdbJyArIHRoaXMuaG9zdG5hbWUgKyAnXScgOiB0aGlzLmhvc3RuYW1lKSArIHBvcnQgKyB0aGlzLnBhdGggKyBxdWVyeTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogRmVhdHVyZSBkZXRlY3Rpb24gZm9yIFdlYlNvY2tldC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEByZXR1cm4ge0Jvb2xlYW59IHdoZXRoZXIgdGhpcyB0cmFuc3BvcnQgaXMgYXZhaWxhYmxlLlxuXHRcdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRXUy5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gISFXZWJTb2NrZXQgJiYgISgnX19pbml0aWFsaXplJyBpbiBXZWJTb2NrZXQgJiYgdGhpcy5uYW1lID09PSBXUy5wcm90b3R5cGUubmFtZSk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiLi4vdHJhbnNwb3J0XCI6IDQsXG5cdFx0XHRcdFwiY29tcG9uZW50LWluaGVyaXRcIjogMTYsXG5cdFx0XHRcdFwiZGVidWdcIjogMTcsXG5cdFx0XHRcdFwiZW5naW5lLmlvLXBhcnNlclwiOiAxOSxcblx0XHRcdFx0XCJwYXJzZXFzXCI6IDI3LFxuXHRcdFx0XHRcIndzXCI6IHVuZGVmaW5lZCxcblx0XHRcdFx0XCJ5ZWFzdFwiOiAzMFxuXHRcdFx0fV0sXG5cdFx0XHQxMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0Ly8gYnJvd3NlciBzaGltIGZvciB4bWxodHRwcmVxdWVzdCBtb2R1bGVcblx0XHRcdFx0dmFyIGhhc0NPUlMgPSBfZGVyZXFfKCdoYXMtY29ycycpO1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9wdHMpIHtcblx0XHRcdFx0XHR2YXIgeGRvbWFpbiA9IG9wdHMueGRvbWFpbjtcblxuXHRcdFx0XHRcdC8vIHNjaGVtZSBtdXN0IGJlIHNhbWUgd2hlbiB1c2lnbiBYRG9tYWluUmVxdWVzdFxuXHRcdFx0XHRcdC8vIGh0dHA6Ly9ibG9ncy5tc2RuLmNvbS9iL2llaW50ZXJuYWxzL2FyY2hpdmUvMjAxMC8wNS8xMy94ZG9tYWlucmVxdWVzdC1yZXN0cmljdGlvbnMtbGltaXRhdGlvbnMtYW5kLXdvcmthcm91bmRzLmFzcHhcblx0XHRcdFx0XHR2YXIgeHNjaGVtZSA9IG9wdHMueHNjaGVtZTtcblxuXHRcdFx0XHRcdC8vIFhEb21haW5SZXF1ZXN0IGhhcyBhIGZsb3cgb2Ygbm90IHNlbmRpbmcgY29va2llLCB0aGVyZWZvcmUgaXQgc2hvdWxkIGJlIGRpc2FibGVkIGFzIGEgZGVmYXVsdC5cblx0XHRcdFx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vQXV0b21hdHRpYy9lbmdpbmUuaW8tY2xpZW50L3B1bGwvMjE3XG5cdFx0XHRcdFx0dmFyIGVuYWJsZXNYRFIgPSBvcHRzLmVuYWJsZXNYRFI7XG5cblx0XHRcdFx0XHQvLyBYTUxIdHRwUmVxdWVzdCBjYW4gYmUgZGlzYWJsZWQgb24gSUVcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAmJiAoIXhkb21haW4gfHwgaGFzQ09SUykpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cblx0XHRcdFx0XHQvLyBVc2UgWERvbWFpblJlcXVlc3QgZm9yIElFOCBpZiBlbmFibGVzWERSIGlzIHRydWVcblx0XHRcdFx0XHQvLyBiZWNhdXNlIGxvYWRpbmcgYmFyIGtlZXBzIGZsYXNoaW5nIHdoZW4gdXNpbmcganNvbnAtcG9sbGluZ1xuXHRcdFx0XHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS95dWppb3Nha2Evc29ja2UuaW8taWU4LWxvYWRpbmctZXhhbXBsZVxuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIFhEb21haW5SZXF1ZXN0ICYmICF4c2NoZW1lICYmIGVuYWJsZXNYRFIpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBYRG9tYWluUmVxdWVzdCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cblx0XHRcdFx0XHRpZiAoIXhkb21haW4pIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTEhUVFAnKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdH0sIHtcblx0XHRcdFx0XCJoYXMtY29yc1wiOiAyMlxuXHRcdFx0fV0sXG5cdFx0XHQxMTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBhZnRlclxuXG5cdFx0XHRcdGZ1bmN0aW9uIGFmdGVyKGNvdW50LCBjYWxsYmFjaywgZXJyX2NiKSB7XG5cdFx0XHRcdFx0dmFyIGJhaWwgPSBmYWxzZVxuXHRcdFx0XHRcdGVycl9jYiA9IGVycl9jYiB8fCBub29wXG5cdFx0XHRcdFx0cHJveHkuY291bnQgPSBjb3VudFxuXG5cdFx0XHRcdFx0cmV0dXJuIChjb3VudCA9PT0gMCkgPyBjYWxsYmFjaygpIDogcHJveHlcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHByb3h5KGVyciwgcmVzdWx0KSB7XG5cdFx0XHRcdFx0XHRpZiAocHJveHkuY291bnQgPD0gMCkge1xuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ2FmdGVyIGNhbGxlZCB0b28gbWFueSB0aW1lcycpXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQtLXByb3h5LmNvdW50XG5cblx0XHRcdFx0XHRcdC8vIGFmdGVyIGZpcnN0IGVycm9yLCByZXN0IGFyZSBwYXNzZWQgdG8gZXJyX2NiXG5cdFx0XHRcdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdFx0XHRcdGJhaWwgPSB0cnVlXG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrKGVycilcblx0XHRcdFx0XHRcdFx0Ly8gZnV0dXJlIGVycm9yIGNhbGxiYWNrcyB3aWxsIGdvIHRvIGVycm9yIGhhbmRsZXJcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sgPSBlcnJfY2Jcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAocHJveHkuY291bnQgPT09IDAgJiYgIWJhaWwpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0KVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQxMjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEFuIGFic3RyYWN0aW9uIGZvciBzbGljaW5nIGFuIGFycmF5YnVmZmVyIGV2ZW4gd2hlblxuXHRcdFx0XHQgKiBBcnJheUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgaXMgbm90IHN1cHBvcnRlZFxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhcnJheWJ1ZmZlciwgc3RhcnQsIGVuZCkge1xuXHRcdFx0XHRcdHZhciBieXRlcyA9IGFycmF5YnVmZmVyLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdFx0c3RhcnQgPSBzdGFydCB8fCAwO1xuXHRcdFx0XHRcdGVuZCA9IGVuZCB8fCBieXRlcztcblxuXHRcdFx0XHRcdGlmIChhcnJheWJ1ZmZlci5zbGljZSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGFycmF5YnVmZmVyLnNsaWNlKHN0YXJ0LCBlbmQpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChzdGFydCA8IDApIHtcblx0XHRcdFx0XHRcdHN0YXJ0ICs9IGJ5dGVzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZW5kIDwgMCkge1xuXHRcdFx0XHRcdFx0ZW5kICs9IGJ5dGVzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZW5kID4gYnl0ZXMpIHtcblx0XHRcdFx0XHRcdGVuZCA9IGJ5dGVzO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChzdGFydCA+PSBieXRlcyB8fCBzdGFydCA+PSBlbmQgfHwgYnl0ZXMgPT09IDApIHtcblx0XHRcdFx0XHRcdHJldHVybiBuZXcgQXJyYXlCdWZmZXIoMCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGFidiA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKTtcblx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoZW5kIC0gc3RhcnQpO1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSBzdGFydCwgaWkgPSAwOyBpIDwgZW5kOyBpKyssIGlpKyspIHtcblx0XHRcdFx0XHRcdHJlc3VsdFtpaV0gPSBhYnZbaV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiByZXN1bHQuYnVmZmVyO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQxMzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0Lypcblx0XHRcdFx0ICogYmFzZTY0LWFycmF5YnVmZmVyXG5cdFx0XHRcdCAqIGh0dHBzOi8vZ2l0aHViLmNvbS9uaWtsYXN2aC9iYXNlNjQtYXJyYXlidWZmZXJcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQ29weXJpZ2h0IChjKSAyMDEyIE5pa2xhcyB2b24gSGVydHplblxuXHRcdFx0XHQgKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cdFx0XHRcdCAqL1xuXHRcdFx0XHQoZnVuY3Rpb24gKGNoYXJzKSB7XG5cdFx0XHRcdFx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0XHRcdFx0XHRleHBvcnRzLmVuY29kZSA9IGZ1bmN0aW9uIChhcnJheWJ1ZmZlcikge1xuXHRcdFx0XHRcdFx0dmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLFxuXHRcdFx0XHRcdFx0XHRpLCBsZW4gPSBieXRlcy5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdGJhc2U2NCA9IFwiXCI7XG5cblx0XHRcdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykge1xuXHRcdFx0XHRcdFx0XHRiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07XG5cdFx0XHRcdFx0XHRcdGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTtcblx0XHRcdFx0XHRcdFx0YmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07XG5cdFx0XHRcdFx0XHRcdGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICgobGVuICUgMykgPT09IDIpIHtcblx0XHRcdFx0XHRcdFx0YmFzZTY0ID0gYmFzZTY0LnN1YnN0cmluZygwLCBiYXNlNjQubGVuZ3RoIC0gMSkgKyBcIj1cIjtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobGVuICUgMyA9PT0gMSkge1xuXHRcdFx0XHRcdFx0XHRiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArIFwiPT1cIjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIGJhc2U2NDtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5kZWNvZGUgPSBmdW5jdGlvbiAoYmFzZTY0KSB7XG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVyTGVuZ3RoID0gYmFzZTY0Lmxlbmd0aCAqIDAuNzUsXG5cdFx0XHRcdFx0XHRcdGxlbiA9IGJhc2U2NC5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdGksIHAgPSAwLFxuXHRcdFx0XHRcdFx0XHRlbmNvZGVkMSwgZW5jb2RlZDIsIGVuY29kZWQzLCBlbmNvZGVkNDtcblxuXHRcdFx0XHRcdFx0aWYgKGJhc2U2NFtiYXNlNjQubGVuZ3RoIC0gMV0gPT09IFwiPVwiKSB7XG5cdFx0XHRcdFx0XHRcdGJ1ZmZlckxlbmd0aC0tO1xuXHRcdFx0XHRcdFx0XHRpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAyXSA9PT0gXCI9XCIpIHtcblx0XHRcdFx0XHRcdFx0XHRidWZmZXJMZW5ndGgtLTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgYXJyYXlidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYnVmZmVyTGVuZ3RoKSxcblx0XHRcdFx0XHRcdFx0Ynl0ZXMgPSBuZXcgVWludDhBcnJheShhcnJheWJ1ZmZlcik7XG5cblx0XHRcdFx0XHRcdGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuXHRcdFx0XHRcdFx0XHRlbmNvZGVkMSA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2ldKTtcblx0XHRcdFx0XHRcdFx0ZW5jb2RlZDIgPSBjaGFycy5pbmRleE9mKGJhc2U2NFtpICsgMV0pO1xuXHRcdFx0XHRcdFx0XHRlbmNvZGVkMyA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2kgKyAyXSk7XG5cdFx0XHRcdFx0XHRcdGVuY29kZWQ0ID0gY2hhcnMuaW5kZXhPZihiYXNlNjRbaSArIDNdKTtcblxuXHRcdFx0XHRcdFx0XHRieXRlc1twKytdID0gKGVuY29kZWQxIDw8IDIpIHwgKGVuY29kZWQyID4+IDQpO1xuXHRcdFx0XHRcdFx0XHRieXRlc1twKytdID0gKChlbmNvZGVkMiAmIDE1KSA8PCA0KSB8IChlbmNvZGVkMyA+PiAyKTtcblx0XHRcdFx0XHRcdFx0Ynl0ZXNbcCsrXSA9ICgoZW5jb2RlZDMgJiAzKSA8PCA2KSB8IChlbmNvZGVkNCAmIDYzKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIGFycmF5YnVmZmVyO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0pKFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiKTtcblxuXHRcdFx0fSwge31dLFxuXHRcdFx0MTQ6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ3JlYXRlIGEgYmxvYiBidWlsZGVyIGV2ZW4gd2hlbiB2ZW5kb3IgcHJlZml4ZXMgZXhpc3Rcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBCbG9iQnVpbGRlciA9IGdsb2JhbC5CbG9iQnVpbGRlciB8fFxuXHRcdFx0XHRcdFx0Z2xvYmFsLldlYktpdEJsb2JCdWlsZGVyIHx8XG5cdFx0XHRcdFx0XHRnbG9iYWwuTVNCbG9iQnVpbGRlciB8fFxuXHRcdFx0XHRcdFx0Z2xvYmFsLk1vekJsb2JCdWlsZGVyO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQ2hlY2sgaWYgQmxvYiBjb25zdHJ1Y3RvciBpcyBzdXBwb3J0ZWRcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBibG9iU3VwcG9ydGVkID0gKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHZhciBhID0gbmV3IEJsb2IoWydoaSddKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGEuc2l6ZSA9PT0gMjtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pKCk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDaGVjayBpZiBCbG9iIGNvbnN0cnVjdG9yIHN1cHBvcnRzIEFycmF5QnVmZmVyVmlld3Ncblx0XHRcdFx0XHQgKiBGYWlscyBpbiBTYWZhcmkgNiwgc28gd2UgbmVlZCB0byBtYXAgdG8gQXJyYXlCdWZmZXJzIHRoZXJlLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0dmFyIGJsb2JTdXBwb3J0c0FycmF5QnVmZmVyVmlldyA9IGJsb2JTdXBwb3J0ZWQgJiYgKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHZhciBiID0gbmV3IEJsb2IoW25ldyBVaW50OEFycmF5KFsxLCAyXSldKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGIuc2l6ZSA9PT0gMjtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pKCk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDaGVjayBpZiBCbG9iQnVpbGRlciBpcyBzdXBwb3J0ZWRcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBibG9iQnVpbGRlclN1cHBvcnRlZCA9IEJsb2JCdWlsZGVyICYmXG5cdFx0XHRcdFx0XHRCbG9iQnVpbGRlci5wcm90b3R5cGUuYXBwZW5kICYmXG5cdFx0XHRcdFx0XHRCbG9iQnVpbGRlci5wcm90b3R5cGUuZ2V0QmxvYjtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEhlbHBlciBmdW5jdGlvbiB0aGF0IG1hcHMgQXJyYXlCdWZmZXJWaWV3cyB0byBBcnJheUJ1ZmZlcnNcblx0XHRcdFx0XHQgKiBVc2VkIGJ5IEJsb2JCdWlsZGVyIGNvbnN0cnVjdG9yIGFuZCBvbGQgYnJvd3NlcnMgdGhhdCBkaWRuJ3Rcblx0XHRcdFx0XHQgKiBzdXBwb3J0IGl0IGluIHRoZSBCbG9iIGNvbnN0cnVjdG9yLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gbWFwQXJyYXlCdWZmZXJWaWV3cyhhcnkpIHtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBjaHVuayA9IGFyeVtpXTtcblx0XHRcdFx0XHRcdFx0aWYgKGNodW5rLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGJ1ZiA9IGNodW5rLmJ1ZmZlcjtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIGlmIHRoaXMgaXMgYSBzdWJhcnJheSwgbWFrZSBhIGNvcHkgc28gd2Ugb25seVxuXHRcdFx0XHRcdFx0XHRcdC8vIGluY2x1ZGUgdGhlIHN1YmFycmF5IHJlZ2lvbiBmcm9tIHRoZSB1bmRlcmx5aW5nIGJ1ZmZlclxuXHRcdFx0XHRcdFx0XHRcdGlmIChjaHVuay5ieXRlTGVuZ3RoICE9PSBidWYuYnl0ZUxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGNvcHkgPSBuZXcgVWludDhBcnJheShjaHVuay5ieXRlTGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGNvcHkuc2V0KG5ldyBVaW50OEFycmF5KGJ1ZiwgY2h1bmsuYnl0ZU9mZnNldCwgY2h1bmsuYnl0ZUxlbmd0aCkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnVmID0gY29weS5idWZmZXI7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0YXJ5W2ldID0gYnVmO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gQmxvYkJ1aWxkZXJDb25zdHJ1Y3RvcihhcnksIG9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdFx0XHRcdFx0XHR2YXIgYmIgPSBuZXcgQmxvYkJ1aWxkZXIoKTtcblx0XHRcdFx0XHRcdG1hcEFycmF5QnVmZmVyVmlld3MoYXJ5KTtcblxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnkubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0YmIuYXBwZW5kKGFyeVtpXSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiAob3B0aW9ucy50eXBlKSA/IGJiLmdldEJsb2Iob3B0aW9ucy50eXBlKSA6IGJiLmdldEJsb2IoKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0ZnVuY3Rpb24gQmxvYkNvbnN0cnVjdG9yKGFyeSwgb3B0aW9ucykge1xuXHRcdFx0XHRcdFx0bWFwQXJyYXlCdWZmZXJWaWV3cyhhcnkpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBCbG9iKGFyeSwgb3B0aW9ucyB8fCB7fSk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmIChibG9iU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBibG9iU3VwcG9ydHNBcnJheUJ1ZmZlclZpZXcgPyBnbG9iYWwuQmxvYiA6IEJsb2JDb25zdHJ1Y3Rvcjtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoYmxvYkJ1aWxkZXJTdXBwb3J0ZWQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIEJsb2JCdWlsZGVyQ29uc3RydWN0b3I7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pKCk7XG5cblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KVxuXHRcdFx0fSwge31dLFxuXHRcdFx0MTU6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEV4cG9zZSBgRW1pdHRlcmAuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogSW5pdGlhbGl6ZSBhIG5ldyBgRW1pdHRlcmAuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIEVtaXR0ZXIob2JqKSB7XG5cdFx0XHRcdFx0aWYgKG9iaikgcmV0dXJuIG1peGluKG9iaik7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1peGluIHRoZSBlbWl0dGVyIHByb3BlcnRpZXMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcblx0XHRcdFx0ICogQHJldHVybiB7T2JqZWN0fVxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gbWl4aW4ob2JqKSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIga2V5IGluIEVtaXR0ZXIucHJvdG90eXBlKSB7XG5cdFx0XHRcdFx0XHRvYmpba2V5XSA9IEVtaXR0ZXIucHJvdG90eXBlW2tleV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBvYmo7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTGlzdGVuIG9uIHRoZSBnaXZlbiBgZXZlbnRgIHdpdGggYGZuYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG5cdFx0XHRcdCAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG5cdFx0XHRcdCAqIEByZXR1cm4ge0VtaXR0ZXJ9XG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLm9uID1cblx0XHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xuXHRcdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXHRcdFx0XHRcdFx0KHRoaXMuX2NhbGxiYWNrc1tldmVudF0gPSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdIHx8IFtdKVxuXHRcdFx0XHRcdFx0LnB1c2goZm4pO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQWRkcyBhbiBgZXZlbnRgIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBpbnZva2VkIGEgc2luZ2xlXG5cdFx0XHRcdCAqIHRpbWUgdGhlbiBhdXRvbWF0aWNhbGx5IHJlbW92ZWQuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuXHRcdFx0XHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuXHRcdFx0XHQgKiBAcmV0dXJuIHtFbWl0dGVyfVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24gKGV2ZW50LCBmbikge1xuXHRcdFx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cblx0XHRcdFx0XHRmdW5jdGlvbiBvbigpIHtcblx0XHRcdFx0XHRcdHNlbGYub2ZmKGV2ZW50LCBvbik7XG5cdFx0XHRcdFx0XHRmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG9uLmZuID0gZm47XG5cdFx0XHRcdFx0dGhpcy5vbihldmVudCwgb24pO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBSZW1vdmUgdGhlIGdpdmVuIGNhbGxiYWNrIGZvciBgZXZlbnRgIG9yIGFsbFxuXHRcdFx0XHQgKiByZWdpc3RlcmVkIGNhbGxiYWNrcy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG5cdFx0XHRcdCAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG5cdFx0XHRcdCAqIEByZXR1cm4ge0VtaXR0ZXJ9XG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLm9mZiA9XG5cdFx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPVxuXHRcdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9XG5cdFx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHtcblx0XHRcdFx0XHRcdHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcblxuXHRcdFx0XHRcdFx0Ly8gYWxsXG5cdFx0XHRcdFx0XHRpZiAoMCA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX2NhbGxiYWNrcyA9IHt9O1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gc3BlY2lmaWMgZXZlbnRcblx0XHRcdFx0XHRcdHZhciBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdO1xuXHRcdFx0XHRcdFx0aWYgKCFjYWxsYmFja3MpIHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdFx0XHQvLyByZW1vdmUgYWxsIGhhbmRsZXJzXG5cdFx0XHRcdFx0XHRpZiAoMSA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gcmVtb3ZlIHNwZWNpZmljIGhhbmRsZXJcblx0XHRcdFx0XHRcdHZhciBjYjtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGNiID0gY2FsbGJhY2tzW2ldO1xuXHRcdFx0XHRcdFx0XHRpZiAoY2IgPT09IGZuIHx8IGNiLmZuID09PSBmbikge1xuXHRcdFx0XHRcdFx0XHRcdGNhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEVtaXQgYGV2ZW50YCB3aXRoIHRoZSBnaXZlbiBhcmdzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcblx0XHRcdFx0ICogQHBhcmFtIHtNaXhlZH0gLi4uXG5cdFx0XHRcdCAqIEByZXR1cm4ge0VtaXR0ZXJ9XG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSksXG5cdFx0XHRcdFx0XHRjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbZXZlbnRdO1xuXG5cdFx0XHRcdFx0aWYgKGNhbGxiYWNrcykge1xuXHRcdFx0XHRcdFx0Y2FsbGJhY2tzID0gY2FsbGJhY2tzLnNsaWNlKDApO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGNhbGxiYWNrcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFja3NbaV0uYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFJldHVybiBhcnJheSBvZiBjYWxsYmFja3MgZm9yIGBldmVudGAuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuXHRcdFx0XHQgKiBAcmV0dXJuIHtBcnJheX1cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9jYWxsYmFja3NbZXZlbnRdIHx8IFtdO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDaGVjayBpZiB0aGlzIGVtaXR0ZXIgaGFzIGBldmVudGAgaGFuZGxlcnMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuXHRcdFx0XHQgKiBAcmV0dXJuIHtCb29sZWFufVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5oYXNMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0XHRyZXR1cm4gISF0aGlzLmxpc3RlbmVycyhldmVudCkubGVuZ3RoO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQxNjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChhLCBiKSB7XG5cdFx0XHRcdFx0dmFyIGZuID0gZnVuY3Rpb24gKCkge307XG5cdFx0XHRcdFx0Zm4ucHJvdG90eXBlID0gYi5wcm90b3R5cGU7XG5cdFx0XHRcdFx0YS5wcm90b3R5cGUgPSBuZXcgZm47XG5cdFx0XHRcdFx0YS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBhO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSwge31dLFxuXHRcdFx0MTc6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFRoaXMgaXMgdGhlIHdlYiBicm93c2VyIGltcGxlbWVudGF0aW9uIG9mIGBkZWJ1ZygpYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogRXhwb3NlIGBkZWJ1ZygpYCBhcyB0aGUgbW9kdWxlLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBfZGVyZXFfKCcuL2RlYnVnJyk7XG5cdFx0XHRcdGV4cG9ydHMubG9nID0gbG9nO1xuXHRcdFx0XHRleHBvcnRzLmZvcm1hdEFyZ3MgPSBmb3JtYXRBcmdzO1xuXHRcdFx0XHRleHBvcnRzLnNhdmUgPSBzYXZlO1xuXHRcdFx0XHRleHBvcnRzLmxvYWQgPSBsb2FkO1xuXHRcdFx0XHRleHBvcnRzLnVzZUNvbG9ycyA9IHVzZUNvbG9ycztcblx0XHRcdFx0ZXhwb3J0cy5zdG9yYWdlID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGNocm9tZSAmJlxuXHRcdFx0XHRcdCd1bmRlZmluZWQnICE9IHR5cGVvZiBjaHJvbWUuc3RvcmFnZSA/XG5cdFx0XHRcdFx0Y2hyb21lLnN0b3JhZ2UubG9jYWwgOlxuXHRcdFx0XHRcdGxvY2Fsc3RvcmFnZSgpO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDb2xvcnMuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuY29sb3JzID0gW1xuXHRcdFx0XHRcdCdsaWdodHNlYWdyZWVuJyxcblx0XHRcdFx0XHQnZm9yZXN0Z3JlZW4nLFxuXHRcdFx0XHRcdCdnb2xkZW5yb2QnLFxuXHRcdFx0XHRcdCdkb2RnZXJibHVlJyxcblx0XHRcdFx0XHQnZGFya29yY2hpZCcsXG5cdFx0XHRcdFx0J2NyaW1zb24nXG5cdFx0XHRcdF07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsXG5cdFx0XHRcdCAqIGFuZCB0aGUgRmlyZWJ1ZyBleHRlbnNpb24gKGFueSBGaXJlZm94IHZlcnNpb24pIGFyZSBrbm93blxuXHRcdFx0XHQgKiB0byBzdXBwb3J0IFwiJWNcIiBDU1MgY3VzdG9taXphdGlvbnMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIFRPRE86IGFkZCBhIGBsb2NhbFN0b3JhZ2VgIHZhcmlhYmxlIHRvIGV4cGxpY2l0bHkgZW5hYmxlL2Rpc2FibGUgY29sb3JzXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIHVzZUNvbG9ycygpIHtcblx0XHRcdFx0XHQvLyBpcyB3ZWJraXQ/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE2NDU5NjA2LzM3Njc3M1xuXHRcdFx0XHRcdHJldHVybiAoJ1dlYmtpdEFwcGVhcmFuY2UnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSkgfHxcblx0XHRcdFx0XHRcdC8vIGlzIGZpcmVidWc/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM5ODEyMC8zNzY3NzNcblx0XHRcdFx0XHRcdCh3aW5kb3cuY29uc29sZSAmJiAoY29uc29sZS5maXJlYnVnIHx8IChjb25zb2xlLmV4Y2VwdGlvbiAmJiBjb25zb2xlLnRhYmxlKSkpIHx8XG5cdFx0XHRcdFx0XHQvLyBpcyBmaXJlZm94ID49IHYzMT9cblx0XHRcdFx0XHRcdC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvVG9vbHMvV2ViX0NvbnNvbGUjU3R5bGluZ19tZXNzYWdlc1xuXHRcdFx0XHRcdFx0KG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5tYXRjaCgvZmlyZWZveFxcLyhcXGQrKS8pICYmIHBhcnNlSW50KFJlZ0V4cC4kMSwgMTApID49IDMxKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNYXAgJWogdG8gYEpTT04uc3RyaW5naWZ5KClgLCBzaW5jZSBubyBXZWIgSW5zcGVjdG9ycyBkbyB0aGF0IGJ5IGRlZmF1bHQuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24gKHYpIHtcblx0XHRcdFx0XHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG5cdFx0XHRcdH07XG5cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ29sb3JpemUgbG9nIGFyZ3VtZW50cyBpZiBlbmFibGVkLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBmb3JtYXRBcmdzKCkge1xuXHRcdFx0XHRcdHZhciBhcmdzID0gYXJndW1lbnRzO1xuXHRcdFx0XHRcdHZhciB1c2VDb2xvcnMgPSB0aGlzLnVzZUNvbG9ycztcblxuXHRcdFx0XHRcdGFyZ3NbMF0gPSAodXNlQ29sb3JzID8gJyVjJyA6ICcnKSArXG5cdFx0XHRcdFx0XHR0aGlzLm5hbWVzcGFjZSArXG5cdFx0XHRcdFx0XHQodXNlQ29sb3JzID8gJyAlYycgOiAnICcpICtcblx0XHRcdFx0XHRcdGFyZ3NbMF0gK1xuXHRcdFx0XHRcdFx0KHVzZUNvbG9ycyA/ICclYyAnIDogJyAnKSArXG5cdFx0XHRcdFx0XHQnKycgKyBleHBvcnRzLmh1bWFuaXplKHRoaXMuZGlmZik7XG5cblx0XHRcdFx0XHRpZiAoIXVzZUNvbG9ycykgcmV0dXJuIGFyZ3M7XG5cblx0XHRcdFx0XHR2YXIgYyA9ICdjb2xvcjogJyArIHRoaXMuY29sb3I7XG5cdFx0XHRcdFx0YXJncyA9IFthcmdzWzBdLCBjLCAnY29sb3I6IGluaGVyaXQnXS5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJncywgMSkpO1xuXG5cdFx0XHRcdFx0Ly8gdGhlIGZpbmFsIFwiJWNcIiBpcyBzb21ld2hhdCB0cmlja3ksIGJlY2F1c2UgdGhlcmUgY291bGQgYmUgb3RoZXJcblx0XHRcdFx0XHQvLyBhcmd1bWVudHMgcGFzc2VkIGVpdGhlciBiZWZvcmUgb3IgYWZ0ZXIgdGhlICVjLCBzbyB3ZSBuZWVkIHRvXG5cdFx0XHRcdFx0Ly8gZmlndXJlIG91dCB0aGUgY29ycmVjdCBpbmRleCB0byBpbnNlcnQgdGhlIENTUyBpbnRvXG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gMDtcblx0XHRcdFx0XHR2YXIgbGFzdEMgPSAwO1xuXHRcdFx0XHRcdGFyZ3NbMF0ucmVwbGFjZSgvJVthLXolXS9nLCBmdW5jdGlvbiAobWF0Y2gpIHtcblx0XHRcdFx0XHRcdGlmICgnJSUnID09PSBtYXRjaCkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHRcdGlmICgnJWMnID09PSBtYXRjaCkge1xuXHRcdFx0XHRcdFx0XHQvLyB3ZSBvbmx5IGFyZSBpbnRlcmVzdGVkIGluIHRoZSAqbGFzdCogJWNcblx0XHRcdFx0XHRcdFx0Ly8gKHRoZSB1c2VyIG1heSBoYXZlIHByb3ZpZGVkIHRoZWlyIG93bilcblx0XHRcdFx0XHRcdFx0bGFzdEMgPSBpbmRleDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTtcblx0XHRcdFx0XHRyZXR1cm4gYXJncztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBJbnZva2VzIGBjb25zb2xlLmxvZygpYCB3aGVuIGF2YWlsYWJsZS5cblx0XHRcdFx0ICogTm8tb3Agd2hlbiBgY29uc29sZS5sb2dgIGlzIG5vdCBhIFwiZnVuY3Rpb25cIi5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gbG9nKCkge1xuXHRcdFx0XHRcdC8vIHRoaXMgaGFja2VyeSBpcyByZXF1aXJlZCBmb3IgSUU4LzksIHdoZXJlXG5cdFx0XHRcdFx0Ly8gdGhlIGBjb25zb2xlLmxvZ2AgZnVuY3Rpb24gZG9lc24ndCBoYXZlICdhcHBseSdcblx0XHRcdFx0XHRyZXR1cm4gJ29iamVjdCcgPT09IHR5cGVvZiBjb25zb2xlICYmXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyAmJlxuXHRcdFx0XHRcdFx0RnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmNhbGwoY29uc29sZS5sb2csIGNvbnNvbGUsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2F2ZSBgbmFtZXNwYWNlc2AuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lc3BhY2VzXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBzYXZlKG5hbWVzcGFjZXMpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0aWYgKG51bGwgPT0gbmFtZXNwYWNlcykge1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzLnN0b3JhZ2UucmVtb3ZlSXRlbSgnZGVidWcnKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZyA9IG5hbWVzcGFjZXM7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBMb2FkIGBuYW1lc3BhY2VzYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHJldHVybiB7U3RyaW5nfSByZXR1cm5zIHRoZSBwcmV2aW91c2x5IHBlcnNpc3RlZCBkZWJ1ZyBtb2Rlc1xuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gbG9hZCgpIHtcblx0XHRcdFx0XHR2YXIgcjtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0ciA9IGV4cG9ydHMuc3RvcmFnZS5kZWJ1Zztcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7fVxuXHRcdFx0XHRcdHJldHVybiByO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEVuYWJsZSBuYW1lc3BhY2VzIGxpc3RlZCBpbiBgbG9jYWxTdG9yYWdlLmRlYnVnYCBpbml0aWFsbHkuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuZW5hYmxlKGxvYWQoKSk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIExvY2Fsc3RvcmFnZSBhdHRlbXB0cyB0byByZXR1cm4gdGhlIGxvY2Fsc3RvcmFnZS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogVGhpcyBpcyBuZWNlc3NhcnkgYmVjYXVzZSBzYWZhcmkgdGhyb3dzXG5cdFx0XHRcdCAqIHdoZW4gYSB1c2VyIGRpc2FibGVzIGNvb2tpZXMvbG9jYWxzdG9yYWdlXG5cdFx0XHRcdCAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEByZXR1cm4ge0xvY2FsU3RvcmFnZX1cblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGxvY2Fsc3RvcmFnZSgpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2U7XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0fVxuXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiLi9kZWJ1Z1wiOiAxOFxuXHRcdFx0fV0sXG5cdFx0XHQxODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogVGhpcyBpcyB0aGUgY29tbW9uIGxvZ2ljIGZvciBib3RoIHRoZSBOb2RlLmpzIGFuZCB3ZWIgYnJvd3NlclxuXHRcdFx0XHQgKiBpbXBsZW1lbnRhdGlvbnMgb2YgYGRlYnVnKClgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBFeHBvc2UgYGRlYnVnKClgIGFzIHRoZSBtb2R1bGUuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGRlYnVnO1xuXHRcdFx0XHRleHBvcnRzLmNvZXJjZSA9IGNvZXJjZTtcblx0XHRcdFx0ZXhwb3J0cy5kaXNhYmxlID0gZGlzYWJsZTtcblx0XHRcdFx0ZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG5cdFx0XHRcdGV4cG9ydHMuZW5hYmxlZCA9IGVuYWJsZWQ7XG5cdFx0XHRcdGV4cG9ydHMuaHVtYW5pemUgPSBfZGVyZXFfKCdtcycpO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBUaGUgY3VycmVudGx5IGFjdGl2ZSBkZWJ1ZyBtb2RlIG5hbWVzLCBhbmQgbmFtZXMgdG8gc2tpcC5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZXhwb3J0cy5uYW1lcyA9IFtdO1xuXHRcdFx0XHRleHBvcnRzLnNraXBzID0gW107XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1hcCBvZiBzcGVjaWFsIFwiJW5cIiBoYW5kbGluZyBmdW5jdGlvbnMsIGZvciB0aGUgZGVidWcgXCJmb3JtYXRcIiBhcmd1bWVudC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogVmFsaWQga2V5IG5hbWVzIGFyZSBhIHNpbmdsZSwgbG93ZXJjYXNlZCBsZXR0ZXIsIGkuZS4gXCJuXCIuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuZm9ybWF0dGVycyA9IHt9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQcmV2aW91c2x5IGFzc2lnbmVkIGNvbG9yLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgcHJldkNvbG9yID0gMDtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUHJldmlvdXMgbG9nIHRpbWVzdGFtcC5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0dmFyIHByZXZUaW1lO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZWxlY3QgYSBjb2xvci5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHJldHVybiB7TnVtYmVyfVxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gc2VsZWN0Q29sb3IoKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuY29sb3JzW3ByZXZDb2xvcisrICUgZXhwb3J0cy5jb2xvcnMubGVuZ3RoXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDcmVhdGUgYSBkZWJ1Z2dlciB3aXRoIHRoZSBnaXZlbiBgbmFtZXNwYWNlYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZVxuXHRcdFx0XHQgKiBAcmV0dXJuIHtGdW5jdGlvbn1cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gZGVidWcobmFtZXNwYWNlKSB7XG5cblx0XHRcdFx0XHQvLyBkZWZpbmUgdGhlIGBkaXNhYmxlZGAgdmVyc2lvblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGRpc2FibGVkKCkge31cblx0XHRcdFx0XHRkaXNhYmxlZC5lbmFibGVkID0gZmFsc2U7XG5cblx0XHRcdFx0XHQvLyBkZWZpbmUgdGhlIGBlbmFibGVkYCB2ZXJzaW9uXG5cdFx0XHRcdFx0ZnVuY3Rpb24gZW5hYmxlZCgpIHtcblxuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSBlbmFibGVkO1xuXG5cdFx0XHRcdFx0XHQvLyBzZXQgYGRpZmZgIHRpbWVzdGFtcFxuXHRcdFx0XHRcdFx0dmFyIGN1cnIgPSArbmV3IERhdGUoKTtcblx0XHRcdFx0XHRcdHZhciBtcyA9IGN1cnIgLSAocHJldlRpbWUgfHwgY3Vycik7XG5cdFx0XHRcdFx0XHRzZWxmLmRpZmYgPSBtcztcblx0XHRcdFx0XHRcdHNlbGYucHJldiA9IHByZXZUaW1lO1xuXHRcdFx0XHRcdFx0c2VsZi5jdXJyID0gY3Vycjtcblx0XHRcdFx0XHRcdHByZXZUaW1lID0gY3VycjtcblxuXHRcdFx0XHRcdFx0Ly8gYWRkIHRoZSBgY29sb3JgIGlmIG5vdCBzZXRcblx0XHRcdFx0XHRcdGlmIChudWxsID09IHNlbGYudXNlQ29sb3JzKSBzZWxmLnVzZUNvbG9ycyA9IGV4cG9ydHMudXNlQ29sb3JzKCk7XG5cdFx0XHRcdFx0XHRpZiAobnVsbCA9PSBzZWxmLmNvbG9yICYmIHNlbGYudXNlQ29sb3JzKSBzZWxmLmNvbG9yID0gc2VsZWN0Q29sb3IoKTtcblxuXHRcdFx0XHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuXG5cdFx0XHRcdFx0XHRhcmdzWzBdID0gZXhwb3J0cy5jb2VyY2UoYXJnc1swXSk7XG5cblx0XHRcdFx0XHRcdGlmICgnc3RyaW5nJyAhPT0gdHlwZW9mIGFyZ3NbMF0pIHtcblx0XHRcdFx0XHRcdFx0Ly8gYW55dGhpbmcgZWxzZSBsZXQncyBpbnNwZWN0IHdpdGggJW9cblx0XHRcdFx0XHRcdFx0YXJncyA9IFsnJW8nXS5jb25jYXQoYXJncyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIGFwcGx5IGFueSBgZm9ybWF0dGVyc2AgdHJhbnNmb3JtYXRpb25zXG5cdFx0XHRcdFx0XHR2YXIgaW5kZXggPSAwO1xuXHRcdFx0XHRcdFx0YXJnc1swXSA9IGFyZ3NbMF0ucmVwbGFjZSgvJShbYS16JV0pL2csIGZ1bmN0aW9uIChtYXRjaCwgZm9ybWF0KSB7XG5cdFx0XHRcdFx0XHRcdC8vIGlmIHdlIGVuY291bnRlciBhbiBlc2NhcGVkICUgdGhlbiBkb24ndCBpbmNyZWFzZSB0aGUgYXJyYXkgaW5kZXhcblx0XHRcdFx0XHRcdFx0aWYgKG1hdGNoID09PSAnJSUnKSByZXR1cm4gbWF0Y2g7XG5cdFx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0XHRcdHZhciBmb3JtYXR0ZXIgPSBleHBvcnRzLmZvcm1hdHRlcnNbZm9ybWF0XTtcblx0XHRcdFx0XHRcdFx0aWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBmb3JtYXR0ZXIpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgdmFsID0gYXJnc1tpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0bWF0Y2ggPSBmb3JtYXR0ZXIuY2FsbChzZWxmLCB2YWwpO1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gbm93IHdlIG5lZWQgdG8gcmVtb3ZlIGBhcmdzW2luZGV4XWAgc2luY2UgaXQncyBpbmxpbmVkIGluIHRoZSBgZm9ybWF0YFxuXHRcdFx0XHRcdFx0XHRcdGFyZ3Muc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdFx0XHRcdFx0XHRpbmRleC0tO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJldHVybiBtYXRjaDtcblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGV4cG9ydHMuZm9ybWF0QXJncykge1xuXHRcdFx0XHRcdFx0XHRhcmdzID0gZXhwb3J0cy5mb3JtYXRBcmdzLmFwcGx5KHNlbGYsIGFyZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dmFyIGxvZ0ZuID0gZW5hYmxlZC5sb2cgfHwgZXhwb3J0cy5sb2cgfHwgY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcblx0XHRcdFx0XHRcdGxvZ0ZuLmFwcGx5KHNlbGYsIGFyZ3MpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbmFibGVkLmVuYWJsZWQgPSB0cnVlO1xuXG5cdFx0XHRcdFx0dmFyIGZuID0gZXhwb3J0cy5lbmFibGVkKG5hbWVzcGFjZSkgPyBlbmFibGVkIDogZGlzYWJsZWQ7XG5cblx0XHRcdFx0XHRmbi5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG5cblx0XHRcdFx0XHRyZXR1cm4gZm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRW5hYmxlcyBhIGRlYnVnIG1vZGUgYnkgbmFtZXNwYWNlcy4gVGhpcyBjYW4gaW5jbHVkZSBtb2Rlc1xuXHRcdFx0XHQgKiBzZXBhcmF0ZWQgYnkgYSBjb2xvbiBhbmQgd2lsZGNhcmRzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBlbmFibGUobmFtZXNwYWNlcykge1xuXHRcdFx0XHRcdGV4cG9ydHMuc2F2ZShuYW1lc3BhY2VzKTtcblxuXHRcdFx0XHRcdHZhciBzcGxpdCA9IChuYW1lc3BhY2VzIHx8ICcnKS5zcGxpdCgvW1xccyxdKy8pO1xuXHRcdFx0XHRcdHZhciBsZW4gPSBzcGxpdC5sZW5ndGg7XG5cblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXNwbGl0W2ldKSBjb250aW51ZTsgLy8gaWdub3JlIGVtcHR5IHN0cmluZ3Ncblx0XHRcdFx0XHRcdG5hbWVzcGFjZXMgPSBzcGxpdFtpXS5yZXBsYWNlKC9cXCovZywgJy4qPycpO1xuXHRcdFx0XHRcdFx0aWYgKG5hbWVzcGFjZXNbMF0gPT09ICctJykge1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzLnNraXBzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzLnN1YnN0cigxKSArICckJykpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5uYW1lcy5wdXNoKG5ldyBSZWdFeHAoJ14nICsgbmFtZXNwYWNlcyArICckJykpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBEaXNhYmxlIGRlYnVnIG91dHB1dC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gZGlzYWJsZSgpIHtcblx0XHRcdFx0XHRleHBvcnRzLmVuYWJsZSgnJyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuXHRcdFx0XHQgKiBAcmV0dXJuIHtCb29sZWFufVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBlbmFibGVkKG5hbWUpIHtcblx0XHRcdFx0XHR2YXIgaSwgbGVuO1xuXHRcdFx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IGV4cG9ydHMuc2tpcHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHRcdGlmIChleHBvcnRzLnNraXBzW2ldLnRlc3QobmFtZSkpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBleHBvcnRzLm5hbWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoZXhwb3J0cy5uYW1lc1tpXS50ZXN0KG5hbWUpKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ29lcmNlIGB2YWxgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge01peGVkfSB2YWxcblx0XHRcdFx0ICogQHJldHVybiB7TWl4ZWR9XG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBjb2VyY2UodmFsKSB7XG5cdFx0XHRcdFx0aWYgKHZhbCBpbnN0YW5jZW9mIEVycm9yKSByZXR1cm4gdmFsLnN0YWNrIHx8IHZhbC5tZXNzYWdlO1xuXHRcdFx0XHRcdHJldHVybiB2YWw7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSwge1xuXHRcdFx0XHRcIm1zXCI6IDI1XG5cdFx0XHR9XSxcblx0XHRcdDE5OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIga2V5cyA9IF9kZXJlcV8oJy4va2V5cycpO1xuXHRcdFx0XHRcdHZhciBoYXNCaW5hcnkgPSBfZGVyZXFfKCdoYXMtYmluYXJ5Jyk7XG5cdFx0XHRcdFx0dmFyIHNsaWNlQnVmZmVyID0gX2RlcmVxXygnYXJyYXlidWZmZXIuc2xpY2UnKTtcblx0XHRcdFx0XHR2YXIgYmFzZTY0ZW5jb2RlciA9IF9kZXJlcV8oJ2Jhc2U2NC1hcnJheWJ1ZmZlcicpO1xuXHRcdFx0XHRcdHZhciBhZnRlciA9IF9kZXJlcV8oJ2FmdGVyJyk7XG5cdFx0XHRcdFx0dmFyIHV0ZjggPSBfZGVyZXFfKCd1dGY4Jyk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDaGVjayBpZiB3ZSBhcmUgcnVubmluZyBhbiBhbmRyb2lkIGJyb3dzZXIuIFRoYXQgcmVxdWlyZXMgdXMgdG8gdXNlXG5cdFx0XHRcdFx0ICogQXJyYXlCdWZmZXIgd2l0aCBwb2xsaW5nIHRyYW5zcG9ydHMuLi5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIGh0dHA6Ly9naGluZGEubmV0L2pwZWctYmxvYi1hamF4LWFuZHJvaWQvXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgaXNBbmRyb2lkID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIENoZWNrIGlmIHdlIGFyZSBydW5uaW5nIGluIFBoYW50b21KUy5cblx0XHRcdFx0XHQgKiBVcGxvYWRpbmcgYSBCbG9iIHdpdGggUGhhbnRvbUpTIGRvZXMgbm90IHdvcmsgY29ycmVjdGx5LCBhcyByZXBvcnRlZCBoZXJlOlxuXHRcdFx0XHRcdCAqIGh0dHBzOi8vZ2l0aHViLmNvbS9hcml5YS9waGFudG9tanMvaXNzdWVzLzExMzk1XG5cdFx0XHRcdFx0ICogQHR5cGUgYm9vbGVhblxuXHRcdFx0XHRcdCAqL1xuXHRcdFx0XHRcdHZhciBpc1BoYW50b21KUyA9IC9QaGFudG9tSlMvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogV2hlbiB0cnVlLCBhdm9pZHMgdXNpbmcgQmxvYnMgdG8gZW5jb2RlIHBheWxvYWRzLlxuXHRcdFx0XHRcdCAqIEB0eXBlIGJvb2xlYW5cblx0XHRcdFx0XHQgKi9cblx0XHRcdFx0XHR2YXIgZG9udFNlbmRCbG9icyA9IGlzQW5kcm9pZCB8fCBpc1BoYW50b21KUztcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEN1cnJlbnQgcHJvdG9jb2wgdmVyc2lvbi5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMucHJvdG9jb2wgPSAzO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogUGFja2V0IHR5cGVzLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0dmFyIHBhY2tldHMgPSBleHBvcnRzLnBhY2tldHMgPSB7XG5cdFx0XHRcdFx0XHRvcGVuOiAwIC8vIG5vbi13c1xuXHRcdFx0XHRcdFx0XHQsXG5cdFx0XHRcdFx0XHRjbG9zZTogMSAvLyBub24td3Ncblx0XHRcdFx0XHRcdFx0LFxuXHRcdFx0XHRcdFx0cGluZzogMixcblx0XHRcdFx0XHRcdHBvbmc6IDMsXG5cdFx0XHRcdFx0XHRtZXNzYWdlOiA0LFxuXHRcdFx0XHRcdFx0dXBncmFkZTogNSxcblx0XHRcdFx0XHRcdG5vb3A6IDZcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0dmFyIHBhY2tldHNsaXN0ID0ga2V5cyhwYWNrZXRzKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIFByZW1hZGUgZXJyb3IgcGFja2V0LlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0dmFyIGVyciA9IHtcblx0XHRcdFx0XHRcdHR5cGU6ICdlcnJvcicsXG5cdFx0XHRcdFx0XHRkYXRhOiAncGFyc2VyIGVycm9yJ1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDcmVhdGUgYSBibG9iIGFwaSBldmVuIGZvciBibG9iIGJ1aWxkZXIgd2hlbiB2ZW5kb3IgcHJlZml4ZXMgZXhpc3Rcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBCbG9iID0gX2RlcmVxXygnYmxvYicpO1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogRW5jb2RlcyBhIHBhY2tldC5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqICAgICA8cGFja2V0IHR5cGUgaWQ+IFsgPGRhdGE+IF1cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEV4YW1wbGU6XG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiAgICAgNWhlbGxvIHdvcmxkXG5cdFx0XHRcdFx0ICogICAgIDNcblx0XHRcdFx0XHQgKiAgICAgNFxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQmluYXJ5IGlzIGVuY29kZWQgaW4gYW4gaWRlbnRpY2FsIHByaW5jaXBsZVxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmVuY29kZVBhY2tldCA9IGZ1bmN0aW9uIChwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCB1dGY4ZW5jb2RlLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0aWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIHN1cHBvcnRzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrID0gc3VwcG9ydHNCaW5hcnk7XG5cdFx0XHRcdFx0XHRcdHN1cHBvcnRzQmluYXJ5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICgnZnVuY3Rpb24nID09IHR5cGVvZiB1dGY4ZW5jb2RlKSB7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrID0gdXRmOGVuY29kZTtcblx0XHRcdFx0XHRcdFx0dXRmOGVuY29kZSA9IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBkYXRhID0gKHBhY2tldC5kYXRhID09PSB1bmRlZmluZWQpID9cblx0XHRcdFx0XHRcdFx0dW5kZWZpbmVkIDpcblx0XHRcdFx0XHRcdFx0cGFja2V0LmRhdGEuYnVmZmVyIHx8IHBhY2tldC5kYXRhO1xuXG5cdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLkFycmF5QnVmZmVyICYmIGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZW5jb2RlQXJyYXlCdWZmZXIocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChCbG9iICYmIGRhdGEgaW5zdGFuY2VvZiBnbG9iYWwuQmxvYikge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZW5jb2RlQmxvYihwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIG1pZ2h0IGJlIGFuIG9iamVjdCB3aXRoIHsgYmFzZTY0OiB0cnVlLCBkYXRhOiBkYXRhQXNCYXNlNjRTdHJpbmcgfVxuXHRcdFx0XHRcdFx0aWYgKGRhdGEgJiYgZGF0YS5iYXNlNjQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGVuY29kZUJhc2U2NE9iamVjdChwYWNrZXQsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gU2VuZGluZyBkYXRhIGFzIGEgdXRmLTggc3RyaW5nXG5cdFx0XHRcdFx0XHR2YXIgZW5jb2RlZCA9IHBhY2tldHNbcGFja2V0LnR5cGVdO1xuXG5cdFx0XHRcdFx0XHQvLyBkYXRhIGZyYWdtZW50IGlzIG9wdGlvbmFsXG5cdFx0XHRcdFx0XHRpZiAodW5kZWZpbmVkICE9PSBwYWNrZXQuZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRlbmNvZGVkICs9IHV0ZjhlbmNvZGUgPyB1dGY4LmVuY29kZShTdHJpbmcocGFja2V0LmRhdGEpKSA6IFN0cmluZyhwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjaygnJyArIGVuY29kZWQpO1xuXG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUJhc2U2NE9iamVjdChwYWNrZXQsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHQvLyBwYWNrZXQgZGF0YSBpcyBhbiBvYmplY3QgeyBiYXNlNjQ6IHRydWUsIGRhdGE6IGRhdGFBc0Jhc2U2NFN0cmluZyB9XG5cdFx0XHRcdFx0XHR2YXIgbWVzc2FnZSA9ICdiJyArIGV4cG9ydHMucGFja2V0c1twYWNrZXQudHlwZV0gKyBwYWNrZXQuZGF0YS5kYXRhO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKG1lc3NhZ2UpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEVuY29kZSBwYWNrZXQgaGVscGVycyBmb3IgYmluYXJ5IHR5cGVzXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBlbmNvZGVBcnJheUJ1ZmZlcihwYWNrZXQsIHN1cHBvcnRzQmluYXJ5LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0aWYgKCFzdXBwb3J0c0JpbmFyeSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZXhwb3J0cy5lbmNvZGVCYXNlNjRQYWNrZXQocGFja2V0LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBkYXRhID0gcGFja2V0LmRhdGE7XG5cdFx0XHRcdFx0XHR2YXIgY29udGVudEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0QnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMSArIGRhdGEuYnl0ZUxlbmd0aCk7XG5cblx0XHRcdFx0XHRcdHJlc3VsdEJ1ZmZlclswXSA9IHBhY2tldHNbcGFja2V0LnR5cGVdO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjb250ZW50QXJyYXkubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0cmVzdWx0QnVmZmVyW2kgKyAxXSA9IGNvbnRlbnRBcnJheVtpXTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKHJlc3VsdEJ1ZmZlci5idWZmZXIpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUJsb2JBc0FycmF5QnVmZmVyKHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRpZiAoIXN1cHBvcnRzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBleHBvcnRzLmVuY29kZUJhc2U2NFBhY2tldChwYWNrZXQsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGZyID0gbmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdFx0XHRcdGZyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0cGFja2V0LmRhdGEgPSBmci5yZXN1bHQ7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgc3VwcG9ydHNCaW5hcnksIHRydWUsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRyZXR1cm4gZnIucmVhZEFzQXJyYXlCdWZmZXIocGFja2V0LmRhdGEpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUJsb2IocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICghc3VwcG9ydHNCaW5hcnkpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0KHBhY2tldCwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoZG9udFNlbmRCbG9icykge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZW5jb2RlQmxvYkFzQXJyYXlCdWZmZXIocGFja2V0LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgbGVuZ3RoID0gbmV3IFVpbnQ4QXJyYXkoMSk7XG5cdFx0XHRcdFx0XHRsZW5ndGhbMF0gPSBwYWNrZXRzW3BhY2tldC50eXBlXTtcblx0XHRcdFx0XHRcdHZhciBibG9iID0gbmV3IEJsb2IoW2xlbmd0aC5idWZmZXIsIHBhY2tldC5kYXRhXSk7XG5cblx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhibG9iKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBFbmNvZGVzIGEgcGFja2V0IHdpdGggYmluYXJ5IGRhdGEgaW4gYSBiYXNlNjQgc3RyaW5nXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0LCBoYXMgYHR5cGVgIGFuZCBgZGF0YWBcblx0XHRcdFx0XHQgKiBAcmV0dXJuIHtTdHJpbmd9IGJhc2U2NCBlbmNvZGVkIG1lc3NhZ2Vcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlQmFzZTY0UGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdHZhciBtZXNzYWdlID0gJ2InICsgZXhwb3J0cy5wYWNrZXRzW3BhY2tldC50eXBlXTtcblx0XHRcdFx0XHRcdGlmIChCbG9iICYmIHBhY2tldC5kYXRhIGluc3RhbmNlb2YgZ2xvYmFsLkJsb2IpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGZyID0gbmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdFx0XHRcdFx0ZnIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBiNjQgPSBmci5yZXN1bHQuc3BsaXQoJywnKVsxXTtcblx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayhtZXNzYWdlICsgYjY0KTtcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZyLnJlYWRBc0RhdGFVUkwocGFja2V0LmRhdGEpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgYjY0ZGF0YTtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGI2NGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KHBhY2tldC5kYXRhKSk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIGlQaG9uZSBTYWZhcmkgZG9lc24ndCBsZXQgeW91IGFwcGx5IHdpdGggdHlwZWQgYXJyYXlzXG5cdFx0XHRcdFx0XHRcdHZhciB0eXBlZCA9IG5ldyBVaW50OEFycmF5KHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0dmFyIGJhc2ljID0gbmV3IEFycmF5KHR5cGVkLmxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdHlwZWQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRiYXNpY1tpXSA9IHR5cGVkW2ldO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGI2NGRhdGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGJhc2ljKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdG1lc3NhZ2UgKz0gZ2xvYmFsLmJ0b2EoYjY0ZGF0YSk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2sobWVzc2FnZSk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIERlY29kZXMgYSBwYWNrZXQuIENoYW5nZXMgZm9ybWF0IHRvIEJsb2IgaWYgcmVxdWVzdGVkLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGB0eXBlYCBhbmQgYGRhdGFgIChpZiBhbnkpXG5cdFx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29kZVBhY2tldCA9IGZ1bmN0aW9uIChkYXRhLCBiaW5hcnlUeXBlLCB1dGY4ZGVjb2RlKSB7XG5cdFx0XHRcdFx0XHQvLyBTdHJpbmcgZGF0YVxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnIHx8IGRhdGEgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoZGF0YS5jaGFyQXQoMCkgPT0gJ2InKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuZGVjb2RlQmFzZTY0UGFja2V0KGRhdGEuc3Vic3RyKDEpLCBiaW5hcnlUeXBlKTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmICh1dGY4ZGVjb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGEgPSB1dGY4LmRlY29kZShkYXRhKTtcblx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR2YXIgdHlwZSA9IGRhdGEuY2hhckF0KDApO1xuXG5cdFx0XHRcdFx0XHRcdGlmIChOdW1iZXIodHlwZSkgIT0gdHlwZSB8fCAhcGFja2V0c2xpc3RbdHlwZV0pIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZXJyO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKGRhdGEubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0eXBlOiBwYWNrZXRzbGlzdFt0eXBlXSxcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGE6IGRhdGEuc3Vic3RyaW5nKDEpXG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0dHlwZTogcGFja2V0c2xpc3RbdHlwZV1cblx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBhc0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG5cdFx0XHRcdFx0XHR2YXIgdHlwZSA9IGFzQXJyYXlbMF07XG5cdFx0XHRcdFx0XHR2YXIgcmVzdCA9IHNsaWNlQnVmZmVyKGRhdGEsIDEpO1xuXHRcdFx0XHRcdFx0aWYgKEJsb2IgJiYgYmluYXJ5VHlwZSA9PT0gJ2Jsb2InKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3QgPSBuZXcgQmxvYihbcmVzdF0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdFx0dHlwZTogcGFja2V0c2xpc3RbdHlwZV0sXG5cdFx0XHRcdFx0XHRcdGRhdGE6IHJlc3Rcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIERlY29kZXMgYSBwYWNrZXQgZW5jb2RlZCBpbiBhIGJhc2U2NCBzdHJpbmdcblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBiYXNlNjQgZW5jb2RlZCBtZXNzYWdlXG5cdFx0XHRcdFx0ICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGB0eXBlYCBhbmQgYGRhdGFgIChpZiBhbnkpXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29kZUJhc2U2NFBhY2tldCA9IGZ1bmN0aW9uIChtc2csIGJpbmFyeVR5cGUpIHtcblx0XHRcdFx0XHRcdHZhciB0eXBlID0gcGFja2V0c2xpc3RbbXNnLmNoYXJBdCgwKV07XG5cdFx0XHRcdFx0XHRpZiAoIWdsb2JhbC5BcnJheUJ1ZmZlcikge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdHR5cGU6IHR5cGUsXG5cdFx0XHRcdFx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdFx0XHRcdFx0YmFzZTY0OiB0cnVlLFxuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YTogbXNnLnN1YnN0cigxKVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGRhdGEgPSBiYXNlNjRlbmNvZGVyLmRlY29kZShtc2cuc3Vic3RyKDEpKTtcblxuXHRcdFx0XHRcdFx0aWYgKGJpbmFyeVR5cGUgPT09ICdibG9iJyAmJiBCbG9iKSB7XG5cdFx0XHRcdFx0XHRcdGRhdGEgPSBuZXcgQmxvYihbZGF0YV0pO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0XHRcdFx0XHRkYXRhOiBkYXRhXG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBFbmNvZGVzIG11bHRpcGxlIG1lc3NhZ2VzIChwYXlsb2FkKS5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqICAgICA8bGVuZ3RoPjpkYXRhXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBFeGFtcGxlOlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogICAgIDExOmhlbGxvIHdvcmxkMjpoaVxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogSWYgYW55IGNvbnRlbnRzIGFyZSBiaW5hcnksIHRoZXkgd2lsbCBiZSBlbmNvZGVkIGFzIGJhc2U2NCBzdHJpbmdzLiBCYXNlNjRcblx0XHRcdFx0XHQgKiBlbmNvZGVkIHN0cmluZ3MgYXJlIG1hcmtlZCB3aXRoIGEgYiBiZWZvcmUgdGhlIGxlbmd0aCBzcGVjaWZpZXJcblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7QXJyYXl9IHBhY2tldHNcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGF5bG9hZCA9IGZ1bmN0aW9uIChwYWNrZXRzLCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICh0eXBlb2Ygc3VwcG9ydHNCaW5hcnkgPT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IHN1cHBvcnRzQmluYXJ5O1xuXHRcdFx0XHRcdFx0XHRzdXBwb3J0c0JpbmFyeSA9IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBpc0JpbmFyeSA9IGhhc0JpbmFyeShwYWNrZXRzKTtcblxuXHRcdFx0XHRcdFx0aWYgKHN1cHBvcnRzQmluYXJ5ICYmIGlzQmluYXJ5KSB7XG5cdFx0XHRcdFx0XHRcdGlmIChCbG9iICYmICFkb250U2VuZEJsb2JzKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuZW5jb2RlUGF5bG9hZEFzQmxvYihwYWNrZXRzLCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZXhwb3J0cy5lbmNvZGVQYXlsb2FkQXNBcnJheUJ1ZmZlcihwYWNrZXRzLCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICghcGFja2V0cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKCcwOicpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBzZXRMZW5ndGhIZWFkZXIobWVzc2FnZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbWVzc2FnZS5sZW5ndGggKyAnOicgKyBtZXNzYWdlO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBlbmNvZGVPbmUocGFja2V0LCBkb25lQ2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5lbmNvZGVQYWNrZXQocGFja2V0LCAhaXNCaW5hcnkgPyBmYWxzZSA6IHN1cHBvcnRzQmluYXJ5LCB0cnVlLCBmdW5jdGlvbiAobWVzc2FnZSkge1xuXHRcdFx0XHRcdFx0XHRcdGRvbmVDYWxsYmFjayhudWxsLCBzZXRMZW5ndGhIZWFkZXIobWVzc2FnZSkpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0bWFwKHBhY2tldHMsIGVuY29kZU9uZSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0cykge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2socmVzdWx0cy5qb2luKCcnKSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogQXN5bmMgYXJyYXkgbWFwIHVzaW5nIGFmdGVyXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBtYXAoYXJ5LCBlYWNoLCBkb25lKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gbmV3IEFycmF5KGFyeS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0dmFyIG5leHQgPSBhZnRlcihhcnkubGVuZ3RoLCBkb25lKTtcblxuXHRcdFx0XHRcdFx0dmFyIGVhY2hXaXRoSW5kZXggPSBmdW5jdGlvbiAoaSwgZWwsIGNiKSB7XG5cdFx0XHRcdFx0XHRcdGVhY2goZWwsIGZ1bmN0aW9uIChlcnJvciwgbXNnKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmVzdWx0W2ldID0gbXNnO1xuXHRcdFx0XHRcdFx0XHRcdGNiKGVycm9yLCByZXN1bHQpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGVhY2hXaXRoSW5kZXgoaSwgYXJ5W2ldLCBuZXh0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdCAqIERlY29kZXMgZGF0YSB3aGVuIGEgcGF5bG9hZCBpcyBtYXliZSBleHBlY3RlZC4gUG9zc2libGUgYmluYXJ5IGNvbnRlbnRzIGFyZVxuXHRcdFx0XHRcdCAqIGRlY29kZWQgZnJvbSB0aGVpciBiYXNlNjQgcmVwcmVzZW50YXRpb25cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLCBjYWxsYmFjayBtZXRob2Rcblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5kZWNvZGVQYXlsb2FkID0gZnVuY3Rpb24gKGRhdGEsIGJpbmFyeVR5cGUsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRpZiAodHlwZW9mIGRhdGEgIT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGV4cG9ydHMuZGVjb2RlUGF5bG9hZEFzQmluYXJ5KGRhdGEsIGJpbmFyeVR5cGUsIGNhbGxiYWNrKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHR5cGVvZiBiaW5hcnlUeXBlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0XHRcdGNhbGxiYWNrID0gYmluYXJ5VHlwZTtcblx0XHRcdFx0XHRcdFx0YmluYXJ5VHlwZSA9IG51bGw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBwYWNrZXQ7XG5cdFx0XHRcdFx0XHRpZiAoZGF0YSA9PSAnJykge1xuXHRcdFx0XHRcdFx0XHQvLyBwYXJzZXIgZXJyb3IgLSBpZ25vcmluZyBwYXlsb2FkXG5cdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgbGVuZ3RoID0gJycsXG5cdFx0XHRcdFx0XHRcdG4sIG1zZztcblxuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSBkYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHRcdFx0XHRcdFx0XHR2YXIgY2hyID0gZGF0YS5jaGFyQXQoaSk7XG5cblx0XHRcdFx0XHRcdFx0aWYgKCc6JyAhPSBjaHIpIHtcblx0XHRcdFx0XHRcdFx0XHRsZW5ndGggKz0gY2hyO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGlmICgnJyA9PSBsZW5ndGggfHwgKGxlbmd0aCAhPSAobiA9IE51bWJlcihsZW5ndGgpKSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHBhcnNlciBlcnJvciAtIGlnbm9yaW5nIHBheWxvYWRcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdG1zZyA9IGRhdGEuc3Vic3RyKGkgKyAxLCBuKTtcblxuXHRcdFx0XHRcdFx0XHRcdGlmIChsZW5ndGggIT0gbXNnLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gcGFyc2VyIGVycm9yIC0gaWdub3JpbmcgcGF5bG9hZFxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKGVyciwgMCwgMSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKG1zZy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHBhY2tldCA9IGV4cG9ydHMuZGVjb2RlUGFja2V0KG1zZywgYmluYXJ5VHlwZSwgdHJ1ZSk7XG5cblx0XHRcdFx0XHRcdFx0XHRcdGlmIChlcnIudHlwZSA9PSBwYWNrZXQudHlwZSAmJiBlcnIuZGF0YSA9PSBwYWNrZXQuZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBwYXJzZXIgZXJyb3IgaW4gaW5kaXZpZHVhbCBwYWNrZXQgLSBpZ25vcmluZyBwYXlsb2FkXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhlcnIsIDAsIDEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgcmV0ID0gY2FsbGJhY2socGFja2V0LCBpICsgbiwgbCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoZmFsc2UgPT09IHJldCkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdC8vIGFkdmFuY2UgY3Vyc29yXG5cdFx0XHRcdFx0XHRcdFx0aSArPSBuO1xuXHRcdFx0XHRcdFx0XHRcdGxlbmd0aCA9ICcnO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmIChsZW5ndGggIT0gJycpIHtcblx0XHRcdFx0XHRcdFx0Ly8gcGFyc2VyIGVycm9yIC0gaWdub3JpbmcgcGF5bG9hZFxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY2FsbGJhY2soZXJyLCAwLCAxKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBFbmNvZGVzIG11bHRpcGxlIG1lc3NhZ2VzIChwYXlsb2FkKSBhcyBiaW5hcnkuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiA8MSA9IGJpbmFyeSwgMCA9IHN0cmluZz48bnVtYmVyIGZyb20gMC05PjxudW1iZXIgZnJvbSAwLTk+Wy4uLl08bnVtYmVyXG5cdFx0XHRcdFx0ICogMjU1PjxkYXRhPlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogRXhhbXBsZTpcblx0XHRcdFx0XHQgKiAxIDMgMjU1IDEgMiAzLCBpZiB0aGUgYmluYXJ5IGNvbnRlbnRzIGFyZSBpbnRlcnByZXRlZCBhcyA4IGJpdCBpbnRlZ2Vyc1xuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtBcnJheX0gcGFja2V0c1xuXHRcdFx0XHRcdCAqIEByZXR1cm4ge0FycmF5QnVmZmVyfSBlbmNvZGVkIHBheWxvYWRcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGF5bG9hZEFzQXJyYXlCdWZmZXIgPSBmdW5jdGlvbiAocGFja2V0cywgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICghcGFja2V0cy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKG5ldyBBcnJheUJ1ZmZlcigwKSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZU9uZShwYWNrZXQsIGRvbmVDYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzLmVuY29kZVBhY2tldChwYWNrZXQsIHRydWUsIHRydWUsIGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGRvbmVDYWxsYmFjayhudWxsLCBkYXRhKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdG1hcChwYWNrZXRzLCBlbmNvZGVPbmUsIGZ1bmN0aW9uIChlcnIsIGVuY29kZWRQYWNrZXRzKSB7XG5cdFx0XHRcdFx0XHRcdHZhciB0b3RhbExlbmd0aCA9IGVuY29kZWRQYWNrZXRzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGxlbjtcblx0XHRcdFx0XHRcdFx0XHRpZiAodHlwZW9mIHAgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZW4gPSBwLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0bGVuID0gcC5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gYWNjICsgbGVuLnRvU3RyaW5nKCkubGVuZ3RoICsgbGVuICsgMjsgLy8gc3RyaW5nL2JpbmFyeSBpZGVudGlmaWVyICsgc2VwYXJhdG9yID0gMlxuXHRcdFx0XHRcdFx0XHR9LCAwKTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgcmVzdWx0QXJyYXkgPSBuZXcgVWludDhBcnJheSh0b3RhbExlbmd0aCk7XG5cblx0XHRcdFx0XHRcdFx0dmFyIGJ1ZmZlckluZGV4ID0gMDtcblx0XHRcdFx0XHRcdFx0ZW5jb2RlZFBhY2tldHMuZm9yRWFjaChmdW5jdGlvbiAocCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBpc1N0cmluZyA9IHR5cGVvZiBwID09PSAnc3RyaW5nJztcblx0XHRcdFx0XHRcdFx0XHR2YXIgYWIgPSBwO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChpc1N0cmluZykge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHZpZXcgPSBuZXcgVWludDhBcnJheShwLmxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHAubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld1tpXSA9IHAuY2hhckNvZGVBdChpKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdGFiID0gdmlldy5idWZmZXI7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGlzU3RyaW5nKSB7IC8vIG5vdCB0cnVlIGJpbmFyeVxuXHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSAwO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7IC8vIHRydWUgYmluYXJ5XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHRBcnJheVtidWZmZXJJbmRleCsrXSA9IDE7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGxlblN0ciA9IGFiLmJ5dGVMZW5ndGgudG9TdHJpbmcoKTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlblN0ci5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSBwYXJzZUludChsZW5TdHJbaV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRyZXN1bHRBcnJheVtidWZmZXJJbmRleCsrXSA9IDI1NTtcblxuXHRcdFx0XHRcdFx0XHRcdHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYWIpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0QXJyYXlbYnVmZmVySW5kZXgrK10gPSB2aWV3W2ldO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrKHJlc3VsdEFycmF5LmJ1ZmZlcik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogRW5jb2RlIGFzIEJsb2Jcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGF5bG9hZEFzQmxvYiA9IGZ1bmN0aW9uIChwYWNrZXRzLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gZW5jb2RlT25lKHBhY2tldCwgZG9uZUNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdGV4cG9ydHMuZW5jb2RlUGFja2V0KHBhY2tldCwgdHJ1ZSwgdHJ1ZSwgZnVuY3Rpb24gKGVuY29kZWQpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgYmluYXJ5SWRlbnRpZmllciA9IG5ldyBVaW50OEFycmF5KDEpO1xuXHRcdFx0XHRcdFx0XHRcdGJpbmFyeUlkZW50aWZpZXJbMF0gPSAxO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgZW5jb2RlZCA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoZW5jb2RlZC5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbmNvZGVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdbaV0gPSBlbmNvZGVkLmNoYXJDb2RlQXQoaSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRlbmNvZGVkID0gdmlldy5idWZmZXI7XG5cdFx0XHRcdFx0XHRcdFx0XHRiaW5hcnlJZGVudGlmaWVyWzBdID0gMDtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHR2YXIgbGVuID0gKGVuY29kZWQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgP1xuXHRcdFx0XHRcdFx0XHRcdFx0ZW5jb2RlZC5ieXRlTGVuZ3RoIDpcblx0XHRcdFx0XHRcdFx0XHRcdGVuY29kZWQuc2l6ZTtcblxuXHRcdFx0XHRcdFx0XHRcdHZhciBsZW5TdHIgPSBsZW4udG9TdHJpbmcoKTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgbGVuZ3RoQXJ5ID0gbmV3IFVpbnQ4QXJyYXkobGVuU3RyLmxlbmd0aCArIDEpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGVuU3RyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZW5ndGhBcnlbaV0gPSBwYXJzZUludChsZW5TdHJbaV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRsZW5ndGhBcnlbbGVuU3RyLmxlbmd0aF0gPSAyNTU7XG5cblx0XHRcdFx0XHRcdFx0XHRpZiAoQmxvYikge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGJsb2IgPSBuZXcgQmxvYihbYmluYXJ5SWRlbnRpZmllci5idWZmZXIsIGxlbmd0aEFyeS5idWZmZXIsIGVuY29kZWRdKTtcblx0XHRcdFx0XHRcdFx0XHRcdGRvbmVDYWxsYmFjayhudWxsLCBibG9iKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRtYXAocGFja2V0cywgZW5jb2RlT25lLCBmdW5jdGlvbiAoZXJyLCByZXN1bHRzKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBjYWxsYmFjayhuZXcgQmxvYihyZXN1bHRzKSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0Lypcblx0XHRcdFx0XHQgKiBEZWNvZGVzIGRhdGEgd2hlbiBhIHBheWxvYWQgaXMgbWF5YmUgZXhwZWN0ZWQuIFN0cmluZ3MgYXJlIGRlY29kZWQgYnlcblx0XHRcdFx0XHQgKiBpbnRlcnByZXRpbmcgZWFjaCBieXRlIGFzIGEga2V5IGNvZGUgZm9yIGVudHJpZXMgbWFya2VkIHRvIHN0YXJ0IHdpdGggMC4gU2VlXG5cdFx0XHRcdFx0ICogZGVzY3JpcHRpb24gb2YgZW5jb2RlUGF5bG9hZEFzQmluYXJ5XG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBkYXRhLCBjYWxsYmFjayBtZXRob2Rcblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5kZWNvZGVQYXlsb2FkQXNCaW5hcnkgPSBmdW5jdGlvbiAoZGF0YSwgYmluYXJ5VHlwZSwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmICh0eXBlb2YgYmluYXJ5VHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IGJpbmFyeVR5cGU7XG5cdFx0XHRcdFx0XHRcdGJpbmFyeVR5cGUgPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVyVGFpbCA9IGRhdGE7XG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVycyA9IFtdO1xuXG5cdFx0XHRcdFx0XHR2YXIgbnVtYmVyVG9vTG9uZyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0d2hpbGUgKGJ1ZmZlclRhaWwuYnl0ZUxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0dmFyIHRhaWxBcnJheSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlclRhaWwpO1xuXHRcdFx0XHRcdFx0XHR2YXIgaXNTdHJpbmcgPSB0YWlsQXJyYXlbMF0gPT09IDA7XG5cdFx0XHRcdFx0XHRcdHZhciBtc2dMZW5ndGggPSAnJztcblxuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMTs7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0YWlsQXJyYXlbaV0gPT0gMjU1KSBicmVhaztcblxuXHRcdFx0XHRcdFx0XHRcdGlmIChtc2dMZW5ndGgubGVuZ3RoID4gMzEwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRudW1iZXJUb29Mb25nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdG1zZ0xlbmd0aCArPSB0YWlsQXJyYXlbaV07XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZiAobnVtYmVyVG9vTG9uZykgcmV0dXJuIGNhbGxiYWNrKGVyciwgMCwgMSk7XG5cblx0XHRcdFx0XHRcdFx0YnVmZmVyVGFpbCA9IHNsaWNlQnVmZmVyKGJ1ZmZlclRhaWwsIDIgKyBtc2dMZW5ndGgubGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0bXNnTGVuZ3RoID0gcGFyc2VJbnQobXNnTGVuZ3RoKTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgbXNnID0gc2xpY2VCdWZmZXIoYnVmZmVyVGFpbCwgMCwgbXNnTGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0aWYgKGlzU3RyaW5nKSB7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdG1zZyA9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkobXNnKSk7XG5cdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gaVBob25lIFNhZmFyaSBkb2Vzbid0IGxldCB5b3UgYXBwbHkgdG8gdHlwZWQgYXJyYXlzXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgdHlwZWQgPSBuZXcgVWludDhBcnJheShtc2cpO1xuXHRcdFx0XHRcdFx0XHRcdFx0bXNnID0gJyc7XG5cdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHR5cGVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG1zZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHR5cGVkW2ldKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRidWZmZXJzLnB1c2gobXNnKTtcblx0XHRcdFx0XHRcdFx0YnVmZmVyVGFpbCA9IHNsaWNlQnVmZmVyKGJ1ZmZlclRhaWwsIG1zZ0xlbmd0aCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciB0b3RhbCA9IGJ1ZmZlcnMubGVuZ3RoO1xuXHRcdFx0XHRcdFx0YnVmZmVycy5mb3JFYWNoKGZ1bmN0aW9uIChidWZmZXIsIGkpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2soZXhwb3J0cy5kZWNvZGVQYWNrZXQoYnVmZmVyLCBiaW5hcnlUeXBlLCB0cnVlKSwgaSwgdG90YWwpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiLi9rZXlzXCI6IDIwLFxuXHRcdFx0XHRcImFmdGVyXCI6IDExLFxuXHRcdFx0XHRcImFycmF5YnVmZmVyLnNsaWNlXCI6IDEyLFxuXHRcdFx0XHRcImJhc2U2NC1hcnJheWJ1ZmZlclwiOiAxMyxcblx0XHRcdFx0XCJibG9iXCI6IDE0LFxuXHRcdFx0XHRcImhhcy1iaW5hcnlcIjogMjEsXG5cdFx0XHRcdFwidXRmOFwiOiAyOVxuXHRcdFx0fV0sXG5cdFx0XHQyMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogR2V0cyB0aGUga2V5cyBmb3IgYW4gb2JqZWN0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcmV0dXJuIHtBcnJheX0ga2V5c1xuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiBrZXlzKG9iaikge1xuXHRcdFx0XHRcdHZhciBhcnIgPSBbXTtcblx0XHRcdFx0XHR2YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblxuXHRcdFx0XHRcdGZvciAodmFyIGkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRpZiAoaGFzLmNhbGwob2JqLCBpKSkge1xuXHRcdFx0XHRcdFx0XHRhcnIucHVzaChpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIGFycjtcblx0XHRcdFx0fTtcblxuXHRcdFx0fSwge31dLFxuXHRcdFx0MjE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSByZXF1aXJlbWVudHMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgaXNBcnJheSA9IF9kZXJlcV8oJ2lzYXJyYXknKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBoYXNCaW5hcnk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDaGVja3MgZm9yIGJpbmFyeSBkYXRhLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogUmlnaHQgbm93IG9ubHkgQnVmZmVyIGFuZCBBcnJheUJ1ZmZlciBhcmUgc3VwcG9ydGVkLi5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBhbnl0aGluZ1xuXHRcdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBoYXNCaW5hcnkoZGF0YSkge1xuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBfaGFzQmluYXJ5KG9iaikge1xuXHRcdFx0XHRcdFx0XHRpZiAoIW9iaikgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRcdFx0XHRcdGlmICgoZ2xvYmFsLkJ1ZmZlciAmJiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyKG9iaikpIHx8XG5cdFx0XHRcdFx0XHRcdFx0KGdsb2JhbC5BcnJheUJ1ZmZlciAmJiBvYmogaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgfHxcblx0XHRcdFx0XHRcdFx0XHQoZ2xvYmFsLkJsb2IgJiYgb2JqIGluc3RhbmNlb2YgQmxvYikgfHxcblx0XHRcdFx0XHRcdFx0XHQoZ2xvYmFsLkZpbGUgJiYgb2JqIGluc3RhbmNlb2YgRmlsZSlcblx0XHRcdFx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpZiAoaXNBcnJheShvYmopKSB7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChfaGFzQmluYXJ5KG9ialtpXSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG9iaiAmJiAnb2JqZWN0JyA9PSB0eXBlb2Ygb2JqKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9iai50b0pTT04pIHtcblx0XHRcdFx0XHRcdFx0XHRcdG9iaiA9IG9iai50b0pTT04oKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSAmJiBfaGFzQmluYXJ5KG9ialtrZXldKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiBfaGFzQmluYXJ5KGRhdGEpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiaXNhcnJheVwiOiAyNFxuXHRcdFx0fV0sXG5cdFx0XHQyMjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTW9kdWxlIGV4cG9ydHMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIExvZ2ljIGJvcnJvd2VkIGZyb20gTW9kZXJuaXpyOlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiAgIC0gaHR0cHM6Ly9naXRodWIuY29tL01vZGVybml6ci9Nb2Rlcm5penIvYmxvYi9tYXN0ZXIvZmVhdHVyZS1kZXRlY3RzL2NvcnMuanNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gJ3VuZGVmaW5lZCcgJiZcblx0XHRcdFx0XHRcdCd3aXRoQ3JlZGVudGlhbHMnIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdFx0XHQvLyBpZiBYTUxIdHRwIHN1cHBvcnQgaXMgZGlzYWJsZWQgaW4gSUUgdGhlbiBpdCB3aWxsIHRocm93XG5cdFx0XHRcdFx0Ly8gd2hlbiB0cnlpbmcgdG8gY3JlYXRlXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQyMzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHR2YXIgaW5kZXhPZiA9IFtdLmluZGV4T2Y7XG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYXJyLCBvYmopIHtcblx0XHRcdFx0XHRpZiAoaW5kZXhPZikgcmV0dXJuIGFyci5pbmRleE9mKG9iaik7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcblx0XHRcdFx0XHRcdGlmIChhcnJbaV0gPT09IG9iaikgcmV0dXJuIGk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdFx0fTtcblx0XHRcdH0sIHt9XSxcblx0XHRcdDI0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuXHRcdFx0XHRcdHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJyKSA9PSAnW29iamVjdCBBcnJheV0nO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQyNTogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEhlbHBlcnMuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdHZhciBzID0gMTAwMDtcblx0XHRcdFx0dmFyIG0gPSBzICogNjA7XG5cdFx0XHRcdHZhciBoID0gbSAqIDYwO1xuXHRcdFx0XHR2YXIgZCA9IGggKiAyNDtcblx0XHRcdFx0dmFyIHkgPSBkICogMzY1LjI1O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQYXJzZSBvciBmb3JtYXQgdGhlIGdpdmVuIGB2YWxgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBPcHRpb25zOlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiAgLSBgbG9uZ2AgdmVyYm9zZSBmb3JtYXR0aW5nIFtmYWxzZV1cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd8TnVtYmVyfSB2YWxcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcblx0XHRcdFx0ICogQHJldHVybiB7U3RyaW5nfE51bWJlcn1cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodmFsLCBvcHRpb25zKSB7XG5cdFx0XHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0XHRcdFx0aWYgKCdzdHJpbmcnID09IHR5cGVvZiB2YWwpIHJldHVybiBwYXJzZSh2YWwpO1xuXHRcdFx0XHRcdHJldHVybiBvcHRpb25zLmxvbmcgP1xuXHRcdFx0XHRcdFx0bG9uZyh2YWwpIDpcblx0XHRcdFx0XHRcdHNob3J0KHZhbCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFBhcnNlIHRoZSBnaXZlbiBgc3RyYCBhbmQgcmV0dXJuIG1pbGxpc2Vjb25kcy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IHN0clxuXHRcdFx0XHQgKiBAcmV0dXJuIHtOdW1iZXJ9XG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBwYXJzZShzdHIpIHtcblx0XHRcdFx0XHRzdHIgPSAnJyArIHN0cjtcblx0XHRcdFx0XHRpZiAoc3RyLmxlbmd0aCA+IDEwMDAwKSByZXR1cm47XG5cdFx0XHRcdFx0dmFyIG1hdGNoID0gL14oKD86XFxkKyk/XFwuP1xcZCspICoobWlsbGlzZWNvbmRzP3xtc2Vjcz98bXN8c2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx5ZWFycz98eXJzP3x5KT8kL2kuZXhlYyhzdHIpO1xuXHRcdFx0XHRcdGlmICghbWF0Y2gpIHJldHVybjtcblx0XHRcdFx0XHR2YXIgbiA9IHBhcnNlRmxvYXQobWF0Y2hbMV0pO1xuXHRcdFx0XHRcdHZhciB0eXBlID0gKG1hdGNoWzJdIHx8ICdtcycpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdFx0c3dpdGNoICh0eXBlKSB7XG5cdFx0XHRcdFx0XHRjYXNlICd5ZWFycyc6XG5cdFx0XHRcdFx0XHRjYXNlICd5ZWFyJzpcblx0XHRcdFx0XHRcdGNhc2UgJ3lycyc6XG5cdFx0XHRcdFx0XHRjYXNlICd5cic6XG5cdFx0XHRcdFx0XHRjYXNlICd5Jzpcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG4gKiB5O1xuXHRcdFx0XHRcdFx0Y2FzZSAnZGF5cyc6XG5cdFx0XHRcdFx0XHRjYXNlICdkYXknOlxuXHRcdFx0XHRcdFx0Y2FzZSAnZCc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuICogZDtcblx0XHRcdFx0XHRcdGNhc2UgJ2hvdXJzJzpcblx0XHRcdFx0XHRcdGNhc2UgJ2hvdXInOlxuXHRcdFx0XHRcdFx0Y2FzZSAnaHJzJzpcblx0XHRcdFx0XHRcdGNhc2UgJ2hyJzpcblx0XHRcdFx0XHRcdGNhc2UgJ2gnOlxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbiAqIGg7XG5cdFx0XHRcdFx0XHRjYXNlICdtaW51dGVzJzpcblx0XHRcdFx0XHRcdGNhc2UgJ21pbnV0ZSc6XG5cdFx0XHRcdFx0XHRjYXNlICdtaW5zJzpcblx0XHRcdFx0XHRcdGNhc2UgJ21pbic6XG5cdFx0XHRcdFx0XHRjYXNlICdtJzpcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG4gKiBtO1xuXHRcdFx0XHRcdFx0Y2FzZSAnc2Vjb25kcyc6XG5cdFx0XHRcdFx0XHRjYXNlICdzZWNvbmQnOlxuXHRcdFx0XHRcdFx0Y2FzZSAnc2Vjcyc6XG5cdFx0XHRcdFx0XHRjYXNlICdzZWMnOlxuXHRcdFx0XHRcdFx0Y2FzZSAncyc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiBuICogcztcblx0XHRcdFx0XHRcdGNhc2UgJ21pbGxpc2Vjb25kcyc6XG5cdFx0XHRcdFx0XHRjYXNlICdtaWxsaXNlY29uZCc6XG5cdFx0XHRcdFx0XHRjYXNlICdtc2Vjcyc6XG5cdFx0XHRcdFx0XHRjYXNlICdtc2VjJzpcblx0XHRcdFx0XHRcdGNhc2UgJ21zJzpcblx0XHRcdFx0XHRcdFx0cmV0dXJuIG47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFNob3J0IGZvcm1hdCBmb3IgYG1zYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtOdW1iZXJ9IG1zXG5cdFx0XHRcdCAqIEByZXR1cm4ge1N0cmluZ31cblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIHNob3J0KG1zKSB7XG5cdFx0XHRcdFx0aWYgKG1zID49IGQpIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gZCkgKyAnZCc7XG5cdFx0XHRcdFx0aWYgKG1zID49IGgpIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gaCkgKyAnaCc7XG5cdFx0XHRcdFx0aWYgKG1zID49IG0pIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gbSkgKyAnbSc7XG5cdFx0XHRcdFx0aWYgKG1zID49IHMpIHJldHVybiBNYXRoLnJvdW5kKG1zIC8gcykgKyAncyc7XG5cdFx0XHRcdFx0cmV0dXJuIG1zICsgJ21zJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBMb25nIGZvcm1hdCBmb3IgYG1zYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtOdW1iZXJ9IG1zXG5cdFx0XHRcdCAqIEByZXR1cm4ge1N0cmluZ31cblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGxvbmcobXMpIHtcblx0XHRcdFx0XHRyZXR1cm4gcGx1cmFsKG1zLCBkLCAnZGF5JykgfHxcblx0XHRcdFx0XHRcdHBsdXJhbChtcywgaCwgJ2hvdXInKSB8fFxuXHRcdFx0XHRcdFx0cGx1cmFsKG1zLCBtLCAnbWludXRlJykgfHxcblx0XHRcdFx0XHRcdHBsdXJhbChtcywgcywgJ3NlY29uZCcpIHx8XG5cdFx0XHRcdFx0XHRtcyArICcgbXMnO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFBsdXJhbGl6YXRpb24gaGVscGVyLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBwbHVyYWwobXMsIG4sIG5hbWUpIHtcblx0XHRcdFx0XHRpZiAobXMgPCBuKSByZXR1cm47XG5cdFx0XHRcdFx0aWYgKG1zIDwgbiAqIDEuNSkgcmV0dXJuIE1hdGguZmxvb3IobXMgLyBuKSArICcgJyArIG5hbWU7XG5cdFx0XHRcdFx0cmV0dXJuIE1hdGguY2VpbChtcyAvIG4pICsgJyAnICsgbmFtZSArICdzJztcblx0XHRcdFx0fVxuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQyNjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0KGZ1bmN0aW9uIChnbG9iYWwpIHtcblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBKU09OIHBhcnNlLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHNlZSBCYXNlZCBvbiBqUXVlcnkjcGFyc2VKU09OIChNSVQpIGFuZCBKU09OMlxuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0dmFyIHJ2YWxpZGNoYXJzID0gL15bXFxdLDp7fVxcc10qJC87XG5cdFx0XHRcdFx0dmFyIHJ2YWxpZGVzY2FwZSA9IC9cXFxcKD86W1wiXFxcXFxcL2JmbnJ0XXx1WzAtOWEtZkEtRl17NH0pL2c7XG5cdFx0XHRcdFx0dmFyIHJ2YWxpZHRva2VucyA9IC9cIlteXCJcXFxcXFxuXFxyXSpcInx0cnVlfGZhbHNlfG51bGx8LT9cXGQrKD86XFwuXFxkKik/KD86W2VFXVsrXFwtXT9cXGQrKT8vZztcblx0XHRcdFx0XHR2YXIgcnZhbGlkYnJhY2VzID0gLyg/Ol58OnwsKSg/OlxccypcXFspKy9nO1xuXHRcdFx0XHRcdHZhciBydHJpbUxlZnQgPSAvXlxccysvO1xuXHRcdFx0XHRcdHZhciBydHJpbVJpZ2h0ID0gL1xccyskLztcblxuXHRcdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcGFyc2Vqc29uKGRhdGEpIHtcblx0XHRcdFx0XHRcdGlmICgnc3RyaW5nJyAhPSB0eXBlb2YgZGF0YSB8fCAhZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZGF0YSA9IGRhdGEucmVwbGFjZShydHJpbUxlZnQsICcnKS5yZXBsYWNlKHJ0cmltUmlnaHQsICcnKTtcblxuXHRcdFx0XHRcdFx0Ly8gQXR0ZW1wdCB0byBwYXJzZSB1c2luZyB0aGUgbmF0aXZlIEpTT04gcGFyc2VyIGZpcnN0XG5cdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLkpTT04gJiYgSlNPTi5wYXJzZSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHJ2YWxpZGNoYXJzLnRlc3QoZGF0YS5yZXBsYWNlKHJ2YWxpZGVzY2FwZSwgJ0AnKVxuXHRcdFx0XHRcdFx0XHRcdC5yZXBsYWNlKHJ2YWxpZHRva2VucywgJ10nKVxuXHRcdFx0XHRcdFx0XHRcdC5yZXBsYWNlKHJ2YWxpZGJyYWNlcywgJycpKSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gKG5ldyBGdW5jdGlvbigncmV0dXJuICcgKyBkYXRhKSkoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQyNzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENvbXBpbGVzIGEgcXVlcnlzdHJpbmdcblx0XHRcdFx0ICogUmV0dXJucyBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdFxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH1cblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuZW5jb2RlID0gZnVuY3Rpb24gKG9iaikge1xuXHRcdFx0XHRcdHZhciBzdHIgPSAnJztcblxuXHRcdFx0XHRcdGZvciAodmFyIGkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRpZiAob2JqLmhhc093blByb3BlcnR5KGkpKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChzdHIubGVuZ3RoKSBzdHIgKz0gJyYnO1xuXHRcdFx0XHRcdFx0XHRzdHIgKz0gZW5jb2RlVVJJQ29tcG9uZW50KGkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG9ialtpXSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHN0cjtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUGFyc2VzIGEgc2ltcGxlIHF1ZXJ5c3RyaW5nIGludG8gYW4gb2JqZWN0XG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBxc1xuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZXhwb3J0cy5kZWNvZGUgPSBmdW5jdGlvbiAocXMpIHtcblx0XHRcdFx0XHR2YXIgcXJ5ID0ge307XG5cdFx0XHRcdFx0dmFyIHBhaXJzID0gcXMuc3BsaXQoJyYnKTtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMCwgbCA9IHBhaXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHRcdFx0XHRcdFx0dmFyIHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuXHRcdFx0XHRcdFx0cXJ5W2RlY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBxcnk7XG5cdFx0XHRcdH07XG5cblx0XHRcdH0sIHt9XSxcblx0XHRcdDI4OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUGFyc2VzIGFuIFVSSVxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXV0aG9yIFN0ZXZlbiBMZXZpdGhhbiA8c3RldmVubGV2aXRoYW4uY29tPiAoTUlUIGxpY2Vuc2UpXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgcmUgPSAvXig/Oig/IVteOkBdKzpbXjpAXFwvXSpAKShodHRwfGh0dHBzfHdzfHdzcyk6XFwvXFwvKT8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLztcblxuXHRcdFx0XHR2YXIgcGFydHMgPSBbXG5cdFx0XHRcdFx0J3NvdXJjZScsICdwcm90b2NvbCcsICdhdXRob3JpdHknLCAndXNlckluZm8nLCAndXNlcicsICdwYXNzd29yZCcsICdob3N0JywgJ3BvcnQnLCAncmVsYXRpdmUnLCAncGF0aCcsICdkaXJlY3RvcnknLCAnZmlsZScsICdxdWVyeScsICdhbmNob3InXG5cdFx0XHRcdF07XG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYXJzZXVyaShzdHIpIHtcblx0XHRcdFx0XHR2YXIgc3JjID0gc3RyLFxuXHRcdFx0XHRcdFx0YiA9IHN0ci5pbmRleE9mKCdbJyksXG5cdFx0XHRcdFx0XHRlID0gc3RyLmluZGV4T2YoJ10nKTtcblxuXHRcdFx0XHRcdGlmIChiICE9IC0xICYmIGUgIT0gLTEpIHtcblx0XHRcdFx0XHRcdHN0ciA9IHN0ci5zdWJzdHJpbmcoMCwgYikgKyBzdHIuc3Vic3RyaW5nKGIsIGUpLnJlcGxhY2UoLzovZywgJzsnKSArIHN0ci5zdWJzdHJpbmcoZSwgc3RyLmxlbmd0aCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIG0gPSByZS5leGVjKHN0ciB8fCAnJyksXG5cdFx0XHRcdFx0XHR1cmkgPSB7fSxcblx0XHRcdFx0XHRcdGkgPSAxNDtcblxuXHRcdFx0XHRcdHdoaWxlIChpLS0pIHtcblx0XHRcdFx0XHRcdHVyaVtwYXJ0c1tpXV0gPSBtW2ldIHx8ICcnO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChiICE9IC0xICYmIGUgIT0gLTEpIHtcblx0XHRcdFx0XHRcdHVyaS5zb3VyY2UgPSBzcmM7XG5cdFx0XHRcdFx0XHR1cmkuaG9zdCA9IHVyaS5ob3N0LnN1YnN0cmluZygxLCB1cmkuaG9zdC5sZW5ndGggLSAxKS5yZXBsYWNlKC87L2csICc6Jyk7XG5cdFx0XHRcdFx0XHR1cmkuYXV0aG9yaXR5ID0gdXJpLmF1dGhvcml0eS5yZXBsYWNlKCdbJywgJycpLnJlcGxhY2UoJ10nLCAnJykucmVwbGFjZSgvOy9nLCAnOicpO1xuXHRcdFx0XHRcdFx0dXJpLmlwdjZ1cmkgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiB1cmk7XG5cdFx0XHRcdH07XG5cblx0XHRcdH0sIHt9XSxcblx0XHRcdDI5OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXHRcdFx0XHRcdC8qISBodHRwczovL210aHMuYmUvdXRmOGpzIHYyLjAuMCBieSBAbWF0aGlhcyAqL1xuXHRcdFx0XHRcdDtcblx0XHRcdFx0XHQoZnVuY3Rpb24gKHJvb3QpIHtcblxuXHRcdFx0XHRcdFx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGVzIGBleHBvcnRzYFxuXHRcdFx0XHRcdFx0dmFyIGZyZWVFeHBvcnRzID0gdHlwZW9mIGV4cG9ydHMgPT0gJ29iamVjdCcgJiYgZXhwb3J0cztcblxuXHRcdFx0XHRcdFx0Ly8gRGV0ZWN0IGZyZWUgdmFyaWFibGUgYG1vZHVsZWBcblx0XHRcdFx0XHRcdHZhciBmcmVlTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUgJiZcblx0XHRcdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMgJiYgbW9kdWxlO1xuXG5cdFx0XHRcdFx0XHQvLyBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgZ2xvYmFsYCwgZnJvbSBOb2RlLmpzIG9yIEJyb3dzZXJpZmllZCBjb2RlLFxuXHRcdFx0XHRcdFx0Ly8gYW5kIHVzZSBpdCBhcyBgcm9vdGBcblx0XHRcdFx0XHRcdHZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7XG5cdFx0XHRcdFx0XHRpZiAoZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHwgZnJlZUdsb2JhbC53aW5kb3cgPT09IGZyZWVHbG9iYWwpIHtcblx0XHRcdFx0XHRcdFx0cm9vdCA9IGZyZWVHbG9iYWw7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0XHR2YXIgc3RyaW5nRnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTtcblxuXHRcdFx0XHRcdFx0Ly8gVGFrZW4gZnJvbSBodHRwczovL210aHMuYmUvcHVueWNvZGVcblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBvdXRwdXQgPSBbXTtcblx0XHRcdFx0XHRcdFx0dmFyIGNvdW50ZXIgPSAwO1xuXHRcdFx0XHRcdFx0XHR2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0dmFyIHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR2YXIgZXh0cmE7XG5cdFx0XHRcdFx0XHRcdHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA+PSAweEQ4MDAgJiYgdmFsdWUgPD0gMHhEQkZGICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGhpZ2ggc3Vycm9nYXRlLCBhbmQgdGhlcmUgaXMgYSBuZXh0IGNoYXJhY3RlclxuXHRcdFx0XHRcdFx0XHRcdFx0ZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKChleHRyYSAmIDB4RkMwMCkgPT0gMHhEQzAwKSB7IC8vIGxvdyBzdXJyb2dhdGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0b3V0cHV0LnB1c2goKCh2YWx1ZSAmIDB4M0ZGKSA8PCAxMCkgKyAoZXh0cmEgJiAweDNGRikgKyAweDEwMDAwKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlIHRoZSBuZXh0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNvZGUgdW5pdCBpcyB0aGUgaGlnaCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRvdXRwdXQucHVzaCh2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvdW50ZXItLTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0b3V0cHV0LnB1c2godmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gb3V0cHV0O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBUYWtlbiBmcm9tIGh0dHBzOi8vbXRocy5iZS9wdW55Y29kZVxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gdWNzMmVuY29kZShhcnJheSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHR2YXIgaW5kZXggPSAtMTtcblx0XHRcdFx0XHRcdFx0dmFyIHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR2YXIgb3V0cHV0ID0gJyc7XG5cdFx0XHRcdFx0XHRcdHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBhcnJheVtpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID4gMHhGRkZGKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSAtPSAweDEwMDAwO1xuXHRcdFx0XHRcdFx0XHRcdFx0b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IDB4REMwMCB8IHZhbHVlICYgMHgzRkY7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJldHVybiBvdXRwdXQ7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGNoZWNrU2NhbGFyVmFsdWUoY29kZVBvaW50KSB7XG5cdFx0XHRcdFx0XHRcdGlmIChjb2RlUG9pbnQgPj0gMHhEODAwICYmIGNvZGVQb2ludCA8PSAweERGRkYpIHtcblx0XHRcdFx0XHRcdFx0XHR0aHJvdyBFcnJvcihcblx0XHRcdFx0XHRcdFx0XHRcdCdMb25lIHN1cnJvZ2F0ZSBVKycgKyBjb2RlUG9pbnQudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCkgK1xuXHRcdFx0XHRcdFx0XHRcdFx0JyBpcyBub3QgYSBzY2FsYXIgdmFsdWUnXG5cdFx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGNyZWF0ZUJ5dGUoY29kZVBvaW50LCBzaGlmdCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gc3RyaW5nRnJvbUNoYXJDb2RlKCgoY29kZVBvaW50ID4+IHNoaWZ0KSAmIDB4M0YpIHwgMHg4MCk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIGVuY29kZUNvZGVQb2ludChjb2RlUG9pbnQpIHtcblx0XHRcdFx0XHRcdFx0aWYgKChjb2RlUG9pbnQgJiAweEZGRkZGRjgwKSA9PSAwKSB7IC8vIDEtYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBzdHJpbmdGcm9tQ2hhckNvZGUoY29kZVBvaW50KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR2YXIgc3ltYm9sID0gJyc7XG5cdFx0XHRcdFx0XHRcdGlmICgoY29kZVBvaW50ICYgMHhGRkZGRjgwMCkgPT0gMCkgeyAvLyAyLWJ5dGUgc2VxdWVuY2Vcblx0XHRcdFx0XHRcdFx0XHRzeW1ib2wgPSBzdHJpbmdGcm9tQ2hhckNvZGUoKChjb2RlUG9pbnQgPj4gNikgJiAweDFGKSB8IDB4QzApO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKChjb2RlUG9pbnQgJiAweEZGRkYwMDAwKSA9PSAwKSB7IC8vIDMtYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0XHRcdFx0XHRcdGNoZWNrU2NhbGFyVmFsdWUoY29kZVBvaW50KTtcblx0XHRcdFx0XHRcdFx0XHRzeW1ib2wgPSBzdHJpbmdGcm9tQ2hhckNvZGUoKChjb2RlUG9pbnQgPj4gMTIpICYgMHgwRikgfCAweEUwKTtcblx0XHRcdFx0XHRcdFx0XHRzeW1ib2wgKz0gY3JlYXRlQnl0ZShjb2RlUG9pbnQsIDYpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKChjb2RlUG9pbnQgJiAweEZGRTAwMDAwKSA9PSAwKSB7IC8vIDQtYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0XHRcdFx0XHRcdHN5bWJvbCA9IHN0cmluZ0Zyb21DaGFyQ29kZSgoKGNvZGVQb2ludCA+PiAxOCkgJiAweDA3KSB8IDB4RjApO1xuXHRcdFx0XHRcdFx0XHRcdHN5bWJvbCArPSBjcmVhdGVCeXRlKGNvZGVQb2ludCwgMTIpO1xuXHRcdFx0XHRcdFx0XHRcdHN5bWJvbCArPSBjcmVhdGVCeXRlKGNvZGVQb2ludCwgNik7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0c3ltYm9sICs9IHN0cmluZ0Zyb21DaGFyQ29kZSgoY29kZVBvaW50ICYgMHgzRikgfCAweDgwKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHN5bWJvbDtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gdXRmOGVuY29kZShzdHJpbmcpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGNvZGVQb2ludHMgPSB1Y3MyZGVjb2RlKHN0cmluZyk7XG5cdFx0XHRcdFx0XHRcdHZhciBsZW5ndGggPSBjb2RlUG9pbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0dmFyIGluZGV4ID0gLTE7XG5cdFx0XHRcdFx0XHRcdHZhciBjb2RlUG9pbnQ7XG5cdFx0XHRcdFx0XHRcdHZhciBieXRlU3RyaW5nID0gJyc7XG5cdFx0XHRcdFx0XHRcdHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29kZVBvaW50ID0gY29kZVBvaW50c1tpbmRleF07XG5cdFx0XHRcdFx0XHRcdFx0Ynl0ZVN0cmluZyArPSBlbmNvZGVDb2RlUG9pbnQoY29kZVBvaW50KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYnl0ZVN0cmluZztcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHJlYWRDb250aW51YXRpb25CeXRlKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoYnl0ZUluZGV4ID49IGJ5dGVDb3VudCkge1xuXHRcdFx0XHRcdFx0XHRcdHRocm93IEVycm9yKCdJbnZhbGlkIGJ5dGUgaW5kZXgnKTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdHZhciBjb250aW51YXRpb25CeXRlID0gYnl0ZUFycmF5W2J5dGVJbmRleF0gJiAweEZGO1xuXHRcdFx0XHRcdFx0XHRieXRlSW5kZXgrKztcblxuXHRcdFx0XHRcdFx0XHRpZiAoKGNvbnRpbnVhdGlvbkJ5dGUgJiAweEMwKSA9PSAweDgwKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbnRpbnVhdGlvbkJ5dGUgJiAweDNGO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0Ly8gSWYgd2UgZW5kIHVwIGhlcmUsIGl04oCZcyBub3QgYSBjb250aW51YXRpb24gYnl0ZVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBjb250aW51YXRpb24gYnl0ZScpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBkZWNvZGVTeW1ib2woKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBieXRlMTtcblx0XHRcdFx0XHRcdFx0dmFyIGJ5dGUyO1xuXHRcdFx0XHRcdFx0XHR2YXIgYnl0ZTM7XG5cdFx0XHRcdFx0XHRcdHZhciBieXRlNDtcblx0XHRcdFx0XHRcdFx0dmFyIGNvZGVQb2ludDtcblxuXHRcdFx0XHRcdFx0XHRpZiAoYnl0ZUluZGV4ID4gYnl0ZUNvdW50KSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgYnl0ZSBpbmRleCcpO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKGJ5dGVJbmRleCA9PSBieXRlQ291bnQpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyBSZWFkIGZpcnN0IGJ5dGVcblx0XHRcdFx0XHRcdFx0Ynl0ZTEgPSBieXRlQXJyYXlbYnl0ZUluZGV4XSAmIDB4RkY7XG5cdFx0XHRcdFx0XHRcdGJ5dGVJbmRleCsrO1xuXG5cdFx0XHRcdFx0XHRcdC8vIDEtYnl0ZSBzZXF1ZW5jZSAobm8gY29udGludWF0aW9uIGJ5dGVzKVxuXHRcdFx0XHRcdFx0XHRpZiAoKGJ5dGUxICYgMHg4MCkgPT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBieXRlMTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIDItYnl0ZSBzZXF1ZW5jZVxuXHRcdFx0XHRcdFx0XHRpZiAoKGJ5dGUxICYgMHhFMCkgPT0gMHhDMCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBieXRlMiA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0Y29kZVBvaW50ID0gKChieXRlMSAmIDB4MUYpIDw8IDYpIHwgYnl0ZTI7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvZGVQb2ludCA+PSAweDgwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gY29kZVBvaW50O1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aHJvdyBFcnJvcignSW52YWxpZCBjb250aW51YXRpb24gYnl0ZScpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIDMtYnl0ZSBzZXF1ZW5jZSAobWF5IGluY2x1ZGUgdW5wYWlyZWQgc3Vycm9nYXRlcylcblx0XHRcdFx0XHRcdFx0aWYgKChieXRlMSAmIDB4RjApID09IDB4RTApIHtcblx0XHRcdFx0XHRcdFx0XHRieXRlMiA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0Ynl0ZTMgPSByZWFkQ29udGludWF0aW9uQnl0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdGNvZGVQb2ludCA9ICgoYnl0ZTEgJiAweDBGKSA8PCAxMikgfCAoYnl0ZTIgPDwgNikgfCBieXRlMztcblx0XHRcdFx0XHRcdFx0XHRpZiAoY29kZVBvaW50ID49IDB4MDgwMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y2hlY2tTY2FsYXJWYWx1ZShjb2RlUG9pbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvZGVQb2ludDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgY29udGludWF0aW9uIGJ5dGUnKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyA0LWJ5dGUgc2VxdWVuY2Vcblx0XHRcdFx0XHRcdFx0aWYgKChieXRlMSAmIDB4RjgpID09IDB4RjApIHtcblx0XHRcdFx0XHRcdFx0XHRieXRlMiA9IHJlYWRDb250aW51YXRpb25CeXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0Ynl0ZTMgPSByZWFkQ29udGludWF0aW9uQnl0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdGJ5dGU0ID0gcmVhZENvbnRpbnVhdGlvbkJ5dGUoKTtcblx0XHRcdFx0XHRcdFx0XHRjb2RlUG9pbnQgPSAoKGJ5dGUxICYgMHgwRikgPDwgMHgxMikgfCAoYnl0ZTIgPDwgMHgwQykgfFxuXHRcdFx0XHRcdFx0XHRcdFx0KGJ5dGUzIDw8IDB4MDYpIHwgYnl0ZTQ7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvZGVQb2ludCA+PSAweDAxMDAwMCAmJiBjb2RlUG9pbnQgPD0gMHgxMEZGRkYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBjb2RlUG9pbnQ7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0dGhyb3cgRXJyb3IoJ0ludmFsaWQgVVRGLTggZGV0ZWN0ZWQnKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIGJ5dGVBcnJheTtcblx0XHRcdFx0XHRcdHZhciBieXRlQ291bnQ7XG5cdFx0XHRcdFx0XHR2YXIgYnl0ZUluZGV4O1xuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiB1dGY4ZGVjb2RlKGJ5dGVTdHJpbmcpIHtcblx0XHRcdFx0XHRcdFx0Ynl0ZUFycmF5ID0gdWNzMmRlY29kZShieXRlU3RyaW5nKTtcblx0XHRcdFx0XHRcdFx0Ynl0ZUNvdW50ID0gYnl0ZUFycmF5Lmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0Ynl0ZUluZGV4ID0gMDtcblx0XHRcdFx0XHRcdFx0dmFyIGNvZGVQb2ludHMgPSBbXTtcblx0XHRcdFx0XHRcdFx0dmFyIHRtcDtcblx0XHRcdFx0XHRcdFx0d2hpbGUgKCh0bXAgPSBkZWNvZGVTeW1ib2woKSkgIT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29kZVBvaW50cy5wdXNoKHRtcCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIHVjczJlbmNvZGUoY29kZVBvaW50cyk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0XHRcdFx0XHR2YXIgdXRmOCA9IHtcblx0XHRcdFx0XHRcdFx0J3ZlcnNpb24nOiAnMi4wLjAnLFxuXHRcdFx0XHRcdFx0XHQnZW5jb2RlJzogdXRmOGVuY29kZSxcblx0XHRcdFx0XHRcdFx0J2RlY29kZSc6IHV0ZjhkZWNvZGVcblx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdC8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJuc1xuXHRcdFx0XHRcdFx0Ly8gbGlrZSB0aGUgZm9sbG93aW5nOlxuXHRcdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0XHR0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiZcblx0XHRcdFx0XHRcdFx0dHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiZcblx0XHRcdFx0XHRcdFx0ZGVmaW5lLmFtZFxuXHRcdFx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0XHRcdGRlZmluZShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHV0Zjg7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiAhZnJlZUV4cG9ydHMubm9kZVR5cGUpIHtcblx0XHRcdFx0XHRcdFx0aWYgKGZyZWVNb2R1bGUpIHsgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTIHYwLjguMCtcblx0XHRcdFx0XHRcdFx0XHRmcmVlTW9kdWxlLmV4cG9ydHMgPSB1dGY4O1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgeyAvLyBpbiBOYXJ3aGFsIG9yIFJpbmdvSlMgdjAuNy4wLVxuXHRcdFx0XHRcdFx0XHRcdHZhciBvYmplY3QgPSB7fTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3QuaGFzT3duUHJvcGVydHk7XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIga2V5IGluIHV0ZjgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGhhc093blByb3BlcnR5LmNhbGwodXRmOCwga2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHV0Zjhba2V5XSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2UgeyAvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyXG5cdFx0XHRcdFx0XHRcdHJvb3QudXRmOCA9IHV0Zjg7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR9KHRoaXMpKTtcblxuXHRcdFx0XHR9KS5jYWxsKHRoaXMsIHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDoge30pXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQzMDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0J3VzZSBzdHJpY3QnO1xuXG5cdFx0XHRcdHZhciBhbHBoYWJldCA9ICcwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ei1fJy5zcGxpdCgnJyksXG5cdFx0XHRcdFx0bGVuZ3RoID0gNjQsXG5cdFx0XHRcdFx0bWFwID0ge30sXG5cdFx0XHRcdFx0c2VlZCA9IDAsXG5cdFx0XHRcdFx0aSA9IDAsXG5cdFx0XHRcdFx0cHJldjtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgc3BlY2lmaWVkIG51bWJlci5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtOdW1iZXJ9IG51bSBUaGUgbnVtYmVyIHRvIGNvbnZlcnQuXG5cdFx0XHRcdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG51bWJlci5cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cdFx0XHRcdGZ1bmN0aW9uIGVuY29kZShudW0pIHtcblx0XHRcdFx0XHR2YXIgZW5jb2RlZCA9ICcnO1xuXG5cdFx0XHRcdFx0ZG8ge1xuXHRcdFx0XHRcdFx0ZW5jb2RlZCA9IGFscGhhYmV0W251bSAlIGxlbmd0aF0gKyBlbmNvZGVkO1xuXHRcdFx0XHRcdFx0bnVtID0gTWF0aC5mbG9vcihudW0gLyBsZW5ndGgpO1xuXHRcdFx0XHRcdH0gd2hpbGUgKG51bSA+IDApO1xuXG5cdFx0XHRcdFx0cmV0dXJuIGVuY29kZWQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUmV0dXJuIHRoZSBpbnRlZ2VyIHZhbHVlIHNwZWNpZmllZCBieSB0aGUgZ2l2ZW4gc3RyaW5nLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBzdHJpbmcgdG8gY29udmVydC5cblx0XHRcdFx0ICogQHJldHVybnMge051bWJlcn0gVGhlIGludGVnZXIgdmFsdWUgcmVwcmVzZW50ZWQgYnkgdGhlIHN0cmluZy5cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cdFx0XHRcdGZ1bmN0aW9uIGRlY29kZShzdHIpIHtcblx0XHRcdFx0XHR2YXIgZGVjb2RlZCA9IDA7XG5cblx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRkZWNvZGVkID0gZGVjb2RlZCAqIGxlbmd0aCArIG1hcFtzdHIuY2hhckF0KGkpXTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gZGVjb2RlZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBZZWFzdDogQSB0aW55IGdyb3dpbmcgaWQgZ2VuZXJhdG9yLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcmV0dXJucyB7U3RyaW5nfSBBIHVuaXF1ZSBpZC5cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cdFx0XHRcdGZ1bmN0aW9uIHllYXN0KCkge1xuXHRcdFx0XHRcdHZhciBub3cgPSBlbmNvZGUoK25ldyBEYXRlKCkpO1xuXG5cdFx0XHRcdFx0aWYgKG5vdyAhPT0gcHJldikgcmV0dXJuIHNlZWQgPSAwLCBwcmV2ID0gbm93O1xuXHRcdFx0XHRcdHJldHVybiBub3cgKyAnLicgKyBlbmNvZGUoc2VlZCsrKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vXG5cdFx0XHRcdC8vIE1hcCBlYWNoIGNoYXJhY3RlciB0byBpdHMgaW5kZXguXG5cdFx0XHRcdC8vXG5cdFx0XHRcdGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIG1hcFthbHBoYWJldFtpXV0gPSBpO1xuXG5cdFx0XHRcdC8vXG5cdFx0XHRcdC8vIEV4cG9zZSB0aGUgYHllYXN0YCwgYGVuY29kZWAgYW5kIGBkZWNvZGVgIGZ1bmN0aW9ucy5cblx0XHRcdFx0Ly9cblx0XHRcdFx0eWVhc3QuZW5jb2RlID0gZW5jb2RlO1xuXHRcdFx0XHR5ZWFzdC5kZWNvZGUgPSBkZWNvZGU7XG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0geWVhc3Q7XG5cblx0XHRcdH0sIHt9XSxcblx0XHRcdDMxOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgdXJsID0gX2RlcmVxXygnLi91cmwnKTtcblx0XHRcdFx0dmFyIHBhcnNlciA9IF9kZXJlcV8oJ3NvY2tldC5pby1wYXJzZXInKTtcblx0XHRcdFx0dmFyIE1hbmFnZXIgPSBfZGVyZXFfKCcuL21hbmFnZXInKTtcblx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnc29ja2V0LmlvLWNsaWVudCcpO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNb2R1bGUgZXhwb3J0cy5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzID0gbG9va3VwO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNYW5hZ2VycyBjYWNoZS5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0dmFyIGNhY2hlID0gZXhwb3J0cy5tYW5hZ2VycyA9IHt9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBMb29rcyB1cCBhbiBleGlzdGluZyBgTWFuYWdlcmAgZm9yIG11bHRpcGxleGluZy5cblx0XHRcdFx0ICogSWYgdGhlIHVzZXIgc3VtbW9uczpcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogICBgaW8oJ2h0dHA6Ly9sb2NhbGhvc3QvYScpO2Bcblx0XHRcdFx0ICogICBgaW8oJ2h0dHA6Ly9sb2NhbGhvc3QvYicpO2Bcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogV2UgcmV1c2UgdGhlIGV4aXN0aW5nIGluc3RhbmNlIGJhc2VkIG9uIHNhbWUgc2NoZW1lL3BvcnQvaG9zdCxcblx0XHRcdFx0ICogYW5kIHdlIGluaXRpYWxpemUgc29ja2V0cyBmb3IgZWFjaCBuYW1lc3BhY2UuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIGxvb2t1cCh1cmksIG9wdHMpIHtcblx0XHRcdFx0XHRpZiAodHlwZW9mIHVyaSA9PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRcdFx0b3B0cyA9IHVyaTtcblx0XHRcdFx0XHRcdHVyaSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRvcHRzID0gb3B0cyB8fCB7fTtcblxuXHRcdFx0XHRcdHZhciBwYXJzZWQgPSB1cmwodXJpKTtcblx0XHRcdFx0XHR2YXIgc291cmNlID0gcGFyc2VkLnNvdXJjZTtcblx0XHRcdFx0XHR2YXIgaWQgPSBwYXJzZWQuaWQ7XG5cdFx0XHRcdFx0dmFyIHBhdGggPSBwYXJzZWQucGF0aDtcblx0XHRcdFx0XHR2YXIgc2FtZU5hbWVzcGFjZSA9IGNhY2hlW2lkXSAmJiBwYXRoIGluIGNhY2hlW2lkXS5uc3BzO1xuXHRcdFx0XHRcdHZhciBuZXdDb25uZWN0aW9uID0gb3B0cy5mb3JjZU5ldyB8fCBvcHRzWydmb3JjZSBuZXcgY29ubmVjdGlvbiddIHx8XG5cdFx0XHRcdFx0XHRmYWxzZSA9PT0gb3B0cy5tdWx0aXBsZXggfHwgc2FtZU5hbWVzcGFjZTtcblxuXHRcdFx0XHRcdHZhciBpbztcblxuXHRcdFx0XHRcdGlmIChuZXdDb25uZWN0aW9uKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygnaWdub3Jpbmcgc29ja2V0IGNhY2hlIGZvciAlcycsIHNvdXJjZSk7XG5cdFx0XHRcdFx0XHRpbyA9IE1hbmFnZXIoc291cmNlLCBvcHRzKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYgKCFjYWNoZVtpZF0pIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ25ldyBpbyBpbnN0YW5jZSBmb3IgJXMnLCBzb3VyY2UpO1xuXHRcdFx0XHRcdFx0XHRjYWNoZVtpZF0gPSBNYW5hZ2VyKHNvdXJjZSwgb3B0cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpbyA9IGNhY2hlW2lkXTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gaW8uc29ja2V0KHBhcnNlZC5wYXRoKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQcm90b2NvbCB2ZXJzaW9uLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRleHBvcnRzLnByb3RvY29sID0gcGFyc2VyLnByb3RvY29sO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBgY29ubmVjdGAuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSB1cmlcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZXhwb3J0cy5jb25uZWN0ID0gbG9va3VwO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBFeHBvc2UgY29uc3RydWN0b3JzIGZvciBzdGFuZGFsb25lIGJ1aWxkLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRleHBvcnRzLk1hbmFnZXIgPSBfZGVyZXFfKCcuL21hbmFnZXInKTtcblx0XHRcdFx0ZXhwb3J0cy5Tb2NrZXQgPSBfZGVyZXFfKCcuL3NvY2tldCcpO1xuXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiLi9tYW5hZ2VyXCI6IDMyLFxuXHRcdFx0XHRcIi4vc29ja2V0XCI6IDM0LFxuXHRcdFx0XHRcIi4vdXJsXCI6IDM1LFxuXHRcdFx0XHRcImRlYnVnXCI6IDM5LFxuXHRcdFx0XHRcInNvY2tldC5pby1wYXJzZXJcIjogNDdcblx0XHRcdH1dLFxuXHRcdFx0MzI6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdHZhciBlaW8gPSBfZGVyZXFfKCdlbmdpbmUuaW8tY2xpZW50Jyk7XG5cdFx0XHRcdHZhciBTb2NrZXQgPSBfZGVyZXFfKCcuL3NvY2tldCcpO1xuXHRcdFx0XHR2YXIgRW1pdHRlciA9IF9kZXJlcV8oJ2NvbXBvbmVudC1lbWl0dGVyJyk7XG5cdFx0XHRcdHZhciBwYXJzZXIgPSBfZGVyZXFfKCdzb2NrZXQuaW8tcGFyc2VyJyk7XG5cdFx0XHRcdHZhciBvbiA9IF9kZXJlcV8oJy4vb24nKTtcblx0XHRcdFx0dmFyIGJpbmQgPSBfZGVyZXFfKCdjb21wb25lbnQtYmluZCcpO1xuXHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdzb2NrZXQuaW8tY2xpZW50Om1hbmFnZXInKTtcblx0XHRcdFx0dmFyIGluZGV4T2YgPSBfZGVyZXFfKCdpbmRleG9mJyk7XG5cdFx0XHRcdHZhciBCYWNrb2ZmID0gX2RlcmVxXygnYmFja28yJyk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIElFNisgaGFzT3duUHJvcGVydHlcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0dmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gTWFuYWdlcjtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogYE1hbmFnZXJgIGNvbnN0cnVjdG9yLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gZW5naW5lIGluc3RhbmNlIG9yIGVuZ2luZSB1cmkvb3B0c1xuXHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBNYW5hZ2VyKHVyaSwgb3B0cykge1xuXHRcdFx0XHRcdGlmICghKHRoaXMgaW5zdGFuY2VvZiBNYW5hZ2VyKSkgcmV0dXJuIG5ldyBNYW5hZ2VyKHVyaSwgb3B0cyk7XG5cdFx0XHRcdFx0aWYgKHVyaSAmJiAoJ29iamVjdCcgPT0gdHlwZW9mIHVyaSkpIHtcblx0XHRcdFx0XHRcdG9wdHMgPSB1cmk7XG5cdFx0XHRcdFx0XHR1cmkgPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdG9wdHMgPSBvcHRzIHx8IHt9O1xuXG5cdFx0XHRcdFx0b3B0cy5wYXRoID0gb3B0cy5wYXRoIHx8ICcvc29ja2V0LmlvJztcblx0XHRcdFx0XHR0aGlzLm5zcHMgPSB7fTtcblx0XHRcdFx0XHR0aGlzLnN1YnMgPSBbXTtcblx0XHRcdFx0XHR0aGlzLm9wdHMgPSBvcHRzO1xuXHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW9uKG9wdHMucmVjb25uZWN0aW9uICE9PSBmYWxzZSk7XG5cdFx0XHRcdFx0dGhpcy5yZWNvbm5lY3Rpb25BdHRlbXB0cyhvcHRzLnJlY29ubmVjdGlvbkF0dGVtcHRzIHx8IEluZmluaXR5KTtcblx0XHRcdFx0XHR0aGlzLnJlY29ubmVjdGlvbkRlbGF5KG9wdHMucmVjb25uZWN0aW9uRGVsYXkgfHwgMTAwMCk7XG5cdFx0XHRcdFx0dGhpcy5yZWNvbm5lY3Rpb25EZWxheU1heChvcHRzLnJlY29ubmVjdGlvbkRlbGF5TWF4IHx8IDUwMDApO1xuXHRcdFx0XHRcdHRoaXMucmFuZG9taXphdGlvbkZhY3RvcihvcHRzLnJhbmRvbWl6YXRpb25GYWN0b3IgfHwgMC41KTtcblx0XHRcdFx0XHR0aGlzLmJhY2tvZmYgPSBuZXcgQmFja29mZih7XG5cdFx0XHRcdFx0XHRtaW46IHRoaXMucmVjb25uZWN0aW9uRGVsYXkoKSxcblx0XHRcdFx0XHRcdG1heDogdGhpcy5yZWNvbm5lY3Rpb25EZWxheU1heCgpLFxuXHRcdFx0XHRcdFx0aml0dGVyOiB0aGlzLnJhbmRvbWl6YXRpb25GYWN0b3IoKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHRoaXMudGltZW91dChudWxsID09IG9wdHMudGltZW91dCA/IDIwMDAwIDogb3B0cy50aW1lb3V0KTtcblx0XHRcdFx0XHR0aGlzLnJlYWR5U3RhdGUgPSAnY2xvc2VkJztcblx0XHRcdFx0XHR0aGlzLnVyaSA9IHVyaTtcblx0XHRcdFx0XHR0aGlzLmNvbm5lY3RpbmcgPSBbXTtcblx0XHRcdFx0XHR0aGlzLmxhc3RQaW5nID0gbnVsbDtcblx0XHRcdFx0XHR0aGlzLmVuY29kaW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5wYWNrZXRCdWZmZXIgPSBbXTtcblx0XHRcdFx0XHR0aGlzLmVuY29kZXIgPSBuZXcgcGFyc2VyLkVuY29kZXIoKTtcblx0XHRcdFx0XHR0aGlzLmRlY29kZXIgPSBuZXcgcGFyc2VyLkRlY29kZXIoKTtcblx0XHRcdFx0XHR0aGlzLmF1dG9Db25uZWN0ID0gb3B0cy5hdXRvQ29ubmVjdCAhPT0gZmFsc2U7XG5cdFx0XHRcdFx0aWYgKHRoaXMuYXV0b0Nvbm5lY3QpIHRoaXMub3BlbigpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFByb3BhZ2F0ZSBnaXZlbiBldmVudCB0byBzb2NrZXRzIGFuZCBlbWl0IG9uIGB0aGlzYFxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUuZW1pdEFsbCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLmVtaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRmb3IgKHZhciBuc3AgaW4gdGhpcy5uc3BzKSB7XG5cdFx0XHRcdFx0XHRpZiAoaGFzLmNhbGwodGhpcy5uc3BzLCBuc3ApKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMubnNwc1tuc3BdLmVtaXQuYXBwbHkodGhpcy5uc3BzW25zcF0sIGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBVcGRhdGUgYHNvY2tldC5pZGAgb2YgYWxsIHNvY2tldHNcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZVNvY2tldElkcyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRmb3IgKHZhciBuc3AgaW4gdGhpcy5uc3BzKSB7XG5cdFx0XHRcdFx0XHRpZiAoaGFzLmNhbGwodGhpcy5uc3BzLCBuc3ApKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMubnNwc1tuc3BdLmlkID0gdGhpcy5lbmdpbmUuaWQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNaXggaW4gYEVtaXR0ZXJgLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRFbWl0dGVyKE1hbmFnZXIucHJvdG90eXBlKTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2V0cyB0aGUgYHJlY29ubmVjdGlvbmAgY29uZmlnLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge0Jvb2xlYW59IHRydWUvZmFsc2UgaWYgaXQgc2hvdWxkIGF1dG9tYXRpY2FsbHkgcmVjb25uZWN0XG5cdFx0XHRcdCAqIEByZXR1cm4ge01hbmFnZXJ9IHNlbGYgb3IgdmFsdWVcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0aW9uID0gZnVuY3Rpb24gKHYpIHtcblx0XHRcdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb247XG5cdFx0XHRcdFx0dGhpcy5fcmVjb25uZWN0aW9uID0gISF2O1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZXRzIHRoZSByZWNvbm5lY3Rpb24gYXR0ZW1wdHMgY29uZmlnLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge051bWJlcn0gbWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0cyBiZWZvcmUgZ2l2aW5nIHVwXG5cdFx0XHRcdCAqIEByZXR1cm4ge01hbmFnZXJ9IHNlbGYgb3IgdmFsdWVcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0aW9uQXR0ZW1wdHMgPSBmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzO1xuXHRcdFx0XHRcdHRoaXMuX3JlY29ubmVjdGlvbkF0dGVtcHRzID0gdjtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2V0cyB0aGUgZGVsYXkgYmV0d2VlbiByZWNvbm5lY3Rpb25zLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge051bWJlcn0gZGVsYXlcblx0XHRcdFx0ICogQHJldHVybiB7TWFuYWdlcn0gc2VsZiBvciB2YWx1ZVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheSA9IGZ1bmN0aW9uICh2KSB7XG5cdFx0XHRcdFx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXk7XG5cdFx0XHRcdFx0dGhpcy5fcmVjb25uZWN0aW9uRGVsYXkgPSB2O1xuXHRcdFx0XHRcdHRoaXMuYmFja29mZiAmJiB0aGlzLmJhY2tvZmYuc2V0TWluKHYpO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnJhbmRvbWl6YXRpb25GYWN0b3IgPSBmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3JhbmRvbWl6YXRpb25GYWN0b3I7XG5cdFx0XHRcdFx0dGhpcy5fcmFuZG9taXphdGlvbkZhY3RvciA9IHY7XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmICYmIHRoaXMuYmFja29mZi5zZXRKaXR0ZXIodik7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFNldHMgdGhlIG1heGltdW0gZGVsYXkgYmV0d2VlbiByZWNvbm5lY3Rpb25zLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge051bWJlcn0gZGVsYXlcblx0XHRcdFx0ICogQHJldHVybiB7TWFuYWdlcn0gc2VsZiBvciB2YWx1ZVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5yZWNvbm5lY3Rpb25EZWxheU1heCA9IGZ1bmN0aW9uICh2KSB7XG5cdFx0XHRcdFx0aWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXg7XG5cdFx0XHRcdFx0dGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXggPSB2O1xuXHRcdFx0XHRcdHRoaXMuYmFja29mZiAmJiB0aGlzLmJhY2tvZmYuc2V0TWF4KHYpO1xuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZXRzIHRoZSBjb25uZWN0aW9uIHRpbWVvdXQuIGBmYWxzZWAgdG8gZGlzYWJsZVxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcmV0dXJuIHtNYW5hZ2VyfSBzZWxmIG9yIHZhbHVlXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnRpbWVvdXQgPSBmdW5jdGlvbiAodikge1xuXHRcdFx0XHRcdGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3RpbWVvdXQ7XG5cdFx0XHRcdFx0dGhpcy5fdGltZW91dCA9IHY7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFN0YXJ0cyB0cnlpbmcgdG8gcmVjb25uZWN0IGlmIHJlY29ubmVjdGlvbiBpcyBlbmFibGVkIGFuZCB3ZSBoYXZlIG5vdFxuXHRcdFx0XHQgKiBzdGFydGVkIHJlY29ubmVjdGluZyB5ZXRcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm1heWJlUmVjb25uZWN0T25PcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdC8vIE9ubHkgdHJ5IHRvIHJlY29ubmVjdCBpZiBpdCdzIHRoZSBmaXJzdCB0aW1lIHdlJ3JlIGNvbm5lY3Rpbmdcblx0XHRcdFx0XHRpZiAoIXRoaXMucmVjb25uZWN0aW5nICYmIHRoaXMuX3JlY29ubmVjdGlvbiAmJiB0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPT09IDApIHtcblx0XHRcdFx0XHRcdC8vIGtlZXBzIHJlY29ubmVjdGlvbiBmcm9tIGZpcmluZyB0d2ljZSBmb3IgdGhlIHNhbWUgcmVjb25uZWN0aW9uIGxvb3Bcblx0XHRcdFx0XHRcdHRoaXMucmVjb25uZWN0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFNldHMgdGhlIGN1cnJlbnQgdHJhbnNwb3J0IGBzb2NrZXRgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25hbCwgY2FsbGJhY2tcblx0XHRcdFx0ICogQHJldHVybiB7TWFuYWdlcn0gc2VsZlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5vcGVuID1cblx0XHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKGZuKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygncmVhZHlTdGF0ZSAlcycsIHRoaXMucmVhZHlTdGF0ZSk7XG5cdFx0XHRcdFx0XHRpZiAofnRoaXMucmVhZHlTdGF0ZS5pbmRleE9mKCdvcGVuJykpIHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdFx0XHRkZWJ1Zygnb3BlbmluZyAlcycsIHRoaXMudXJpKTtcblx0XHRcdFx0XHRcdHRoaXMuZW5naW5lID0gZWlvKHRoaXMudXJpLCB0aGlzLm9wdHMpO1xuXHRcdFx0XHRcdFx0dmFyIHNvY2tldCA9IHRoaXMuZW5naW5lO1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ29wZW5pbmcnO1xuXHRcdFx0XHRcdFx0dGhpcy5za2lwUmVjb25uZWN0ID0gZmFsc2U7XG5cblx0XHRcdFx0XHRcdC8vIGVtaXQgYG9wZW5gXG5cdFx0XHRcdFx0XHR2YXIgb3BlblN1YiA9IG9uKHNvY2tldCwgJ29wZW4nLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYub25vcGVuKCk7XG5cdFx0XHRcdFx0XHRcdGZuICYmIGZuKCk7XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0Ly8gZW1pdCBgY29ubmVjdF9lcnJvcmBcblx0XHRcdFx0XHRcdHZhciBlcnJvclN1YiA9IG9uKHNvY2tldCwgJ2Vycm9yJywgZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2Nvbm5lY3RfZXJyb3InKTtcblx0XHRcdFx0XHRcdFx0c2VsZi5jbGVhbnVwKCk7XG5cdFx0XHRcdFx0XHRcdHNlbGYucmVhZHlTdGF0ZSA9ICdjbG9zZWQnO1xuXHRcdFx0XHRcdFx0XHRzZWxmLmVtaXRBbGwoJ2Nvbm5lY3RfZXJyb3InLCBkYXRhKTtcblx0XHRcdFx0XHRcdFx0aWYgKGZuKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGVyciA9IG5ldyBFcnJvcignQ29ubmVjdGlvbiBlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdGVyci5kYXRhID0gZGF0YTtcblx0XHRcdFx0XHRcdFx0XHRmbihlcnIpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZG8gdGhpcyBpZiB0aGVyZSBpcyBubyBmbiB0byBoYW5kbGUgdGhlIGVycm9yXG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5tYXliZVJlY29ubmVjdE9uT3BlbigpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0Ly8gZW1pdCBgY29ubmVjdF90aW1lb3V0YFxuXHRcdFx0XHRcdFx0aWYgKGZhbHNlICE9PSB0aGlzLl90aW1lb3V0KSB7XG5cdFx0XHRcdFx0XHRcdHZhciB0aW1lb3V0ID0gdGhpcy5fdGltZW91dDtcblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2Nvbm5lY3QgYXR0ZW1wdCB3aWxsIHRpbWVvdXQgYWZ0ZXIgJWQnLCB0aW1lb3V0KTtcblxuXHRcdFx0XHRcdFx0XHQvLyBzZXQgdGltZXJcblx0XHRcdFx0XHRcdFx0dmFyIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ2Nvbm5lY3QgYXR0ZW1wdCB0aW1lZCBvdXQgYWZ0ZXIgJWQnLCB0aW1lb3V0KTtcblx0XHRcdFx0XHRcdFx0XHRvcGVuU3ViLmRlc3Ryb3koKTtcblx0XHRcdFx0XHRcdFx0XHRzb2NrZXQuY2xvc2UoKTtcblx0XHRcdFx0XHRcdFx0XHRzb2NrZXQuZW1pdCgnZXJyb3InLCAndGltZW91dCcpO1xuXHRcdFx0XHRcdFx0XHRcdHNlbGYuZW1pdEFsbCgnY29ubmVjdF90aW1lb3V0JywgdGltZW91dCk7XG5cdFx0XHRcdFx0XHRcdH0sIHRpbWVvdXQpO1xuXG5cdFx0XHRcdFx0XHRcdHRoaXMuc3Vicy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHRkZXN0cm95OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHRoaXMuc3Vicy5wdXNoKG9wZW5TdWIpO1xuXHRcdFx0XHRcdFx0dGhpcy5zdWJzLnB1c2goZXJyb3JTdWIpO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgb3Blbi5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRkZWJ1Zygnb3BlbicpO1xuXG5cdFx0XHRcdFx0Ly8gY2xlYXIgb2xkIHN1YnNcblx0XHRcdFx0XHR0aGlzLmNsZWFudXAoKTtcblxuXHRcdFx0XHRcdC8vIG1hcmsgYXMgb3BlblxuXHRcdFx0XHRcdHRoaXMucmVhZHlTdGF0ZSA9ICdvcGVuJztcblx0XHRcdFx0XHR0aGlzLmVtaXQoJ29wZW4nKTtcblxuXHRcdFx0XHRcdC8vIGFkZCBuZXcgc3Vic1xuXHRcdFx0XHRcdHZhciBzb2NrZXQgPSB0aGlzLmVuZ2luZTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdkYXRhJywgYmluZCh0aGlzLCAnb25kYXRhJykpKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdwaW5nJywgYmluZCh0aGlzLCAnb25waW5nJykpKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdwb25nJywgYmluZCh0aGlzLCAnb25wb25nJykpKTtcblx0XHRcdFx0XHR0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsICdlcnJvcicsIGJpbmQodGhpcywgJ29uZXJyb3InKSkpO1xuXHRcdFx0XHRcdHRoaXMuc3Vicy5wdXNoKG9uKHNvY2tldCwgJ2Nsb3NlJywgYmluZCh0aGlzLCAnb25jbG9zZScpKSk7XG5cdFx0XHRcdFx0dGhpcy5zdWJzLnB1c2gob24odGhpcy5kZWNvZGVyLCAnZGVjb2RlZCcsIGJpbmQodGhpcywgJ29uZGVjb2RlZCcpKSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIGEgcGluZy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm9ucGluZyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLmxhc3RQaW5nID0gbmV3IERhdGU7XG5cdFx0XHRcdFx0dGhpcy5lbWl0QWxsKCdwaW5nJyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIGEgcGFja2V0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25wb25nID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHRoaXMuZW1pdEFsbCgncG9uZycsIG5ldyBEYXRlIC0gdGhpcy5sYXN0UGluZyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB3aXRoIGRhdGEuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5vbmRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHRoaXMuZGVjb2Rlci5hZGQoZGF0YSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB3aGVuIHBhcnNlciBmdWxseSBkZWNvZGVzIGEgcGFja2V0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25kZWNvZGVkID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdHRoaXMuZW1pdCgncGFja2V0JywgcGFja2V0KTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2FsbGVkIHVwb24gc29ja2V0IGVycm9yLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRkZWJ1ZygnZXJyb3InLCBlcnIpO1xuXHRcdFx0XHRcdHRoaXMuZW1pdEFsbCgnZXJyb3InLCBlcnIpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDcmVhdGVzIGEgbmV3IHNvY2tldCBmb3IgdGhlIGdpdmVuIGBuc3BgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcmV0dXJuIHtTb2NrZXR9XG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnNvY2tldCA9IGZ1bmN0aW9uIChuc3ApIHtcblx0XHRcdFx0XHR2YXIgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG5cdFx0XHRcdFx0aWYgKCFzb2NrZXQpIHtcblx0XHRcdFx0XHRcdHNvY2tldCA9IG5ldyBTb2NrZXQodGhpcywgbnNwKTtcblx0XHRcdFx0XHRcdHRoaXMubnNwc1tuc3BdID0gc29ja2V0O1xuXHRcdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0XHRcdFx0c29ja2V0Lm9uKCdjb25uZWN0aW5nJywgb25Db25uZWN0aW5nKTtcblx0XHRcdFx0XHRcdHNvY2tldC5vbignY29ubmVjdCcsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0c29ja2V0LmlkID0gc2VsZi5lbmdpbmUuaWQ7XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0aWYgKHRoaXMuYXV0b0Nvbm5lY3QpIHtcblx0XHRcdFx0XHRcdFx0Ly8gbWFudWFsbHkgY2FsbCBoZXJlIHNpbmNlIGNvbm5lY3RpbmcgZXZuZXQgaXMgZmlyZWQgYmVmb3JlIGxpc3RlbmluZ1xuXHRcdFx0XHRcdFx0XHRvbkNvbm5lY3RpbmcoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRmdW5jdGlvbiBvbkNvbm5lY3RpbmcoKSB7XG5cdFx0XHRcdFx0XHRpZiAoIX5pbmRleE9mKHNlbGYuY29ubmVjdGluZywgc29ja2V0KSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLmNvbm5lY3RpbmcucHVzaChzb2NrZXQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBzb2NrZXQ7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIGEgc29ja2V0IGNsb3NlLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1NvY2tldH0gc29ja2V0XG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoc29ja2V0KSB7XG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gaW5kZXhPZih0aGlzLmNvbm5lY3RpbmcsIHNvY2tldCk7XG5cdFx0XHRcdFx0aWYgKH5pbmRleCkgdGhpcy5jb25uZWN0aW5nLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuY29ubmVjdGluZy5sZW5ndGgpIHJldHVybjtcblxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogV3JpdGVzIGEgcGFja2V0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge09iamVjdH0gcGFja2V0XG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0ZGVidWcoJ3dyaXRpbmcgcGFja2V0ICVqJywgcGFja2V0KTtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdFx0XHRpZiAoIXNlbGYuZW5jb2RpbmcpIHtcblx0XHRcdFx0XHRcdC8vIGVuY29kZSwgdGhlbiB3cml0ZSB0byBlbmdpbmUgd2l0aCByZXN1bHRcblx0XHRcdFx0XHRcdHNlbGYuZW5jb2RpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0dGhpcy5lbmNvZGVyLmVuY29kZShwYWNrZXQsIGZ1bmN0aW9uIChlbmNvZGVkUGFja2V0cykge1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGVuY29kZWRQYWNrZXRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdFx0c2VsZi5lbmdpbmUud3JpdGUoZW5jb2RlZFBhY2tldHNbaV0sIHBhY2tldC5vcHRpb25zKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRzZWxmLmVuY29kaW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdHNlbGYucHJvY2Vzc1BhY2tldFF1ZXVlKCk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2UgeyAvLyBhZGQgcGFja2V0IHRvIHRoZSBxdWV1ZVxuXHRcdFx0XHRcdFx0c2VsZi5wYWNrZXRCdWZmZXIucHVzaChwYWNrZXQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogSWYgcGFja2V0IGJ1ZmZlciBpcyBub24tZW1wdHksIGJlZ2lucyBlbmNvZGluZyB0aGVcblx0XHRcdFx0ICogbmV4dCBwYWNrZXQgaW4gbGluZS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLnByb2Nlc3NQYWNrZXRRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5wYWNrZXRCdWZmZXIubGVuZ3RoID4gMCAmJiAhdGhpcy5lbmNvZGluZykge1xuXHRcdFx0XHRcdFx0dmFyIHBhY2sgPSB0aGlzLnBhY2tldEJ1ZmZlci5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5wYWNrZXQocGFjayk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDbGVhbiB1cCB0cmFuc3BvcnQgc3Vic2NyaXB0aW9ucyBhbmQgcGFja2V0IGJ1ZmZlci5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLmNsZWFudXAgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0ZGVidWcoJ2NsZWFudXAnKTtcblxuXHRcdFx0XHRcdHZhciBzdWI7XG5cdFx0XHRcdFx0d2hpbGUgKHN1YiA9IHRoaXMuc3Vicy5zaGlmdCgpKSBzdWIuZGVzdHJveSgpO1xuXG5cdFx0XHRcdFx0dGhpcy5wYWNrZXRCdWZmZXIgPSBbXTtcblx0XHRcdFx0XHR0aGlzLmVuY29kaW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5sYXN0UGluZyA9IG51bGw7XG5cblx0XHRcdFx0XHR0aGlzLmRlY29kZXIuZGVzdHJveSgpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDbG9zZSB0aGUgY3VycmVudCBzb2NrZXQuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRNYW5hZ2VyLnByb3RvdHlwZS5jbG9zZSA9XG5cdFx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdkaXNjb25uZWN0Jyk7XG5cdFx0XHRcdFx0XHR0aGlzLnNraXBSZWNvbm5lY3QgPSB0cnVlO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWNvbm5lY3RpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGlmICgnb3BlbmluZycgPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIGBvbmNsb3NlYCB3aWxsIG5vdCBmaXJlIGJlY2F1c2Vcblx0XHRcdFx0XHRcdFx0Ly8gYW4gb3BlbiBldmVudCBuZXZlciBoYXBwZW5lZFxuXHRcdFx0XHRcdFx0XHR0aGlzLmNsZWFudXAoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHRoaXMuYmFja29mZi5yZXNldCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ2Nsb3NlZCc7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5lbmdpbmUpIHRoaXMuZW5naW5lLmNsb3NlKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2FsbGVkIHVwb24gZW5naW5lIGNsb3NlLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUub25jbG9zZSA9IGZ1bmN0aW9uIChyZWFzb24pIHtcblx0XHRcdFx0XHRkZWJ1Zygnb25jbG9zZScpO1xuXG5cdFx0XHRcdFx0dGhpcy5jbGVhbnVwKCk7XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmLnJlc2V0KCk7XG5cdFx0XHRcdFx0dGhpcy5yZWFkeVN0YXRlID0gJ2Nsb3NlZCc7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdjbG9zZScsIHJlYXNvbik7XG5cblx0XHRcdFx0XHRpZiAodGhpcy5fcmVjb25uZWN0aW9uICYmICF0aGlzLnNraXBSZWNvbm5lY3QpIHtcblx0XHRcdFx0XHRcdHRoaXMucmVjb25uZWN0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBBdHRlbXB0IGEgcmVjb25uZWN0aW9uLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0TWFuYWdlci5wcm90b3R5cGUucmVjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICh0aGlzLnJlY29ubmVjdGluZyB8fCB0aGlzLnNraXBSZWNvbm5lY3QpIHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuYmFja29mZi5hdHRlbXB0cyA+PSB0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cykge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ3JlY29ubmVjdCBmYWlsZWQnKTtcblx0XHRcdFx0XHRcdHRoaXMuYmFja29mZi5yZXNldCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5lbWl0QWxsKCdyZWNvbm5lY3RfZmFpbGVkJyk7XG5cdFx0XHRcdFx0XHR0aGlzLnJlY29ubmVjdGluZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgZGVsYXkgPSB0aGlzLmJhY2tvZmYuZHVyYXRpb24oKTtcblx0XHRcdFx0XHRcdGRlYnVnKCd3aWxsIHdhaXQgJWRtcyBiZWZvcmUgcmVjb25uZWN0IGF0dGVtcHQnLCBkZWxheSk7XG5cblx0XHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW5nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHZhciB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5za2lwUmVjb25uZWN0KSByZXR1cm47XG5cblx0XHRcdFx0XHRcdFx0ZGVidWcoJ2F0dGVtcHRpbmcgcmVjb25uZWN0Jyk7XG5cdFx0XHRcdFx0XHRcdHNlbGYuZW1pdEFsbCgncmVjb25uZWN0X2F0dGVtcHQnLCBzZWxmLmJhY2tvZmYuYXR0ZW1wdHMpO1xuXHRcdFx0XHRcdFx0XHRzZWxmLmVtaXRBbGwoJ3JlY29ubmVjdGluZycsIHNlbGYuYmFja29mZi5hdHRlbXB0cyk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gY2hlY2sgYWdhaW4gZm9yIHRoZSBjYXNlIHNvY2tldCBjbG9zZWQgaW4gYWJvdmUgZXZlbnRzXG5cdFx0XHRcdFx0XHRcdGlmIChzZWxmLnNraXBSZWNvbm5lY3QpIHJldHVybjtcblxuXHRcdFx0XHRcdFx0XHRzZWxmLm9wZW4oZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRlYnVnKCdyZWNvbm5lY3QgYXR0ZW1wdCBlcnJvcicpO1xuXHRcdFx0XHRcdFx0XHRcdFx0c2VsZi5yZWNvbm5lY3RpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdHNlbGYucmVjb25uZWN0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLmVtaXRBbGwoJ3JlY29ubmVjdF9lcnJvcicsIGVyci5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ3JlY29ubmVjdCBzdWNjZXNzJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRzZWxmLm9ucmVjb25uZWN0KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0sIGRlbGF5KTtcblxuXHRcdFx0XHRcdFx0dGhpcy5zdWJzLnB1c2goe1xuXHRcdFx0XHRcdFx0XHRkZXN0cm95OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDYWxsZWQgdXBvbiBzdWNjZXNzZnVsIHJlY29ubmVjdC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdE1hbmFnZXIucHJvdG90eXBlLm9ucmVjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHZhciBhdHRlbXB0ID0gdGhpcy5iYWNrb2ZmLmF0dGVtcHRzO1xuXHRcdFx0XHRcdHRoaXMucmVjb25uZWN0aW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5iYWNrb2ZmLnJlc2V0KCk7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVTb2NrZXRJZHMoKTtcblx0XHRcdFx0XHR0aGlzLmVtaXRBbGwoJ3JlY29ubmVjdCcsIGF0dGVtcHQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiLi9vblwiOiAzMyxcblx0XHRcdFx0XCIuL3NvY2tldFwiOiAzNCxcblx0XHRcdFx0XCJiYWNrbzJcIjogMzYsXG5cdFx0XHRcdFwiY29tcG9uZW50LWJpbmRcIjogMzcsXG5cdFx0XHRcdFwiY29tcG9uZW50LWVtaXR0ZXJcIjogMzgsXG5cdFx0XHRcdFwiZGVidWdcIjogMzksXG5cdFx0XHRcdFwiZW5naW5lLmlvLWNsaWVudFwiOiAxLFxuXHRcdFx0XHRcImluZGV4b2ZcIjogNDIsXG5cdFx0XHRcdFwic29ja2V0LmlvLXBhcnNlclwiOiA0N1xuXHRcdFx0fV0sXG5cdFx0XHQzMzogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTW9kdWxlIGV4cG9ydHMuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gb247XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEhlbHBlciBmb3Igc3Vic2NyaXB0aW9ucy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R8RXZlbnRFbWl0dGVyfSBvYmogd2l0aCBgRW1pdHRlcmAgbWl4aW4gb3IgYEV2ZW50RW1pdHRlcmBcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IG5hbWVcblx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gb24ob2JqLCBldiwgZm4pIHtcblx0XHRcdFx0XHRvYmoub24oZXYsIGZuKTtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0ZGVzdHJveTogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRvYmoucmVtb3ZlTGlzdGVuZXIoZXYsIGZuKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cblx0XHRcdH0sIHt9XSxcblx0XHRcdDM0OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgcGFyc2VyID0gX2RlcmVxXygnc29ja2V0LmlvLXBhcnNlcicpO1xuXHRcdFx0XHR2YXIgRW1pdHRlciA9IF9kZXJlcV8oJ2NvbXBvbmVudC1lbWl0dGVyJyk7XG5cdFx0XHRcdHZhciB0b0FycmF5ID0gX2RlcmVxXygndG8tYXJyYXknKTtcblx0XHRcdFx0dmFyIG9uID0gX2RlcmVxXygnLi9vbicpO1xuXHRcdFx0XHR2YXIgYmluZCA9IF9kZXJlcV8oJ2NvbXBvbmVudC1iaW5kJyk7XG5cdFx0XHRcdHZhciBkZWJ1ZyA9IF9kZXJlcV8oJ2RlYnVnJykoJ3NvY2tldC5pby1jbGllbnQ6c29ja2V0Jyk7XG5cdFx0XHRcdHZhciBoYXNCaW4gPSBfZGVyZXFfKCdoYXMtYmluYXJ5Jyk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMgPSBTb2NrZXQ7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEludGVybmFsIGV2ZW50cyAoYmxhY2tsaXN0ZWQpLlxuXHRcdFx0XHQgKiBUaGVzZSBldmVudHMgY2FuJ3QgYmUgZW1pdHRlZCBieSB0aGUgdXNlci5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdHZhciBldmVudHMgPSB7XG5cdFx0XHRcdFx0Y29ubmVjdDogMSxcblx0XHRcdFx0XHRjb25uZWN0X2Vycm9yOiAxLFxuXHRcdFx0XHRcdGNvbm5lY3RfdGltZW91dDogMSxcblx0XHRcdFx0XHRjb25uZWN0aW5nOiAxLFxuXHRcdFx0XHRcdGRpc2Nvbm5lY3Q6IDEsXG5cdFx0XHRcdFx0ZXJyb3I6IDEsXG5cdFx0XHRcdFx0cmVjb25uZWN0OiAxLFxuXHRcdFx0XHRcdHJlY29ubmVjdF9hdHRlbXB0OiAxLFxuXHRcdFx0XHRcdHJlY29ubmVjdF9mYWlsZWQ6IDEsXG5cdFx0XHRcdFx0cmVjb25uZWN0X2Vycm9yOiAxLFxuXHRcdFx0XHRcdHJlY29ubmVjdGluZzogMSxcblx0XHRcdFx0XHRwaW5nOiAxLFxuXHRcdFx0XHRcdHBvbmc6IDFcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2hvcnRjdXQgdG8gYEVtaXR0ZXIjZW1pdGAuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdHZhciBlbWl0ID0gRW1pdHRlci5wcm90b3R5cGUuZW1pdDtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogYFNvY2tldGAgY29uc3RydWN0b3IuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGZ1bmN0aW9uIFNvY2tldChpbywgbnNwKSB7XG5cdFx0XHRcdFx0dGhpcy5pbyA9IGlvO1xuXHRcdFx0XHRcdHRoaXMubnNwID0gbnNwO1xuXHRcdFx0XHRcdHRoaXMuanNvbiA9IHRoaXM7IC8vIGNvbXBhdFxuXHRcdFx0XHRcdHRoaXMuaWRzID0gMDtcblx0XHRcdFx0XHR0aGlzLmFja3MgPSB7fTtcblx0XHRcdFx0XHR0aGlzLnJlY2VpdmVCdWZmZXIgPSBbXTtcblx0XHRcdFx0XHR0aGlzLnNlbmRCdWZmZXIgPSBbXTtcblx0XHRcdFx0XHR0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuXHRcdFx0XHRcdHRoaXMuZGlzY29ubmVjdGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRpZiAodGhpcy5pby5hdXRvQ29ubmVjdCkgdGhpcy5vcGVuKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTWl4IGluIGBFbWl0dGVyYC5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0RW1pdHRlcihTb2NrZXQucHJvdG90eXBlKTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU3Vic2NyaWJlIHRvIG9wZW4sIGNsb3NlIGFuZCBwYWNrZXQgZXZlbnRzXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLnN1YkV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5zdWJzKSByZXR1cm47XG5cblx0XHRcdFx0XHR2YXIgaW8gPSB0aGlzLmlvO1xuXHRcdFx0XHRcdHRoaXMuc3VicyA9IFtcblx0XHRcdFx0XHRcdG9uKGlvLCAnb3BlbicsIGJpbmQodGhpcywgJ29ub3BlbicpKSxcblx0XHRcdFx0XHRcdG9uKGlvLCAncGFja2V0JywgYmluZCh0aGlzLCAnb25wYWNrZXQnKSksXG5cdFx0XHRcdFx0XHRvbihpbywgJ2Nsb3NlJywgYmluZCh0aGlzLCAnb25jbG9zZScpKVxuXHRcdFx0XHRcdF07XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFwiT3BlbnNcIiB0aGUgc29ja2V0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9wZW4gPVxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmICh0aGlzLmNvbm5lY3RlZCkgcmV0dXJuIHRoaXM7XG5cblx0XHRcdFx0XHRcdHRoaXMuc3ViRXZlbnRzKCk7XG5cdFx0XHRcdFx0XHR0aGlzLmlvLm9wZW4oKTsgLy8gZW5zdXJlIG9wZW5cblx0XHRcdFx0XHRcdGlmICgnb3BlbicgPT0gdGhpcy5pby5yZWFkeVN0YXRlKSB0aGlzLm9ub3BlbigpO1xuXHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdjb25uZWN0aW5nJyk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZW5kcyBhIGBtZXNzYWdlYCBldmVudC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHJldHVybiB7U29ja2V0fSBzZWxmXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcblx0XHRcdFx0XHRhcmdzLnVuc2hpZnQoJ21lc3NhZ2UnKTtcblx0XHRcdFx0XHR0aGlzLmVtaXQuYXBwbHkodGhpcywgYXJncyk7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIE92ZXJyaWRlIGBlbWl0YC5cblx0XHRcdFx0ICogSWYgdGhlIGV2ZW50IGlzIGluIGBldmVudHNgLCBpdCdzIGVtaXR0ZWQgbm9ybWFsbHkuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCBuYW1lXG5cdFx0XHRcdCAqIEByZXR1cm4ge1NvY2tldH0gc2VsZlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiAoZXYpIHtcblx0XHRcdFx0XHRpZiAoZXZlbnRzLmhhc093blByb3BlcnR5KGV2KSkge1xuXHRcdFx0XHRcdFx0ZW1pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG5cdFx0XHRcdFx0dmFyIHBhcnNlclR5cGUgPSBwYXJzZXIuRVZFTlQ7IC8vIGRlZmF1bHRcblx0XHRcdFx0XHRpZiAoaGFzQmluKGFyZ3MpKSB7XG5cdFx0XHRcdFx0XHRwYXJzZXJUeXBlID0gcGFyc2VyLkJJTkFSWV9FVkVOVDtcblx0XHRcdFx0XHR9IC8vIGJpbmFyeVxuXHRcdFx0XHRcdHZhciBwYWNrZXQgPSB7XG5cdFx0XHRcdFx0XHR0eXBlOiBwYXJzZXJUeXBlLFxuXHRcdFx0XHRcdFx0ZGF0YTogYXJnc1xuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRwYWNrZXQub3B0aW9ucyA9IHt9O1xuXHRcdFx0XHRcdHBhY2tldC5vcHRpb25zLmNvbXByZXNzID0gIXRoaXMuZmxhZ3MgfHwgZmFsc2UgIT09IHRoaXMuZmxhZ3MuY29tcHJlc3M7XG5cblx0XHRcdFx0XHQvLyBldmVudCBhY2sgY2FsbGJhY2tcblx0XHRcdFx0XHRpZiAoJ2Z1bmN0aW9uJyA9PSB0eXBlb2YgYXJnc1thcmdzLmxlbmd0aCAtIDFdKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygnZW1pdHRpbmcgcGFja2V0IHdpdGggYWNrIGlkICVkJywgdGhpcy5pZHMpO1xuXHRcdFx0XHRcdFx0dGhpcy5hY2tzW3RoaXMuaWRzXSA9IGFyZ3MucG9wKCk7XG5cdFx0XHRcdFx0XHRwYWNrZXQuaWQgPSB0aGlzLmlkcysrO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh0aGlzLmNvbm5lY3RlZCkge1xuXHRcdFx0XHRcdFx0dGhpcy5wYWNrZXQocGFja2V0KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy5zZW5kQnVmZmVyLnB1c2gocGFja2V0KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRkZWxldGUgdGhpcy5mbGFncztcblxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZW5kcyBhIHBhY2tldC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IHBhY2tldFxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0cGFja2V0Lm5zcCA9IHRoaXMubnNwO1xuXHRcdFx0XHRcdHRoaXMuaW8ucGFja2V0KHBhY2tldCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIGVuZ2luZSBgb3BlbmAuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRkZWJ1ZygndHJhbnNwb3J0IGlzIG9wZW4gLSBjb25uZWN0aW5nJyk7XG5cblx0XHRcdFx0XHQvLyB3cml0ZSBjb25uZWN0IHBhY2tldCBpZiBuZWNlc3Nhcnlcblx0XHRcdFx0XHRpZiAoJy8nICE9IHRoaXMubnNwKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBhY2tldCh7XG5cdFx0XHRcdFx0XHRcdHR5cGU6IHBhcnNlci5DT05ORUNUXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIGVuZ2luZSBgY2xvc2VgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gcmVhc29uXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uY2xvc2UgPSBmdW5jdGlvbiAocmVhc29uKSB7XG5cdFx0XHRcdFx0ZGVidWcoJ2Nsb3NlICglcyknLCByZWFzb24pO1xuXHRcdFx0XHRcdHRoaXMuY29ubmVjdGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5kaXNjb25uZWN0ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLmlkO1xuXHRcdFx0XHRcdHRoaXMuZW1pdCgnZGlzY29ubmVjdCcsIHJlYXNvbik7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB3aXRoIHNvY2tldCBwYWNrZXQuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25wYWNrZXQgPSBmdW5jdGlvbiAocGFja2V0KSB7XG5cdFx0XHRcdFx0aWYgKHBhY2tldC5uc3AgIT0gdGhpcy5uc3ApIHJldHVybjtcblxuXHRcdFx0XHRcdHN3aXRjaCAocGFja2V0LnR5cGUpIHtcblx0XHRcdFx0XHRcdGNhc2UgcGFyc2VyLkNPTk5FQ1Q6XG5cdFx0XHRcdFx0XHRcdHRoaXMub25jb25uZWN0KCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5FVkVOVDpcblx0XHRcdFx0XHRcdFx0dGhpcy5vbmV2ZW50KHBhY2tldCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5CSU5BUllfRVZFTlQ6XG5cdFx0XHRcdFx0XHRcdHRoaXMub25ldmVudChwYWNrZXQpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0Y2FzZSBwYXJzZXIuQUNLOlxuXHRcdFx0XHRcdFx0XHR0aGlzLm9uYWNrKHBhY2tldCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5CSU5BUllfQUNLOlxuXHRcdFx0XHRcdFx0XHR0aGlzLm9uYWNrKHBhY2tldCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIHBhcnNlci5ESVNDT05ORUNUOlxuXHRcdFx0XHRcdFx0XHR0aGlzLm9uZGlzY29ubmVjdCgpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0Y2FzZSBwYXJzZXIuRVJST1I6XG5cdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2FsbGVkIHVwb24gYSBzZXJ2ZXIgZXZlbnQuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUub25ldmVudCA9IGZ1bmN0aW9uIChwYWNrZXQpIHtcblx0XHRcdFx0XHR2YXIgYXJncyA9IHBhY2tldC5kYXRhIHx8IFtdO1xuXHRcdFx0XHRcdGRlYnVnKCdlbWl0dGluZyBldmVudCAlaicsIGFyZ3MpO1xuXG5cdFx0XHRcdFx0aWYgKG51bGwgIT0gcGFja2V0LmlkKSB7XG5cdFx0XHRcdFx0XHRkZWJ1ZygnYXR0YWNoaW5nIGFjayBjYWxsYmFjayB0byBldmVudCcpO1xuXHRcdFx0XHRcdFx0YXJncy5wdXNoKHRoaXMuYWNrKHBhY2tldC5pZCkpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh0aGlzLmNvbm5lY3RlZCkge1xuXHRcdFx0XHRcdFx0ZW1pdC5hcHBseSh0aGlzLCBhcmdzKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy5yZWNlaXZlQnVmZmVyLnB1c2goYXJncyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQcm9kdWNlcyBhbiBhY2sgY2FsbGJhY2sgdG8gZW1pdCB3aXRoIGFuIGV2ZW50LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5hY2sgPSBmdW5jdGlvbiAoaWQpIHtcblx0XHRcdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRcdFx0dmFyIHNlbnQgPSBmYWxzZTtcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0Ly8gcHJldmVudCBkb3VibGUgY2FsbGJhY2tzXG5cdFx0XHRcdFx0XHRpZiAoc2VudCkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0c2VudCA9IHRydWU7XG5cdFx0XHRcdFx0XHR2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcdGRlYnVnKCdzZW5kaW5nIGFjayAlaicsIGFyZ3MpO1xuXG5cdFx0XHRcdFx0XHR2YXIgdHlwZSA9IGhhc0JpbihhcmdzKSA/IHBhcnNlci5CSU5BUllfQUNLIDogcGFyc2VyLkFDSztcblx0XHRcdFx0XHRcdHNlbGYucGFja2V0KHtcblx0XHRcdFx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0XHRcdFx0aWQ6IGlkLFxuXHRcdFx0XHRcdFx0XHRkYXRhOiBhcmdzXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBhY2tub3dsZWdlbWVudC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IHBhY2tldFxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbmFjayA9IGZ1bmN0aW9uIChwYWNrZXQpIHtcblx0XHRcdFx0XHR2YXIgYWNrID0gdGhpcy5hY2tzW3BhY2tldC5pZF07XG5cdFx0XHRcdFx0aWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIGFjaykge1xuXHRcdFx0XHRcdFx0ZGVidWcoJ2NhbGxpbmcgYWNrICVzIHdpdGggJWonLCBwYWNrZXQuaWQsIHBhY2tldC5kYXRhKTtcblx0XHRcdFx0XHRcdGFjay5hcHBseSh0aGlzLCBwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHRkZWxldGUgdGhpcy5hY2tzW3BhY2tldC5pZF07XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGRlYnVnKCdiYWQgYWNrICVzJywgcGFja2V0LmlkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIHNlcnZlciBjb25uZWN0LlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5vbmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0dGhpcy5jb25uZWN0ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZGlzY29ubmVjdGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5lbWl0KCdjb25uZWN0Jyk7XG5cdFx0XHRcdFx0dGhpcy5lbWl0QnVmZmVyZWQoKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRW1pdCBidWZmZXJlZCBldmVudHMgKHJlY2VpdmVkIGFuZCBlbWl0dGVkKS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwcml2YXRlXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuZW1pdEJ1ZmZlcmVkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHZhciBpO1xuXHRcdFx0XHRcdGZvciAoaSA9IDA7IGkgPCB0aGlzLnJlY2VpdmVCdWZmZXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGVtaXQuYXBwbHkodGhpcywgdGhpcy5yZWNlaXZlQnVmZmVyW2ldKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5yZWNlaXZlQnVmZmVyID0gW107XG5cblx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgdGhpcy5zZW5kQnVmZmVyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBhY2tldCh0aGlzLnNlbmRCdWZmZXJbaV0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGlzLnNlbmRCdWZmZXIgPSBbXTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2FsbGVkIHVwb24gc2VydmVyIGRpc2Nvbm5lY3QuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRTb2NrZXQucHJvdG90eXBlLm9uZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRkZWJ1Zygnc2VydmVyIGRpc2Nvbm5lY3QgKCVzKScsIHRoaXMubnNwKTtcblx0XHRcdFx0XHR0aGlzLmRlc3Ryb3koKTtcblx0XHRcdFx0XHR0aGlzLm9uY2xvc2UoJ2lvIHNlcnZlciBkaXNjb25uZWN0Jyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIENhbGxlZCB1cG9uIGZvcmNlZCBjbGllbnQvc2VydmVyIHNpZGUgZGlzY29ubmVjdGlvbnMsXG5cdFx0XHRcdCAqIHRoaXMgbWV0aG9kIGVuc3VyZXMgdGhlIG1hbmFnZXIgc3RvcHMgdHJhY2tpbmcgdXMgYW5kXG5cdFx0XHRcdCAqIHRoYXQgcmVjb25uZWN0aW9ucyBkb24ndCBnZXQgdHJpZ2dlcmVkIGZvciB0aGlzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGUuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5zdWJzKSB7XG5cdFx0XHRcdFx0XHQvLyBjbGVhbiBzdWJzY3JpcHRpb25zIHRvIGF2b2lkIHJlY29ubmVjdGlvbnNcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zdWJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc3Vic1tpXS5kZXN0cm95KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR0aGlzLnN1YnMgPSBudWxsO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMuaW8uZGVzdHJveSh0aGlzKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRGlzY29ubmVjdHMgdGhlIHNvY2tldCBtYW51YWxseS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHJldHVybiB7U29ja2V0fSBzZWxmXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuY2xvc2UgPVxuXHRcdFx0XHRcdFNvY2tldC5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGlmICh0aGlzLmNvbm5lY3RlZCkge1xuXHRcdFx0XHRcdFx0XHRkZWJ1ZygncGVyZm9ybWluZyBkaXNjb25uZWN0ICglcyknLCB0aGlzLm5zcCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMucGFja2V0KHtcblx0XHRcdFx0XHRcdFx0XHR0eXBlOiBwYXJzZXIuRElTQ09OTkVDVFxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gcmVtb3ZlIHNvY2tldCBmcm9tIHBvb2xcblx0XHRcdFx0XHRcdHRoaXMuZGVzdHJveSgpO1xuXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5jb25uZWN0ZWQpIHtcblx0XHRcdFx0XHRcdFx0Ly8gZmlyZSBldmVudHNcblx0XHRcdFx0XHRcdFx0dGhpcy5vbmNsb3NlKCdpbyBjbGllbnQgZGlzY29ubmVjdCcpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2V0cyB0aGUgY29tcHJlc3MgZmxhZy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtCb29sZWFufSBpZiBgdHJ1ZWAsIGNvbXByZXNzZXMgdGhlIHNlbmRpbmcgZGF0YVxuXHRcdFx0XHQgKiBAcmV0dXJuIHtTb2NrZXR9IHNlbGZcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0U29ja2V0LnByb3RvdHlwZS5jb21wcmVzcyA9IGZ1bmN0aW9uIChjb21wcmVzcykge1xuXHRcdFx0XHRcdHRoaXMuZmxhZ3MgPSB0aGlzLmZsYWdzIHx8IHt9O1xuXHRcdFx0XHRcdHRoaXMuZmxhZ3MuY29tcHJlc3MgPSBjb21wcmVzcztcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0fSwge1xuXHRcdFx0XHRcIi4vb25cIjogMzMsXG5cdFx0XHRcdFwiY29tcG9uZW50LWJpbmRcIjogMzcsXG5cdFx0XHRcdFwiY29tcG9uZW50LWVtaXR0ZXJcIjogMzgsXG5cdFx0XHRcdFwiZGVidWdcIjogMzksXG5cdFx0XHRcdFwiaGFzLWJpbmFyeVwiOiA0MSxcblx0XHRcdFx0XCJzb2NrZXQuaW8tcGFyc2VyXCI6IDQ3LFxuXHRcdFx0XHRcInRvLWFycmF5XCI6IDUxXG5cdFx0XHR9XSxcblx0XHRcdDM1OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogTW9kdWxlIGRlcGVuZGVuY2llcy5cblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBwYXJzZXVyaSA9IF9kZXJlcV8oJ3BhcnNldXJpJyk7XG5cdFx0XHRcdFx0dmFyIGRlYnVnID0gX2RlcmVxXygnZGVidWcnKSgnc29ja2V0LmlvLWNsaWVudDp1cmwnKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSB1cmw7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBVUkwgcGFyc2VyLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IHVybFxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBBbiBvYmplY3QgbWVhbnQgdG8gbWltaWMgd2luZG93LmxvY2F0aW9uLlxuXHRcdFx0XHRcdCAqICAgICAgICAgICAgICAgICBEZWZhdWx0cyB0byB3aW5kb3cubG9jYXRpb24uXG5cdFx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIHVybCh1cmksIGxvYykge1xuXHRcdFx0XHRcdFx0dmFyIG9iaiA9IHVyaTtcblxuXHRcdFx0XHRcdFx0Ly8gZGVmYXVsdCB0byB3aW5kb3cubG9jYXRpb25cblx0XHRcdFx0XHRcdHZhciBsb2MgPSBsb2MgfHwgZ2xvYmFsLmxvY2F0aW9uO1xuXHRcdFx0XHRcdFx0aWYgKG51bGwgPT0gdXJpKSB1cmkgPSBsb2MucHJvdG9jb2wgKyAnLy8nICsgbG9jLmhvc3Q7XG5cblx0XHRcdFx0XHRcdC8vIHJlbGF0aXZlIHBhdGggc3VwcG9ydFxuXHRcdFx0XHRcdFx0aWYgKCdzdHJpbmcnID09IHR5cGVvZiB1cmkpIHtcblx0XHRcdFx0XHRcdFx0aWYgKCcvJyA9PSB1cmkuY2hhckF0KDApKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCcvJyA9PSB1cmkuY2hhckF0KDEpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR1cmkgPSBsb2MucHJvdG9jb2wgKyB1cmk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHVyaSA9IGxvYy5ob3N0ICsgdXJpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmICghL14oaHR0cHM/fHdzcz8pOlxcL1xcLy8udGVzdCh1cmkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZGVidWcoJ3Byb3RvY29sLWxlc3MgdXJsICVzJywgdXJpKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGxvYykge1xuXHRcdFx0XHRcdFx0XHRcdFx0dXJpID0gbG9jLnByb3RvY29sICsgJy8vJyArIHVyaTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dXJpID0gJ2h0dHBzOi8vJyArIHVyaTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHQvLyBwYXJzZVxuXHRcdFx0XHRcdFx0XHRkZWJ1ZygncGFyc2UgJXMnLCB1cmkpO1xuXHRcdFx0XHRcdFx0XHRvYmogPSBwYXJzZXVyaSh1cmkpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBtYWtlIHN1cmUgd2UgdHJlYXQgYGxvY2FsaG9zdDo4MGAgYW5kIGBsb2NhbGhvc3RgIGVxdWFsbHlcblx0XHRcdFx0XHRcdGlmICghb2JqLnBvcnQpIHtcblx0XHRcdFx0XHRcdFx0aWYgKC9eKGh0dHB8d3MpJC8udGVzdChvYmoucHJvdG9jb2wpKSB7XG5cdFx0XHRcdFx0XHRcdFx0b2JqLnBvcnQgPSAnODAnO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKC9eKGh0dHB8d3MpcyQvLnRlc3Qob2JqLnByb3RvY29sKSkge1xuXHRcdFx0XHRcdFx0XHRcdG9iai5wb3J0ID0gJzQ0Myc7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0b2JqLnBhdGggPSBvYmoucGF0aCB8fCAnLyc7XG5cblx0XHRcdFx0XHRcdHZhciBpcHY2ID0gb2JqLmhvc3QuaW5kZXhPZignOicpICE9PSAtMTtcblx0XHRcdFx0XHRcdHZhciBob3N0ID0gaXB2NiA/ICdbJyArIG9iai5ob3N0ICsgJ10nIDogb2JqLmhvc3Q7XG5cblx0XHRcdFx0XHRcdC8vIGRlZmluZSB1bmlxdWUgaWRcblx0XHRcdFx0XHRcdG9iai5pZCA9IG9iai5wcm90b2NvbCArICc6Ly8nICsgaG9zdCArICc6JyArIG9iai5wb3J0O1xuXHRcdFx0XHRcdFx0Ly8gZGVmaW5lIGhyZWZcblx0XHRcdFx0XHRcdG9iai5ocmVmID0gb2JqLnByb3RvY29sICsgJzovLycgKyBob3N0ICsgKGxvYyAmJiBsb2MucG9ydCA9PSBvYmoucG9ydCA/ICcnIDogKCc6JyArIG9iai5wb3J0KSk7XG5cblx0XHRcdFx0XHRcdHJldHVybiBvYmo7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSlcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJkZWJ1Z1wiOiAzOSxcblx0XHRcdFx0XCJwYXJzZXVyaVwiOiA0NVxuXHRcdFx0fV0sXG5cdFx0XHQzNjogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRXhwb3NlIGBCYWNrb2ZmYC5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBCYWNrb2ZmO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBJbml0aWFsaXplIGJhY2tvZmYgdGltZXIgd2l0aCBgb3B0c2AuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIC0gYG1pbmAgaW5pdGlhbCB0aW1lb3V0IGluIG1pbGxpc2Vjb25kcyBbMTAwXVxuXHRcdFx0XHQgKiAtIGBtYXhgIG1heCB0aW1lb3V0IFsxMDAwMF1cblx0XHRcdFx0ICogLSBgaml0dGVyYCBbMF1cblx0XHRcdFx0ICogLSBgZmFjdG9yYCBbMl1cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IG9wdHNcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gQmFja29mZihvcHRzKSB7XG5cdFx0XHRcdFx0b3B0cyA9IG9wdHMgfHwge307XG5cdFx0XHRcdFx0dGhpcy5tcyA9IG9wdHMubWluIHx8IDEwMDtcblx0XHRcdFx0XHR0aGlzLm1heCA9IG9wdHMubWF4IHx8IDEwMDAwO1xuXHRcdFx0XHRcdHRoaXMuZmFjdG9yID0gb3B0cy5mYWN0b3IgfHwgMjtcblx0XHRcdFx0XHR0aGlzLmppdHRlciA9IG9wdHMuaml0dGVyID4gMCAmJiBvcHRzLmppdHRlciA8PSAxID8gb3B0cy5qaXR0ZXIgOiAwO1xuXHRcdFx0XHRcdHRoaXMuYXR0ZW1wdHMgPSAwO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFJldHVybiB0aGUgYmFja29mZiBkdXJhdGlvbi5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHJldHVybiB7TnVtYmVyfVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRCYWNrb2ZmLnByb3RvdHlwZS5kdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR2YXIgbXMgPSB0aGlzLm1zICogTWF0aC5wb3codGhpcy5mYWN0b3IsIHRoaXMuYXR0ZW1wdHMrKyk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuaml0dGVyKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmFuZCA9IE1hdGgucmFuZG9tKCk7XG5cdFx0XHRcdFx0XHR2YXIgZGV2aWF0aW9uID0gTWF0aC5mbG9vcihyYW5kICogdGhpcy5qaXR0ZXIgKiBtcyk7XG5cdFx0XHRcdFx0XHRtcyA9IChNYXRoLmZsb29yKHJhbmQgKiAxMCkgJiAxKSA9PSAwID8gbXMgLSBkZXZpYXRpb24gOiBtcyArIGRldmlhdGlvbjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIE1hdGgubWluKG1zLCB0aGlzLm1heCkgfCAwO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBSZXNldCB0aGUgbnVtYmVyIG9mIGF0dGVtcHRzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRCYWNrb2ZmLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLmF0dGVtcHRzID0gMDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogU2V0IHRoZSBtaW5pbXVtIGR1cmF0aW9uXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEJhY2tvZmYucHJvdG90eXBlLnNldE1pbiA9IGZ1bmN0aW9uIChtaW4pIHtcblx0XHRcdFx0XHR0aGlzLm1zID0gbWluO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZXQgdGhlIG1heGltdW0gZHVyYXRpb25cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0QmFja29mZi5wcm90b3R5cGUuc2V0TWF4ID0gZnVuY3Rpb24gKG1heCkge1xuXHRcdFx0XHRcdHRoaXMubWF4ID0gbWF4O1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTZXQgdGhlIGppdHRlclxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRCYWNrb2ZmLnByb3RvdHlwZS5zZXRKaXR0ZXIgPSBmdW5jdGlvbiAoaml0dGVyKSB7XG5cdFx0XHRcdFx0dGhpcy5qaXR0ZXIgPSBqaXR0ZXI7XG5cdFx0XHRcdH07XG5cblxuXHRcdFx0fSwge31dLFxuXHRcdFx0Mzc6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBTbGljZSByZWZlcmVuY2UuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdHZhciBzbGljZSA9IFtdLnNsaWNlO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBCaW5kIGBvYmpgIHRvIGBmbmAuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcblx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IGZuIG9yIHN0cmluZ1xuXHRcdFx0XHQgKiBAcmV0dXJuIHtGdW5jdGlvbn1cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob2JqLCBmbikge1xuXHRcdFx0XHRcdGlmICgnc3RyaW5nJyA9PSB0eXBlb2YgZm4pIGZuID0gb2JqW2ZuXTtcblx0XHRcdFx0XHRpZiAoJ2Z1bmN0aW9uJyAhPSB0eXBlb2YgZm4pIHRocm93IG5ldyBFcnJvcignYmluZCgpIHJlcXVpcmVzIGEgZnVuY3Rpb24nKTtcblx0XHRcdFx0XHR2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZuLmFwcGx5KG9iaiwgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHR9LCB7fV0sXG5cdFx0XHQzODogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRXhwb3NlIGBFbWl0dGVyYC5cblx0XHRcdFx0ICovXG5cblx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBFbWl0dGVyO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBJbml0aWFsaXplIGEgbmV3IGBFbWl0dGVyYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gRW1pdHRlcihvYmopIHtcblx0XHRcdFx0XHRpZiAob2JqKSByZXR1cm4gbWl4aW4ob2JqKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTWl4aW4gdGhlIGVtaXR0ZXIgcHJvcGVydGllcy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IG9ialxuXHRcdFx0XHQgKiBAcmV0dXJuIHtPYmplY3R9XG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBtaXhpbihvYmopIHtcblx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpIHtcblx0XHRcdFx0XHRcdG9ialtrZXldID0gRW1pdHRlci5wcm90b3R5cGVba2V5XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIG9iajtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBMaXN0ZW4gb24gdGhlIGdpdmVuIGBldmVudGAgd2l0aCBgZm5gLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcblx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cblx0XHRcdFx0ICogQHJldHVybiB7RW1pdHRlcn1cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUub24gPVxuXHRcdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XG5cdFx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cdFx0XHRcdFx0XHQodGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XSA9IHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF0gfHwgW10pXG5cdFx0XHRcdFx0XHQucHVzaChmbik7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBBZGRzIGFuIGBldmVudGAgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGludm9rZWQgYSBzaW5nbGVcblx0XHRcdFx0ICogdGltZSB0aGVuIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG5cdFx0XHRcdCAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG5cdFx0XHRcdCAqIEByZXR1cm4ge0VtaXR0ZXJ9XG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XG5cdFx0XHRcdFx0ZnVuY3Rpb24gb24oKSB7XG5cdFx0XHRcdFx0XHR0aGlzLm9mZihldmVudCwgb24pO1xuXHRcdFx0XHRcdFx0Zm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRvbi5mbiA9IGZuO1xuXHRcdFx0XHRcdHRoaXMub24oZXZlbnQsIG9uKTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUmVtb3ZlIHRoZSBnaXZlbiBjYWxsYmFjayBmb3IgYGV2ZW50YCBvciBhbGxcblx0XHRcdFx0ICogcmVnaXN0ZXJlZCBjYWxsYmFja3MuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuXHRcdFx0XHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuXHRcdFx0XHQgKiBAcmV0dXJuIHtFbWl0dGVyfVxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5vZmYgPVxuXHRcdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID1cblx0XHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPVxuXHRcdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7XG5cdFx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cblx0XHRcdFx0XHRcdC8vIGFsbFxuXHRcdFx0XHRcdFx0aWYgKDAgPT0gYXJndW1lbnRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLl9jYWxsYmFja3MgPSB7fTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIHNwZWNpZmljIGV2ZW50XG5cdFx0XHRcdFx0XHR2YXIgY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcblx0XHRcdFx0XHRcdGlmICghY2FsbGJhY2tzKSByZXR1cm4gdGhpcztcblxuXHRcdFx0XHRcdFx0Ly8gcmVtb3ZlIGFsbCBoYW5kbGVyc1xuXHRcdFx0XHRcdFx0aWYgKDEgPT0gYXJndW1lbnRzLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRkZWxldGUgdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIHJlbW92ZSBzcGVjaWZpYyBoYW5kbGVyXG5cdFx0XHRcdFx0XHR2YXIgY2I7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRjYiA9IGNhbGxiYWNrc1tpXTtcblx0XHRcdFx0XHRcdFx0aWYgKGNiID09PSBmbiB8fCBjYi5mbiA9PT0gZm4pIHtcblx0XHRcdFx0XHRcdFx0XHRjYWxsYmFja3Muc3BsaWNlKGksIDEpO1xuXHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBFbWl0IGBldmVudGAgd2l0aCB0aGUgZ2l2ZW4gYXJncy5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG5cdFx0XHRcdCAqIEBwYXJhbSB7TWl4ZWR9IC4uLlxuXHRcdFx0XHQgKiBAcmV0dXJuIHtFbWl0dGVyfVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzIHx8IHt9O1xuXHRcdFx0XHRcdHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLFxuXHRcdFx0XHRcdFx0Y2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcblxuXHRcdFx0XHRcdGlmIChjYWxsYmFja3MpIHtcblx0XHRcdFx0XHRcdGNhbGxiYWNrcyA9IGNhbGxiYWNrcy5zbGljZSgwKTtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSBjYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2tzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBSZXR1cm4gYXJyYXkgb2YgY2FsbGJhY2tzIGZvciBgZXZlbnRgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcblx0XHRcdFx0ICogQHJldHVybiB7QXJyYXl9XG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHRcdHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XSB8fCBbXTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2hlY2sgaWYgdGhpcyBlbWl0dGVyIGhhcyBgZXZlbnRgIGhhbmRsZXJzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcblx0XHRcdFx0ICogQHJldHVybiB7Qm9vbGVhbn1cblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0RW1pdHRlci5wcm90b3R5cGUuaGFzTGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhdGhpcy5saXN0ZW5lcnMoZXZlbnQpLmxlbmd0aDtcblx0XHRcdFx0fTtcblxuXHRcdFx0fSwge31dLFxuXHRcdFx0Mzk6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdGFyZ3VtZW50c1s0XVsxN11bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKVxuXHRcdFx0fSwge1xuXHRcdFx0XHRcIi4vZGVidWdcIjogNDAsXG5cdFx0XHRcdFwiZHVwXCI6IDE3XG5cdFx0XHR9XSxcblx0XHRcdDQwOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRhcmd1bWVudHNbNF1bMThdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cylcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJkdXBcIjogMTgsXG5cdFx0XHRcdFwibXNcIjogNDRcblx0XHRcdH1dLFxuXHRcdFx0NDE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSByZXF1aXJlbWVudHMuXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHR2YXIgaXNBcnJheSA9IF9kZXJlcV8oJ2lzYXJyYXknKTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSBleHBvcnRzLlxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBoYXNCaW5hcnk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBDaGVja3MgZm9yIGJpbmFyeSBkYXRhLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogUmlnaHQgbm93IG9ubHkgQnVmZmVyIGFuZCBBcnJheUJ1ZmZlciBhcmUgc3VwcG9ydGVkLi5cblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBhbnl0aGluZ1xuXHRcdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRmdW5jdGlvbiBoYXNCaW5hcnkoZGF0YSkge1xuXG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBfaGFzQmluYXJ5KG9iaikge1xuXHRcdFx0XHRcdFx0XHRpZiAoIW9iaikgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRcdFx0XHRcdGlmICgoZ2xvYmFsLkJ1ZmZlciAmJiBnbG9iYWwuQnVmZmVyLmlzQnVmZmVyICYmIGdsb2JhbC5CdWZmZXIuaXNCdWZmZXIob2JqKSkgfHxcblx0XHRcdFx0XHRcdFx0XHQoZ2xvYmFsLkFycmF5QnVmZmVyICYmIG9iaiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB8fFxuXHRcdFx0XHRcdFx0XHRcdChnbG9iYWwuQmxvYiAmJiBvYmogaW5zdGFuY2VvZiBCbG9iKSB8fFxuXHRcdFx0XHRcdFx0XHRcdChnbG9iYWwuRmlsZSAmJiBvYmogaW5zdGFuY2VvZiBGaWxlKVxuXHRcdFx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGlmIChpc0FycmF5KG9iaikpIHtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKF9oYXNCaW5hcnkob2JqW2ldKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAob2JqICYmICdvYmplY3QnID09IHR5cGVvZiBvYmopIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBzZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9BdXRvbWF0dGljL2hhcy1iaW5hcnkvcHVsbC80XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9iai50b0pTT04gJiYgJ2Z1bmN0aW9uJyA9PSB0eXBlb2Ygb2JqLnRvSlNPTikge1xuXHRcdFx0XHRcdFx0XHRcdFx0b2JqID0gb2JqLnRvSlNPTigpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBvYmopIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpICYmIF9oYXNCaW5hcnkob2JqW2tleV0pKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0cmV0dXJuIF9oYXNCaW5hcnkoZGF0YSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSlcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJpc2FycmF5XCI6IDQzXG5cdFx0XHR9XSxcblx0XHRcdDQyOiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRhcmd1bWVudHNbNF1bMjNdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cylcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJkdXBcIjogMjNcblx0XHRcdH1dLFxuXHRcdFx0NDM6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdGFyZ3VtZW50c1s0XVsyNF1bMF0uYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKVxuXHRcdFx0fSwge1xuXHRcdFx0XHRcImR1cFwiOiAyNFxuXHRcdFx0fV0sXG5cdFx0XHQ0NDogW2Z1bmN0aW9uIChfZGVyZXFfLCBtb2R1bGUsIGV4cG9ydHMpIHtcblx0XHRcdFx0YXJndW1lbnRzWzRdWzI1XVswXS5hcHBseShleHBvcnRzLCBhcmd1bWVudHMpXG5cdFx0XHR9LCB7XG5cdFx0XHRcdFwiZHVwXCI6IDI1XG5cdFx0XHR9XSxcblx0XHRcdDQ1OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRhcmd1bWVudHNbNF1bMjhdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cylcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJkdXBcIjogMjhcblx0XHRcdH1dLFxuXHRcdFx0NDY6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cdFx0XHRcdFx0LypnbG9iYWwgQmxvYixGaWxlKi9cblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIE1vZHVsZSByZXF1aXJlbWVudHNcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdHZhciBpc0FycmF5ID0gX2RlcmVxXygnaXNhcnJheScpO1xuXHRcdFx0XHRcdHZhciBpc0J1ZiA9IF9kZXJlcV8oJy4vaXMtYnVmZmVyJyk7XG5cblx0XHRcdFx0XHQvKipcblx0XHRcdFx0XHQgKiBSZXBsYWNlcyBldmVyeSBCdWZmZXIgfCBBcnJheUJ1ZmZlciBpbiBwYWNrZXQgd2l0aCBhIG51bWJlcmVkIHBsYWNlaG9sZGVyLlxuXHRcdFx0XHRcdCAqIEFueXRoaW5nIHdpdGggYmxvYnMgb3IgZmlsZXMgc2hvdWxkIGJlIGZlZCB0aHJvdWdoIHJlbW92ZUJsb2JzIGJlZm9yZSBjb21pbmdcblx0XHRcdFx0XHQgKiBoZXJlLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IHBhY2tldCAtIHNvY2tldC5pbyBldmVudCBwYWNrZXRcblx0XHRcdFx0XHQgKiBAcmV0dXJuIHtPYmplY3R9IHdpdGggZGVjb25zdHJ1Y3RlZCBwYWNrZXQgYW5kIGxpc3Qgb2YgYnVmZmVyc1xuXHRcdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdFx0ICovXG5cblx0XHRcdFx0XHRleHBvcnRzLmRlY29uc3RydWN0UGFja2V0ID0gZnVuY3Rpb24gKHBhY2tldCkge1xuXHRcdFx0XHRcdFx0dmFyIGJ1ZmZlcnMgPSBbXTtcblx0XHRcdFx0XHRcdHZhciBwYWNrZXREYXRhID0gcGFja2V0LmRhdGE7XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdGlmICghZGF0YSkgcmV0dXJuIGRhdGE7XG5cblx0XHRcdFx0XHRcdFx0aWYgKGlzQnVmKGRhdGEpKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHBsYWNlaG9sZGVyID0ge1xuXHRcdFx0XHRcdFx0XHRcdFx0X3BsYWNlaG9sZGVyOiB0cnVlLFxuXHRcdFx0XHRcdFx0XHRcdFx0bnVtOiBidWZmZXJzLmxlbmd0aFxuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0YnVmZmVycy5wdXNoKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBwbGFjZWhvbGRlcjtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChpc0FycmF5KGRhdGEpKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIG5ld0RhdGEgPSBuZXcgQXJyYXkoZGF0YS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0bmV3RGF0YVtpXSA9IF9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2ldKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ld0RhdGE7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoJ29iamVjdCcgPT0gdHlwZW9mIGRhdGEgJiYgIShkYXRhIGluc3RhbmNlb2YgRGF0ZSkpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgbmV3RGF0YSA9IHt9O1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRuZXdEYXRhW2tleV0gPSBfZGVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtrZXldKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIG5ld0RhdGE7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHZhciBwYWNrID0gcGFja2V0O1xuXHRcdFx0XHRcdFx0cGFjay5kYXRhID0gX2RlY29uc3RydWN0UGFja2V0KHBhY2tldERhdGEpO1xuXHRcdFx0XHRcdFx0cGFjay5hdHRhY2htZW50cyA9IGJ1ZmZlcnMubGVuZ3RoOyAvLyBudW1iZXIgb2YgYmluYXJ5ICdhdHRhY2htZW50cydcblx0XHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRcdHBhY2tldDogcGFjayxcblx0XHRcdFx0XHRcdFx0YnVmZmVyczogYnVmZmVyc1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0LyoqXG5cdFx0XHRcdFx0ICogUmVjb25zdHJ1Y3RzIGEgYmluYXJ5IHBhY2tldCBmcm9tIGl0cyBwbGFjZWhvbGRlciBwYWNrZXQgYW5kIGJ1ZmZlcnNcblx0XHRcdFx0XHQgKlxuXHRcdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXQgLSBldmVudCBwYWNrZXQgd2l0aCBwbGFjZWhvbGRlcnNcblx0XHRcdFx0XHQgKiBAcGFyYW0ge0FycmF5fSBidWZmZXJzIC0gYmluYXJ5IGJ1ZmZlcnMgdG8gcHV0IGluIHBsYWNlaG9sZGVyIHBvc2l0aW9uc1xuXHRcdFx0XHRcdCAqIEByZXR1cm4ge09iamVjdH0gcmVjb25zdHJ1Y3RlZCBwYWNrZXRcblx0XHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5yZWNvbnN0cnVjdFBhY2tldCA9IGZ1bmN0aW9uIChwYWNrZXQsIGJ1ZmZlcnMpIHtcblx0XHRcdFx0XHRcdHZhciBjdXJQbGFjZUhvbGRlciA9IDA7XG5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIF9yZWNvbnN0cnVjdFBhY2tldChkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChkYXRhICYmIGRhdGEuX3BsYWNlaG9sZGVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGJ1ZiA9IGJ1ZmZlcnNbZGF0YS5udW1dOyAvLyBhcHByb3ByaWF0ZSBidWZmZXIgKHNob3VsZCBiZSBuYXR1cmFsIG9yZGVyIGFueXdheSlcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gYnVmO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGlzQXJyYXkoZGF0YSkpIHtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGFbaV0gPSBfcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtpXSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEgJiYgJ29iamVjdCcgPT0gdHlwZW9mIGRhdGEpIHtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZGF0YVtrZXldID0gX3JlY29uc3RydWN0UGFja2V0KGRhdGFba2V5XSk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRwYWNrZXQuZGF0YSA9IF9yZWNvbnN0cnVjdFBhY2tldChwYWNrZXQuZGF0YSk7XG5cdFx0XHRcdFx0XHRwYWNrZXQuYXR0YWNobWVudHMgPSB1bmRlZmluZWQ7IC8vIG5vIGxvbmdlciB1c2VmdWxcblx0XHRcdFx0XHRcdHJldHVybiBwYWNrZXQ7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIEFzeW5jaHJvbm91c2x5IHJlbW92ZXMgQmxvYnMgb3IgRmlsZXMgZnJvbSBkYXRhIHZpYVxuXHRcdFx0XHRcdCAqIEZpbGVSZWFkZXIncyByZWFkQXNBcnJheUJ1ZmZlciBtZXRob2QuIFVzZWQgYmVmb3JlIGVuY29kaW5nXG5cdFx0XHRcdFx0ICogZGF0YSBhcyBtc2dwYWNrLiBDYWxscyBjYWxsYmFjayB3aXRoIHRoZSBibG9ibGVzcyBkYXRhLlxuXHRcdFx0XHRcdCAqXG5cdFx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IGRhdGFcblx0XHRcdFx0XHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuXHRcdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHRcdCAqL1xuXG5cdFx0XHRcdFx0ZXhwb3J0cy5yZW1vdmVCbG9icyA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gX3JlbW92ZUJsb2JzKG9iaiwgY3VyS2V5LCBjb250YWluaW5nT2JqZWN0KSB7XG5cdFx0XHRcdFx0XHRcdGlmICghb2JqKSByZXR1cm4gb2JqO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGNvbnZlcnQgYW55IGJsb2Jcblx0XHRcdFx0XHRcdFx0aWYgKChnbG9iYWwuQmxvYiAmJiBvYmogaW5zdGFuY2VvZiBCbG9iKSB8fFxuXHRcdFx0XHRcdFx0XHRcdChnbG9iYWwuRmlsZSAmJiBvYmogaW5zdGFuY2VvZiBGaWxlKSkge1xuXHRcdFx0XHRcdFx0XHRcdHBlbmRpbmdCbG9icysrO1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gYXN5bmMgZmlsZXJlYWRlclxuXHRcdFx0XHRcdFx0XHRcdHZhciBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdFx0XHRcdFx0XHRmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsgLy8gdGhpcy5yZXN1bHQgPT0gYXJyYXlidWZmZXJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChjb250YWluaW5nT2JqZWN0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnRhaW5pbmdPYmplY3RbY3VyS2V5XSA9IHRoaXMucmVzdWx0O1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0YmxvYmxlc3NEYXRhID0gdGhpcy5yZXN1bHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdC8vIGlmIG5vdGhpbmcgcGVuZGluZyBpdHMgY2FsbGJhY2sgdGltZVxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCEtLXBlbmRpbmdCbG9icykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayhibG9ibGVzc0RhdGEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdFx0XHRmaWxlUmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKG9iaik7IC8vIGJsb2IgLT4gYXJyYXlidWZmZXJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChpc0FycmF5KG9iaikpIHsgLy8gaGFuZGxlIGFycmF5XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdF9yZW1vdmVCbG9icyhvYmpbaV0sIGksIG9iaik7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG9iaiAmJiAnb2JqZWN0JyA9PSB0eXBlb2Ygb2JqICYmICFpc0J1ZihvYmopKSB7IC8vIGFuZCBvYmplY3Rcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRfcmVtb3ZlQmxvYnMob2JqW2tleV0sIGtleSwgb2JqKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dmFyIHBlbmRpbmdCbG9icyA9IDA7XG5cdFx0XHRcdFx0XHR2YXIgYmxvYmxlc3NEYXRhID0gZGF0YTtcblx0XHRcdFx0XHRcdF9yZW1vdmVCbG9icyhibG9ibGVzc0RhdGEpO1xuXHRcdFx0XHRcdFx0aWYgKCFwZW5kaW5nQmxvYnMpIHtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2soYmxvYmxlc3NEYXRhKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSlcblx0XHRcdH0sIHtcblx0XHRcdFx0XCIuL2lzLWJ1ZmZlclwiOiA0OCxcblx0XHRcdFx0XCJpc2FycmF5XCI6IDQzXG5cdFx0XHR9XSxcblx0XHRcdDQ3OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHR2YXIgZGVidWcgPSBfZGVyZXFfKCdkZWJ1ZycpKCdzb2NrZXQuaW8tcGFyc2VyJyk7XG5cdFx0XHRcdHZhciBqc29uID0gX2RlcmVxXygnanNvbjMnKTtcblx0XHRcdFx0dmFyIGlzQXJyYXkgPSBfZGVyZXFfKCdpc2FycmF5Jyk7XG5cdFx0XHRcdHZhciBFbWl0dGVyID0gX2RlcmVxXygnY29tcG9uZW50LWVtaXR0ZXInKTtcblx0XHRcdFx0dmFyIGJpbmFyeSA9IF9kZXJlcV8oJy4vYmluYXJ5Jyk7XG5cdFx0XHRcdHZhciBpc0J1ZiA9IF9kZXJlcV8oJy4vaXMtYnVmZmVyJyk7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFByb3RvY29sIHZlcnNpb24uXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMucHJvdG9jb2wgPSA0O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQYWNrZXQgdHlwZXMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMudHlwZXMgPSBbXG5cdFx0XHRcdFx0J0NPTk5FQ1QnLFxuXHRcdFx0XHRcdCdESVNDT05ORUNUJyxcblx0XHRcdFx0XHQnRVZFTlQnLFxuXHRcdFx0XHRcdCdCSU5BUllfRVZFTlQnLFxuXHRcdFx0XHRcdCdBQ0snLFxuXHRcdFx0XHRcdCdCSU5BUllfQUNLJyxcblx0XHRcdFx0XHQnRVJST1InXG5cdFx0XHRcdF07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFBhY2tldCB0eXBlIGBjb25uZWN0YC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZXhwb3J0cy5DT05ORUNUID0gMDtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUGFja2V0IHR5cGUgYGRpc2Nvbm5lY3RgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRleHBvcnRzLkRJU0NPTk5FQ1QgPSAxO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBQYWNrZXQgdHlwZSBgZXZlbnRgLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRleHBvcnRzLkVWRU5UID0gMjtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUGFja2V0IHR5cGUgYGFja2AuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuQUNLID0gMztcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUGFja2V0IHR5cGUgYGVycm9yYC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZXhwb3J0cy5FUlJPUiA9IDQ7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIFBhY2tldCB0eXBlICdiaW5hcnkgZXZlbnQnXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuQklOQVJZX0VWRU5UID0gNTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogUGFja2V0IHR5cGUgYGJpbmFyeSBhY2tgLiBGb3IgYWNrcyB3aXRoIGJpbmFyeSBhcmd1bWVudHMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuQklOQVJZX0FDSyA9IDY7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEVuY29kZXIgY29uc3RydWN0b3IuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuRW5jb2RlciA9IEVuY29kZXI7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIERlY29kZXIgY29uc3RydWN0b3IuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdGV4cG9ydHMuRGVjb2RlciA9IERlY29kZXI7XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEEgc29ja2V0LmlvIEVuY29kZXIgaW5zdGFuY2Vcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQGFwaSBwdWJsaWNcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gRW5jb2RlcigpIHt9XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIEVuY29kZSBhIHBhY2tldCBhcyBhIHNpbmdsZSBzdHJpbmcgaWYgbm9uLWJpbmFyeSwgb3IgYXMgYVxuXHRcdFx0XHQgKiBidWZmZXIgc2VxdWVuY2UsIGRlcGVuZGluZyBvbiBwYWNrZXQgdHlwZS5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtPYmplY3R9IG9iaiAtIHBhY2tldCBvYmplY3Rcblx0XHRcdFx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBmdW5jdGlvbiB0byBoYW5kbGUgZW5jb2RpbmdzIChsaWtlbHkgZW5naW5lLndyaXRlKVxuXHRcdFx0XHQgKiBAcmV0dXJuIENhbGxzIGNhbGxiYWNrIHdpdGggQXJyYXkgb2YgZW5jb2RpbmdzXG5cdFx0XHRcdCAqIEBhcGkgcHVibGljXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVuY29kZXIucHJvdG90eXBlLmVuY29kZSA9IGZ1bmN0aW9uIChvYmosIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0ZGVidWcoJ2VuY29kaW5nIHBhY2tldCAlaicsIG9iaik7XG5cblx0XHRcdFx0XHRpZiAoZXhwb3J0cy5CSU5BUllfRVZFTlQgPT0gb2JqLnR5cGUgfHwgZXhwb3J0cy5CSU5BUllfQUNLID09IG9iai50eXBlKSB7XG5cdFx0XHRcdFx0XHRlbmNvZGVBc0JpbmFyeShvYmosIGNhbGxiYWNrKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dmFyIGVuY29kaW5nID0gZW5jb2RlQXNTdHJpbmcob2JqKTtcblx0XHRcdFx0XHRcdGNhbGxiYWNrKFtlbmNvZGluZ10pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRW5jb2RlIHBhY2tldCBhcyBzdHJpbmcuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcblx0XHRcdFx0ICogQHJldHVybiB7U3RyaW5nfSBlbmNvZGVkXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBlbmNvZGVBc1N0cmluZyhvYmopIHtcblx0XHRcdFx0XHR2YXIgc3RyID0gJyc7XG5cdFx0XHRcdFx0dmFyIG5zcCA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0Ly8gZmlyc3QgaXMgdHlwZVxuXHRcdFx0XHRcdHN0ciArPSBvYmoudHlwZTtcblxuXHRcdFx0XHRcdC8vIGF0dGFjaG1lbnRzIGlmIHdlIGhhdmUgdGhlbVxuXHRcdFx0XHRcdGlmIChleHBvcnRzLkJJTkFSWV9FVkVOVCA9PSBvYmoudHlwZSB8fCBleHBvcnRzLkJJTkFSWV9BQ0sgPT0gb2JqLnR5cGUpIHtcblx0XHRcdFx0XHRcdHN0ciArPSBvYmouYXR0YWNobWVudHM7XG5cdFx0XHRcdFx0XHRzdHIgKz0gJy0nO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGlmIHdlIGhhdmUgYSBuYW1lc3BhY2Ugb3RoZXIgdGhhbiBgL2Bcblx0XHRcdFx0XHQvLyB3ZSBhcHBlbmQgaXQgZm9sbG93ZWQgYnkgYSBjb21tYSBgLGBcblx0XHRcdFx0XHRpZiAob2JqLm5zcCAmJiAnLycgIT0gb2JqLm5zcCkge1xuXHRcdFx0XHRcdFx0bnNwID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHN0ciArPSBvYmoubnNwO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IHRoZSBpZFxuXHRcdFx0XHRcdGlmIChudWxsICE9IG9iai5pZCkge1xuXHRcdFx0XHRcdFx0aWYgKG5zcCkge1xuXHRcdFx0XHRcdFx0XHRzdHIgKz0gJywnO1xuXHRcdFx0XHRcdFx0XHRuc3AgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHN0ciArPSBvYmouaWQ7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8ganNvbiBkYXRhXG5cdFx0XHRcdFx0aWYgKG51bGwgIT0gb2JqLmRhdGEpIHtcblx0XHRcdFx0XHRcdGlmIChuc3ApIHN0ciArPSAnLCc7XG5cdFx0XHRcdFx0XHRzdHIgKz0ganNvbi5zdHJpbmdpZnkob2JqLmRhdGEpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRlYnVnKCdlbmNvZGVkICVqIGFzICVzJywgb2JqLCBzdHIpO1xuXHRcdFx0XHRcdHJldHVybiBzdHI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRW5jb2RlIHBhY2tldCBhcyAnYnVmZmVyIHNlcXVlbmNlJyBieSByZW1vdmluZyBibG9icywgYW5kXG5cdFx0XHRcdCAqIGRlY29uc3RydWN0aW5nIHBhY2tldCBpbnRvIG9iamVjdCB3aXRoIHBsYWNlaG9sZGVycyBhbmRcblx0XHRcdFx0ICogYSBsaXN0IG9mIGJ1ZmZlcnMuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcblx0XHRcdFx0ICogQHJldHVybiB7QnVmZmVyfSBlbmNvZGVkXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBlbmNvZGVBc0JpbmFyeShvYmosIGNhbGxiYWNrKSB7XG5cblx0XHRcdFx0XHRmdW5jdGlvbiB3cml0ZUVuY29kaW5nKGJsb2JsZXNzRGF0YSkge1xuXHRcdFx0XHRcdFx0dmFyIGRlY29uc3RydWN0aW9uID0gYmluYXJ5LmRlY29uc3RydWN0UGFja2V0KGJsb2JsZXNzRGF0YSk7XG5cdFx0XHRcdFx0XHR2YXIgcGFjayA9IGVuY29kZUFzU3RyaW5nKGRlY29uc3RydWN0aW9uLnBhY2tldCk7XG5cdFx0XHRcdFx0XHR2YXIgYnVmZmVycyA9IGRlY29uc3RydWN0aW9uLmJ1ZmZlcnM7XG5cblx0XHRcdFx0XHRcdGJ1ZmZlcnMudW5zaGlmdChwYWNrKTsgLy8gYWRkIHBhY2tldCBpbmZvIHRvIGJlZ2lubmluZyBvZiBkYXRhIGxpc3Rcblx0XHRcdFx0XHRcdGNhbGxiYWNrKGJ1ZmZlcnMpOyAvLyB3cml0ZSBhbGwgdGhlIGJ1ZmZlcnNcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRiaW5hcnkucmVtb3ZlQmxvYnMob2JqLCB3cml0ZUVuY29kaW5nKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBBIHNvY2tldC5pbyBEZWNvZGVyIGluc3RhbmNlXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEByZXR1cm4ge09iamVjdH0gZGVjb2RlclxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRmdW5jdGlvbiBEZWNvZGVyKCkge1xuXHRcdFx0XHRcdHRoaXMucmVjb25zdHJ1Y3RvciA9IG51bGw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogTWl4IGluIGBFbWl0dGVyYCB3aXRoIERlY29kZXIuXG5cdFx0XHRcdCAqL1xuXG5cdFx0XHRcdEVtaXR0ZXIoRGVjb2Rlci5wcm90b3R5cGUpO1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBEZWNvZGVzIGFuIGVjb2RlZCBwYWNrZXQgc3RyaW5nIGludG8gcGFja2V0IEpTT04uXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7U3RyaW5nfSBvYmogLSBlbmNvZGVkIHBhY2tldFxuXHRcdFx0XHQgKiBAcmV0dXJuIHtPYmplY3R9IHBhY2tldFxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHREZWNvZGVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAob2JqKSB7XG5cdFx0XHRcdFx0dmFyIHBhY2tldDtcblx0XHRcdFx0XHRpZiAoJ3N0cmluZycgPT0gdHlwZW9mIG9iaikge1xuXHRcdFx0XHRcdFx0cGFja2V0ID0gZGVjb2RlU3RyaW5nKG9iaik7XG5cdFx0XHRcdFx0XHRpZiAoZXhwb3J0cy5CSU5BUllfRVZFTlQgPT0gcGFja2V0LnR5cGUgfHwgZXhwb3J0cy5CSU5BUllfQUNLID09IHBhY2tldC50eXBlKSB7IC8vIGJpbmFyeSBwYWNrZXQncyBqc29uXG5cdFx0XHRcdFx0XHRcdHRoaXMucmVjb25zdHJ1Y3RvciA9IG5ldyBCaW5hcnlSZWNvbnN0cnVjdG9yKHBhY2tldCk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gbm8gYXR0YWNobWVudHMsIGxhYmVsZWQgYmluYXJ5IGJ1dCBubyBiaW5hcnkgZGF0YSB0byBmb2xsb3dcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucmVjb25zdHJ1Y3Rvci5yZWNvblBhY2suYXR0YWNobWVudHMgPT09IDApIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2RlY29kZWQnLCBwYWNrZXQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2UgeyAvLyBub24tYmluYXJ5IGZ1bGwgcGFja2V0XG5cdFx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnZGVjb2RlZCcsIHBhY2tldCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChpc0J1ZihvYmopIHx8IG9iai5iYXNlNjQpIHsgLy8gcmF3IGJpbmFyeSBkYXRhXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMucmVjb25zdHJ1Y3Rvcikge1xuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ2dvdCBiaW5hcnkgZGF0YSB3aGVuIG5vdCByZWNvbnN0cnVjdGluZyBhIHBhY2tldCcpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0cGFja2V0ID0gdGhpcy5yZWNvbnN0cnVjdG9yLnRha2VCaW5hcnlEYXRhKG9iaik7XG5cdFx0XHRcdFx0XHRcdGlmIChwYWNrZXQpIHsgLy8gcmVjZWl2ZWQgZmluYWwgYnVmZmVyXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5yZWNvbnN0cnVjdG9yID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmVtaXQoJ2RlY29kZWQnLCBwYWNrZXQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcignVW5rbm93biB0eXBlOiAnICsgb2JqKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0LyoqXG5cdFx0XHRcdCAqIERlY29kZSBhIHBhY2tldCBTdHJpbmcgKEpTT04gZGF0YSlcblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtTdHJpbmd9IHN0clxuXHRcdFx0XHQgKiBAcmV0dXJuIHtPYmplY3R9IHBhY2tldFxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gZGVjb2RlU3RyaW5nKHN0cikge1xuXHRcdFx0XHRcdHZhciBwID0ge307XG5cdFx0XHRcdFx0dmFyIGkgPSAwO1xuXG5cdFx0XHRcdFx0Ly8gbG9vayB1cCB0eXBlXG5cdFx0XHRcdFx0cC50eXBlID0gTnVtYmVyKHN0ci5jaGFyQXQoMCkpO1xuXHRcdFx0XHRcdGlmIChudWxsID09IGV4cG9ydHMudHlwZXNbcC50eXBlXSkgcmV0dXJuIGVycm9yKCk7XG5cblx0XHRcdFx0XHQvLyBsb29rIHVwIGF0dGFjaG1lbnRzIGlmIHR5cGUgYmluYXJ5XG5cdFx0XHRcdFx0aWYgKGV4cG9ydHMuQklOQVJZX0VWRU5UID09IHAudHlwZSB8fCBleHBvcnRzLkJJTkFSWV9BQ0sgPT0gcC50eXBlKSB7XG5cdFx0XHRcdFx0XHR2YXIgYnVmID0gJyc7XG5cdFx0XHRcdFx0XHR3aGlsZSAoc3RyLmNoYXJBdCgrK2kpICE9ICctJykge1xuXHRcdFx0XHRcdFx0XHRidWYgKz0gc3RyLmNoYXJBdChpKTtcblx0XHRcdFx0XHRcdFx0aWYgKGkgPT0gc3RyLmxlbmd0aCkgYnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoYnVmICE9IE51bWJlcihidWYpIHx8IHN0ci5jaGFyQXQoaSkgIT0gJy0nKSB7XG5cdFx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcignSWxsZWdhbCBhdHRhY2htZW50cycpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cC5hdHRhY2htZW50cyA9IE51bWJlcihidWYpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGxvb2sgdXAgbmFtZXNwYWNlIChpZiBhbnkpXG5cdFx0XHRcdFx0aWYgKCcvJyA9PSBzdHIuY2hhckF0KGkgKyAxKSkge1xuXHRcdFx0XHRcdFx0cC5uc3AgPSAnJztcblx0XHRcdFx0XHRcdHdoaWxlICgrK2kpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGMgPSBzdHIuY2hhckF0KGkpO1xuXHRcdFx0XHRcdFx0XHRpZiAoJywnID09IGMpIGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRwLm5zcCArPSBjO1xuXHRcdFx0XHRcdFx0XHRpZiAoaSA9PSBzdHIubGVuZ3RoKSBicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cC5uc3AgPSAnLyc7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gbG9vayB1cCBpZFxuXHRcdFx0XHRcdHZhciBuZXh0ID0gc3RyLmNoYXJBdChpICsgMSk7XG5cdFx0XHRcdFx0aWYgKCcnICE9PSBuZXh0ICYmIE51bWJlcihuZXh0KSA9PSBuZXh0KSB7XG5cdFx0XHRcdFx0XHRwLmlkID0gJyc7XG5cdFx0XHRcdFx0XHR3aGlsZSAoKytpKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBjID0gc3RyLmNoYXJBdChpKTtcblx0XHRcdFx0XHRcdFx0aWYgKG51bGwgPT0gYyB8fCBOdW1iZXIoYykgIT0gYykge1xuXHRcdFx0XHRcdFx0XHRcdC0taTtcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRwLmlkICs9IHN0ci5jaGFyQXQoaSk7XG5cdFx0XHRcdFx0XHRcdGlmIChpID09IHN0ci5sZW5ndGgpIGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cC5pZCA9IE51bWJlcihwLmlkKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBsb29rIHVwIGpzb24gZGF0YVxuXHRcdFx0XHRcdGlmIChzdHIuY2hhckF0KCsraSkpIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdHAuZGF0YSA9IGpzb24ucGFyc2Uoc3RyLnN1YnN0cihpKSk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBlcnJvcigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRlYnVnKCdkZWNvZGVkICVzIGFzICVqJywgc3RyLCBwKTtcblx0XHRcdFx0XHRyZXR1cm4gcDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBEZWFsbG9jYXRlcyBhIHBhcnNlcidzIHJlc291cmNlc1xuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHB1YmxpY1xuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHREZWNvZGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGlmICh0aGlzLnJlY29uc3RydWN0b3IpIHtcblx0XHRcdFx0XHRcdHRoaXMucmVjb25zdHJ1Y3Rvci5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBBIG1hbmFnZXIgb2YgYSBiaW5hcnkgZXZlbnQncyAnYnVmZmVyIHNlcXVlbmNlJy4gU2hvdWxkXG5cdFx0XHRcdCAqIGJlIGNvbnN0cnVjdGVkIHdoZW5ldmVyIGEgcGFja2V0IG9mIHR5cGUgQklOQVJZX0VWRU5UIGlzXG5cdFx0XHRcdCAqIGRlY29kZWQuXG5cdFx0XHRcdCAqXG5cdFx0XHRcdCAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcblx0XHRcdFx0ICogQHJldHVybiB7QmluYXJ5UmVjb25zdHJ1Y3Rvcn0gaW5pdGlhbGl6ZWQgcmVjb25zdHJ1Y3RvclxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0ZnVuY3Rpb24gQmluYXJ5UmVjb25zdHJ1Y3RvcihwYWNrZXQpIHtcblx0XHRcdFx0XHR0aGlzLnJlY29uUGFjayA9IHBhY2tldDtcblx0XHRcdFx0XHR0aGlzLmJ1ZmZlcnMgPSBbXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qKlxuXHRcdFx0XHQgKiBNZXRob2QgdG8gYmUgY2FsbGVkIHdoZW4gYmluYXJ5IGRhdGEgcmVjZWl2ZWQgZnJvbSBjb25uZWN0aW9uXG5cdFx0XHRcdCAqIGFmdGVyIGEgQklOQVJZX0VWRU5UIHBhY2tldC5cblx0XHRcdFx0ICpcblx0XHRcdFx0ICogQHBhcmFtIHtCdWZmZXIgfCBBcnJheUJ1ZmZlcn0gYmluRGF0YSAtIHRoZSByYXcgYmluYXJ5IGRhdGEgcmVjZWl2ZWRcblx0XHRcdFx0ICogQHJldHVybiB7bnVsbCB8IE9iamVjdH0gcmV0dXJucyBudWxsIGlmIG1vcmUgYmluYXJ5IGRhdGEgaXMgZXhwZWN0ZWQgb3Jcblx0XHRcdFx0ICogICBhIHJlY29uc3RydWN0ZWQgcGFja2V0IG9iamVjdCBpZiBhbGwgYnVmZmVycyBoYXZlIGJlZW4gcmVjZWl2ZWQuXG5cdFx0XHRcdCAqIEBhcGkgcHJpdmF0ZVxuXHRcdFx0XHQgKi9cblxuXHRcdFx0XHRCaW5hcnlSZWNvbnN0cnVjdG9yLnByb3RvdHlwZS50YWtlQmluYXJ5RGF0YSA9IGZ1bmN0aW9uIChiaW5EYXRhKSB7XG5cdFx0XHRcdFx0dGhpcy5idWZmZXJzLnB1c2goYmluRGF0YSk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuYnVmZmVycy5sZW5ndGggPT0gdGhpcy5yZWNvblBhY2suYXR0YWNobWVudHMpIHsgLy8gZG9uZSB3aXRoIGJ1ZmZlciBsaXN0XG5cdFx0XHRcdFx0XHR2YXIgcGFja2V0ID0gYmluYXJ5LnJlY29uc3RydWN0UGFja2V0KHRoaXMucmVjb25QYWNrLCB0aGlzLmJ1ZmZlcnMpO1xuXHRcdFx0XHRcdFx0dGhpcy5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcGFja2V0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogQ2xlYW5zIHVwIGJpbmFyeSBwYWNrZXQgcmVjb25zdHJ1Y3Rpb24gdmFyaWFibGVzLlxuXHRcdFx0XHQgKlxuXHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0ICovXG5cblx0XHRcdFx0QmluYXJ5UmVjb25zdHJ1Y3Rvci5wcm90b3R5cGUuZmluaXNoZWRSZWNvbnN0cnVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHR0aGlzLnJlY29uUGFjayA9IG51bGw7XG5cdFx0XHRcdFx0dGhpcy5idWZmZXJzID0gW107XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0ZnVuY3Rpb24gZXJyb3IoZGF0YSkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHR0eXBlOiBleHBvcnRzLkVSUk9SLFxuXHRcdFx0XHRcdFx0ZGF0YTogJ3BhcnNlciBlcnJvcidcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cblx0XHRcdH0sIHtcblx0XHRcdFx0XCIuL2JpbmFyeVwiOiA0Nixcblx0XHRcdFx0XCIuL2lzLWJ1ZmZlclwiOiA0OCxcblx0XHRcdFx0XCJjb21wb25lbnQtZW1pdHRlclwiOiA0OSxcblx0XHRcdFx0XCJkZWJ1Z1wiOiAzOSxcblx0XHRcdFx0XCJpc2FycmF5XCI6IDQzLFxuXHRcdFx0XHRcImpzb24zXCI6IDUwXG5cdFx0XHR9XSxcblx0XHRcdDQ4OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHQoZnVuY3Rpb24gKGdsb2JhbCkge1xuXG5cdFx0XHRcdFx0bW9kdWxlLmV4cG9ydHMgPSBpc0J1ZjtcblxuXHRcdFx0XHRcdC8qKlxuXHRcdFx0XHRcdCAqIFJldHVybnMgdHJ1ZSBpZiBvYmogaXMgYSBidWZmZXIgb3IgYW4gYXJyYXlidWZmZXIuXG5cdFx0XHRcdFx0ICpcblx0XHRcdFx0XHQgKiBAYXBpIHByaXZhdGVcblx0XHRcdFx0XHQgKi9cblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGlzQnVmKG9iaikge1xuXHRcdFx0XHRcdFx0cmV0dXJuIChnbG9iYWwuQnVmZmVyICYmIGdsb2JhbC5CdWZmZXIuaXNCdWZmZXIob2JqKSkgfHxcblx0XHRcdFx0XHRcdFx0KGdsb2JhbC5BcnJheUJ1ZmZlciAmJiBvYmogaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0pLmNhbGwodGhpcywgdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB7fSlcblx0XHRcdH0sIHt9XSxcblx0XHRcdDQ5OiBbZnVuY3Rpb24gKF9kZXJlcV8sIG1vZHVsZSwgZXhwb3J0cykge1xuXHRcdFx0XHRhcmd1bWVudHNbNF1bMTVdWzBdLmFwcGx5KGV4cG9ydHMsIGFyZ3VtZW50cylcblx0XHRcdH0sIHtcblx0XHRcdFx0XCJkdXBcIjogMTVcblx0XHRcdH1dLFxuXHRcdFx0NTA6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdChmdW5jdGlvbiAoZ2xvYmFsKSB7XG5cdFx0XHRcdFx0LyohIEpTT04gdjMuMy4yIHwgaHR0cDovL2Jlc3RpZWpzLmdpdGh1Yi5pby9qc29uMyB8IENvcHlyaWdodCAyMDEyLTIwMTQsIEtpdCBDYW1icmlkZ2UgfCBodHRwOi8va2l0Lm1pdC1saWNlbnNlLm9yZyAqL1xuXHRcdFx0XHRcdDtcblx0XHRcdFx0XHQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0Ly8gRGV0ZWN0IHRoZSBgZGVmaW5lYCBmdW5jdGlvbiBleHBvc2VkIGJ5IGFzeW5jaHJvbm91cyBtb2R1bGUgbG9hZGVycy4gVGhlXG5cdFx0XHRcdFx0XHQvLyBzdHJpY3QgYGRlZmluZWAgY2hlY2sgaXMgbmVjZXNzYXJ5IGZvciBjb21wYXRpYmlsaXR5IHdpdGggYHIuanNgLlxuXHRcdFx0XHRcdFx0dmFyIGlzTG9hZGVyID0gdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQ7XG5cblx0XHRcdFx0XHRcdC8vIEEgc2V0IG9mIHR5cGVzIHVzZWQgdG8gZGlzdGluZ3Vpc2ggb2JqZWN0cyBmcm9tIHByaW1pdGl2ZXMuXG5cdFx0XHRcdFx0XHR2YXIgb2JqZWN0VHlwZXMgPSB7XG5cdFx0XHRcdFx0XHRcdFwiZnVuY3Rpb25cIjogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0XCJvYmplY3RcIjogdHJ1ZVxuXHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0Ly8gRGV0ZWN0IHRoZSBgZXhwb3J0c2Agb2JqZWN0IGV4cG9zZWQgYnkgQ29tbW9uSlMgaW1wbGVtZW50YXRpb25zLlxuXHRcdFx0XHRcdFx0dmFyIGZyZWVFeHBvcnRzID0gb2JqZWN0VHlwZXNbdHlwZW9mIGV4cG9ydHNdICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblxuXHRcdFx0XHRcdFx0Ly8gVXNlIHRoZSBgZ2xvYmFsYCBvYmplY3QgZXhwb3NlZCBieSBOb2RlIChpbmNsdWRpbmcgQnJvd3NlcmlmeSB2aWFcblx0XHRcdFx0XHRcdC8vIGBpbnNlcnQtbW9kdWxlLWdsb2JhbHNgKSwgTmFyd2hhbCwgYW5kIFJpbmdvIGFzIHRoZSBkZWZhdWx0IGNvbnRleHQsXG5cdFx0XHRcdFx0XHQvLyBhbmQgdGhlIGB3aW5kb3dgIG9iamVjdCBpbiBicm93c2Vycy4gUmhpbm8gZXhwb3J0cyBhIGBnbG9iYWxgIGZ1bmN0aW9uXG5cdFx0XHRcdFx0XHQvLyBpbnN0ZWFkLlxuXHRcdFx0XHRcdFx0dmFyIHJvb3QgPSBvYmplY3RUeXBlc1t0eXBlb2Ygd2luZG93XSAmJiB3aW5kb3cgfHwgdGhpcyxcblx0XHRcdFx0XHRcdFx0ZnJlZUdsb2JhbCA9IGZyZWVFeHBvcnRzICYmIG9iamVjdFR5cGVzW3R5cGVvZiBtb2R1bGVdICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlICYmIHR5cGVvZiBnbG9iYWwgPT0gXCJvYmplY3RcIiAmJiBnbG9iYWw7XG5cblx0XHRcdFx0XHRcdGlmIChmcmVlR2xvYmFsICYmIChmcmVlR2xvYmFsW1wiZ2xvYmFsXCJdID09PSBmcmVlR2xvYmFsIHx8IGZyZWVHbG9iYWxbXCJ3aW5kb3dcIl0gPT09IGZyZWVHbG9iYWwgfHwgZnJlZUdsb2JhbFtcInNlbGZcIl0gPT09IGZyZWVHbG9iYWwpKSB7XG5cdFx0XHRcdFx0XHRcdHJvb3QgPSBmcmVlR2xvYmFsO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvLyBQdWJsaWM6IEluaXRpYWxpemVzIEpTT04gMyB1c2luZyB0aGUgZ2l2ZW4gYGNvbnRleHRgIG9iamVjdCwgYXR0YWNoaW5nIHRoZVxuXHRcdFx0XHRcdFx0Ly8gYHN0cmluZ2lmeWAgYW5kIGBwYXJzZWAgZnVuY3Rpb25zIHRvIHRoZSBzcGVjaWZpZWQgYGV4cG9ydHNgIG9iamVjdC5cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIHJ1bkluQ29udGV4dChjb250ZXh0LCBleHBvcnRzKSB7XG5cdFx0XHRcdFx0XHRcdGNvbnRleHQgfHwgKGNvbnRleHQgPSByb290W1wiT2JqZWN0XCJdKCkpO1xuXHRcdFx0XHRcdFx0XHRleHBvcnRzIHx8IChleHBvcnRzID0gcm9vdFtcIk9iamVjdFwiXSgpKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBOYXRpdmUgY29uc3RydWN0b3IgYWxpYXNlcy5cblx0XHRcdFx0XHRcdFx0dmFyIE51bWJlciA9IGNvbnRleHRbXCJOdW1iZXJcIl0gfHwgcm9vdFtcIk51bWJlclwiXSxcblx0XHRcdFx0XHRcdFx0XHRTdHJpbmcgPSBjb250ZXh0W1wiU3RyaW5nXCJdIHx8IHJvb3RbXCJTdHJpbmdcIl0sXG5cdFx0XHRcdFx0XHRcdFx0T2JqZWN0ID0gY29udGV4dFtcIk9iamVjdFwiXSB8fCByb290W1wiT2JqZWN0XCJdLFxuXHRcdFx0XHRcdFx0XHRcdERhdGUgPSBjb250ZXh0W1wiRGF0ZVwiXSB8fCByb290W1wiRGF0ZVwiXSxcblx0XHRcdFx0XHRcdFx0XHRTeW50YXhFcnJvciA9IGNvbnRleHRbXCJTeW50YXhFcnJvclwiXSB8fCByb290W1wiU3ludGF4RXJyb3JcIl0sXG5cdFx0XHRcdFx0XHRcdFx0VHlwZUVycm9yID0gY29udGV4dFtcIlR5cGVFcnJvclwiXSB8fCByb290W1wiVHlwZUVycm9yXCJdLFxuXHRcdFx0XHRcdFx0XHRcdE1hdGggPSBjb250ZXh0W1wiTWF0aFwiXSB8fCByb290W1wiTWF0aFwiXSxcblx0XHRcdFx0XHRcdFx0XHRuYXRpdmVKU09OID0gY29udGV4dFtcIkpTT05cIl0gfHwgcm9vdFtcIkpTT05cIl07XG5cblx0XHRcdFx0XHRcdFx0Ly8gRGVsZWdhdGUgdG8gdGhlIG5hdGl2ZSBgc3RyaW5naWZ5YCBhbmQgYHBhcnNlYCBpbXBsZW1lbnRhdGlvbnMuXG5cdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgbmF0aXZlSlNPTiA9PSBcIm9iamVjdFwiICYmIG5hdGl2ZUpTT04pIHtcblx0XHRcdFx0XHRcdFx0XHRleHBvcnRzLnN0cmluZ2lmeSA9IG5hdGl2ZUpTT04uc3RyaW5naWZ5O1xuXHRcdFx0XHRcdFx0XHRcdGV4cG9ydHMucGFyc2UgPSBuYXRpdmVKU09OLnBhcnNlO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0Ly8gQ29udmVuaWVuY2UgYWxpYXNlcy5cblx0XHRcdFx0XHRcdFx0dmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZSxcblx0XHRcdFx0XHRcdFx0XHRnZXRDbGFzcyA9IG9iamVjdFByb3RvLnRvU3RyaW5nLFxuXHRcdFx0XHRcdFx0XHRcdGlzUHJvcGVydHksIGZvckVhY2gsIHVuZGVmO1xuXG5cdFx0XHRcdFx0XHRcdC8vIFRlc3QgdGhlIGBEYXRlI2dldFVUQypgIG1ldGhvZHMuIEJhc2VkIG9uIHdvcmsgYnkgQFlhZmZsZS5cblx0XHRcdFx0XHRcdFx0dmFyIGlzRXh0ZW5kZWQgPSBuZXcgRGF0ZSgtMzUwOTgyNzMzNDU3MzI5Mik7XG5cdFx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGBnZXRVVENGdWxsWWVhcmAsIGBNb250aGAsIGFuZCBgRGF0ZWAgbWV0aG9kcyByZXR1cm4gbm9uc2Vuc2ljYWxcblx0XHRcdFx0XHRcdFx0XHQvLyByZXN1bHRzIGZvciBjZXJ0YWluIGRhdGVzIGluIE9wZXJhID49IDEwLjUzLlxuXHRcdFx0XHRcdFx0XHRcdGlzRXh0ZW5kZWQgPSBpc0V4dGVuZGVkLmdldFVUQ0Z1bGxZZWFyKCkgPT0gLTEwOTI1MiAmJiBpc0V4dGVuZGVkLmdldFVUQ01vbnRoKCkgPT09IDAgJiYgaXNFeHRlbmRlZC5nZXRVVENEYXRlKCkgPT09IDEgJiZcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFNhZmFyaSA8IDIuMC4yIHN0b3JlcyB0aGUgaW50ZXJuYWwgbWlsbGlzZWNvbmQgdGltZSB2YWx1ZSBjb3JyZWN0bHksXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBidXQgY2xpcHMgdGhlIHZhbHVlcyByZXR1cm5lZCBieSB0aGUgZGF0ZSBtZXRob2RzIHRvIHRoZSByYW5nZSBvZlxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gc2lnbmVkIDMyLWJpdCBpbnRlZ2VycyAoWy0yICoqIDMxLCAyICoqIDMxIC0gMV0pLlxuXHRcdFx0XHRcdFx0XHRcdFx0aXNFeHRlbmRlZC5nZXRVVENIb3VycygpID09IDEwICYmIGlzRXh0ZW5kZWQuZ2V0VVRDTWludXRlcygpID09IDM3ICYmIGlzRXh0ZW5kZWQuZ2V0VVRDU2Vjb25kcygpID09IDYgJiYgaXNFeHRlbmRlZC5nZXRVVENNaWxsaXNlY29uZHMoKSA9PSA3MDg7XG5cdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cblxuXHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBuYXRpdmUgYEpTT04uc3RyaW5naWZ5YCBhbmQgYHBhcnNlYFxuXHRcdFx0XHRcdFx0XHQvLyBpbXBsZW1lbnRhdGlvbnMgYXJlIHNwZWMtY29tcGxpYW50LiBCYXNlZCBvbiB3b3JrIGJ5IEtlbiBTbnlkZXIuXG5cdFx0XHRcdFx0XHRcdGZ1bmN0aW9uIGhhcyhuYW1lKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGhhc1tuYW1lXSAhPT0gdW5kZWYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFJldHVybiBjYWNoZWQgZmVhdHVyZSB0ZXN0IHJlc3VsdC5cblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBoYXNbbmFtZV07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHZhciBpc1N1cHBvcnRlZDtcblx0XHRcdFx0XHRcdFx0XHRpZiAobmFtZSA9PSBcImJ1Zy1zdHJpbmctY2hhci1pbmRleFwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJRSA8PSA3IGRvZXNuJ3Qgc3VwcG9ydCBhY2Nlc3Npbmcgc3RyaW5nIGNoYXJhY3RlcnMgdXNpbmcgc3F1YXJlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBicmFja2V0IG5vdGF0aW9uLiBJRSA4IG9ubHkgc3VwcG9ydHMgdGhpcyBmb3IgcHJpbWl0aXZlcy5cblx0XHRcdFx0XHRcdFx0XHRcdGlzU3VwcG9ydGVkID0gXCJhXCIgWzBdICE9IFwiYVwiO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobmFtZSA9PSBcImpzb25cIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW5kaWNhdGVzIHdoZXRoZXIgYm90aCBgSlNPTi5zdHJpbmdpZnlgIGFuZCBgSlNPTi5wYXJzZWAgYXJlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBzdXBwb3J0ZWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRpc1N1cHBvcnRlZCA9IGhhcyhcImpzb24tc3RyaW5naWZ5XCIpICYmIGhhcyhcImpzb24tcGFyc2VcIik7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciB2YWx1ZSwgc2VyaWFsaXplZCA9ICd7XCJhXCI6WzEsdHJ1ZSxmYWxzZSxudWxsLFwiXFxcXHUwMDAwXFxcXGJcXFxcblxcXFxmXFxcXHJcXFxcdFwiXX0nO1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGVzdCBgSlNPTi5zdHJpbmdpZnlgLlxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG5hbWUgPT0gXCJqc29uLXN0cmluZ2lmeVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBzdHJpbmdpZnkgPSBleHBvcnRzLnN0cmluZ2lmeSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnlTdXBwb3J0ZWQgPSB0eXBlb2Ygc3RyaW5naWZ5ID09IFwiZnVuY3Rpb25cIiAmJiBpc0V4dGVuZGVkO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoc3RyaW5naWZ5U3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQSB0ZXN0IGZ1bmN0aW9uIG9iamVjdCB3aXRoIGEgY3VzdG9tIGB0b0pTT05gIG1ldGhvZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQodmFsdWUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gMTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KS50b0pTT04gPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5U3VwcG9ydGVkID1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRmlyZWZveCAzLjFiMSBhbmQgYjIgc2VyaWFsaXplIHN0cmluZywgbnVtYmVyLCBhbmQgYm9vbGVhblxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBwcmltaXRpdmVzIGFzIG9iamVjdCBsaXRlcmFscy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KDApID09PSBcIjBcIiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiAzLjFiMSwgYjIsIGFuZCBKU09OIDIgc2VyaWFsaXplIHdyYXBwZWQgcHJpbWl0aXZlcyBhcyBvYmplY3Rcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeShuZXcgTnVtYmVyKCkpID09PSBcIjBcIiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IFN0cmluZygpKSA9PSAnXCJcIicgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gRkYgMy4xYjEsIDIgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIHZhbHVlIGlzIGBudWxsYCwgYHVuZGVmaW5lZGAsIG9yXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRvZXMgbm90IGRlZmluZSBhIGNhbm9uaWNhbCBKU09OIHJlcHJlc2VudGF0aW9uICh0aGlzIGFwcGxpZXMgdG9cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gb2JqZWN0cyB3aXRoIGB0b0pTT05gIHByb3BlcnRpZXMgYXMgd2VsbCwgKnVubGVzcyogdGhleSBhcmUgbmVzdGVkXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHdpdGhpbiBhbiBvYmplY3Qgb3IgYXJyYXkpLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkoZ2V0Q2xhc3MpID09PSB1bmRlZiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBJRSA4IHNlcmlhbGl6ZXMgYHVuZGVmaW5lZGAgYXMgYFwidW5kZWZpbmVkXCJgLiBTYWZhcmkgPD0gNS4xLjcgYW5kXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIzIHBhc3MgdGhpcyB0ZXN0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkodW5kZWYpID09PSB1bmRlZiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTYWZhcmkgPD0gNS4xLjcgYW5kIEZGIDMuMWIzIHRocm93IGBFcnJvcmBzIGFuZCBgVHlwZUVycm9yYHMsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHJlc3BlY3RpdmVseSwgaWYgdGhlIHZhbHVlIGlzIG9taXR0ZWQgZW50aXJlbHkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeSgpID09PSB1bmRlZiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiAzLjFiMSwgMiB0aHJvdyBhbiBlcnJvciBpZiB0aGUgZ2l2ZW4gdmFsdWUgaXMgbm90IGEgbnVtYmVyLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBzdHJpbmcsIGFycmF5LCBvYmplY3QsIEJvb2xlYW4sIG9yIGBudWxsYCBsaXRlcmFsLiBUaGlzIGFwcGxpZXMgdG9cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gb2JqZWN0cyB3aXRoIGN1c3RvbSBgdG9KU09OYCBtZXRob2RzIGFzIHdlbGwsIHVubGVzcyB0aGV5IGFyZSBuZXN0ZWRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gaW5zaWRlIG9iamVjdCBvciBhcnJheSBsaXRlcmFscy4gWVVJIDMuMC4wYjEgaWdub3JlcyBjdXN0b20gYHRvSlNPTmBcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbWV0aG9kcyBlbnRpcmVseS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KHZhbHVlKSA9PT0gXCIxXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KFt2YWx1ZV0pID09IFwiWzFdXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUHJvdG90eXBlIDw9IDEuNi4xIHNlcmlhbGl6ZXMgYFt1bmRlZmluZWRdYCBhcyBgXCJbXVwiYCBpbnN0ZWFkIG9mXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGBcIltudWxsXVwiYC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KFt1bmRlZl0pID09IFwiW251bGxdXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gWVVJIDMuMC4wYjEgZmFpbHMgdG8gc2VyaWFsaXplIGBudWxsYCBsaXRlcmFscy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KG51bGwpID09IFwibnVsbFwiICYmXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxLCAyIGhhbHRzIHNlcmlhbGl6YXRpb24gaWYgYW4gYXJyYXkgY29udGFpbnMgYSBmdW5jdGlvbjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFsxLCB0cnVlLCBnZXRDbGFzcywgMV1gIHNlcmlhbGl6ZXMgYXMgXCJbMSx0cnVlLF0sXCIuIEZGIDMuMWIzXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGVsaWRlcyBub24tSlNPTiB2YWx1ZXMgZnJvbSBvYmplY3RzIGFuZCBhcnJheXMsIHVubGVzcyB0aGV5XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRlZmluZSBjdXN0b20gYHRvSlNPTmAgbWV0aG9kcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KFt1bmRlZiwgZ2V0Q2xhc3MsIG51bGxdKSA9PSBcIltudWxsLG51bGwsbnVsbF1cIiAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTaW1wbGUgc2VyaWFsaXphdGlvbiB0ZXN0LiBGRiAzLjFiMSB1c2VzIFVuaWNvZGUgZXNjYXBlIHNlcXVlbmNlc1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyB3aGVyZSBjaGFyYWN0ZXIgZXNjYXBlIGNvZGVzIGFyZSBleHBlY3RlZCAoZS5nLiwgYFxcYmAgPT4gYFxcdTAwMDhgKS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcImFcIjogW3ZhbHVlLCB0cnVlLCBmYWxzZSwgbnVsbCwgXCJcXHgwMFxcYlxcblxcZlxcclxcdFwiXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KSA9PSBzZXJpYWxpemVkICYmXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxIGFuZCBiMiBpZ25vcmUgdGhlIGBmaWx0ZXJgIGFuZCBgd2lkdGhgIGFyZ3VtZW50cy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KG51bGwsIHZhbHVlKSA9PT0gXCIxXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5naWZ5KFsxLCAyXSwgbnVsbCwgMSkgPT0gXCJbXFxuIDEsXFxuIDJcXG5dXCIgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSlNPTiAyLCBQcm90b3R5cGUgPD0gMS43LCBhbmQgb2xkZXIgV2ViS2l0IGJ1aWxkcyBpbmNvcnJlY3RseVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBzZXJpYWxpemUgZXh0ZW5kZWQgeWVhcnMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeShuZXcgRGF0ZSgtOC42NGUxNSkpID09ICdcIi0yNzE4MjEtMDQtMjBUMDA6MDA6MDAuMDAwWlwiJyAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgbWlsbGlzZWNvbmRzIGFyZSBvcHRpb25hbCBpbiBFUyA1LCBidXQgcmVxdWlyZWQgaW4gNS4xLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IERhdGUoOC42NGUxNSkpID09ICdcIisyNzU3NjAtMDktMTNUMDA6MDA6MDAuMDAwWlwiJyAmJlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGaXJlZm94IDw9IDExLjAgaW5jb3JyZWN0bHkgc2VyaWFsaXplcyB5ZWFycyBwcmlvciB0byAwIGFzIG5lZ2F0aXZlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGZvdXItZGlnaXQgeWVhcnMgaW5zdGVhZCBvZiBzaXgtZGlnaXQgeWVhcnMuIENyZWRpdHM6IEBZYWZmbGUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN0cmluZ2lmeShuZXcgRGF0ZSgtNjIxOTg3NTUyZTUpKSA9PSAnXCItMDAwMDAxLTAxLTAxVDAwOjAwOjAwLjAwMFpcIicgJiZcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2FmYXJpIDw9IDUuMS41IGFuZCBPcGVyYSA+PSAxMC41MyBpbmNvcnJlY3RseSBzZXJpYWxpemUgbWlsbGlzZWNvbmRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gdmFsdWVzIGxlc3MgdGhhbiAxMDAwLiBDcmVkaXRzOiBAWWFmZmxlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnkobmV3IERhdGUoLTEpKSA9PSAnXCIxOTY5LTEyLTMxVDIzOjU5OjU5Ljk5OVpcIic7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBjYXRjaCAoZXhjZXB0aW9uKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdHJpbmdpZnlTdXBwb3J0ZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aXNTdXBwb3J0ZWQgPSBzdHJpbmdpZnlTdXBwb3J0ZWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBUZXN0IGBKU09OLnBhcnNlYC5cblx0XHRcdFx0XHRcdFx0XHRcdGlmIChuYW1lID09IFwianNvbi1wYXJzZVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBwYXJzZSA9IGV4cG9ydHMucGFyc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgcGFyc2UgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZGIDMuMWIxLCBiMiB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhIGJhcmUgbGl0ZXJhbCBpcyBwcm92aWRlZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENvbmZvcm1pbmcgaW1wbGVtZW50YXRpb25zIHNob3VsZCBhbHNvIGNvZXJjZSB0aGUgaW5pdGlhbCBhcmd1bWVudCB0b1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYSBzdHJpbmcgcHJpb3IgdG8gcGFyc2luZy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChwYXJzZShcIjBcIikgPT09IDAgJiYgIXBhcnNlKGZhbHNlKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTaW1wbGUgcGFyc2luZyB0ZXN0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IHBhcnNlKHNlcmlhbGl6ZWQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgcGFyc2VTdXBwb3J0ZWQgPSB2YWx1ZVtcImFcIl0ubGVuZ3RoID09IDUgJiYgdmFsdWVbXCJhXCJdWzBdID09PSAxO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAocGFyc2VTdXBwb3J0ZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2FmYXJpIDw9IDUuMS4yIGFuZCBGRiAzLjFiMSBhbGxvdyB1bmVzY2FwZWQgdGFicyBpbiBzdHJpbmdzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cGFyc2VTdXBwb3J0ZWQgPSAhcGFyc2UoJ1wiXFx0XCInKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChleGNlcHRpb24pIHt9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiA0LjAgYW5kIDQuMC4xIGFsbG93IGxlYWRpbmcgYCtgIHNpZ25zIGFuZCBsZWFkaW5nXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRlY2ltYWwgcG9pbnRzLiBGRiA0LjAsIDQuMC4xLCBhbmQgSUUgOS0xMCBhbHNvIGFsbG93XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNlcnRhaW4gb2N0YWwgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcnNlU3VwcG9ydGVkID0gcGFyc2UoXCIwMVwiKSAhPT0gMTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBhcnNlU3VwcG9ydGVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBGRiA0LjAsIDQuMC4xLCBhbmQgUmhpbm8gMS43UjMtUjQgYWxsb3cgdHJhaWxpbmcgZGVjaW1hbFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBwb2ludHMuIFRoZXNlIGVudmlyb25tZW50cywgYWxvbmcgd2l0aCBGRiAzLjFiMSBhbmQgMixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYWxzbyBhbGxvdyB0cmFpbGluZyBjb21tYXMgaW4gSlNPTiBvYmplY3RzIGFuZCBhcnJheXMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcnNlU3VwcG9ydGVkID0gcGFyc2UoXCIxLlwiKSAhPT0gMTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gY2F0Y2ggKGV4Y2VwdGlvbikge31cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChleGNlcHRpb24pIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcnNlU3VwcG9ydGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlzU3VwcG9ydGVkID0gcGFyc2VTdXBwb3J0ZWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBoYXNbbmFtZV0gPSAhIWlzU3VwcG9ydGVkO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKCFoYXMoXCJqc29uXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gQ29tbW9uIGBbW0NsYXNzXV1gIG5hbWUgYWxpYXNlcy5cblx0XHRcdFx0XHRcdFx0XHR2YXIgZnVuY3Rpb25DbGFzcyA9IFwiW29iamVjdCBGdW5jdGlvbl1cIixcblx0XHRcdFx0XHRcdFx0XHRcdGRhdGVDbGFzcyA9IFwiW29iamVjdCBEYXRlXVwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0bnVtYmVyQ2xhc3MgPSBcIltvYmplY3QgTnVtYmVyXVwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0c3RyaW5nQ2xhc3MgPSBcIltvYmplY3QgU3RyaW5nXVwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0YXJyYXlDbGFzcyA9IFwiW29iamVjdCBBcnJheV1cIixcblx0XHRcdFx0XHRcdFx0XHRcdGJvb2xlYW5DbGFzcyA9IFwiW29iamVjdCBCb29sZWFuXVwiO1xuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gRGV0ZWN0IGluY29tcGxldGUgc3VwcG9ydCBmb3IgYWNjZXNzaW5nIHN0cmluZyBjaGFyYWN0ZXJzIGJ5IGluZGV4LlxuXHRcdFx0XHRcdFx0XHRcdHZhciBjaGFySW5kZXhCdWdneSA9IGhhcyhcImJ1Zy1zdHJpbmctY2hhci1pbmRleFwiKTtcblxuXHRcdFx0XHRcdFx0XHRcdC8vIERlZmluZSBhZGRpdGlvbmFsIHV0aWxpdHkgbWV0aG9kcyBpZiB0aGUgYERhdGVgIG1ldGhvZHMgYXJlIGJ1Z2d5LlxuXHRcdFx0XHRcdFx0XHRcdGlmICghaXNFeHRlbmRlZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGZsb29yID0gTWF0aC5mbG9vcjtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgbWFwcGluZyBiZXR3ZWVuIHRoZSBtb250aHMgb2YgdGhlIHllYXIgYW5kIHRoZSBudW1iZXIgb2YgZGF5cyBiZXR3ZWVuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBKYW51YXJ5IDFzdCBhbmQgdGhlIGZpcnN0IG9mIHRoZSByZXNwZWN0aXZlIG1vbnRoLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIE1vbnRocyA9IFswLCAzMSwgNTksIDkwLCAxMjAsIDE1MSwgMTgxLCAyMTIsIDI0MywgMjczLCAzMDQsIDMzNF07XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogQ2FsY3VsYXRlcyB0aGUgbnVtYmVyIG9mIGRheXMgYmV0d2VlbiB0aGUgVW5peCBlcG9jaCBhbmQgdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBmaXJzdCBkYXkgb2YgdGhlIGdpdmVuIG1vbnRoLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGdldERheSA9IGZ1bmN0aW9uICh5ZWFyLCBtb250aCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gTW9udGhzW21vbnRoXSArIDM2NSAqICh5ZWFyIC0gMTk3MCkgKyBmbG9vcigoeWVhciAtIDE5NjkgKyAobW9udGggPSArKG1vbnRoID4gMSkpKSAvIDQpIC0gZmxvb3IoKHllYXIgLSAxOTAxICsgbW9udGgpIC8gMTAwKSArIGZsb29yKCh5ZWFyIC0gMTYwMSArIG1vbnRoKSAvIDQwMCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdC8vIEludGVybmFsOiBEZXRlcm1pbmVzIGlmIGEgcHJvcGVydHkgaXMgYSBkaXJlY3QgcHJvcGVydHkgb2YgdGhlIGdpdmVuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gb2JqZWN0LiBEZWxlZ2F0ZXMgdG8gdGhlIG5hdGl2ZSBgT2JqZWN0I2hhc093blByb3BlcnR5YCBtZXRob2QuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCEoaXNQcm9wZXJ0eSA9IG9iamVjdFByb3RvLmhhc093blByb3BlcnR5KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aXNQcm9wZXJ0eSA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgbWVtYmVycyA9IHt9LFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0cnVjdG9yO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoKG1lbWJlcnMuX19wcm90b19fID0gbnVsbCwgbWVtYmVycy5fX3Byb3RvX18gPSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgKnByb3RvKiBwcm9wZXJ0eSBjYW5ub3QgYmUgc2V0IG11bHRpcGxlIHRpbWVzIGluIHJlY2VudFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gdmVyc2lvbnMgb2YgRmlyZWZveCBhbmQgU2VhTW9ua2V5LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XCJ0b1N0cmluZ1wiOiAxXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSwgbWVtYmVycykudG9TdHJpbmcgIT0gZ2V0Q2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTYWZhcmkgPD0gMi4wLjMgZG9lc24ndCBpbXBsZW1lbnQgYE9iamVjdCNoYXNPd25Qcm9wZXJ0eWAsIGJ1dFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHN1cHBvcnRzIHRoZSBtdXRhYmxlICpwcm90byogcHJvcGVydHkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aXNQcm9wZXJ0eSA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ2FwdHVyZSBhbmQgYnJlYWsgdGhlIG9iamVjdCdzIHByb3RvdHlwZSBjaGFpbiAoc2VlIHNlY3Rpb24gOC42LjJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIG9mIHRoZSBFUyA1LjEgc3BlYykuIFRoZSBwYXJlbnRoZXNpemVkIGV4cHJlc3Npb24gcHJldmVudHMgYW5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHVuc2FmZSB0cmFuc2Zvcm1hdGlvbiBieSB0aGUgQ2xvc3VyZSBDb21waWxlci5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBvcmlnaW5hbCA9IHRoaXMuX19wcm90b19fLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHQgPSBwcm9wZXJ0eSBpbiAodGhpcy5fX3Byb3RvX18gPSBudWxsLCB0aGlzKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIHByb3RvdHlwZSBjaGFpbi5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuX19wcm90b19fID0gb3JpZ2luYWw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ2FwdHVyZSBhIHJlZmVyZW5jZSB0byB0aGUgdG9wLWxldmVsIGBPYmplY3RgIGNvbnN0cnVjdG9yLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0cnVjdG9yID0gbWVtYmVycy5jb25zdHJ1Y3Rvcjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBVc2UgdGhlIGBjb25zdHJ1Y3RvcmAgcHJvcGVydHkgdG8gc2ltdWxhdGUgYE9iamVjdCNoYXNPd25Qcm9wZXJ0eWAgaW5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBvdGhlciBlbnZpcm9ubWVudHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aXNQcm9wZXJ0eSA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHBhcmVudCA9ICh0aGlzLmNvbnN0cnVjdG9yIHx8IGNvbnN0cnVjdG9yKS5wcm90b3R5cGU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gcHJvcGVydHkgaW4gdGhpcyAmJiAhKHByb3BlcnR5IGluIHBhcmVudCAmJiB0aGlzW3Byb3BlcnR5XSA9PT0gcGFyZW50W3Byb3BlcnR5XSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRtZW1iZXJzID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGlzUHJvcGVydHkuY2FsbCh0aGlzLCBwcm9wZXJ0eSk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdC8vIEludGVybmFsOiBOb3JtYWxpemVzIHRoZSBgZm9yLi4uaW5gIGl0ZXJhdGlvbiBhbGdvcml0aG0gYWNyb3NzXG5cdFx0XHRcdFx0XHRcdFx0Ly8gZW52aXJvbm1lbnRzLiBFYWNoIGVudW1lcmF0ZWQga2V5IGlzIHlpZWxkZWQgdG8gYSBgY2FsbGJhY2tgIGZ1bmN0aW9uLlxuXHRcdFx0XHRcdFx0XHRcdGZvckVhY2ggPSBmdW5jdGlvbiAob2JqZWN0LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHNpemUgPSAwLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRQcm9wZXJ0aWVzLCBtZW1iZXJzLCBwcm9wZXJ0eTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGVzdHMgZm9yIGJ1Z3MgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQncyBgZm9yLi4uaW5gIGFsZ29yaXRobS4gVGhlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBgdmFsdWVPZmAgcHJvcGVydHkgaW5oZXJpdHMgdGhlIG5vbi1lbnVtZXJhYmxlIGZsYWcgZnJvbVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gYE9iamVjdC5wcm90b3R5cGVgIGluIG9sZGVyIHZlcnNpb25zIG9mIElFLCBOZXRzY2FwZSwgYW5kIE1vemlsbGEuXG5cdFx0XHRcdFx0XHRcdFx0XHQoUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy52YWx1ZU9mID0gMDtcblx0XHRcdFx0XHRcdFx0XHRcdH0pLnByb3RvdHlwZS52YWx1ZU9mID0gMDtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSXRlcmF0ZSBvdmVyIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBgUHJvcGVydGllc2AgY2xhc3MuXG5cdFx0XHRcdFx0XHRcdFx0XHRtZW1iZXJzID0gbmV3IFByb3BlcnRpZXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdGZvciAocHJvcGVydHkgaW4gbWVtYmVycykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBJZ25vcmUgYWxsIHByb3BlcnRpZXMgaW5oZXJpdGVkIGZyb20gYE9iamVjdC5wcm90b3R5cGVgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoaXNQcm9wZXJ0eS5jYWxsKG1lbWJlcnMsIHByb3BlcnR5KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHNpemUrKztcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0UHJvcGVydGllcyA9IG1lbWJlcnMgPSBudWxsO1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBOb3JtYWxpemUgdGhlIGl0ZXJhdGlvbiBhbGdvcml0aG0uXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIXNpemUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQSBsaXN0IG9mIG5vbi1lbnVtZXJhYmxlIHByb3BlcnRpZXMgaW5oZXJpdGVkIGZyb20gYE9iamVjdC5wcm90b3R5cGVgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRtZW1iZXJzID0gW1widmFsdWVPZlwiLCBcInRvU3RyaW5nXCIsIFwidG9Mb2NhbGVTdHJpbmdcIiwgXCJwcm9wZXJ0eUlzRW51bWVyYWJsZVwiLCBcImlzUHJvdG90eXBlT2ZcIiwgXCJoYXNPd25Qcm9wZXJ0eVwiLCBcImNvbnN0cnVjdG9yXCJdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBJRSA8PSA4LCBNb3ppbGxhIDEuMCwgYW5kIE5ldHNjYXBlIDYuMiBpZ25vcmUgc2hhZG93ZWQgbm9uLWVudW1lcmFibGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gcHJvcGVydGllcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yRWFjaCA9IGZ1bmN0aW9uIChvYmplY3QsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGlzRnVuY3Rpb24gPSBnZXRDbGFzcy5jYWxsKG9iamVjdCkgPT0gZnVuY3Rpb25DbGFzcyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHByb3BlcnR5LCBsZW5ndGg7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGhhc1Byb3BlcnR5ID0gIWlzRnVuY3Rpb24gJiYgdHlwZW9mIG9iamVjdC5jb25zdHJ1Y3RvciAhPSBcImZ1bmN0aW9uXCIgJiYgb2JqZWN0VHlwZXNbdHlwZW9mIG9iamVjdC5oYXNPd25Qcm9wZXJ0eV0gJiYgb2JqZWN0Lmhhc093blByb3BlcnR5IHx8IGlzUHJvcGVydHk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChwcm9wZXJ0eSBpbiBvYmplY3QpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEdlY2tvIDw9IDEuMCBlbnVtZXJhdGVzIHRoZSBgcHJvdG90eXBlYCBwcm9wZXJ0eSBvZiBmdW5jdGlvbnMgdW5kZXJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNlcnRhaW4gY29uZGl0aW9uczsgSUUgZG9lcyBub3QuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIShpc0Z1bmN0aW9uICYmIHByb3BlcnR5ID09IFwicHJvdG90eXBlXCIpICYmIGhhc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FsbGJhY2socHJvcGVydHkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBNYW51YWxseSBpbnZva2UgdGhlIGNhbGxiYWNrIGZvciBlYWNoIG5vbi1lbnVtZXJhYmxlIHByb3BlcnR5LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAobGVuZ3RoID0gbWVtYmVycy5sZW5ndGg7IHByb3BlcnR5ID0gbWVtYmVyc1stLWxlbmd0aF07IGhhc1Byb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSkgJiYgY2FsbGJhY2socHJvcGVydHkpKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoc2l6ZSA9PSAyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNhZmFyaSA8PSAyLjAuNCBlbnVtZXJhdGVzIHNoYWRvd2VkIHByb3BlcnRpZXMgdHdpY2UuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZvckVhY2ggPSBmdW5jdGlvbiAob2JqZWN0LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENyZWF0ZSBhIHNldCBvZiBpdGVyYXRlZCBwcm9wZXJ0aWVzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBtZW1iZXJzID0ge30sXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpc0Z1bmN0aW9uID0gZ2V0Q2xhc3MuY2FsbChvYmplY3QpID09IGZ1bmN0aW9uQ2xhc3MsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwcm9wZXJ0eTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHByb3BlcnR5IGluIG9iamVjdCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3RvcmUgZWFjaCBwcm9wZXJ0eSBuYW1lIHRvIHByZXZlbnQgZG91YmxlIGVudW1lcmF0aW9uLiBUaGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGBwcm90b3R5cGVgIHByb3BlcnR5IG9mIGZ1bmN0aW9ucyBpcyBub3QgZW51bWVyYXRlZCBkdWUgdG8gY3Jvc3MtXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBlbnZpcm9ubWVudCBpbmNvbnNpc3RlbmNpZXMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIShpc0Z1bmN0aW9uICYmIHByb3BlcnR5ID09IFwicHJvdG90eXBlXCIpICYmICFpc1Byb3BlcnR5LmNhbGwobWVtYmVycywgcHJvcGVydHkpICYmIChtZW1iZXJzW3Byb3BlcnR5XSA9IDEpICYmIGlzUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayhwcm9wZXJ0eSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTm8gYnVncyBkZXRlY3RlZDsgdXNlIHRoZSBzdGFuZGFyZCBgZm9yLi4uaW5gIGFsZ29yaXRobS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yRWFjaCA9IGZ1bmN0aW9uIChvYmplY3QsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGlzRnVuY3Rpb24gPSBnZXRDbGFzcy5jYWxsKG9iamVjdCkgPT0gZnVuY3Rpb25DbGFzcyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHByb3BlcnR5LCBpc0NvbnN0cnVjdG9yO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAocHJvcGVydHkgaW4gb2JqZWN0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIShpc0Z1bmN0aW9uICYmIHByb3BlcnR5ID09IFwicHJvdG90eXBlXCIpICYmIGlzUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSAmJiAhKGlzQ29uc3RydWN0b3IgPSBwcm9wZXJ0eSA9PT0gXCJjb25zdHJ1Y3RvclwiKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayhwcm9wZXJ0eSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE1hbnVhbGx5IGludm9rZSB0aGUgY2FsbGJhY2sgZm9yIHRoZSBgY29uc3RydWN0b3JgIHByb3BlcnR5IGR1ZSB0b1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNyb3NzLWVudmlyb25tZW50IGluY29uc2lzdGVuY2llcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoaXNDb25zdHJ1Y3RvciB8fCBpc1Byb3BlcnR5LmNhbGwob2JqZWN0LCAocHJvcGVydHkgPSBcImNvbnN0cnVjdG9yXCIpKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FsbGJhY2socHJvcGVydHkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBmb3JFYWNoKG9iamVjdCwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBQdWJsaWM6IFNlcmlhbGl6ZXMgYSBKYXZhU2NyaXB0IGB2YWx1ZWAgYXMgYSBKU09OIHN0cmluZy4gVGhlIG9wdGlvbmFsXG5cdFx0XHRcdFx0XHRcdFx0Ly8gYGZpbHRlcmAgYXJndW1lbnQgbWF5IHNwZWNpZnkgZWl0aGVyIGEgZnVuY3Rpb24gdGhhdCBhbHRlcnMgaG93IG9iamVjdCBhbmRcblx0XHRcdFx0XHRcdFx0XHQvLyBhcnJheSBtZW1iZXJzIGFyZSBzZXJpYWxpemVkLCBvciBhbiBhcnJheSBvZiBzdHJpbmdzIGFuZCBudW1iZXJzIHRoYXRcblx0XHRcdFx0XHRcdFx0XHQvLyBpbmRpY2F0ZXMgd2hpY2ggcHJvcGVydGllcyBzaG91bGQgYmUgc2VyaWFsaXplZC4gVGhlIG9wdGlvbmFsIGB3aWR0aGBcblx0XHRcdFx0XHRcdFx0XHQvLyBhcmd1bWVudCBtYXkgYmUgZWl0aGVyIGEgc3RyaW5nIG9yIG51bWJlciB0aGF0IHNwZWNpZmllcyB0aGUgaW5kZW50YXRpb25cblx0XHRcdFx0XHRcdFx0XHQvLyBsZXZlbCBvZiB0aGUgb3V0cHV0LlxuXHRcdFx0XHRcdFx0XHRcdGlmICghaGFzKFwianNvbi1zdHJpbmdpZnlcIikpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEludGVybmFsOiBBIG1hcCBvZiBjb250cm9sIGNoYXJhY3RlcnMgYW5kIHRoZWlyIGVzY2FwZWQgZXF1aXZhbGVudHMuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgRXNjYXBlcyA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0OTI6IFwiXFxcXFxcXFxcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MzQ6ICdcXFxcXCInLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ4OiBcIlxcXFxiXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDEyOiBcIlxcXFxmXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDEwOiBcIlxcXFxuXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDEzOiBcIlxcXFxyXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDk6IFwiXFxcXHRcIlxuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IENvbnZlcnRzIGB2YWx1ZWAgaW50byBhIHplcm8tcGFkZGVkIHN0cmluZyBzdWNoIHRoYXQgaXRzXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBsZW5ndGggaXMgYXQgbGVhc3QgZXF1YWwgdG8gYHdpZHRoYC4gVGhlIGB3aWR0aGAgbXVzdCBiZSA8PSA2LlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGxlYWRpbmdaZXJvZXMgPSBcIjAwMDAwMFwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHRvUGFkZGVkU3RyaW5nID0gZnVuY3Rpb24gKHdpZHRoLCB2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgYHx8IDBgIGV4cHJlc3Npb24gaXMgbmVjZXNzYXJ5IHRvIHdvcmsgYXJvdW5kIGEgYnVnIGluXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9wZXJhIDw9IDcuNTR1MiB3aGVyZSBgMCA9PSAtMGAsIGJ1dCBgU3RyaW5nKC0wKSAhPT0gXCIwXCJgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gKGxlYWRpbmdaZXJvZXMgKyAodmFsdWUgfHwgMCkpLnNsaWNlKC13aWR0aCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogRG91YmxlLXF1b3RlcyBhIHN0cmluZyBgdmFsdWVgLCByZXBsYWNpbmcgYWxsIEFTQ0lJIGNvbnRyb2xcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGNoYXJhY3RlcnMgKGNoYXJhY3RlcnMgd2l0aCBjb2RlIHVuaXQgdmFsdWVzIGJldHdlZW4gMCBhbmQgMzEpIHdpdGhcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHRoZWlyIGVzY2FwZWQgZXF1aXZhbGVudHMuIFRoaXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBgUXVvdGUodmFsdWUpYCBvcGVyYXRpb24gZGVmaW5lZCBpbiBFUyA1LjEgc2VjdGlvbiAxNS4xMi4zLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHVuaWNvZGVQcmVmaXggPSBcIlxcXFx1MDBcIjtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBxdW90ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgcmVzdWx0ID0gJ1wiJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpbmRleCA9IDAsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bGVuZ3RoID0gdmFsdWUubGVuZ3RoLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHVzZUNoYXJJbmRleCA9ICFjaGFySW5kZXhCdWdneSB8fCBsZW5ndGggPiAxMDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHN5bWJvbHMgPSB1c2VDaGFySW5kZXggJiYgKGNoYXJJbmRleEJ1Z2d5ID8gdmFsdWUuc3BsaXQoXCJcIikgOiB2YWx1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBjaGFyQ29kZSA9IHZhbHVlLmNoYXJDb2RlQXQoaW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElmIHRoZSBjaGFyYWN0ZXIgaXMgYSBjb250cm9sIGNoYXJhY3RlciwgYXBwZW5kIGl0cyBVbmljb2RlIG9yXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gc2hvcnRoYW5kIGVzY2FwZSBzZXF1ZW5jZTsgb3RoZXJ3aXNlLCBhcHBlbmQgdGhlIGNoYXJhY3RlciBhcy1pcy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGNoYXJDb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDg6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDk6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDEwOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAxMjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTM6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDM0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSA5Mjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0ICs9IEVzY2FwZXNbY2hhckNvZGVdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyQ29kZSA8IDMyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0ICs9IHVuaWNvZGVQcmVmaXggKyB0b1BhZGRlZFN0cmluZygyLCBjaGFyQ29kZS50b1N0cmluZygxNikpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCArPSB1c2VDaGFySW5kZXggPyBzeW1ib2xzW2luZGV4XSA6IHZhbHVlLmNoYXJBdChpbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiByZXN1bHQgKyAnXCInO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFJlY3Vyc2l2ZWx5IHNlcmlhbGl6ZXMgYW4gb2JqZWN0LiBJbXBsZW1lbnRzIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFN0cihrZXksIGhvbGRlcilgLCBgSk8odmFsdWUpYCwgYW5kIGBKQSh2YWx1ZSlgIG9wZXJhdGlvbnMuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgc2VyaWFsaXplID0gZnVuY3Rpb24gKHByb3BlcnR5LCBvYmplY3QsIGNhbGxiYWNrLCBwcm9wZXJ0aWVzLCB3aGl0ZXNwYWNlLCBpbmRlbnRhdGlvbiwgc3RhY2spIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHZhbHVlLCBjbGFzc05hbWUsIHllYXIsIG1vbnRoLCBkYXRlLCB0aW1lLCBob3VycywgbWludXRlcywgc2Vjb25kcywgbWlsbGlzZWNvbmRzLCByZXN1bHRzLCBlbGVtZW50LCBpbmRleCwgbGVuZ3RoLCBwcmVmaXgsIHJlc3VsdDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBOZWNlc3NhcnkgZm9yIGhvc3Qgb2JqZWN0IHN1cHBvcnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBvYmplY3RbcHJvcGVydHldO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9IGNhdGNoIChleGNlcHRpb24pIHt9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIiAmJiB2YWx1ZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNsYXNzTmFtZSA9IGdldENsYXNzLmNhbGwodmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjbGFzc05hbWUgPT0gZGF0ZUNsYXNzICYmICFpc1Byb3BlcnR5LmNhbGwodmFsdWUsIFwidG9KU09OXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPiAtMSAvIDAgJiYgdmFsdWUgPCAxIC8gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBEYXRlcyBhcmUgc2VyaWFsaXplZCBhY2NvcmRpbmcgdG8gdGhlIGBEYXRlI3RvSlNPTmAgbWV0aG9kXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNwZWNpZmllZCBpbiBFUyA1LjEgc2VjdGlvbiAxNS45LjUuNDQuIFNlZSBzZWN0aW9uIDE1LjkuMS4xNVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBmb3IgdGhlIElTTyA4NjAxIGRhdGUgdGltZSBzdHJpbmcgZm9ybWF0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZ2V0RGF5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTWFudWFsbHkgY29tcHV0ZSB0aGUgeWVhciwgbW9udGgsIGRhdGUsIGhvdXJzLCBtaW51dGVzLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNlY29uZHMsIGFuZCBtaWxsaXNlY29uZHMgaWYgdGhlIGBnZXRVVEMqYCBtZXRob2RzIGFyZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGJ1Z2d5LiBBZGFwdGVkIGZyb20gQFlhZmZsZSdzIGBkYXRlLXNoaW1gIHByb2plY3QuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGF0ZSA9IGZsb29yKHZhbHVlIC8gODY0ZTUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoeWVhciA9IGZsb29yKGRhdGUgLyAzNjUuMjQyNSkgKyAxOTcwIC0gMTsgZ2V0RGF5KHllYXIgKyAxLCAwKSA8PSBkYXRlOyB5ZWFyKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAobW9udGggPSBmbG9vcigoZGF0ZSAtIGdldERheSh5ZWFyLCAwKSkgLyAzMC40Mik7IGdldERheSh5ZWFyLCBtb250aCArIDEpIDw9IGRhdGU7IG1vbnRoKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRhdGUgPSAxICsgZGF0ZSAtIGdldERheSh5ZWFyLCBtb250aCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGB0aW1lYCB2YWx1ZSBzcGVjaWZpZXMgdGhlIHRpbWUgd2l0aGluIHRoZSBkYXkgKHNlZSBFU1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIDUuMSBzZWN0aW9uIDE1LjkuMS4yKS4gVGhlIGZvcm11bGEgYChBICUgQiArIEIpICUgQmAgaXMgdXNlZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHRvIGNvbXB1dGUgYEEgbW9kdWxvIEJgLCBhcyB0aGUgYCVgIG9wZXJhdG9yIGRvZXMgbm90XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gY29ycmVzcG9uZCB0byB0aGUgYG1vZHVsb2Agb3BlcmF0aW9uIGZvciBuZWdhdGl2ZSBudW1iZXJzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRpbWUgPSAodmFsdWUgJSA4NjRlNSArIDg2NGU1KSAlIDg2NGU1O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBob3VycywgbWludXRlcywgc2Vjb25kcywgYW5kIG1pbGxpc2Vjb25kcyBhcmUgb2J0YWluZWQgYnlcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBkZWNvbXBvc2luZyB0aGUgdGltZSB3aXRoaW4gdGhlIGRheS4gU2VlIHNlY3Rpb24gMTUuOS4xLjEwLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGhvdXJzID0gZmxvb3IodGltZSAvIDM2ZTUpICUgMjQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWludXRlcyA9IGZsb29yKHRpbWUgLyA2ZTQpICUgNjA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2Vjb25kcyA9IGZsb29yKHRpbWUgLyAxZTMpICUgNjA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWlsbGlzZWNvbmRzID0gdGltZSAlIDFlMztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR5ZWFyID0gdmFsdWUuZ2V0VVRDRnVsbFllYXIoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRtb250aCA9IHZhbHVlLmdldFVUQ01vbnRoKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGF0ZSA9IHZhbHVlLmdldFVUQ0RhdGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRob3VycyA9IHZhbHVlLmdldFVUQ0hvdXJzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWludXRlcyA9IHZhbHVlLmdldFVUQ01pbnV0ZXMoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzZWNvbmRzID0gdmFsdWUuZ2V0VVRDU2Vjb25kcygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdG1pbGxpc2Vjb25kcyA9IHZhbHVlLmdldFVUQ01pbGxpc2Vjb25kcygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFNlcmlhbGl6ZSBleHRlbmRlZCB5ZWFycyBjb3JyZWN0bHkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gKHllYXIgPD0gMCB8fCB5ZWFyID49IDFlNCA/ICh5ZWFyIDwgMCA/IFwiLVwiIDogXCIrXCIpICsgdG9QYWRkZWRTdHJpbmcoNiwgeWVhciA8IDAgPyAteWVhciA6IHllYXIpIDogdG9QYWRkZWRTdHJpbmcoNCwgeWVhcikpICtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcIi1cIiArIHRvUGFkZGVkU3RyaW5nKDIsIG1vbnRoICsgMSkgKyBcIi1cIiArIHRvUGFkZGVkU3RyaW5nKDIsIGRhdGUpICtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBNb250aHMsIGRhdGVzLCBob3VycywgbWludXRlcywgYW5kIHNlY29uZHMgc2hvdWxkIGhhdmUgdHdvXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZGlnaXRzOyBtaWxsaXNlY29uZHMgc2hvdWxkIGhhdmUgdGhyZWUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XCJUXCIgKyB0b1BhZGRlZFN0cmluZygyLCBob3VycykgKyBcIjpcIiArIHRvUGFkZGVkU3RyaW5nKDIsIG1pbnV0ZXMpICsgXCI6XCIgKyB0b1BhZGRlZFN0cmluZygyLCBzZWNvbmRzKSArXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTWlsbGlzZWNvbmRzIGFyZSBvcHRpb25hbCBpbiBFUyA1LjAsIGJ1dCByZXF1aXJlZCBpbiA1LjEuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XCIuXCIgKyB0b1BhZGRlZFN0cmluZygzLCBtaWxsaXNlY29uZHMpICsgXCJaXCI7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgdmFsdWUudG9KU09OID09IFwiZnVuY3Rpb25cIiAmJiAoKGNsYXNzTmFtZSAhPSBudW1iZXJDbGFzcyAmJiBjbGFzc05hbWUgIT0gc3RyaW5nQ2xhc3MgJiYgY2xhc3NOYW1lICE9IGFycmF5Q2xhc3MpIHx8IGlzUHJvcGVydHkuY2FsbCh2YWx1ZSwgXCJ0b0pTT05cIikpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQcm90b3R5cGUgPD0gMS42LjEgYWRkcyBub24tc3RhbmRhcmQgYHRvSlNPTmAgbWV0aG9kcyB0byB0aGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGBOdW1iZXJgLCBgU3RyaW5nYCwgYERhdGVgLCBhbmQgYEFycmF5YCBwcm90b3R5cGVzLiBKU09OIDNcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGlnbm9yZXMgYWxsIGB0b0pTT05gIG1ldGhvZHMgb24gdGhlc2Ugb2JqZWN0cyB1bmxlc3MgdGhleSBhcmVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRlZmluZWQgZGlyZWN0bHkgb24gYW4gaW5zdGFuY2UuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IHZhbHVlLnRvSlNPTihwcm9wZXJ0eSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElmIGEgcmVwbGFjZW1lbnQgZnVuY3Rpb24gd2FzIHByb3ZpZGVkLCBjYWxsIGl0IHRvIG9idGFpbiB0aGUgdmFsdWVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBmb3Igc2VyaWFsaXphdGlvbi5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGNhbGxiYWNrLmNhbGwob2JqZWN0LCBwcm9wZXJ0eSwgdmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBcIm51bGxcIjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjbGFzc05hbWUgPSBnZXRDbGFzcy5jYWxsKHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNsYXNzTmFtZSA9PSBib29sZWFuQ2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBCb29sZWFucyBhcmUgcmVwcmVzZW50ZWQgbGl0ZXJhbGx5LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBcIlwiICsgdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoY2xhc3NOYW1lID09IG51bWJlckNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSlNPTiBudW1iZXJzIG11c3QgYmUgZmluaXRlLiBgSW5maW5pdHlgIGFuZCBgTmFOYCBhcmUgc2VyaWFsaXplZCBhc1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGBcIm51bGxcImAuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlID4gLTEgLyAwICYmIHZhbHVlIDwgMSAvIDAgPyBcIlwiICsgdmFsdWUgOiBcIm51bGxcIjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChjbGFzc05hbWUgPT0gc3RyaW5nQ2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTdHJpbmdzIGFyZSBkb3VibGUtcXVvdGVkIGFuZCBlc2NhcGVkLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBxdW90ZShcIlwiICsgdmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlY3Vyc2l2ZWx5IHNlcmlhbGl6ZSBvYmplY3RzIGFuZCBhcnJheXMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgdmFsdWUgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENoZWNrIGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhpcyBpcyBhIGxpbmVhciBzZWFyY2g7IHBlcmZvcm1hbmNlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gaXMgaW52ZXJzZWx5IHByb3BvcnRpb25hbCB0byB0aGUgbnVtYmVyIG9mIHVuaXF1ZSBuZXN0ZWQgb2JqZWN0cy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGxlbmd0aCA9IHN0YWNrLmxlbmd0aDsgbGVuZ3RoLS07KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoc3RhY2tbbGVuZ3RoXSA9PT0gdmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ3ljbGljIHN0cnVjdHVyZXMgY2Fubm90IGJlIHNlcmlhbGl6ZWQgYnkgYEpTT04uc3RyaW5naWZ5YC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGhyb3cgVHlwZUVycm9yKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFkZCB0aGUgb2JqZWN0IHRvIHRoZSBzdGFjayBvZiB0cmF2ZXJzZWQgb2JqZWN0cy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdGFjay5wdXNoKHZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHRzID0gW107XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2F2ZSB0aGUgY3VycmVudCBpbmRlbnRhdGlvbiBsZXZlbCBhbmQgaW5kZW50IG9uZSBhZGRpdGlvbmFsIGxldmVsLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHByZWZpeCA9IGluZGVudGF0aW9uO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGluZGVudGF0aW9uICs9IHdoaXRlc3BhY2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNsYXNzTmFtZSA9PSBhcnJheUNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZWN1cnNpdmVseSBzZXJpYWxpemUgYXJyYXkgZWxlbWVudHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGluZGV4ID0gMCwgbGVuZ3RoID0gdmFsdWUubGVuZ3RoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbGVtZW50ID0gc2VyaWFsaXplKGluZGV4LCB2YWx1ZSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIGluZGVudGF0aW9uLCBzdGFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaChlbGVtZW50ID09PSB1bmRlZiA/IFwibnVsbFwiIDogZWxlbWVudCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHQgPSByZXN1bHRzLmxlbmd0aCA/ICh3aGl0ZXNwYWNlID8gXCJbXFxuXCIgKyBpbmRlbnRhdGlvbiArIHJlc3VsdHMuam9pbihcIixcXG5cIiArIGluZGVudGF0aW9uKSArIFwiXFxuXCIgKyBwcmVmaXggKyBcIl1cIiA6IChcIltcIiArIHJlc3VsdHMuam9pbihcIixcIikgKyBcIl1cIikpIDogXCJbXVwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZWN1cnNpdmVseSBzZXJpYWxpemUgb2JqZWN0IG1lbWJlcnMuIE1lbWJlcnMgYXJlIHNlbGVjdGVkIGZyb21cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGVpdGhlciBhIHVzZXItc3BlY2lmaWVkIGxpc3Qgb2YgcHJvcGVydHkgbmFtZXMsIG9yIHRoZSBvYmplY3Rcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGl0c2VsZi5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvckVhY2gocHJvcGVydGllcyB8fCB2YWx1ZSwgZnVuY3Rpb24gKHByb3BlcnR5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBlbGVtZW50ID0gc2VyaWFsaXplKHByb3BlcnR5LCB2YWx1ZSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIGluZGVudGF0aW9uLCBzdGFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChlbGVtZW50ICE9PSB1bmRlZikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFjY29yZGluZyB0byBFUyA1LjEgc2VjdGlvbiAxNS4xMi4zOiBcIklmIGBnYXBgIHt3aGl0ZXNwYWNlfVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGlzIG5vdCB0aGUgZW1wdHkgc3RyaW5nLCBsZXQgYG1lbWJlcmAge3F1b3RlKHByb3BlcnR5KSArIFwiOlwifVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGJlIHRoZSBjb25jYXRlbmF0aW9uIG9mIGBtZW1iZXJgIGFuZCB0aGUgYHNwYWNlYCBjaGFyYWN0ZXIuXCJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgXCJgc3BhY2VgIGNoYXJhY3RlclwiIHJlZmVycyB0byB0aGUgbGl0ZXJhbCBzcGFjZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNoYXJhY3Rlciwgbm90IHRoZSBgc3BhY2VgIHt3aWR0aH0gYXJndW1lbnQgcHJvdmlkZWQgdG9cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgSlNPTi5zdHJpbmdpZnlgLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdHMucHVzaChxdW90ZShwcm9wZXJ0eSkgKyBcIjpcIiArICh3aGl0ZXNwYWNlID8gXCIgXCIgOiBcIlwiKSArIGVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IHJlc3VsdHMubGVuZ3RoID8gKHdoaXRlc3BhY2UgPyBcIntcXG5cIiArIGluZGVudGF0aW9uICsgcmVzdWx0cy5qb2luKFwiLFxcblwiICsgaW5kZW50YXRpb24pICsgXCJcXG5cIiArIHByZWZpeCArIFwifVwiIDogKFwie1wiICsgcmVzdWx0cy5qb2luKFwiLFwiKSArIFwifVwiKSkgOiBcInt9XCI7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlbW92ZSB0aGUgb2JqZWN0IGZyb20gdGhlIHRyYXZlcnNlZCBvYmplY3Qgc3RhY2suXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3RhY2sucG9wKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUHVibGljOiBgSlNPTi5zdHJpbmdpZnlgLiBTZWUgRVMgNS4xIHNlY3Rpb24gMTUuMTIuMy5cblx0XHRcdFx0XHRcdFx0XHRcdGV4cG9ydHMuc3RyaW5naWZ5ID0gZnVuY3Rpb24gKHNvdXJjZSwgZmlsdGVyLCB3aWR0aCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgd2hpdGVzcGFjZSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIGNsYXNzTmFtZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKG9iamVjdFR5cGVzW3R5cGVvZiBmaWx0ZXJdICYmIGZpbHRlcikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICgoY2xhc3NOYW1lID0gZ2V0Q2xhc3MuY2FsbChmaWx0ZXIpKSA9PSBmdW5jdGlvbkNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYWxsYmFjayA9IGZpbHRlcjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNsYXNzTmFtZSA9PSBhcnJheUNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDb252ZXJ0IHRoZSBwcm9wZXJ0eSBuYW1lcyBhcnJheSBpbnRvIGEgbWFrZXNoaWZ0IHNldC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHByb3BlcnRpZXMgPSB7fTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIGluZGV4ID0gMCwgbGVuZ3RoID0gZmlsdGVyLmxlbmd0aCwgdmFsdWU7IGluZGV4IDwgbGVuZ3RoOyB2YWx1ZSA9IGZpbHRlcltpbmRleCsrXSwgKChjbGFzc05hbWUgPSBnZXRDbGFzcy5jYWxsKHZhbHVlKSksIGNsYXNzTmFtZSA9PSBzdHJpbmdDbGFzcyB8fCBjbGFzc05hbWUgPT0gbnVtYmVyQ2xhc3MpICYmIChwcm9wZXJ0aWVzW3ZhbHVlXSA9IDEpKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHdpZHRoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKChjbGFzc05hbWUgPSBnZXRDbGFzcy5jYWxsKHdpZHRoKSkgPT0gbnVtYmVyQ2xhc3MpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENvbnZlcnQgdGhlIGB3aWR0aGAgdG8gYW4gaW50ZWdlciBhbmQgY3JlYXRlIGEgc3RyaW5nIGNvbnRhaW5pbmdcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGB3aWR0aGAgbnVtYmVyIG9mIHNwYWNlIGNoYXJhY3RlcnMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoKHdpZHRoIC09IHdpZHRoICUgMSkgPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAod2hpdGVzcGFjZSA9IFwiXCIsIHdpZHRoID4gMTAgJiYgKHdpZHRoID0gMTApOyB3aGl0ZXNwYWNlLmxlbmd0aCA8IHdpZHRoOyB3aGl0ZXNwYWNlICs9IFwiIFwiKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNsYXNzTmFtZSA9PSBzdHJpbmdDbGFzcykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0d2hpdGVzcGFjZSA9IHdpZHRoLmxlbmd0aCA8PSAxMCA/IHdpZHRoIDogd2lkdGguc2xpY2UoMCwgMTApO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPcGVyYSA8PSA3LjU0dTIgZGlzY2FyZHMgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggZW1wdHkgc3RyaW5nIGtleXNcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gKGBcIlwiYCkgb25seSBpZiB0aGV5IGFyZSB1c2VkIGRpcmVjdGx5IHdpdGhpbiBhbiBvYmplY3QgbWVtYmVyIGxpc3Rcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gKGUuZy4sIGAhKFwiXCIgaW4geyBcIlwiOiAxfSlgKS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHNlcmlhbGl6ZShcIlwiLCAodmFsdWUgPSB7fSwgdmFsdWVbXCJcIl0gPSBzb3VyY2UsIHZhbHVlKSwgY2FsbGJhY2ssIHByb3BlcnRpZXMsIHdoaXRlc3BhY2UsIFwiXCIsIFtdKTtcblx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUHVibGljOiBQYXJzZXMgYSBKU09OIHNvdXJjZSBzdHJpbmcuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFoYXMoXCJqc29uLXBhcnNlXCIpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgZnJvbUNoYXJDb2RlID0gU3RyaW5nLmZyb21DaGFyQ29kZTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IEEgbWFwIG9mIGVzY2FwZWQgY29udHJvbCBjaGFyYWN0ZXJzIGFuZCB0aGVpciB1bmVzY2FwZWRcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGVxdWl2YWxlbnRzLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIFVuZXNjYXBlcyA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0OTI6IFwiXFxcXFwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQzNDogJ1wiJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0NDc6IFwiL1wiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQ5ODogXCJcXGJcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTE2OiBcIlxcdFwiLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQxMTA6IFwiXFxuXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdDEwMjogXCJcXGZcIixcblx0XHRcdFx0XHRcdFx0XHRcdFx0MTE0OiBcIlxcclwiXG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogU3RvcmVzIHRoZSBwYXJzZXIgc3RhdGUuXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgSW5kZXgsIFNvdXJjZTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFJlc2V0cyB0aGUgcGFyc2VyIHN0YXRlIGFuZCB0aHJvd3MgYSBgU3ludGF4RXJyb3JgLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGFib3J0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCA9IFNvdXJjZSA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRocm93IFN5bnRheEVycm9yKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogUmV0dXJucyB0aGUgbmV4dCB0b2tlbiwgb3IgYFwiJFwiYCBpZiB0aGUgcGFyc2VyIGhhcyByZWFjaGVkXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc3RyaW5nLiBBIHRva2VuIG1heSBiZSBhIHN0cmluZywgbnVtYmVyLCBgbnVsbGBcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGxpdGVyYWwsIG9yIEJvb2xlYW4gbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBsZXggPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBzb3VyY2UgPSBTb3VyY2UsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bGVuZ3RoID0gc291cmNlLmxlbmd0aCxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSwgYmVnaW4sIHBvc2l0aW9uLCBpc1NpZ25lZCwgY2hhckNvZGU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHdoaWxlIChJbmRleCA8IGxlbmd0aCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoSW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN3aXRjaCAoY2hhckNvZGUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgOTpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTA6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDEzOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAzMjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gU2tpcCB3aGl0ZXNwYWNlIHRva2VucywgaW5jbHVkaW5nIHRhYnMsIGNhcnJpYWdlIHJldHVybnMsIGxpbmVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZmVlZHMsIGFuZCBzcGFjZSBjaGFyYWN0ZXJzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTIzOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAxMjU6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDkxOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSA5Mzpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgNTg6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDQ0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSBhIHB1bmN0dWF0b3IgdG9rZW4gKGB7YCwgYH1gLCBgW2AsIGBdYCwgYDpgLCBvciBgLGApIGF0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHRoZSBjdXJyZW50IHBvc2l0aW9uLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGNoYXJJbmRleEJ1Z2d5ID8gc291cmNlLmNoYXJBdChJbmRleCkgOiBzb3VyY2VbSW5kZXhdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDM0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgXCJgIGRlbGltaXRzIGEgSlNPTiBzdHJpbmc7IGFkdmFuY2UgdG8gdGhlIG5leHQgY2hhcmFjdGVyIGFuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBiZWdpbiBwYXJzaW5nIHRoZSBzdHJpbmcuIFN0cmluZyB0b2tlbnMgYXJlIHByZWZpeGVkIHdpdGggdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNlbnRpbmVsIGBAYCBjaGFyYWN0ZXIgdG8gZGlzdGluZ3Vpc2ggdGhlbSBmcm9tIHB1bmN0dWF0b3JzIGFuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBlbmQtb2Ytc3RyaW5nIHRva2Vucy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YWx1ZSA9IFwiQFwiLCBJbmRleCsrOyBJbmRleCA8IGxlbmd0aDspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjaGFyQ29kZSA9IHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2hhckNvZGUgPCAzMikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVW5lc2NhcGVkIEFTQ0lJIGNvbnRyb2wgY2hhcmFjdGVycyAodGhvc2Ugd2l0aCBhIGNvZGUgdW5pdFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbGVzcyB0aGFuIHRoZSBzcGFjZSBjaGFyYWN0ZXIpIGFyZSBub3QgcGVybWl0dGVkLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGNoYXJDb2RlID09IDkyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBIHJldmVyc2Ugc29saWR1cyAoYFxcYCkgbWFya3MgdGhlIGJlZ2lubmluZyBvZiBhbiBlc2NhcGVkXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjb250cm9sIGNoYXJhY3RlciAoaW5jbHVkaW5nIGBcImAsIGBcXGAsIGFuZCBgL2ApIG9yIFVuaWNvZGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGVzY2FwZSBzZXF1ZW5jZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoKytJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGNoYXJDb2RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgOTI6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMzQ6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgNDc6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgOTg6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTE2OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIDExMDpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAxMDI6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTE0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJldml2ZSBlc2NhcGVkIGNvbnRyb2wgY2hhcmFjdGVycy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSArPSBVbmVzY2FwZXNbY2hhckNvZGVdO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdEluZGV4Kys7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgMTE3OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGBcXHVgIG1hcmtzIHRoZSBiZWdpbm5pbmcgb2YgYSBVbmljb2RlIGVzY2FwZSBzZXF1ZW5jZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBZHZhbmNlIHRvIHRoZSBmaXJzdCBjaGFyYWN0ZXIgYW5kIHZhbGlkYXRlIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGZvdXItZGlnaXQgY29kZSBwb2ludC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRiZWdpbiA9ICsrSW5kZXg7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yIChwb3NpdGlvbiA9IEluZGV4ICsgNDsgSW5kZXggPCBwb3NpdGlvbjsgSW5kZXgrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBIHZhbGlkIHNlcXVlbmNlIGNvbXByaXNlcyBmb3VyIGhleGRpZ2l0cyAoY2FzZS1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGluc2Vuc2l0aXZlKSB0aGF0IGZvcm0gYSBzaW5nbGUgaGV4YWRlY2ltYWwgdmFsdWUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIShjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1NyB8fCBjaGFyQ29kZSA+PSA5NyAmJiBjaGFyQ29kZSA8PSAxMDIgfHwgY2hhckNvZGUgPj0gNjUgJiYgY2hhckNvZGUgPD0gNzApKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEludmFsaWQgVW5pY29kZSBlc2NhcGUgc2VxdWVuY2UuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJldml2ZSB0aGUgZXNjYXBlZCBjaGFyYWN0ZXIuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgKz0gZnJvbUNoYXJDb2RlKFwiMHhcIiArIHNvdXJjZS5zbGljZShiZWdpbiwgSW5kZXgpKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnZhbGlkIGVzY2FwZSBzZXF1ZW5jZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2hhckNvZGUgPT0gMzQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQW4gdW5lc2NhcGVkIGRvdWJsZS1xdW90ZSBjaGFyYWN0ZXIgbWFya3MgdGhlIGVuZCBvZiB0aGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gc3RyaW5nLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoSW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YmVnaW4gPSBJbmRleDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9wdGltaXplIGZvciB0aGUgY29tbW9uIGNhc2Ugd2hlcmUgYSBzdHJpbmcgaXMgdmFsaWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR3aGlsZSAoY2hhckNvZGUgPj0gMzIgJiYgY2hhckNvZGUgIT0gOTIgJiYgY2hhckNvZGUgIT0gMzQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdCgrK0luZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFwcGVuZCB0aGUgc3RyaW5nIGFzLWlzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWUgKz0gc291cmNlLnNsaWNlKGJlZ2luLCBJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChzb3VyY2UuY2hhckNvZGVBdChJbmRleCkgPT0gMzQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBZHZhbmNlIHRvIHRoZSBuZXh0IGNoYXJhY3RlciBhbmQgcmV0dXJuIHRoZSByZXZpdmVkIHN0cmluZy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBVbnRlcm1pbmF0ZWQgc3RyaW5nLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgbnVtYmVycyBhbmQgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJlZ2luID0gSW5kZXg7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEFkdmFuY2UgcGFzdCB0aGUgbmVnYXRpdmUgc2lnbiwgaWYgb25lIGlzIHNwZWNpZmllZC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNoYXJDb2RlID09IDQ1KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aXNTaWduZWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoKytJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgYW4gaW50ZWdlciBvciBmbG9hdGluZy1wb2ludCB2YWx1ZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTGVhZGluZyB6ZXJvZXMgYXJlIGludGVycHJldGVkIGFzIG9jdGFsIGxpdGVyYWxzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyQ29kZSA9PSA0OCAmJiAoKGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoSW5kZXggKyAxKSksIGNoYXJDb2RlID49IDQ4ICYmIGNoYXJDb2RlIDw9IDU3KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWxsZWdhbCBvY3RhbCBsaXRlcmFsLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aXNTaWduZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSB0aGUgaW50ZWdlciBjb21wb25lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICg7IEluZGV4IDwgbGVuZ3RoICYmICgoY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChJbmRleCkpLCBjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1Nyk7IEluZGV4KyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEZsb2F0cyBjYW5ub3QgY29udGFpbiBhIGxlYWRpbmcgZGVjaW1hbCBwb2ludDsgaG93ZXZlciwgdGhpc1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGNhc2UgaXMgYWxyZWFkeSBhY2NvdW50ZWQgZm9yIGJ5IHRoZSBwYXJzZXIuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHNvdXJjZS5jaGFyQ29kZUF0KEluZGV4KSA9PSA0Nikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cG9zaXRpb24gPSArK0luZGV4O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgdGhlIGRlY2ltYWwgY29tcG9uZW50LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICg7IHBvc2l0aW9uIDwgbGVuZ3RoICYmICgoY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChwb3NpdGlvbikpLCBjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1Nyk7IHBvc2l0aW9uKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBvc2l0aW9uID09IEluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElsbGVnYWwgdHJhaWxpbmcgZGVjaW1hbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdEluZGV4ID0gcG9zaXRpb247XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcnNlIGV4cG9uZW50cy4gVGhlIGBlYCBkZW5vdGluZyB0aGUgZXhwb25lbnQgaXNcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBjYXNlLWluc2Vuc2l0aXZlLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoSW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyQ29kZSA9PSAxMDEgfHwgY2hhckNvZGUgPT0gNjkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJDb2RlID0gc291cmNlLmNoYXJDb2RlQXQoKytJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTa2lwIHBhc3QgdGhlIHNpZ24gZm9sbG93aW5nIHRoZSBleHBvbmVudCwgaWYgb25lIGlzXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBzcGVjaWZpZWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoY2hhckNvZGUgPT0gNDMgfHwgY2hhckNvZGUgPT0gNDUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0SW5kZXgrKztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFBhcnNlIHRoZSBleHBvbmVudGlhbCBjb21wb25lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKHBvc2l0aW9uID0gSW5kZXg7IHBvc2l0aW9uIDwgbGVuZ3RoICYmICgoY2hhckNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChwb3NpdGlvbikpLCBjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1Nyk7IHBvc2l0aW9uKyspO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHBvc2l0aW9uID09IEluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElsbGVnYWwgZW1wdHkgZXhwb25lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCA9IHBvc2l0aW9uO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDb2VyY2UgdGhlIHBhcnNlZCB2YWx1ZSB0byBhIEphdmFTY3JpcHQgbnVtYmVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiArc291cmNlLnNsaWNlKGJlZ2luLCBJbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQSBuZWdhdGl2ZSBzaWduIG1heSBvbmx5IHByZWNlZGUgbnVtYmVycy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGlzU2lnbmVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgdHJ1ZWAsIGBmYWxzZWAsIGFuZCBgbnVsbGAgbGl0ZXJhbHMuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChzb3VyY2Uuc2xpY2UoSW5kZXgsIEluZGV4ICsgNCkgPT0gXCJ0cnVlXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCArPSA0O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHNvdXJjZS5zbGljZShJbmRleCwgSW5kZXggKyA1KSA9PSBcImZhbHNlXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCArPSA1O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChzb3VyY2Uuc2xpY2UoSW5kZXgsIEluZGV4ICsgNCkgPT0gXCJudWxsXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCArPSA0O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVucmVjb2duaXplZCB0b2tlbi5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmV0dXJuIHRoZSBzZW50aW5lbCBgJGAgY2hhcmFjdGVyIGlmIHRoZSBwYXJzZXIgaGFzIHJlYWNoZWQgdGhlIGVuZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBvZiB0aGUgc291cmNlIHN0cmluZy5cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIFwiJFwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFBhcnNlcyBhIEpTT04gYHZhbHVlYCB0b2tlbi5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBnZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHJlc3VsdHMsIGhhc01lbWJlcnM7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PSBcIiRcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVuZXhwZWN0ZWQgZW5kIG9mIGlucHV0LlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKChjaGFySW5kZXhCdWdneSA/IHZhbHVlLmNoYXJBdCgwKSA6IHZhbHVlWzBdKSA9PSBcIkBcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBzZW50aW5lbCBgQGAgY2hhcmFjdGVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlLnNsaWNlKDEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBQYXJzZSBvYmplY3QgYW5kIGFycmF5IGxpdGVyYWxzLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PSBcIltcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2VzIGEgSlNPTiBhcnJheSwgcmV0dXJuaW5nIGEgbmV3IEphdmFTY3JpcHQgYXJyYXkuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXN1bHRzID0gW107XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKDs7IGhhc01lbWJlcnMgfHwgKGhhc01lbWJlcnMgPSB0cnVlKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGxleCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBBIGNsb3Npbmcgc3F1YXJlIGJyYWNrZXQgbWFya3MgdGhlIGVuZCBvZiB0aGUgYXJyYXkgbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID09IFwiXVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWYgdGhlIGFycmF5IGxpdGVyYWwgY29udGFpbnMgZWxlbWVudHMsIHRoZSBjdXJyZW50IHRva2VuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNob3VsZCBiZSBhIGNvbW1hIHNlcGFyYXRpbmcgdGhlIHByZXZpb3VzIGVsZW1lbnQgZnJvbSB0aGVcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gbmV4dC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGhhc01lbWJlcnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCIsXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gbGV4KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCJdXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVW5leHBlY3RlZCB0cmFpbGluZyBgLGAgaW4gYXJyYXkgbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQSBgLGAgbXVzdCBzZXBhcmF0ZSBlYWNoIGFycmF5IGVsZW1lbnQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBFbGlzaW9ucyBhbmQgbGVhZGluZyBjb21tYXMgYXJlIG5vdCBwZXJtaXR0ZWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh2YWx1ZSA9PSBcIixcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0cy5wdXNoKGdldCh2YWx1ZSkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmICh2YWx1ZSA9PSBcIntcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2VzIGEgSlNPTiBvYmplY3QsIHJldHVybmluZyBhIG5ldyBKYXZhU2NyaXB0IG9iamVjdC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdHMgPSB7fTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAoOzsgaGFzTWVtYmVycyB8fCAoaGFzTWVtYmVycyA9IHRydWUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gbGV4KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgY2xvc2luZyBjdXJseSBicmFjZSBtYXJrcyB0aGUgZW5kIG9mIHRoZSBvYmplY3QgbGl0ZXJhbC5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID09IFwifVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gSWYgdGhlIG9iamVjdCBsaXRlcmFsIGNvbnRhaW5zIG1lbWJlcnMsIHRoZSBjdXJyZW50IHRva2VuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIHNob3VsZCBiZSBhIGNvbW1hIHNlcGFyYXRvci5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGhhc01lbWJlcnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCIsXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlID0gbGV4KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodmFsdWUgPT0gXCJ9XCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVW5leHBlY3RlZCB0cmFpbGluZyBgLGAgaW4gb2JqZWN0IGxpdGVyYWwuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEEgYCxgIG11c3Qgc2VwYXJhdGUgZWFjaCBvYmplY3QgbWVtYmVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gTGVhZGluZyBjb21tYXMgYXJlIG5vdCBwZXJtaXR0ZWQsIG9iamVjdCBwcm9wZXJ0eSBuYW1lcyBtdXN0IGJlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIGRvdWJsZS1xdW90ZWQgc3RyaW5ncywgYW5kIGEgYDpgIG11c3Qgc2VwYXJhdGUgZWFjaCBwcm9wZXJ0eVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBuYW1lIGFuZCB2YWx1ZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHZhbHVlID09IFwiLFwiIHx8IHR5cGVvZiB2YWx1ZSAhPSBcInN0cmluZ1wiIHx8IChjaGFySW5kZXhCdWdneSA/IHZhbHVlLmNoYXJBdCgwKSA6IHZhbHVlWzBdKSAhPSBcIkBcIiB8fCBsZXgoKSAhPSBcIjpcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFib3J0KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzdWx0c1t2YWx1ZS5zbGljZSgxKV0gPSBnZXQobGV4KCkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFVuZXhwZWN0ZWQgdG9rZW4gZW5jb3VudGVyZWQuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWJvcnQoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJbnRlcm5hbDogVXBkYXRlcyBhIHRyYXZlcnNlZCBvYmplY3QgbWVtYmVyLlxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uIChzb3VyY2UsIHByb3BlcnR5LCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgZWxlbWVudCA9IHdhbGsoc291cmNlLCBwcm9wZXJ0eSwgY2FsbGJhY2spO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZWxlbWVudCA9PT0gdW5kZWYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgc291cmNlW3Byb3BlcnR5XTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzb3VyY2VbcHJvcGVydHldID0gZWxlbWVudDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gSW50ZXJuYWw6IFJlY3Vyc2l2ZWx5IHRyYXZlcnNlcyBhIHBhcnNlZCBKU09OIG9iamVjdCwgaW52b2tpbmcgdGhlXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBgY2FsbGJhY2tgIGZ1bmN0aW9uIGZvciBlYWNoIHZhbHVlLiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZVxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gYFdhbGsoaG9sZGVyLCBuYW1lKWAgb3BlcmF0aW9uIGRlZmluZWQgaW4gRVMgNS4xIHNlY3Rpb24gMTUuMTIuMi5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciB3YWxrID0gZnVuY3Rpb24gKHNvdXJjZSwgcHJvcGVydHksIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciB2YWx1ZSA9IHNvdXJjZVtwcm9wZXJ0eV0sXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHlwZW9mIHZhbHVlID09IFwib2JqZWN0XCIgJiYgdmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBgZm9yRWFjaGAgY2FuJ3QgYmUgdXNlZCB0byB0cmF2ZXJzZSBhbiBhcnJheSBpbiBPcGVyYSA8PSA4LjU0XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYmVjYXVzZSBpdHMgYE9iamVjdCNoYXNPd25Qcm9wZXJ0eWAgaW1wbGVtZW50YXRpb24gcmV0dXJucyBgZmFsc2VgXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gZm9yIGFycmF5IGluZGljZXMgKGUuZy4sIGAhWzEsIDIsIDNdLmhhc093blByb3BlcnR5KFwiMFwiKWApLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChnZXRDbGFzcy5jYWxsKHZhbHVlKSA9PSBhcnJheUNsYXNzKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmb3IgKGxlbmd0aCA9IHZhbHVlLmxlbmd0aDsgbGVuZ3RoLS07KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHVwZGF0ZSh2YWx1ZSwgbGVuZ3RoLCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvckVhY2godmFsdWUsIGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR1cGRhdGUodmFsdWUsIHByb3BlcnR5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrLmNhbGwoc291cmNlLCBwcm9wZXJ0eSwgdmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUHVibGljOiBgSlNPTi5wYXJzZWAuIFNlZSBFUyA1LjEgc2VjdGlvbiAxNS4xMi4yLlxuXHRcdFx0XHRcdFx0XHRcdFx0ZXhwb3J0cy5wYXJzZSA9IGZ1bmN0aW9uIChzb3VyY2UsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciByZXN1bHQsIHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRJbmRleCA9IDA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFNvdXJjZSA9IFwiXCIgKyBzb3VyY2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJlc3VsdCA9IGdldChsZXgoKSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIElmIGEgSlNPTiBzdHJpbmcgY29udGFpbnMgbXVsdGlwbGUgdG9rZW5zLCBpdCBpcyBpbnZhbGlkLlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobGV4KCkgIT0gXCIkXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhYm9ydCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlc2V0IHRoZSBwYXJzZXIgc3RhdGUuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdEluZGV4ID0gU291cmNlID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrICYmIGdldENsYXNzLmNhbGwoY2FsbGJhY2spID09IGZ1bmN0aW9uQ2xhc3MgPyB3YWxrKCh2YWx1ZSA9IHt9LCB2YWx1ZVtcIlwiXSA9IHJlc3VsdCwgdmFsdWUpLCBcIlwiLCBjYWxsYmFjaykgOiByZXN1bHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdGV4cG9ydHNbXCJydW5JbkNvbnRleHRcIl0gPSBydW5JbkNvbnRleHQ7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBleHBvcnRzO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRpZiAoZnJlZUV4cG9ydHMgJiYgIWlzTG9hZGVyKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEV4cG9ydCBmb3IgQ29tbW9uSlMgZW52aXJvbm1lbnRzLlxuXHRcdFx0XHRcdFx0XHRydW5JbkNvbnRleHQocm9vdCwgZnJlZUV4cG9ydHMpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gRXhwb3J0IGZvciB3ZWIgYnJvd3NlcnMgYW5kIEphdmFTY3JpcHQgZW5naW5lcy5cblx0XHRcdFx0XHRcdFx0dmFyIG5hdGl2ZUpTT04gPSByb290LkpTT04sXG5cdFx0XHRcdFx0XHRcdFx0cHJldmlvdXNKU09OID0gcm9vdFtcIkpTT04zXCJdLFxuXHRcdFx0XHRcdFx0XHRcdGlzUmVzdG9yZWQgPSBmYWxzZTtcblxuXHRcdFx0XHRcdFx0XHR2YXIgSlNPTjMgPSBydW5JbkNvbnRleHQocm9vdCwgKHJvb3RbXCJKU09OM1wiXSA9IHtcblx0XHRcdFx0XHRcdFx0XHQvLyBQdWJsaWM6IFJlc3RvcmVzIHRoZSBvcmlnaW5hbCB2YWx1ZSBvZiB0aGUgZ2xvYmFsIGBKU09OYCBvYmplY3QgYW5kXG5cdFx0XHRcdFx0XHRcdFx0Ly8gcmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgYEpTT04zYCBvYmplY3QuXG5cdFx0XHRcdFx0XHRcdFx0XCJub0NvbmZsaWN0XCI6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICghaXNSZXN0b3JlZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpc1Jlc3RvcmVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cm9vdC5KU09OID0gbmF0aXZlSlNPTjtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cm9vdFtcIkpTT04zXCJdID0gcHJldmlvdXNKU09OO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRuYXRpdmVKU09OID0gcHJldmlvdXNKU09OID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBKU09OMztcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pKTtcblxuXHRcdFx0XHRcdFx0XHRyb290LkpTT04gPSB7XG5cdFx0XHRcdFx0XHRcdFx0XCJwYXJzZVwiOiBKU09OMy5wYXJzZSxcblx0XHRcdFx0XHRcdFx0XHRcInN0cmluZ2lmeVwiOiBKU09OMy5zdHJpbmdpZnlcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gRXhwb3J0IGZvciBhc3luY2hyb25vdXMgbW9kdWxlIGxvYWRlcnMuXG5cdFx0XHRcdFx0XHRpZiAoaXNMb2FkZXIpIHtcblx0XHRcdFx0XHRcdFx0ZGVmaW5lKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gSlNPTjM7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pLmNhbGwodGhpcyk7XG5cblx0XHRcdFx0fSkuY2FsbCh0aGlzLCB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHt9KVxuXHRcdFx0fSwge31dLFxuXHRcdFx0NTE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XG5cdFx0XHRcdG1vZHVsZS5leHBvcnRzID0gdG9BcnJheVxuXG5cdFx0XHRcdGZ1bmN0aW9uIHRvQXJyYXkobGlzdCwgaW5kZXgpIHtcblx0XHRcdFx0XHR2YXIgYXJyYXkgPSBbXVxuXG5cdFx0XHRcdFx0aW5kZXggPSBpbmRleCB8fCAwXG5cblx0XHRcdFx0XHRmb3IgKHZhciBpID0gaW5kZXggfHwgMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGFycmF5W2kgLSBpbmRleF0gPSBsaXN0W2ldXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIGFycmF5XG5cdFx0XHRcdH1cblxuXHRcdFx0fSwge31dXG5cdFx0fSwge30sIFszMV0pKDMxKVxuXHR9KTtcbn0iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX3Nwckljb246IG51bGwsXHJcbiAgICAgICAgX3podWFuZzogbnVsbCxcclxuICAgICAgICBfcmVhZHk6IG51bGwsXHJcbiAgICAgICAgX29mZmxpbmU6IG51bGwsXHJcbiAgICAgICAgX2xibE5hbWU6IG51bGwsXHJcbiAgICAgICAgX2xibFNjb3JlOiBudWxsLFxyXG4gICAgICAgIF9uZGRheWluZ2ppYTogbnVsbCxcclxuICAgICAgICBfdm9pY2Vtc2c6IG51bGwsXHJcbiAgICAgICAgX2NoYXRCdWJibGU6IG51bGwsXHJcbiAgICAgICAgX2Vtb2ppOiBudWxsLFxyXG4gICAgICAgIF9sYXN0Q2hhdFRpbWU6IC0xLFxyXG4gICAgICAgIF91c2VyTmFtZTogXCJcIixcclxuICAgICAgICBfc2NvcmU6IDAsXHJcbiAgICAgICAgX2RheWluZ2ppYTogZmFsc2UsXHJcbiAgICAgICAgX2lzT2ZmbGluZTogZmFsc2UsXHJcbiAgICAgICAgX2lzUmVhZHk6IGZhbHNlLFxyXG4gICAgICAgIF9pc1podWFuZzogZmFsc2UsXHJcbiAgICAgICAgX3VzZXJJZDogbnVsbCxcclxuICAgICAgICBfaXNLYW5QYWk6IGZhbHNlLFxyXG4gICAgICAgIF9pc1FpUGFpOiBmYWxzZSxcclxuICAgICAgICBfaXNTaHU6IGZhbHNlLFxyXG4gICAgICAgIF90aW1lTGFiZWw6IG51bGwsXHJcbiAgICAgICAgX3RpbWU6IC0xLFxyXG4gICAgfSxcclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY2MudnYgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3Nwckljb24gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJoZWFkXCIpLmdldENvbXBvbmVudChcIkltYWdlTG9hZGVyXCIpO1xyXG4gICAgICAgIHRoaXMuX2xibE5hbWUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJuYW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fbGJsU2NvcmUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJtb25leVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX2Nvc3RNb25leSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInpqaDE0XCIpLmdldENoaWxkQnlOYW1lKFwieGlhemh1XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XHJcbiAgICAgICAgdGhpcy5fa2FuaWNvbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImthbmljb25cIik7XHJcbiAgICAgICAgdGhpcy5fc2h1aWNvbiA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcInNodWljb25cIik7XHJcbiAgICAgICAgdGhpcy5fcWlpY29uID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicWlpY29uXCIpO1xyXG4gICAgICAgIHRoaXMuX2thbnBhaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImthbnBhaVwiKTtcclxuICAgICAgICB0aGlzLl9zYXlrYW5wYWkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJzYXlrYW5wYWlcIik7XHJcbiAgICAgICAgdGhpcy5fZ2Vuemh1ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZ2Vuemh1XCIpO1xyXG4gICAgICAgIHRoaXMuX2ppYXpodSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImppYXpodVwiKTtcclxuICAgICAgICB0aGlzLl9mYW5ncWkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJmYW5ncWlcIik7XHJcbiAgICAgICAgdGhpcy5fcGtCdXR0b24gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJwa19idXR0b25cIik7XHJcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcIkNoYXRCdWJibGVcIik7XHJcbiAgICAgICAgdGhpcy5feWFuaHVhID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwieWFuaHVhXCIpO1xyXG4gICAgICAgIHRoaXMuX3lhbmh1YUFuaW0gPSB0aGlzLl95YW5odWEuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgdGhpcy5fdGltZUxhYmVsID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwidG9nZ2xlXCIpLmdldENoaWxkQnlOYW1lKFwibGJsVGltZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBcIjAwXCI7XHJcbiAgICAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9wa0J1dHRvbiwgdGhpcy5ub2RlLCBcInpqaFNlYXRcIiwgXCJvbkNsaWNrUGtCdXR0b25cIik7XHJcbiAgICAgICAgLy8gdGhpcy5fdm9pY2Vtc2cgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ2b2ljZW1zZ1wiKTtcclxuICAgICAgICAvLyBpZiAodGhpcy5fdm9pY2Vtc2cpIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5fdm9pY2Vtc2cuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIGlmICh0aGlzLl9zcHJJY29uICYmIHRoaXMuX3Nwckljb24uZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikpIHtcclxuICAgICAgICAvLyAgICAgY2MudnYudXRpbHMuYWRkQ2xpY2tFdmVudCh0aGlzLl9zcHJJY29uLCB0aGlzLm5vZGUsIFwiU2VhdFwiLCBcIm9uSWNvbkNsaWNrZWRcIik7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIHRoaXMuX29mZmxpbmUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJvZmZsaW5lXCIpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlYWR5ID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwicmVhZHlcIik7XHJcbiAgICAgICAgdGhpcy5femh1YW5nID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiemh1YW5nXCIpO1xyXG4gICAgICAgIC8vIHRoaXMuX25kZGF5aW5namlhID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZGF5aW5namlhXCIpO1xyXG4gICAgICAgIHRoaXMuX2Vtb2ppID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiZW1vamlcIik7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24gJiYgdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nwckljb24uc2V0VXNlcklEKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uSWNvbkNsaWNrZWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBpY29uU3ByaXRlID0gdGhpcy5fc3BySWNvbi5ub2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgIGlmICh0aGlzLl91c2VySWQgIT0gbnVsbCAmJiB0aGlzLl91c2VySWQgPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWF0ID0gY2MudnYuZ2FtZU5ldE1nci5nZXRTZWF0QnlJRCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB2YXIgc2V4ID0gMDtcclxuICAgICAgICAgICAgaWYgKGNjLnZ2LmJhc2VJbmZvTWFwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IGNjLnZ2LmJhc2VJbmZvTWFwW3RoaXMuX3VzZXJJZF07XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNleCA9IGluZm8uc2V4O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9sYmxOYW1lICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsTmFtZS5zdHJpbmcgPSB0aGlzLl91c2VyTmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUuc3RyaW5nID0gdGhpcy5fc2NvcmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9uZGRheWluZ2ppYSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25kZGF5aW5namlhLmFjdGl2ZSA9IHRoaXMuX2RheWluZ2ppYSA9PSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fb2ZmbGluZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9vZmZsaW5lLmFjdGl2ZSA9IHRoaXMuX2lzT2ZmbGluZSAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiAoY2MudnYuZ2FtZU5ldE1nci5udW1PZkdhbWVzID4gMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl96aHVhbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5femh1YW5nLmFjdGl2ZSA9IHRoaXMuX2lzWmh1YW5nO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdGhpcy5fdXNlck5hbWUgIT0gbnVsbCAmJiB0aGlzLl91c2VyTmFtZSAhPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLl9rYW5pY29uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2thbmljb24uYWN0aXZlID0gdGhpcy5faXNLYW5QYWk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9zaHVpY29uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NodWljb24uYWN0aXZlID0gdGhpcy5faXNTaHU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9xaWljb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fcWlpY29uLmFjdGl2ZSA9IHRoaXMuX2lzUWlQYWk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9rYW5wYWkpIHtcclxuICAgICAgICAgICAgdGhpcy5fa2FucGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fc2F5a2FucGFpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NheWthbnBhaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2dlbnpodSkge1xyXG4gICAgICAgICAgICB0aGlzLl9nZW56aHUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9qaWF6aHUpIHtcclxuICAgICAgICAgICAgdGhpcy5famlhemh1LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fZmFuZ3FpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2ZhbmdxaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3BrQnV0dG9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BrQnV0dG9uLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fY2hhdEJ1YmJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fZW1vamkpIHtcclxuICAgICAgICAgICAgdGhpcy5fZW1vamkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl95YW5odWEpIHtcclxuICAgICAgICAgICAgdGhpcy5feWFuaHVhLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRJbmZvOiBmdW5jdGlvbihuYW1lLCBzY29yZSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9zY29yZSA9IHNjb3JlO1xyXG4gICAgICAgIGlmICh0aGlzLl9zY29yZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Njb3JlID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2xibFNjb3JlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fbGJsU2NvcmUubm9kZS5hY3RpdmUgPSB0aGlzLl9zY29yZSAhPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgIH0sXHJcbiAgICBzZXRaaHVhbmc6IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5faXNaaHVhbmcgPSB2YWx1ZTtcclxuICAgICAgICBpZiAodGhpcy5femh1YW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3podWFuZy5hY3RpdmUgPSB2YWx1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl96aHVhbmcgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6aHVhbmdcIik7XHJcbiAgICAgICAgICAgIHRoaXMuX3podWFuZy5hY3RpdmUgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0UmVhZHk6IGZ1bmN0aW9uKGlzUmVhZHkpIHtcclxuICAgICAgICB0aGlzLl9pc1JlYWR5ID0gaXNSZWFkeTtcclxuICAgICAgICBpZiAodGhpcy5fcmVhZHkpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVhZHkuYWN0aXZlID0gdGhpcy5faXNSZWFkeSAmJiAoY2MudnYuZ2FtZU5ldE1nci5udW1PZkdhbWVzID4gMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNldElEOiBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgIHZhciBpZE5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJpZFwiKTtcclxuICAgICAgICBpZiAoaWROb2RlKSB7XHJcbiAgICAgICAgICAgIHZhciBsYmwgPSBpZE5vZGUuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICAgICAgbGJsLnN0cmluZyA9IFwiSUQ6XCIgKyBpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gaWQ7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nwckljb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fc3BySWNvbi5zZXRVc2VySUQoaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBnZXRJRDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJZDtcclxuICAgIH0sXHJcbiAgICBzZXRPZmZsaW5lOiBmdW5jdGlvbihpc09mZmxpbmUpIHtcclxuICAgICAgICB0aGlzLl9pc09mZmxpbmUgPSBpc09mZmxpbmU7XHJcbiAgICAgICAgaWYgKHRoaXMuX29mZmxpbmUpIHtcclxuICAgICAgICAgICAgdGhpcy5fb2ZmbGluZS5hY3RpdmUgPSB0aGlzLl9pc09mZmxpbmUgJiYgdGhpcy5fdXNlck5hbWUgIT0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2hhdDogZnVuY3Rpb24oY29udGVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9jaGF0QnViYmxlID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9jaGF0QnViYmxlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGNvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5nZXRDaGlsZEJ5TmFtZShcIk5ldyBMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGNvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5fbGFzdENoYXRUaW1lID0gMztcclxuICAgIH0sXHJcbiAgICBlbW9qaTogZnVuY3Rpb24oZW1vamkpIHtcclxuICAgICAgICAvL2Vtb2ppID0gSlNPTi5wYXJzZShlbW9qaSk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Vtb2ppID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyhlbW9qaSk7XHJcbiAgICAgICAgdGhpcy5fY2hhdEJ1YmJsZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2Vtb2ppLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pLnBsYXkoZW1vamkpO1xyXG4gICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSA9IDM7XHJcbiAgICB9LFxyXG4gICAgdm9pY2VNc2c6IGZ1bmN0aW9uKHNob3cpIHtcclxuICAgICAgICBpZiAodGhpcy5fdm9pY2Vtc2cpIHtcclxuICAgICAgICAgICAgdGhpcy5fdm9pY2Vtc2cuYWN0aXZlID0gc2hvdztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0TW9uZXk6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAvL+iuvue9ruivpeeOqeWutuaJgOaLpeacieeahOeahOmSsVxyXG4gICAgICAgIHRoaXMuX2xibFNjb3JlLnN0cmluZyA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5fc2NvcmUgPSBkYXRhO1xyXG4gICAgfSxcclxuICAgIHNldENvc3RNb25leTogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIC8v6K6+572u6K+l546p5a625pys5bGA5omA5Y6L55qE5rOoXHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5fY29zdE1vbmV5LnN0cmluZyA9IGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiempoMTRcIikuYWN0aXZlKSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ6amgxNFwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIHNob3dHZW5aaHU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLl9nZW56aHUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLl9nZW56aHUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICB9LFxyXG4gICAgc2hvd0thblBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuX2thbmljb24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBzZWxmLl9zYXlrYW5wYWkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLl9zYXlrYW5wYWkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICB9LFxyXG4gICAgc2hvd0ppYVpodTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuX2ppYXpodS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX2ppYXpodS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgIH0sXHJcbiAgICBzaG93UWlQYWk6IGZ1bmN0aW9uKHN0YXR1cykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAoc3RhdHVzID09ICdzaHUnKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX3NodWljb24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLl9xaWljb24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZi5fZmFuZ3FpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fZmFuZ3FpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZmFuZ3FpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2hvd1BrQnV0dG9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fcGtCdXR0b24pIHtcclxuICAgICAgICAgICAgdGhpcy5fcGtCdXR0b24uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgaGlkZVBrQnV0dG9uOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fcGtCdXR0b24pIHtcclxuICAgICAgICAgICAgdGhpcy5fcGtCdXR0b24uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uQ2xpY2tQa0J1dHRvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2MudnYuZ2FtZU5ldE1nci5kaXNwYXRjaEV2ZW50KCdjbGlja1BrQnV0dG9uJywgdGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcbiAgICBzaG93WWFuaHVhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5feWFuaHVhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3lhbmh1YS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl95YW5odWFBbmltLnBsYXkoJ3lhbmh1YScpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzZXRUaW1lOiBmdW5jdGlvbihvKSB7XHJcbiAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSA9IDMwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBmYW5QYWk6IGZ1bmN0aW9uKHNwcml0ZUZyYW1lcykge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgemhlbmdwYWkgPSBzZWxmLl9rYW5wYWkuZ2V0Q2hpbGRCeU5hbWUoJ3poZW5ncGFpJyArIGkpO1xyXG4gICAgICAgICAgICB2YXIgcGFpT2JqID0gc3ByaXRlRnJhbWVzW2ldO1xyXG4gICAgICAgICAgICB2YXIgbnVtUmVzID0gcGFpT2JqWydudW0nXTtcclxuICAgICAgICAgICAgdmFyIGh1YXNlX2JpZ1JlcyA9IHBhaU9ialsnaHVhc2VfYmlnJ107XHJcbiAgICAgICAgICAgIHZhciBodWFzZV9zbWFsbFJlcyA9IHBhaU9ialsnaHVhc2Vfc21hbGwnXTtcclxuICAgICAgICAgICAgemhlbmdwYWkuZ2V0Q2hpbGRCeU5hbWUoJ251bScpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gbnVtUmVzO1xyXG4gICAgICAgICAgICB6aGVuZ3BhaS5nZXRDaGlsZEJ5TmFtZSgnaHVhc2VfYmlnJykuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBodWFzZV9iaWdSZXM7XHJcbiAgICAgICAgICAgIHpoZW5ncGFpLmdldENoaWxkQnlOYW1lKCdodWFzZV9zbWFsbCcpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gaHVhc2Vfc21hbGxSZXM7XHJcbiAgICAgICAgICAgIC8vIHpoZW5ncGFpLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWVzW2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLmhpZGVGdXBhaSgpO1xyXG4gICAgICAgIHNlbGYuX2thbnBhaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGhpZGVGdXBhaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmdXBhaSA9IHNlbGYubm9kZS5nZXRDaGlsZEJ5TmFtZSgnZnVwYWknICsgaSk7XHJcbiAgICAgICAgICAgIGZ1cGFpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgdXBkYXRlOiBmdW5jdGlvbihkdCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9sYXN0Q2hhdFRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xhc3RDaGF0VGltZSAtPSBkdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RDaGF0VGltZSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYXRCdWJibGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbW9qaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Vtb2ppLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pLnN0b3AoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fdGltZSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZSAtPSBkdDtcclxuICAgICAgICAgICAgdmFyIHByZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHQgPSBNYXRoLmNlaWwodGhpcy5fdGltZSk7XHJcbiAgICAgICAgICAgIGlmICh0IDwgMTApIHtcclxuICAgICAgICAgICAgICAgIHByZSA9IFwiMFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWVMYWJlbC5zdHJpbmcgPSBwcmUgKyB0O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyJdLCJzb3VyY2VSb290IjoiIn0=